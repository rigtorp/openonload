cscope 15 $HOME/incoming/onload_tests/src/driver/linux_onload               0000497856
	@bonding.c

12 
	~<lšux/v”siÚ.h
>

13 
	~<lšux/k”Ãl.h
>

14 
	~<lšux/moduË.h
>

15 
	~<lšux/¦ab.h
>

16 
	~<lšux/fs.h
>

17 
	~<lšux/Ãtdeviû.h
>

19 
	~<ci/driv”/š‹º®.h
>

20 
	~<ci/driv”/eçb/wÜkqueue.h
>

21 
	~<ci/eäm/eäm_ş›Á.h
>

22 
	~<Úlßd/tı_driv”.h
>

23 
	~<Úlßd/nic.h
>

24 
	~<Úlßd/ıÏÃ.h
>

25 
	~<Úlßd/debug.h
>

27 
	~<ci/š‹º®/Œª¥Üt_cÚfig_İt.h
>

29 
	~"Úlßd_š‹º®.h
"

31 #ià
CI_CFG_TEAMING


33 #ià
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,24)

34 
	#DEV_GET_BY_NAME
(
n
è
	`dev_g‘_by_Çme
Ò)

	)

36 
	#DEV_GET_BY_NAME
(
n
è
	`dev_g‘_by_Çme
(&
š™_Ãt
, (n))

	)

40 
	goo_bÚd_pŞl_ba£
 = (
HZ
/10);

41 
moduË_·¿m
(
oo_bÚd_pŞl_ba£
, , 
S_IRUGO
 | 
S_IWUSR
);

42 
MODULE_PARM_DESC
(
oo_bÚd_pŞl_ba£
,

49 * 
	$ci_¡ºchr
(cÚ¡ * 
s
, 
size_t
 
couÁ
, 
c
)

51  ; 
couÁ
-- && *
s
 != '\0'; ++s )

52 ifĞ*
s
 =ğ()
c
 )

53  (*)
s
;

54  
NULL
;

55 
	}
}

56 
	#¡ºchr
 
ci_¡ºchr


	)

58 
	sci_bÚdšg_iâame
 {

59 
	miâame
[
IFNAMSIZ
];

60 
ci_dÎšk
 
	mli¡_lšk
;

64 
	sci_bÚdšg_mÿ¡_subsütiÚ
 {

65 
ci_ušt32
 
	mmaddr
;

66 
ci_dÎšk
 
	mli¡_lšk
;

70 
	sci_bÚdšg_sysfs_»ad
 {

71 
fe
* 
	mf
;

72 
mm_£gm’t_t
 
	mŞd_fs
;

76 
	$ci_bÚdšg_¡¬t_sysfs_»ad
(*
f’ame
,

77 
ci_bÚdšg_sysfs_»ad
* 
¡©e
)

79 
¡©e
->
f
 = 
	`fp_İ’
(
f’ame
, 
O_RDONLY
, 0);

80 iàĞ
	`IS_ERR
(
¡©e
->
f
) )

81  -
EIO
;

83 iàĞ(
¡©e
->
f
->
f_İ
 =ğ
NULL
è|| (¡©e->f->f_İ->
»ad
 == NULL) ) {

84 
	`fp_şo£
(
¡©e
->
f
, 
NULL
);

85  -
EIO
;

88 
¡©e
->
Şd_fs
 = 
	`g‘_fs
();

89 
	`£t_fs
(
KERNEL_DS
);

92 
	}
}

95 
	$ci_bÚdšg_do_sysfs_»ad
(
ci_bÚdšg_sysfs_»ad
* 
¡©e
,

96 * 
d©a
, 
couÁ
)

98 
rc
;

101 
rc
 = 
¡©e
->
f
->
f_İ
->
	`»ad
(¡©e->f, (
__u£r
 *)
d©a
, 
couÁ
,

102 &
¡©e
->
f
->
f_pos
);

106 ifĞ
rc
 =ğ-
ERESTARTNOINTR
 )

107 
	`ş—r_tsk_th»ad_æag
(
cu¼’t
, 
TIF_SIGPENDING
);

110 }  
rc
 =ğ-
ERESTARTNOINTR
 ||„ø=ğ-
ERESTARTSYS
 );

111  
rc
;

112 
	}
}

115 
	$ci_bÚdšg_fšish_sysfs_»ad
(
ci_bÚdšg_sysfs_»ad
* 
¡©e
)

117 
	`£t_fs
(
¡©e
->
Şd_fs
);

119 
	`fp_şo£
(
¡©e
->
f
, 
NULL
);

122 
	}
}

125 
	$ci_bÚdšg_»ad_sysfs_fe
(*
f’ame
, *
d©a
, 
couÁ
)

127 
rc
;

128 
ci_bÚdšg_sysfs_»ad
 
¡©e
;

130 
rc
 = 
	`ci_bÚdšg_¡¬t_sysfs_»ad
(
f’ame
, &
¡©e
);

131 ifĞ
rc
 != 0 )

132  
rc
;

134 
rc
 = 
	`ci_bÚdšg_do_sysfs_»ad
(&
¡©e
, 
d©a
, 
couÁ
);

136 
	`ci_bÚdšg_fšish_sysfs_»ad
(&
¡©e
);

138  
rc
;

139 
	}
}

150 
šlše
 * 
	$lše_to_¡ršg
(*
buf
, 
couÁ
, 
Ãwlše
,

151 *
by‹s_cÚsumed
)

153 *
eŞ
 = 
	`¡ºchr
(
buf
, 
couÁ
, 
Ãwlše
);

155 iàĞ
eŞ
 =ğ
NULL
 ) {

156 *
by‹s_cÚsumed
 = 0;

157  
buf
;

160 *
eŞ
 = '\0';

162 *
by‹s_cÚsumed
 = (
eŞ
 - 
buf
) + 1;

163 iàĞ*
by‹s_cÚsumed
 < 
couÁ
 )

164 
eŞ
++;

166 
eŞ
 = 
NULL
;

167  
eŞ
;

168 
	}
}

171 
	#SYSFS_BASE
 "/sys/şass/Ãt/%s/bÚdšg/%s"

	)

172 
	#SYSFS_BASE_STRLEN
 24

	)

173 
	#SYSFS_MODE_LEAF
 "mode"

	)

174 
	#SYSFS_MODE_LEAF_STRLEN
 4

	)

175 
	#SYSFS_ACTIVESLAVE_LEAF
 "aùive_¦ave"

	)

176 
	#SYSFS_ACTIVESLAVE_LEAF_STRLEN
 12

	)

177 
	#SYSFS_SLAVES_LEAF
 "¦aves"

	)

178 
	#SYSFS_SLAVES_LEAF_STRLEN
 6

	)

179 
	#SYSFS_HASHPOLICY_LEAF
 "xm™_hash_pŞicy"

	)

180 
	#SYSFS_HASHPOLICY_LEAF_STRLEN
 16

	)

182 
	#PROC_NET_BONDING_BASE
 "/´oc/Ãt/bÚdšg/%s"

	)

183 
	#PROC_NET_BONDING_STRLEN
 18

	)

185 
	#SYSFS_READ_BLOCK_SIZE
 128

	)

187 
	$ci_bÚdšg_g‘_mode
(*
bÚd_Çme
, *
mode
)

189 * 
bufãr
;

190 * 
pbuf
;

191 * 
f’ame
;

192 
Ën
;

194 
bufãr
 = 
	`km®loc
(
SYSFS_READ_BLOCK_SIZE
 + 1, 
GFP_KERNEL
);

195 iàĞ
bufãr
 =ğ
NULL
 )

196  -
ENOMEM
;

198 
Ën
 = 
	`¡¾’
(
bÚd_Çme
è+ 
SYSFS_BASE_STRLEN
 + 
SYSFS_MODE_LEAF_STRLEN
 + 1;

199 
f’ame
 = 
	`km®loc
(
Ën
, 
GFP_KERNEL
);

200 iàĞ
f’ame
 =ğ
NULL
 ) {

201 
	`kä“
(
bufãr
);

202  -
ENOMEM
;

205 
	`¥rštf
(
f’ame
, 
SYSFS_BASE
, 
bÚd_Çme
, 
SYSFS_MODE_LEAF
);

207 
Ën
 = 
	`ci_bÚdšg_»ad_sysfs_fe
(
f’ame
, 
bufãr
, 
SYSFS_READ_BLOCK_SIZE
);

209 
	`kä“
(
f’ame
);

211 iàĞ
Ën
 < 0 ) {

212 
	`kä“
(
bufãr
);

213  
Ën
;

218 
pbuf
 = 
	`lše_to_¡ršg
(
bufãr
, 
Ën
, '\n', &len);

219 iàĞ
Ën
 == 0 ) {

220 
	`kä“
(
bufãr
);

221  -
EINVAL
;

224 
pbuf
 = 
	`¡ºchr
(
bufãr
, 
Ën
, ' ');

225 iàĞ
pbuf
 =ğ
NULL
 ) {

226 
	`kä“
(
bufãr
);

227  -
EINVAL
;

230 
Ën
 = 
	`ssÿnf
(
pbuf
, " %d", 
mode
);

231 iàĞ
Ën
 != 1 ) {

232 
	`kä“
(
bufãr
);

233  -
EINVAL
;

236 
	`kä“
(
bufãr
);

239 
	}
}

242 
	$ci_bÚdšg_g‘_hash_pŞicy
(*
bÚd_Çme
, *
pŞicy
)

244 * 
bufãr
;

245 * 
pbuf
;

246 * 
f’ame
;

247 
Ën
;

249 
bufãr
 = 
	`km®loc
(
SYSFS_READ_BLOCK_SIZE
 + 1, 
GFP_KERNEL
);

250 iàĞ
bufãr
 =ğ
NULL
 )

251  -
ENOMEM
;

253 
Ën
 = 
	`¡¾’
(
bÚd_Çme
) +

254 
SYSFS_BASE_STRLEN
 + 
SYSFS_HASHPOLICY_LEAF_STRLEN
 + 1;

255 
f’ame
 = 
	`km®loc
(
Ën
, 
GFP_KERNEL
);

256 iàĞ
f’ame
 =ğ
NULL
 ) {

257 
	`kä“
(
bufãr
);

258  -
ENOMEM
;

261 
	`¥rštf
(
f’ame
, 
SYSFS_BASE
, 
bÚd_Çme
, 
SYSFS_HASHPOLICY_LEAF
);

263 
Ën
 = 
	`ci_bÚdšg_»ad_sysfs_fe
(
f’ame
, 
bufãr
, 
SYSFS_READ_BLOCK_SIZE
);

265 
	`kä“
(
f’ame
);

267 iàĞ
Ën
 < 0 ) {

268 
	`kä“
(
bufãr
);

269  
Ën
;

274 
pbuf
 = 
	`lše_to_¡ršg
(
bufãr
, 
Ën
, '\n', &len);

275 iàĞ
Ën
 == 0 ) {

276 
	`kä“
(
bufãr
);

277  -
EINVAL
;

280 
pbuf
 = 
	`¡ºchr
(
bufãr
, 
Ën
, ' ');

281 iàĞ
pbuf
 =ğ
NULL
 ) {

282 
	`kä“
(
bufãr
);

283  -
EINVAL
;

286 
Ën
 = 
	`ssÿnf
(
pbuf
, " %d", 
pŞicy
);

287 iàĞ
Ën
 != 1 ) {

288 
	`kä“
(
bufãr
);

289  -
EINVAL
;

292 
	`kä“
(
bufãr
);

295 
	}
}

297 #ià
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(2,6,39)

299 
	$ci_bÚdšg_g‘_ab_aùive_¦ave
(*
bÚd_Çme
, *
aùive
,

300 
aùive_Ën
)

302 * 
bufãr
;

303 * 
f’ame
;

304 
Ën
;

306 
bufãr
 = 
	`km®loc
(
SYSFS_READ_BLOCK_SIZE
 + 1, 
GFP_KERNEL
);

307 iàĞ
bufãr
 =ğ
NULL
 )

308  -
ENOMEM
;

310 
Ën
 = 
	`¡¾’
(
bÚd_Çme
) +

311 
SYSFS_BASE_STRLEN
 + 
SYSFS_ACTIVESLAVE_LEAF_STRLEN
 + 1;

312 
f’ame
 = 
	`km®loc
(
Ën
, 
GFP_KERNEL
);

313 iàĞ
f’ame
 =ğ
NULL
 ) {

314 
	`kä“
(
bufãr
);

315  -
ENOMEM
;

318 
	`¥rštf
(
f’ame
, 
SYSFS_BASE
, 
bÚd_Çme
, 
SYSFS_ACTIVESLAVE_LEAF
);

320 
Ën
 = 
	`ci_bÚdšg_»ad_sysfs_fe
(
f’ame
, 
bufãr
, 
SYSFS_READ_BLOCK_SIZE
);

322 
	`kä“
(
f’ame
);

324 iàĞ
Ën
 < 0 ) {

325 
	`kä“
(
bufãr
);

326  
Ën
;

329 iàĞ
Ën
 == 0 ) {

330 
	`kä“
(
bufãr
);

331  -
ENOENT
;

336 
	`lše_to_¡ršg
(
bufãr
, 
Ën
, '\n', &len);

337 iàĞ
Ën
 == 0 ) {

338 
	`kä“
(
bufãr
);

339  -
EINVAL
;

342 ià(
Ën
 < 
aùive_Ën
)

343 
	`¡rıy
(
aùive
, 
bufãr
);

345 
	`kä“
(
bufãr
);

346  -
EINVAL
;

349 
	`kä“
(
bufãr
);

351  
Ën
;

352 
	}
}

356 (
	tci_bÚdšg_li¡_’Œy_â
)(
	tci_dÎi¡
*, *, , *);

358 
	$ci_bÚdšg_g‘_li¡
(*
f’ame
, 
ci_dÎi¡
 *
ouut_li¡
,

359 
ci_bÚdšg_li¡_’Œy_â
 *
’Œy_â
,

360 *
¬g
)

362 * 
bufãr
;

363 * 
sü©ch
;

364 * 
pbuf
;

365 
ci_bÚdšg_sysfs_»ad
 
¡©e
;

366 
rc
, 
»ad_Ën
 = 0, 
lše_Ën
, 
bufãr_off£t
 = 0, 
Ëáov”_Ën
 = 0;

368 
bufãr
 = 
	`km®loc
(
SYSFS_READ_BLOCK_SIZE
 + 1, 
GFP_KERNEL
);

369 iàĞ
bufãr
 =ğ
NULL
 )

370  -
ENOMEM
;

372 
rc
 = 
	`ci_bÚdšg_¡¬t_sysfs_»ad
(
f’ame
, &
¡©e
);

373 ifĞ
rc
 != 0 ) {

374 
	`kä“
(
bufãr
);

375  
rc
;

379 
Ëáov”_Ën
 = 
»ad_Ën
 - 
bufãr_off£t
;

380 ifĞ
Ëáov”_Ën
 ) {

381 
sü©ch
 = 
	`km®loc
(
SYSFS_READ_BLOCK_SIZE
 + 1, 
GFP_KERNEL
);

382 iàĞ
sü©ch
 =ğ
NULL
 ) {

383 
rc
 = -
ENOMEM
;

384 
dÚe
;

387 
	`memıy
(
sü©ch
, 
bufãr
+
bufãr_off£t
, 
Ëáov”_Ën
);

388 
	`memıy
(
bufãr
, 
sü©ch
, 
Ëáov”_Ën
);

389 
	`kä“
(
sü©ch
);

395 
rc
 = 
	`ci_bÚdšg_do_sysfs_»ad
(&
¡©e
, 
bufãr
 + 
Ëáov”_Ën
,

396 
SYSFS_READ_BLOCK_SIZE
 - 
Ëáov”_Ën
);

398 ifĞ
rc
 < 0 ) {

399 ifĞ
	`ci_dÎi¡_nÙ_em±y
(
ouut_li¡
) ) {

401 
rc
 = 0;

403 
dÚe
;

405 ifĞ
rc
 == 0 )

406 
dÚe
;

408 
»ad_Ën
 = 
rc
 + 
Ëáov”_Ën
;

409 
bufãr_off£t
 = 0;

410 
pbuf
 = 
bufãr
;

413 
pbuf
 = 
	`lše_to_¡ršg
(
bufãr
 + 
bufãr_off£t
,

414 
»ad_Ën
 - 
bufãr_off£t
,

415 '\n', &
lše_Ën
);

416 ià(
lše_Ën
) {

417 
	`’Œy_â
(
ouut_li¡
, 
bufãr
+
bufãr_off£t
, 
lše_Ën
, 
¬g
);

418 
bufãr_off£t
 +ğ
lše_Ën
;

420 } 
bufãr_off£t
 < 
»ad_Ën
 && 
pbuf
 !ğ
NULL
 && 
lše_Ën
 != 0);

421 } 
»ad_Ën
 =ğ
SYSFS_READ_BLOCK_SIZE
 && 
bufãr_off£t
 > 0);

423 
rc
 = 0;

425 
dÚe
:

426 
	`kä“
(
bufãr
);

427 
	`ci_bÚdšg_fšish_sysfs_»ad
(&
¡©e
);

428  
rc
;

429 
	}
}

432 
	$ci_bÚdšg_g‘_iâames_’Œy_â
(
ci_dÎi¡
* 
iæi¡
, * 
lše
,

433 
lše_Ën
, *
¬g
)

435 *
Ãxt
;

436 
ci_bÚdšg_iâame
 *
iâame
;

439 
iâame
 = 
	`km®loc
((
ci_bÚdšg_iâame
), 
GFP_KERNEL
);

441 ifĞ
iâame
 =ğ
NULL
)

444 
	`ci_as£¹
(
lše
 !ğ
NULL
);

445 
	`ci_as£¹
(
lše_Ën
);

447  
lše_Ën
 > 0 && (*
lše
 == '\n' || *line == ' ' || *line == '\0') ) {

448 ++
lše
;

449 --
lše_Ën
;

452 ifĞ
lše_Ën
 == 0 )

455 
Ãxt
 = 
	`¡ºchr
(
lše
, 
lše_Ën
, ' ');

457 ifĞ
Ãxt
 !ğ
NULL
 ) {

458 
	`ci_as£¹
(
Ãxt
 - 
lše
 <ğ
IFNAMSIZ
);

459 
	`¡ºıy
(
iâame
->iâame, 
lše
, 
Ãxt
 -†ine);

460 
iâame
->iâame[
Ãxt
 - 
lše
] = '\0';

461 
Ãxt
++;

462 
lše_Ën
 -ğ(
Ãxt
 - 
lše
);

465 
	`¡ºıy
(
iâame
->iâame, 
lše
, 
IFNAMSIZ
);

466 
lše_Ën
 = 0;

469 
	`ci_dÎi¡_push
(
iæi¡
, &
iâame
->
li¡_lšk
);

471 
lše
 = 
Ãxt
;

472 } 
lše
 !ğ
NULL
);

473 
	}
}

476 
	$ci_bÚdšg_g‘_ma¡”s
(
ci_dÎi¡
 *
ma¡”s
)

478  
	`ci_bÚdšg_g‘_li¡
("/sys/şass/Ãt/bÚdšg_ma¡”s", 
ma¡”s
,

479 
ci_bÚdšg_g‘_iâames_’Œy_â
, 
NULL
);

480 
	}
}

483 
	$ci_bÚdšg_g‘_¦aves
(*
bÚd_Çme
, 
ci_dÎi¡
 *
¦aves
)

485 *
f’ame
;

486 
Ën
, 
rc
;

488 
Ën
 = 
	`¡¾’
(
bÚd_Çme
è+ 
SYSFS_BASE_STRLEN
 + 
SYSFS_SLAVES_LEAF_STRLEN
;

489 
f’ame
 = 
	`km®loc
(
Ën
, 
GFP_KERNEL
);

490 iàĞ
f’ame
 =ğ
NULL
 )

491  -
ENOMEM
;

493 
	`¥rštf
(
f’ame
, 
SYSFS_BASE
, 
bÚd_Çme
, 
SYSFS_SLAVES_LEAF
);

495 
rc
 = 
	`ci_bÚdšg_g‘_li¡
(
f’ame
, 
¦aves
,

496 
ci_bÚdšg_g‘_iâames_’Œy_â
, 
NULL
);

498 
	`kä“
(
f’ame
);

500  
rc
;

501 
	}
}

504 
	$ci_bÚdšg_g‘_xm™_pŞicy_æags
(*
¬g
, *
æags
)

506 
Ãt_deviû
 *
Ãt_dev
 = (Ãt_deviû *)
¬g
;

507 
hash_pŞicy
 = 
CICP_BOND_XMIT_POLICY_NONE
;

508 
mode
;

510 ifĞ
	`ci_bÚdšg_g‘_mode
(
Ãt_dev
->
Çme
, &
mode
) != 0 )

513 ifĞ
mode
 =ğ
CICP_BOND_MODE_ACTIVE_BACKUP
 ||

514 
mode
 =ğ
CICP_BOND_MODE_802_3AD
 ) {

515 ifĞ
mode
 =ğ
CICP_BOND_MODE_802_3AD
 )

516 ifĞ
	`ci_bÚdšg_g‘_hash_pŞicy
(
Ãt_dev
->
Çme
, &
hash_pŞicy
) != 0 )

519 ifĞ
hash_pŞicy
 =ğ
CICP_BOND_XMIT_POLICY_NONE
 )

520 (*
æags
è&=~ 
CICP_LLAP_TYPE_USES_HASH
;

522 (*
æags
è|ğ
CICP_LLAP_TYPE_USES_HASH
;

524 ifĞ
hash_pŞicy
 =ğ
CICP_BOND_XMIT_POLICY_LAYER34
 )

525 (*
æags
è|ğ
CICP_LLAP_TYPE_XMIT_HASH_LAYER4
;

527 (*
æags
è&=~ 
CICP_LLAP_TYPE_XMIT_HASH_LAYER4
;

531 
	}
}

534 #ià
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(2,6,39)

536 
	sci_»ad_´oc_Ãt_bÚdšg_¡©e
 {

537 
	mcu¼’t_¦ave
[
IFNAMSIZ
];

538 
	magg_id
;

543 
	$ci_bÚdšg_g‘_Ïı_aùive_¦aves_’Œy_â
(
ci_dÎi¡
* 
aùive_¦aves
,

544 * 
lše
, 
lše_Ën
,

545 * 
¬g
)

547 
n
, 
agg_id
;

548 
¦ave_Çme
[
IFNAMSIZ
];

549 
ci_bÚdšg_iâame
 *
iâame
;

550 
ci_»ad_´oc_Ãt_bÚdšg_¡©e
* 
¡©e
 =

551 (
ci_»ad_´oc_Ãt_bÚdšg_¡©e
*)
¬g
;

553 
n
 = 
	`ssÿnf
(
lše
, " Agg»g©Ü ID: %d", &
agg_id
);

555 ifĞ
n
 == 1 ) {

556 ifĞ
¡©e
->
agg_id
 == -1 )

557 
¡©e
->
agg_id
 =‡gg_id;

559 ifĞ
¡©e
->
cu¼’t_¦ave
[0] != '\0' ) {

560 ifĞ
¡©e
->
agg_id
 ==‡gg_id ) {

561 
iâame
 = 
	`km®loc
((
ci_bÚdšg_iâame
), 
GFP_KERNEL
);

562 ifĞ
iâame
 !ğ
NULL
 ) {

563 
	`¡rıy
(
iâame
->iâame, 
¡©e
->
cu¼’t_¦ave
);

564 
	`ci_dÎi¡_push
(
aùive_¦aves
, &
iâame
->
li¡_lšk
);

567 
¡©e
->
cu¼’t_¦ave
[0] = '\0';

570 
	`OO_DEBUG_BONDING
(
	`ci_log
("Aggregator ID found without known slave"));

575 
n
 = 
	`ssÿnf
(
lše
, "SÏvIÁ”çû: %s", 
¦ave_Çme
);

576 ifĞ
n
 == 1 )

577 
	`¡rıy
(
¡©e
->
cu¼’t_¦ave
, 
¦ave_Çme
);

579 
	}
}

582 
	$ci_bÚdšg_g‘_Ïı_aùive_¦ave
(* 
bÚd_Çme
, * 
¦ave_Çme
)

584 
Ën
, 
rc
;

585 * 
f’ame
;

586 
ci_»ad_´oc_Ãt_bÚdšg_¡©e
 
¡©e
;

587 
ci_dÎi¡
 
aùive_¦aves
;

589 
¡©e
.
agg_id
 = -1;

590 
¡©e
.
cu¼’t_¦ave
[0] = '\0';

591 
	`ci_dÎi¡_š™
(&
aùive_¦aves
);

593 
Ën
 = 
	`¡¾’
(
bÚd_Çme
è+ 
PROC_NET_BONDING_STRLEN
 + 1;

594 
f’ame
 = 
	`km®loc
(
Ën
, 
GFP_KERNEL
);

595 iàĞ
f’ame
 =ğ
NULL
 )

596  -
ENOMEM
;

598 
	`¥rštf
(
f’ame
, 
PROC_NET_BONDING_BASE
, 
bÚd_Çme
);

600 
rc
 = 
	`ci_bÚdšg_g‘_li¡
(
f’ame
, &
aùive_¦aves
,

601 
ci_bÚdšg_g‘_Ïı_aùive_¦aves_’Œy_â
, &
¡©e
);

602 
	`kä“
(
f’ame
);

604 ifĞ
rc
 != 0 )

607 
rc
 = 0;

608  
	`ci_dÎi¡_nÙ_em±y
(&
aùive_¦aves
) ) {

609 
ci_dÎšk
 *
lšk
 = 
	`ci_dÎi¡_pİ
(&
aùive_¦aves
);

610 
ci_bÚdšg_iâame
* 
iâame
 =

611 
	`CI_CONTAINER
(
ci_bÚdšg_iâame
, 
li¡_lšk
, 
lšk
);

612 ifĞ
	`¡rcmp
(
¦ave_Çme
, 
iâame
->ifname) == 0 )

613 
rc
 = 1;

614 
	`kä“
(
iâame
);

617  
rc
;

618 
	}
}

623 
	sci_»ad_´oc_Ãt_igmp_¡©e
 {

624 
	mš_right_Ãtdev
;

625 
	mifšdex
;

629 
	$ci_bÚdšg_g‘_mÿ¡_subs_’Œy_â
(
ci_dÎi¡
* 
subsütiÚs
,

630 * 
lše
, 
lše_Ën
,

631 * 
¬g
)

633 
ci_»ad_´oc_Ãt_igmp_¡©e
* 
¡©e
 =

634 (
ci_»ad_´oc_Ãt_igmp_¡©e
*)
¬g
;

635 
ci_bÚdšg_mÿ¡_subsütiÚ
 *
sub
;

636 
Ën
, 
ifšdex
;

638 ifĞ
¡©e
->
š_right_Ãtdev
 ) {

639 ifĞ
lše
[0] >= '0' &&†ine[0] <= '9' )

644 
¡©e
->
š_right_Ãtdev
 = 0;

647 
sub
 = 
	`km®loc
((
ci_bÚdšg_mÿ¡_subsütiÚ
), 
GFP_KERNEL
);

648 ifĞ
sub
 !ğ
NULL
 ) {

649 
Ën
 = 
	`ssÿnf
(
lše
, " %x", &
sub
->
maddr
);

651 ifĞ
Ën
 == 1 ) {

652 
	`ci_dÎi¡_push
(
subsütiÚs
, &
sub
->
li¡_lšk
);

653 
	`OO_DEBUG_BONDING
(
	`ci_log
("Found maddr %x for‚et dev %d",

654 
sub
->
maddr
, 
¡©e
->
ifšdex
));

657 
	`kä“
(
sub
);

658 
	`OO_DEBUG_BONDING
(
	`ci_log
("P¬£ƒ¼Ü (1èš†š%s", 
lše
));

663 ifĞ
lše
[0] >= '0' &&†ine[0] <= '9' ) {

665 
Ën
 = 
	`ssÿnf
(
lše
, "%d", &
ifšdex
);

666 ifĞ
Ën
 == 1 ) {

667 ifĞ
ifšdex
 =ğ
¡©e
->ifindex )

668 
¡©e
->
š_right_Ãtdev
 = 1;

671 
	`OO_DEBUG_BONDING
(
	`ci_log
("P¬£ƒ¼Ü (2èš†š%s", 
lše
));

673 
	}
}

676 
	$ci_bÚdšg_g‘_mÿ¡_subs
(
ifšdex
, 
ci_dÎi¡
* 
subsütiÚs
)

678 
ci_»ad_´oc_Ãt_igmp_¡©e
 
¡©e
;

680 
¡©e
.
š_right_Ãtdev
 = 0;

681 
¡©e
.
ifšdex
 = ifindex;

683  
	`ci_bÚdšg_g‘_li¡
("/´oc/Ãt/igmp", 
subsütiÚs
,

684 
ci_bÚdšg_g‘_mÿ¡_subs_’Œy_â
, &
¡©e
);

685 
	}
}

688 
	sigmp_v3_»pÜt
 {

689 
ci_ušt8
 
	mty³
;

690 
ci_ušt8
 
	m»£rved1
;

692 
ci_ušt16
 
	mchecksum
;

693 
ci_ušt16
 
	m»£rved2
;

695 
ci_ušt16
 
	mn_»cÜds
;

696 
ci_ušt8
 
	m»cÜd_ty³
;

697 
ci_ušt8
 
	maux_d©a_Ën
;

699 
ci_ušt16
 
	mn_¤c
;

701 
ci_ušt32
 
	mmaddr
;

704 
	s_rou‹r_®”t_İtiÚ
 {

705 
ci_ušt8
 
	mty³
;

706 
ci_ušt8
 
	mËn
;

707 
ci_ušt16
 
	mv®ue
;

710 
	$ci_bÚdšg_£nd_igmp_»pÜt
(
Ãt_deviû
 *
Ãtdev
,

711 
ci_ušt32
 
maddr
,

712 
ci__addr_Ãt_t
 
¤c
)

714 
igmp_v3_»pÜt
 *
»pÜt_pkt
;

715 
_rou‹r_®”t_İtiÚ
 *
rou‹r_®”t
;

716 
ci_4_hdr
 *

;

717 
ci_ušt16
* 
buf
;

718 
csum_·¹Ÿl
;

719 
rc
, 
Ën
;

721 
Ën
 = (
ci_4_hdr
) +

722 (
_rou‹r_®”t_İtiÚ
) +

723 (
igmp_v3_»pÜt
);

725 

 = 
	`km®loc
(
Ën
, 
GFP_KERNEL
);

726 
rou‹r_®”t
 = (
_rou‹r_®”t_İtiÚ
 *)(

 + 1);

727 
»pÜt_pkt
 = (
igmp_v3_»pÜt
 *)(
rou‹r_®”t
 + 1);

728 

->
_ihl_v”siÚ
 =

729 
	`CI_IP4_IHL_VERSION
((
ci_4_hdr
) +

730 (
_rou‹r_®”t_İtiÚ
));

731 

->
_tos
 = (
ci_ušt8
)
CI_IP_DFLT_TOS
;

732 

->
_äag_off_be16
 = 
CI_IP4_FRAG_DONT
;

733 

->
_‰l
 = (
ci_ušt8
)1;

734 

->
_´ÙocŞ
 = (
ci_ušt8
)
IPPROTO_IGMP
;

736 

->
_tÙ_Ën_be16
 = 
	`CI_BSWAP_BE16
(
Ën
);

737 

->
_id_be16
 = 0;

738 

->
_§ddr_be32
 = 
¤c
;

739 

->
_daddr_be32
 = 
	`CI_BSWAP_BE32
(0xe0000016);

741 
rou‹r_®”t
->
ty³
 = 0x94;

742 
rou‹r_®”t
->
Ën
 = 4;

743 
rou‹r_®”t
->
v®ue
 = 0;

745 
»pÜt_pkt
->
ty³
 = 0x22;

746 
»pÜt_pkt
->
»£rved1
 = 0;

747 
»pÜt_pkt
->
checksum
 = 0;

748 
»pÜt_pkt
->
»£rved2
 = 0;

749 
»pÜt_pkt
->
n_»cÜds
 = 
	`CI_BSWAP_BE16
(1);

750 
»pÜt_pkt
->
»cÜd_ty³
 = 4;

751 
»pÜt_pkt
->
aux_d©a_Ën
 = 0;

752 
»pÜt_pkt
->
n_¤c
 = 0;

753 
»pÜt_pkt
->
maddr
 = maddr;

755 
buf
 = (
ci_ušt16
 *)
»pÜt_pkt
;

757 
csum_·¹Ÿl
 = 
buf
[0] + buf[3] + buf[4] + buf[6] + buf[7];

758 
csum_·¹Ÿl
 = (csum_partial >> 16u) + (csum_partial & 0xffff);

759 
csum_·¹Ÿl
 += (csum_partial >> 16u);

760 
»pÜt_pkt
->
checksum
 = ~
csum_·¹Ÿl
 & 0xffff;

762 
rc
 = 
	`ciı_¿w_sock_£nd_bšdtodev
(
Ãtdev
->
ifšdex
,‚‘dev->
Çme
,

763 

->
_daddr_be32
, (*), 
Ën
);

765 
	`kä“
(

);

767  
rc
;

768 
	}
}

776 
ci_šlše
 
	$ci_bÚdšg_g‘_¦ave_is_aùive
(
Ãt_deviû
 *
ma¡”_Ãt_dev
,

777 
Ãt_deviû
 *
¦ave_Ãt_dev
,

778 
ma¡”_rowid
)

780 
aùive
;

781 #ià
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(2,6,39)

782 #ifdeà
IFF_SLAVE_INACTIVE


784 
aùive
 = (
¦ave_Ãt_dev
->
´iv_æags
 & 
IFF_SLAVE_INACTIVE
) == 0;

788 
aùive
 = (
¦ave_Ãt_dev
->
æags
 & 
IFF_NOARP
) == 0;

791 
aùive_if
[
IFNAMSIZ
];

792 
rc
, 
mode
;

794 ifĞ
	`ciı_bÚd_g‘_mode
(&
CI_GLOBAL_CPLANE
, 
ma¡”_rowid
,

795 
ma¡”_Ãt_dev
->
ifšdex
, &
mode
) < 0 )

800 ifĞ
mode
 =ğ
CICP_BOND_MODE_ACTIVE_BACKUP
 ) {

801 
rc
 = 
	`ci_bÚdšg_g‘_ab_aùive_¦ave
(
ma¡”_Ãt_dev
->
Çme
, 
aùive_if
,

802 
IFNAMSIZ
);

803 ifĞ
rc
 < 0 ) {

804 
	`OO_DEBUG_BONDING
(
	`ci_log
("Error %d„eading‡ctive interface on bond %s",

805 
rc
, 
ma¡”_Ãt_dev
->
Çme
));

810 
aùive
 = 
	`¡ºcmp
(
¦ave_Ãt_dev
->
Çme
, 
aùive_if
, 
IFNAMSIZ
) == 0;

816 
	`ci_as£¹
(
mode
 =ğ
CICP_BOND_MODE_802_3AD
);

818 
rc
 = 
	`ci_bÚdšg_g‘_Ïı_aùive_¦ave
(
ma¡”_Ãt_dev
->
Çme
,

819 
¦ave_Ãt_dev
->
Çme
);

820 ifĞ
rc
 < 0 )

822 
aùive
 = 
rc
;

826  
aùive
 &&

827 (
¦ave_Ãt_dev
->
æags
 & 
IFF_UP
) &&

828 
	`Ãtif_ruÂšg
(
¦ave_Ãt_dev
);

829 
	}
}

831 
oo_igmp_Ú_çov”
;

833 
	$ci_bÚdšg_çov”
(
Ãt_deviû
 *
Ãt_dev
,

834 
ci_hwpÜt_id_t
 
hwpÜt
,

835 
çl
)

837 
ci_dÎi¡
 
mÿ¡_subs
;

838 
ci_dÎšk
* 
lšk
;

839 
ci_bÚdšg_mÿ¡_subsütiÚ
* 
sub
;

840 
rowid
;

842 ifĞ
hwpÜt
 !ğ
CI_HWPORT_ID_BAD
 )

843 
	`ci_log
("AcûË¿tšg % usšg O³nOÆßd", 
Ãt_dev
->
Çme
);

845 
	`ci_log
("NÙ‡cûË¿tšg % usšg O³nOÆßd", 
Ãt_dev
->
Çme
);

847 
	`OO_DEBUG_BONDING
(
	`ci_log
("Faov” %s/%dØhwpÜˆ%d", 
Ãt_dev
->
Çme
,

848 
Ãt_dev
->
ifšdex
, 
hwpÜt
));

850 
rowid
 = 
	`ciı_bÚd_fšd_rowid
(&
CI_GLOBAL_CPLANE
, 
Ãt_dev
->
ifšdex
);

851 ifĞ
rowid
 == -1 )

852 
	`OO_DEBUG_BONDING
(
	`ci_log
("No„ow for master %d in bondable",

853 
Ãt_dev
->
ifšdex
));

860 ifĞ
	`ciı_Î­_upd©e_aùive_hwpÜt
(&
CI_GLOBAL_CPLANE
, 
Ãt_dev
->
ifšdex
,

861 
hwpÜt
, 
rowid
, 
çl
) )

862 
	`OO_DEBUG_BONDING
(
	`ci_log
("Failover hwport update failed"));

864 ifĞ
hwpÜt
 !ğ
CI_HWPORT_ID_BAD
 && 
oo_igmp_Ú_çov”
 ) {

865 
	`ci_dÎi¡_š™
(&
mÿ¡_subs
);

867 
	`ci_bÚdšg_g‘_mÿ¡_subs
(
Ãt_dev
->
ifšdex
, &
mÿ¡_subs
);

868  
	`ci_dÎi¡_nÙ_em±y
(&
mÿ¡_subs
) ) {

869 
ci__addr_Ãt_t
 
¤c
;

870 
lšk
 = 
	`ci_dÎi¡_pİ
(&
mÿ¡_subs
);

871 
sub
 = 
	`CI_CONTAINER
(
ci_bÚdšg_mÿ¡_subsütiÚ
, 
li¡_lšk
,

872 
lšk
);

873 ifĞ
	`ciıos_if_g‘_ifšdex_addr
(&
CI_GLOBAL_CPLANE
,

874 
Ãt_dev
->
ifšdex
,

875 &
¤c
) == 0 )

876 
	`ci_bÚdšg_£nd_igmp_»pÜt
(
Ãt_dev
, 
sub
->
maddr
, 
¤c
);

877 
	`kä“
(
sub
);

885 
	`ciıos_if_bÚd_chªge
(&
CI_GLOBAL_CPLANE
, 
Ãt_dev
->
ifšdex
);

887 
	}
}

890 
	$ci_bÚdšg_check_mode
(
Ãt_deviû
 *
ma¡”_Ãt_dev
,

891 
ma¡”_rowid
, * 
çl
)

893 
rc
, 
mode
, 
Şd_mode
;

895 
rc
 = 
	`ci_bÚdšg_g‘_mode
(
ma¡”_Ãt_dev
->
Çme
, &
mode
);

896 ifĞ
rc
 != 0 ) {

897 
	`OO_DEBUG_BONDING
(
	`ci_log
("E¼Ü %d„—dšg modÚ bÚd %s", 
rc
,

898 
ma¡”_Ãt_dev
->
Çme
));

899  
rc
;

902 
rc
 = 
	`ciı_bÚd_g‘_mode
(&
CI_GLOBAL_CPLANE
, 
ma¡”_rowid
,

903 
ma¡”_Ãt_dev
->
ifšdex
, &
Şd_mode
);

904 ifĞ
rc
 != 0 )

905  
rc
;

907 ifĞ
mode
 !ğ
Şd_mode
) {

908 
rc
 = 
	`ciı_bÚd_upd©e_mode
(&
CI_GLOBAL_CPLANE
, 
ma¡”_rowid
,

909 
ma¡”_Ãt_dev
->
ifšdex
, 
mode
);

910 ifĞ
rc
 != 0 )

911  
rc
;

914 ifĞ
mode
 !ğ
CICP_BOND_MODE_ACTIVE_BACKUP
 &&

915 
mode
 !ğ
CICP_BOND_MODE_802_3AD
 ) {

916 *
çl
 = 1;

917 
	`OO_DEBUG_BONDING
(
	`ci_log
("Unaccelerated mode %d bond %s",

918 
mode
, 
ma¡”_Ãt_dev
->
Çme
));

921  
mode
;

922 
	}
}

925 
	$ci_bÚdšg_check_¦ave
(
ci_bÚdšg_iâame
* 
¦ave
,

926 
Ãt_deviû
* 
ma¡”_Ãt_dev
,

927 
ma¡”_rowid
)

929 
Ãt_deviû
* 
¦ave_Ãt_dev
;

930 
¦ave_rowid
, 
nÚ_sfc_pÜt
 = 0, 
rc
;

931 
ciı_’ÿp_t
 
’ÿp
;

933 
¦ave_Ãt_dev
 = 
	`DEV_GET_BY_NAME
(
¦ave
->
iâame
);

934 ifĞ
¦ave_Ãt_dev
 !ğ
NULL
 ) {

935 
¦ave_rowid
 = 
	`ciı_bÚd_fšd_rowid
(&
CI_GLOBAL_CPLANE
,

936 
¦ave_Ãt_dev
->
ifšdex
);

937 ifĞ
¦ave_rowid
 == -1 ) {

938 
¦ave_rowid
 =

939 
	`ciı_bÚd_add_¦ave
(&
CI_GLOBAL_CPLANE
, 
ma¡”_Ãt_dev
->
ifšdex
,

940 
¦ave_Ãt_dev
->
ifšdex
);

941 ifĞ
¦ave_rowid
 >= 0 ) {

942 
	`OO_DEBUG_BONDING
(
	`ci_log
("Added slave %s/%do master %s",

943 
¦ave_Ãt_dev
->
Çme
,

944 
¦ave_Ãt_dev
->
ifšdex
,

945 
ma¡”_Ãt_dev
->
Çme
));

948 
	`OO_DEBUG_BONDING
(
	`ci_log
("Failedo‡dd slave %s„ow %d",

949 
¦ave
->
iâame
, 
¦ave_rowid
));

950 
	`dev_put
(
¦ave_Ãt_dev
);

951  
¦ave_rowid
;

954 ifĞ(
rc
 = 
	`ciı_bÚd_check_¦ave_owÃr
(&
CI_GLOBAL_CPLANE
, 
¦ave_rowid
,

955 
¦ave_Ãt_dev
->
ifšdex
,

956 
ma¡”_Ãt_dev
->
ifšdex
)) != 0 ) {

957 
	`OO_DEBUG_BONDING
(
	`ci_log
("Slave %d moved master from %do %d",

958 
¦ave_Ãt_dev
->
ifšdex
, 
rc
,

959 
ma¡”_Ãt_dev
->
ifšdex
));

960 
rc
 = 
	`ciı_bÚd_»move_¦ave
(&
CI_GLOBAL_CPLANE
,„c,

961 
¦ave_Ãt_dev
->
ifšdex
);

962 ifĞ
rc
 != 0 ) {

963 
	`OO_DEBUG_BONDING
(
	`ci_log
("E¼Ü %d„emovšg sÏväom ma¡”", 
rc
));

964 
	`dev_put
(
¦ave_Ãt_dev
);

965  
rc
;

968 
¦ave_rowid
 = 
	`ciı_bÚd_add_¦ave
(&
CI_GLOBAL_CPLANE
,

969 
ma¡”_Ãt_dev
->
ifšdex
,

970 
¦ave_Ãt_dev
->
ifšdex
);

971 ifĞ
¦ave_rowid
 < 0 ) {

972 
	`OO_DEBUG_BONDING
(
	`ci_log
("Failedo‡dd moved slave %sƒrror %d",

973 
¦ave
->
iâame
, 
¦ave_rowid
));

974 
	`dev_put
(
¦ave_Ãt_dev
);

975  
¦ave_rowid
;

981 
rc
 = 
	`ciı_bÚd_£t_aùive
(&
CI_GLOBAL_CPLANE
,

982 
ma¡”_rowid
, 
ma¡”_Ãt_dev
->
ifšdex
,

983 
¦ave_rowid
, 
¦ave_Ãt_dev
->
ifšdex
,

984 
	`ci_bÚdšg_g‘_¦ave_is_aùive
(
ma¡”_Ãt_dev
,

985 
¦ave_Ãt_dev
,

986 
ma¡”_rowid
));

987 ifĞ
rc
 != 0 ) {

988 
	`OO_DEBUG_BONDING
(
	`ci_log
("Failedo set slave %s„ow %d (in)active: %d",

989 
¦ave
->
iâame
, 
¦ave_rowid
, 
rc
));

990 
	`dev_put
(
¦ave_Ãt_dev
);

991  
rc
;

994 
rc
 = 
	`ciı_bÚd_m¬k_row
(&
CI_GLOBAL_CPLANE
, 
¦ave_rowid
,

995 
¦ave_Ãt_dev
->
ifšdex
);

996 ifĞ
rc
 != 0 ) {

997 
	`OO_DEBUG_BONDING
(
	`ci_log
("Failedo mark slave %s„ow %d: %d",

998 
¦ave
->
iâame
, 
¦ave_rowid
, 
rc
));

999 
	`dev_put
(
¦ave_Ãt_dev
);

1000  
rc
;

1003 
rc
 = 
	`ciı_Î­_g‘_’ÿpsuÏtiÚ
(&
CI_GLOBAL_CPLANE
, 
¦ave_Ãt_dev
->
ifšdex
,

1004 &
’ÿp
);

1005 ifĞ
rc
 != 0 ) {

1006 
	`OO_DEBUG_BONDING
(
	`ci_log
("Failedo get slaveƒncapsulation %s %d",

1007 
¦ave
->
iâame
, 
rc
));

1008 
	`dev_put
(
¦ave_Ãt_dev
);

1009  
rc
;

1012 ifĞ!(
’ÿp
.
ty³
 & 
CICP_LLAP_TYPE_SFC
) ||

1013 (
’ÿp
.
ty³
 & 
CICP_LLAP_TYPE_VLAN
) )

1014 
nÚ_sfc_pÜt
 = 1;

1016 
	`dev_put
(
¦ave_Ãt_dev
);

1019 
	`OO_DEBUG_BONDING
(
	`ci_log
("NØÃtdev m©chšg sÏv%s", 
¦ave
->
iâame
));

1023  
nÚ_sfc_pÜt
;

1024 
	}
}

1027 
	$ci_bÚdšg_check_¦aves
(
Ãt_deviû
* 
ma¡”_Ãt_dev
,

1028 
ma¡”_rowid
, *
çl
)

1030 
nÚ_sfc_pÜt
 = 0;

1031 
no_¦aves
 = 1;

1032 
çuÉ
 = 0;

1033 
ci_dÎi¡
 
¦aves
;

1034 
ci_bÚdšg_iâame
* 
¦ave
;

1035 
rc
;

1037 
	`ci_dÎi¡_š™
(&
¦aves
);

1038 
rc
 = 
	`ci_bÚdšg_g‘_¦aves
(
ma¡”_Ãt_dev
->
Çme
, &
¦aves
);

1039 ià(
rc
 != 0) {

1040 
	`OO_DEBUG_BONDING
(
	`ci_log
("E¼Ü %d„—dšg bÚdšg sÏves", 
rc
));

1041 
	`ci_as£¹
(
	`ci_dÎi¡_is_em±y
(&
¦aves
));

1044  
	`ci_dÎi¡_nÙ_em±y
(&
¦aves
) ) {

1045 
¦ave
 = 
	`CI_CONTAINER
(
ci_bÚdšg_iâame
, 
li¡_lšk
,

1046 
	`ci_dÎi¡_pİ
(&
¦aves
));

1047 
rc
 = 
	`ci_bÚdšg_check_¦ave
(
¦ave
, 
ma¡”_Ãt_dev
, 
ma¡”_rowid
);

1048 ifĞ
rc
 < 0 )

1049 
çuÉ
 = 1;

1051 
nÚ_sfc_pÜt
 |ğ
rc
;

1052 
no_¦aves
 = 0;

1054 
	`kä“
(
¦ave
);

1057 
	`ciı_bÚd_´uÃ_unm¬ked_š_bÚd
(&
CI_GLOBAL_CPLANE
,

1058 
ma¡”_Ãt_dev
->
ifšdex
);

1060 ifĞ
çuÉ
 )

1062 ifĞ
no_¦aves
 ) {

1063 
	`OO_DEBUG_BONDING
(
	`ci_log
("No slaves in bond %s,‚ot‡ccelerating",

1064 
ma¡”_Ãt_dev
->
Çme
));

1067 ifĞ
nÚ_sfc_pÜt
 ) {

1068 
	`OO_DEBUG_BONDING
(
	`ci_log
("Non-SFC…ort in bond %s,‚ot‡ccelerating",

1069 
ma¡”_Ãt_dev
->
Çme
));

1070 *
çl
 = 1;

1075 
	}
}

1078 
	$ci_bÚdšg_check_aùive
(
Ãt_deviû
* 
ma¡”_Ãt_dev
,

1079 
ma¡”_row_id
)

1081 
rc
;

1082 
ci_hwpÜt_id_t
 
hwpÜt
, 
cu¼_hwpÜt
;

1084 
rc
 = 
	`ciı_bÚd_g‘_n_aùive_¦aves
(&
CI_GLOBAL_CPLANE
, 
ma¡”_row_id
,

1085 
ma¡”_Ãt_dev
->
ifšdex
);

1086 ifĞ
rc
 < 0 )

1087  
rc
;

1088 ifĞ
rc
 == 0 )

1091 
cu¼_hwpÜt
 = 
	`ciı_Î­_g‘_hwpÜt
(&
CI_GLOBAL_CPLANE
,

1092 
ma¡”_Ãt_dev
->
ifšdex
);

1098 
rc
 = 
	`ciı_bÚd_check_aùive_¦ave_hwpÜt
(&
CI_GLOBAL_CPLANE
,

1099 
ma¡”_row_id
,

1100 
ma¡”_Ãt_dev
->
ifšdex
,

1101 
cu¼_hwpÜt
,

1102 &
hwpÜt
);

1103 ifĞ
rc
 != 0 )

1104  
rc
;

1106 ifĞ
hwpÜt
 !ğ
cu¼_hwpÜt
 ) {

1107 
	`OO_DEBUG_BONDING
(
	`ci_log
("update %s/%d hwport %d->%d",

1108 
ma¡”_Ãt_dev
->
Çme
, ma¡”_Ãt_dev->
ifšdex
,

1109 
cu¼_hwpÜt
, 
hwpÜt
));

1110 
	`ci_bÚdšg_çov”
(
ma¡”_Ãt_dev
, 
hwpÜt
, 0);

1111 
	`OO_DEBUG_BONDING
(
	`ci_log
("update %s/%d hwport‚ow %d",

1112 
ma¡”_Ãt_dev
->
Çme
, ma¡”_Ãt_dev->
ifšdex
,

1113 
	`ciı_Î­_g‘_hwpÜt
(&
CI_GLOBAL_CPLANE
,

1114 
ma¡”_Ãt_dev
->
ifšdex
)));

1118 
	}
}

1121 
	$ci_bÚdšg_check_hash_pŞicy
(
Ãt_deviû
 *
Ãt_dev
,

1122 
rowid
, 
mode
, * 
çl
)

1124 
Ãw_hash_pŞicy
 = 
CICP_BOND_XMIT_POLICY_NONE
;

1125 
rc
;

1126 ifĞ
mode
 =ğ
CICP_BOND_MODE_802_3AD
 )

1127 ifĞ
	`ci_bÚdšg_g‘_hash_pŞicy
(
Ãt_dev
->
Çme
, &
Ãw_hash_pŞicy
) != 0 )

1130 
rc
 = 
	`ciı_bÚd_£t_hash_pŞicy
(&
CI_GLOBAL_CPLANE
, 
rowid
, 
mode
,

1131 
Ãt_dev
->
ifšdex
, 
Ãw_hash_pŞicy
);

1132 ifĞ
rc
 < 0 )

1133  
rc
;

1135 ifĞ
mode
 =ğ
CICP_BOND_MODE_802_3AD
 ) {

1136 ifĞ
Ãw_hash_pŞicy
 =ğ
CICP_BOND_XMIT_POLICY_LAYER2
 ||

1137 
Ãw_hash_pŞicy
 =ğ
CICP_BOND_XMIT_POLICY_LAYER23
 ||

1138 
Ãw_hash_pŞicy
 =ğ
CICP_BOND_XMIT_POLICY_LAYER34
 )

1141 *
çl
 = 1;

1147 
	}
}

1150 
	$ci_bÚdšg_´oûss_ma¡”
(
ci_bÚdšg_iâame
 *
ma¡”
)

1152 
Ãt_deviû
* 
ma¡”_Ãt_dev
;

1153 
rc
, 
ma¡”_rowid
, 
mode
, 
çl
 = 0;

1154 
ciı_’ÿp_t
 
’ÿp
;

1156 
ma¡”_Ãt_dev
 = 
	`DEV_GET_BY_NAME
(
ma¡”
->
iâame
);

1157 ifĞ
ma¡”_Ãt_dev
 =ğ
NULL
 ) {

1158 
	`OO_DEBUG_BONDING
(
	`ci_log
("Can't find‚etdev for master %s",

1159 
ma¡”
->
iâame
));

1163 ifĞ!(
ma¡”_Ãt_dev
->
æags
 & 
IFF_UP
) )

1164 
out0
;

1166 
rc
 = 
	`ciı_bÚd_fšd_rowid
(&
CI_GLOBAL_CPLANE
, 
ma¡”_Ãt_dev
->
ifšdex
);

1167 ifĞ
rc
 < 0 ) {

1168 
	`OO_DEBUG_BONDING
(
	`ci_log
("Can't find„ow for master %s: %d",

1169 
ma¡”
->
iâame
, 
rc
));

1170 
out0
;

1172 
ma¡”_rowid
 = 
rc
;

1174 
rc
 = 
	`ci_bÚdšg_check_mode
(
ma¡”_Ãt_dev
, 
ma¡”_rowid
, &
çl
);

1175 ifĞ
rc
 < 0 )

1176 
out1
;

1177 
mode
 = 
rc
;

1179 
rc
 = 
	`ci_bÚdšg_check_hash_pŞicy
(
ma¡”_Ãt_dev
, 
ma¡”_rowid
, 
mode
, &
çl
);

1180 ifĞ
rc
 != 0 )

1181 
out1
;

1183 
rc
 = 
	`ci_bÚdšg_check_¦aves
(
ma¡”_Ãt_dev
, 
ma¡”_rowid
, &
çl
);

1184 ifĞ
rc
 != 0 )

1185 
out1
;

1190 
rc
 = 
	`ci_bÚdšg_check_aùive
(
ma¡”_Ãt_dev
, 
ma¡”_rowid
);

1191 ifĞ
rc
 != 0 )

1192 
out1
;

1194 
out1
:

1195 ifĞ
rc
 != 0 &&

1196 ((
	`ciı_Î­_g‘_hwpÜt
(&
CI_GLOBAL_CPLANE
, 
ma¡”_Ãt_dev
->
ifšdex
) !=

1197 
CI_HWPORT_ID_BAD
) ||

1198 (
çl
 &&

1199 (
	`ciı_Î­_g‘_’ÿpsuÏtiÚ
(&
CI_GLOBAL_CPLANE
,

1200 
ma¡”_Ãt_dev
->
ifšdex
,

1201 &
’ÿp
) == 0) &&

1202 (
’ÿp
.
ty³
 & 
CICP_LLAP_TYPE_CAN_ONLOAD_BAD_HWPORT
))) )

1203 
	`ci_bÚdšg_çov”
(
ma¡”_Ãt_dev
, 
CI_HWPORT_ID_BAD
, 
çl
);

1205 
out0
:

1206 
	`dev_put
(
ma¡”_Ãt_dev
);

1207 
	}
}

1210 
	$ci_bÚdšg_wÜk™em_â
(* 
cÚ‹xt
)

1212 
ci_dÎi¡
 
ma¡”s
;

1213 
ci_bÚdšg_iâame
* 
ma¡”
;

1214 
rc
;

1216 
	`ci_dÎi¡_š™
(&
ma¡”s
);

1218 
rc
 = 
	`ci_bÚdšg_g‘_ma¡”s
(&
ma¡”s
);

1219 ifĞ
rc
 != 0 ) {

1220 
	`OO_DEBUG_BONDING
(
	`ci_log
("E¼Ü %d„—dšg bÚdšg ma¡”s", 
rc
));

1221 
	`ci_as£¹
(
	`ci_dÎi¡_is_em±y
(&
ma¡”s
));

1222 
	`ci_bÚdšg_£t_tim”_³riod
(
HZ
, 0);

1226  
	`ci_dÎi¡_nÙ_em±y
(&
ma¡”s
) ) {

1227 
ma¡”
 = 
	`CI_CONTAINER
(
ci_bÚdšg_iâame
, 
li¡_lšk
,

1228 
	`ci_dÎi¡_pİ
(&
ma¡”s
));

1230 
	`ci_bÚdšg_´oûss_ma¡”
(
ma¡”
);

1232 
	`kä“
(
ma¡”
);

1236 
	}
}

1239 
©omic_t
 
	gtim”_ruÂšg
;

1240 
tim”_li¡
 
	gbÚdšg_tim”
;

1241 
ci_wÜk™em_t
 
	gbÚdšg_wÜk™em
;

1243 
	gtim”_³riod
;

1244 
	gtim”_occu»nûs
;

1245 
	gÏ¡_tim”_jiff›s
;

1247 
oo_bÚd_pŞl_ba£
;

1249 
	$ci_bÚdšg_g‘_tim”_³riod
()

1251 ifĞ
tim”_occu»nûs
 > 0 ) {

1252 ifĞ(--
tim”_occu»nûs
) == 0 )

1253 
tim”_³riod
 = 
oo_bÚd_pŞl_ba£
;

1255  
tim”_³riod
;

1256 
	}
}

1259 
	$ci_bÚdšg_tim”_â
(
l
)

1261 ifĞ
	`©omic_»ad
(&
tim”_ruÂšg
) == 0 )

1264 
Ï¡_tim”_jiff›s
 = 
jiff›s
;

1266 
	`ci_wÜkqueue_add
(&
CI_GLOBAL_WORKQUEUE
, &
bÚdšg_wÜk™em
);

1268 
	`mod_tim”
(&
bÚdšg_tim”
, 
jiff›s
 + 
	`ci_bÚdšg_g‘_tim”_³riod
());

1269 
	}
}

1274 
	$ci_bÚdšg_£t_tim”_³riod
(
³riod
, 
occu»nûs
)

1276 #ià
CI_CFG_TEAMING


1277 
tim”_³riod
 = 
³riod
;

1278 
tim”_occu»nûs
 = 
occu»nûs
;

1280 ifĞ
	`©omic_»ad
(&
tim”_ruÂšg
) )

1281 
	`mod_tim”
(&
bÚdšg_tim”
, 
Ï¡_tim”_jiff›s
 + 
³riod
);

1283 
	}
}

1286 
	$ci_bÚdšg_š™
()

1288 #ià
CI_CFG_TEAMING


1289 
	`ci_wÜk™em_š™
(&
bÚdšg_wÜk™em
, 
ci_bÚdšg_wÜk™em_â
, 
NULL
);

1291 
	`š™_tim”
(&
bÚdšg_tim”
);

1292 
bÚdšg_tim”
.
funùiÚ
 = &
ci_bÚdšg_tim”_â
;

1293 
bÚdšg_tim”
.
d©a
 = 0;

1294 
	`©omic_£t
(&
tim”_ruÂšg
, 1);

1295 
Ï¡_tim”_jiff›s
 = 
jiff›s
;

1296 
	`ci_bÚdšg_£t_tim”_³riod
(
oo_bÚd_pŞl_ba£
, 0);

1299 
	}
}

1302 
	$ci_bÚdšg_fši
()

1304 #ià
CI_CFG_TEAMING


1305 
	`©omic_£t
(&
tim”_ruÂšg
, 0);

1307 
	`ci_wÜkqueue_æush
(&
CI_GLOBAL_WORKQUEUE
);

1308 
	`d–_tim”_sync
(&
bÚdšg_tim”
);

1309 
	`ci_wÜkqueue_æush
(&
CI_GLOBAL_WORKQUEUE
);

1312 
	}
}

	@compat.c

21 
	~<Úlßd/fd_´iv©e.h
>

22 
	~<ci/š‹º®/.h
>

23 
	~<Úlßd/lšux_Úlßd_š‹º®.h
>

24 
	~<Úlßd/eçbcfg.h
>

25 
	~<Úlßd/tı_h–³r.h
>

28 
ci_´iv©e_t
 *

29 
	$ci_åriv
(
fe
 *
fp
)

31 ifĞ
fp
->
f_İ
 !ğ&
oo_fİs
 )

32  
NULL
;

34  (
ci_´iv©e_t
 *)(
fp
->
´iv©e_d©a
);

35 
	}
}

37 
fe
 *

38 
	$ci_´ivf
(
ci_´iv©e_t
 *
´iv
)

40  
´iv
->
_fp
;

41 
	}
}

44 #ià
CI_MEMLEAK_DEBUG_ALLOC_TABLE


46 
ci_®loc_’Œy
 *
	gci_®loc_bË
[
CI_ALLOC_TABLE_BULKS
];

47 
	gci_®loc_bË_sz
 = 0;

48 
EXPORT_SYMBOL
(
ci_®loc_bË_add
);

49 
EXPORT_SYMBOL
(
ci_®loc_bË_d–
);

	@driver.c

13 
	~<Úlßd/lšux_Úlßd.h
>

14 
	~<Úlßd/tı_h–³r_’dpošt.h
>

15 
	~<Úlßd/lšux_mm­.h
>

16 
	~<ci/š‹º®/.h
>

17 
	~<Úlßd/lšux_ŒampŞše.h
>

18 
	~<Úlßd/lšux_Úlßd_š‹º®.h
>

19 
	~<Úlßd/eçbcfg.h
>

20 
	~<ci/š‹º®/_log.h
>

21 
	~<Úlßd/ioùl.h
>

22 
	~<Úlßd/tı_h–³r_âs.h
>

23 
	~<ci/eäm/nic_bË.h
>

24 
	~"Úlßd_š‹º®.h
"

25 
	~<Úlßd/v”siÚ.h
>

26 
	~<Úlßd/oof_š‹rçû.h
>

28 #ià
defšed
(
__x86_64__
è&& 
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,11)

29 
	#NEED_IOCTL32


	)

30 
	~<lšux/ioùl32.h
>

31 
	~<Úlßd/commÚ.h
>

35 
	~<ci/driv”/eçb/h¬dw¬e.h
>

44 
MODULE_AUTHOR
("Solarflare Communications");

45 
MODULE_LICENSE
("GPL");

46 
MODULE_VERSION
(
ONLOAD_VERSION
);

58 
	gci_driv”_debug_b™s
;

60 
	gno_ù
 = 0;

62 
CI_DEBUG
(
no_sh¬ed_¡©e_·nic
;)

63 
CI_DEBUG
(
EXPORT_SYMBOL
(
no_sh¬ed_¡©e_·nic
);)

65 
moduË_·¿m
(
no_ù
, , 
S_IRUGO
);

66 
MODULE_PARM_DESC
(
no_ù
,

69 
	goo_debug_b™s
 = 
__OO_DEBUGERR__
;

70 
moduË_·¿m
(
oo_debug_b™s
, , 
S_IRUGO
 | 
S_IWUSR
);

71 
MODULE_PARM_DESC
(
oo_debug_b™s
, "Onload driver†og†evel");

73 
CI_DEBUG
(
oo_debug_code_Ëv–
;)

74 
CI_DEBUG
(
moduË_·¿m
(
oo_debug_code_Ëv–
, , 
S_IRUGO
 | 
S_IWUSR
);)

76 
CI_DEBUG
(
moduË_·¿m
(
no_sh¬ed_¡©e_·nic
, , 
S_IRUGO
 | 
S_IWUSR
);)

78 
	gci__log
 = 0xf;

79 
moduË_·¿m
(
ci__log
, 
ušt
, 
S_IRUGO
 | 
S_IWUSR
);

80 
MODULE_PARM_DESC
(
ci__log
, "Onloadransport†og†evel");

82 
	goo_igmp_Ú_çov”
 = 0;

83 
moduË_·¿m
(
oo_igmp_Ú_çov”
, , 
S_IRUGO
 | 
S_IWUSR
);

84 
MODULE_PARM_DESC
(
oo_igmp_Ú_çov”
,

87 
moduË_·¿m
(
ci_log_İtiÚs
, , 
S_IRUGO
 | 
S_IWUSR
);

88 
MODULE_PARM_DESC
(
ci_log_İtiÚs
,

91 
moduË_·¿m
(
oof_sh¬ed_k“p_th»sh
, , 
S_IRUGO
 | 
S_IWUSR
);

92 
MODULE_PARM_DESC
(
oof_sh¬ed_k“p_th»sh
,

97 
moduË_·¿m
(
oof_sh¬ed_¡—l_th»sh
, , 
S_IRUGO
 | 
S_IWUSR
);

98 
MODULE_PARM_DESC
(
oof_sh¬ed_¡—l_th»sh
,

103 
	gphys_mode_gid
 = -2;

104 
moduË_·¿m
(
phys_mode_gid
, , 
S_IRUGO
 | 
S_IWUSR
);

105 
MODULE_PARM_DESC
(
phys_mode_gid
,

111 
	gtimesync_³riod
 = 500;

112 
moduË_·¿m
(
timesync_³riod
, , 
S_IRUGO
 | 
S_IWUSR
);

113 
MODULE_PARM_DESC
(
timesync_³riod
,

117 
	g§ã_sigÇls_ªd_ex™
 = 1;

118 
moduË_·¿m
(
§ã_sigÇls_ªd_ex™
, , 
S_IRUGO
);

119 
MODULE_PARM_DESC
(
§ã_sigÇls_ªd_ex™
,

128 
	gmax_Ïy”2_š‹rçûs
 = 50;

129 
moduË_·¿m
(
max_Ïy”2_š‹rçûs
, , 
S_IRUGO
);

130 
MODULE_PARM_DESC
(
max_Ïy”2_š‹rçûs
,

133 
	gmax_rou‹s
 = 256;

134 
moduË_·¿m
(
max_rou‹s
, , 
S_IRUGO
);

135 
MODULE_PARM_DESC
(
max_rou‹s
,

137 
	gmax_Ãighs
 = 1024;

138 
moduË_·¿m
(
max_Ãighs
, , 
S_IRUGO
);

139 
MODULE_PARM_DESC
(
max_Ãighs
,

145 
eçb_´•¬e_fÜ_iscsi
();

146 
eçb_ş—nup_š_iscsi
();

155 
	$eçb_fds_dump
(
pid
)

157 
sk_¡ruù
* 
t
;

158 
fe
* 
fp
;

159 
ci_´iv©e_t
* 
´iv
;

160 
fd
, 
rc
 = 0;

162 
t
 = 
	`ci_lock_sk_by_pid
(
pid
);

164 ifĞ! 
t
 ) {

165 
	`ci_log
("%s: bad…id %d", 
__FUNCTION__
, 
pid
);

166 
rc
 = -
ENOENT
;

169 ifĞ! 
t
->
fes
 ) {

170 
	`ci_log
("%s: fe poš‹¸i nuÎ iÀpid %d", 
__FUNCTION__
, 
pid
);

171 
rc
 = -
EINVAL
;

174 
ci_fdbË
 *
fdt
;

176 
	`¥š_lock
(&
t
->
fes
->
fe_lock
);

177 
fdt
 = 
	`ci_fes_fdbË
(
t
->
fes
);

179  
fd
 = 0; fd < 
fdt
->
max_fds
; ++fd ) {

180 
fp
 = 
fdt
->
fd
[fd];

181 ifĞ! 
fp
 ) ;

182 
´iv
 = 0;

184 ifĞ
fp
->
f_İ
 =ğ&
oo_fİs
 ) {

185 
	`ci_log
("pid=%d fd=%d =>ƒçb", 
pid
, 
fd
);

186 
´iv
 = (
ci_´iv©e_t
*è
fp
->
´iv©e_d©a
;

188 ifĞ
fp
->
f_İ
 =ğ&
lšux_tı_h–³r_fİs_tı
 ) {

189 
	`ci_log
("pid=%d fd=%d => TCP", 
pid
, 
fd
);

190 
´iv
 = (
ci_´iv©e_t
*è
fp
->
´iv©e_d©a
;

192 ifĞ
fp
->
f_İ
 =ğ&
lšux_tı_h–³r_fİs_udp
 ) {

193 
	`ci_log
("pid=%d fd=%d => UDP", 
pid
, 
fd
);

194 
´iv
 = (
ci_´iv©e_t
*è
fp
->
´iv©e_d©a
;

196 #ià
CI_CFG_USERSPACE_PIPE


197 ifĞ
fp
->
f_İ
 =ğ&
lšux_tı_h–³r_fİs_pe_»ad”
 ) {

198 
	`ci_log
("pid=%d fd=%d => PIPE READER", 
pid
, 
fd
);

199 
´iv
 = (
ci_´iv©e_t
*è
fp
->
´iv©e_d©a
;

201 ifĞ
fp
->
f_İ
 =ğ&
lšux_tı_h–³r_fİs_pe_wr™”
 ) {

202 
	`ci_log
("pid=%d fd=%d => PIPE WRITER", 
pid
, 
fd
);

203 
´iv
 = (
ci_´iv©e_t
*è
fp
->
´iv©e_d©a
;

207 
	`ci_log
("pid=%d fd=%d => oth”", 
pid
, 
fd
);

209 #iâdeà
NDEBUG


210 ifĞ
´iv
 ) 
	`THR_PRIV_DUMP
(priv, " ");

214 
	`¥š_uÆock
(&
t
->
fes
->
fe_lock
);

217 
	`ci_uÆock_sk
();

220  
rc
;

221 
	}
}

225 #ià
CI_MEMLEAK_DEBUG_ALLOC_TABLE


227 
ci_nošlše
 

228 
	$ioùl_debug_®loc_bË
 (
ci_´iv©e_t
 *
´iv
, 
ulÚg
 
¬g
)

230 ià(!
	`ci_is_sy§dmš
()è -
EPERM
;

233 
ci_®loc_šfo
 
loÿl
;

235 
	`cİy_äom_u£r_»t
(&
loÿl
, (
ÿddr_t
è
¬g
,

236 
CI_ALLOC_INFO_SIZEOF_CTRL
, -
EFAULT
);

237 
	`ci_log
("Processing„equest for memory‡llocationable: bulk #%u",

238 
loÿl
.
bulk
);

239 ià(
loÿl
.
bulk
 < (
ci_®loc_bË_sz
 >> 
CI_ALLOC_TABLE_BULK_2
)) {

240 
	`cİy_to_u£r_»t
((
ÿddr_t
)(()
¬g
 +

241 
CI_ALLOC_INFO_SIZEOF_CTRL
),

242 
ci_®loc_bË
[
loÿl
.
bulk
],

243 (
loÿl
.
’Œ›s
),

244 -
EFAULT
);

246  -
E2BIG
;

251 
	}
}

268 
	$oo_fİ_İ’
(
šode
* inode, 
fe
* 
fp
)

270 
ci_´iv©e_t
* 
´iv
;

272 
	`OO_DEBUG_VERB
(
	`ci_log
("ci_char_fop_open:"));

274 ifĞ(
´iv
 = 
	`CI_ALLOC_OBJ
(
ci_´iv©e_t
)è=ğ
NULL
 )

275  -
ENOMEM
;

277 
	`CI_ZERO
(
´iv
);

278 
´iv
->
_fp
 = 
fp
;

279 
´iv
->
fd_ty³
 = 
CI_PRIV_TYPE_NONE
;

281 
fp
->
´iv©e_d©a
 = (*è
´iv
;

282 
fp
->
f_İ
 = &
oo_fİs
;

285 
	}
}

293 
	$oo_fİ_»Ëa£
(
šode
* inode, 
fe
* 
fp
)

295 
ci_´iv©e_t
 *
´iv
 = (ci_´iv©e_ˆ*è
fp
->
´iv©e_d©a
;

297 
	`OO_DEBUG_VERB
(
	`ci_log
("ci_ch¬_fİ_şo£ %d", 
´iv
->
fd_ty³
));

300 
fp
->
´iv©e_d©a
 = 0;

301 ià(
´iv
->
thr
 !ğ
NULL
) {

302 
	`TCP_HELPER_RESOURCE_ASSERT_VALID
(
´iv
->
thr
, 0);

303 
	`eçb_thr_»Ëa£
(
´iv
->
thr
);

305 
	`Úlßd_´iv_ä“
(
´iv
);

307 
	}
}

310 #ià
OO_OPS_TABLE_HAS_NAME


311 
	#OP_NAME
(
İ
è((İ)->
Çme
)

	)

313 
	#OP_NAME
(
İ
è""

	)

321 
	$oo_fİ_uÆocked_ioùl
(
fe
* 
fp
, 
cmd
, 
¬g
)

323 
ci_´iv©e_t
 *
´iv
 = 
fp
->
´iv©e_d©a
;

324 
__u£r
* 
¬gp
 = (__u£r*è
¬g
;

325 
loÿl_¬g
[10];

326 
oo_İ”©iÚs_bË_t
* 
İ
;

327 
ioc_Ä
 = 
	`_IOC_NR
(
cmd
);

328 * 
loÿl_p
;

329 
rc
;

331 ifĞ
eçb_tı_driv”
.
fe_»fs_to_drİ
 !ğ
NULL
 )

332 
	`oo_fe_»f_drİ_li¡_now
(
NULL
);

334 ifĞ
ioc_Ä
 >ğ
OO_OP_END
 || 
	`_IOC_TYPE
(
cmd
è!ğ
OO_LINUX_IOC_BASE
 ) {

345 #ià! 
	`defšed
 (
__PPC__
)

346 
	`BUILD_BUG_ON
(
	`_IOC_TYPE
(
TIOCSSOFTCAR
è!ğ_IOC_TYPE(
TCGETS
));

347 ifĞ
	`_IOC_TYPE
(
cmd
è!ğ_IOC_TYPE(
TCGETS
) ||

348 
	`_IOC_NR
(
cmd
è> _IOC_NR(
TIOCSSOFTCAR
) ) {

353 ifĞ
cmd
 !ğ
TCGETS
 && cmd !ğ
TIOCGPGRP
) {

355 
	`OO_DEBUG_ERR
(
	`ci_log
("%s: bad cmd=%xype=%d(%d)‚r=%d(%d)",

356 
__FUNCTION__
, 
cmd
, 
	`_IOC_TYPE
(cmd), 
OO_LINUX_IOC_BASE
,

357 
ioc_Ä
, 
OO_OP_END
));

359  -
EINVAL
;

361 
İ
 = &
oo_İ”©iÚs
[
ioc_Ä
];

362 ifĞ
İ
->
ioc_cmd
 !ğ
cmd
 ) {

366 
	`ci_log
("%s: ioùÈbË bad cmd=%x‚r=%uƒÁry=%x", 
__FUNCTION__
,

367 
cmd
, 
ioc_Ä
, 
İ
->
ioc_cmd
);

368  -
EINVAL
;

372 ifĞ
	`_IOC_SIZE
(
cmd
è<ğ(
loÿl_¬g
) ) {

373 
loÿl_p
 = &
loÿl_¬g
;

376 
	`CI_DEBUG
(ià(
	`_IOC_SIZE
(
cmd
è=ğ0è
loÿl_p
 = 
NULL
;)

379 ifĞ(
loÿl_p
 = 
	`km®loc
(
	`_IOC_SIZE
(
cmd
), 
GFP_KERNEL
)è=ğ
NULL
 )

380  -
ENOMEM
;

381 
	`mem£t
(
loÿl_p
, 0, 
	`_IOC_SIZE
(
cmd
));

384 
	`OO_DEBUG_OS
(
	`ci_log
("%s: %s×rg=%lx,%s%s,%d)", 
__FUNCTION__
, 
	`OP_NAME
(
İ
), 
¬g
,

385 
	`_IOC_DIR
(
cmd
è& 
_IOC_WRITE
 ? "W" : "",

386 
	`_IOC_DIR
(
cmd
è& 
_IOC_READ
 ? "R" : "", 
	`_IOC_SIZE
(cmd)));

389 ifĞ(
	`_IOC_DIR
(
cmd
è& 
_IOC_WRITE
) )

390 ifĞ
	`cİy_äom_u£r
(
loÿl_p
, 
¬gp
, 
	`_IOC_SIZE
(
cmd
)) ) {

391 
rc
 = -
EFAULT
;

392 
ş—nup_out
;

396 
rc
 = 
İ
->
	`hªdËr
(
´iv
, 
loÿl_p
);

401 ifĞ(
rc
 =ğ0 ||„ø=ğ-
ERESTARTSYS
è&& (
	`_IOC_DIR
(
cmd
è& 
_IOC_READ
) )

402 ifĞ
	`cİy_to_u£r
(
¬gp
, 
loÿl_p
, 
	`_IOC_SIZE
(
cmd
)) ) {

403 
rc
 = -
EFAULT
;

404 
ş—nup_out
;

407 
ş—nup_out
:

408 ifĞ
loÿl_p
 !ğ&
loÿl_¬g
 )

409 
	`kä“
(
loÿl_p
);

410 
	`OO_DEBUG_OS
(
	`ci_log
("%s: %s×rg=%lxè=> %d", 
__FUNCTION__
,

411 
	`OP_NAME
(
İ
), 
¬g
, 
rc
));

412  
rc
;

413 
	}
}

416 #ià!
HAVE_UNLOCKED_IOCTL


417 
	$oo_fİ_ioùl
(
šode
* inode, 
fe
 *
fp
,

418 
cmd
, 
¬g
)

420  
	`oo_fİ_uÆocked_ioùl
(
fp
, 
cmd
, 
¬g
);

421 
	}
}

425 
fe_İ”©iÚs
 
	goo_fİs
 = {

426 .
owÃr
 = 
THIS_MODULE
,

427 .
	gİ’
 = 
oo_fİ_İ’
,

428 .
	g»Ëa£
 = 
oo_fİ_»Ëa£
,

429 #ià
HAVE_UNLOCKED_IOCTL


430 .
	guÆocked_ioùl
 = 
oo_fİ_uÆocked_ioùl
,

432 .
	gioùl
 = 
oo_fİ_ioùl
,

434 #ià
HAVE_COMPAT_IOCTL


435 .
	gcom·t_ioùl
 = 
oo_fİ_com·t_ioùl
,

437 .
	gmm­
 = 
oo_fİ_mm­
,

447 
	goo_dev_majÜ
;

448 cÚ¡ * 
	goo_dev_Çme
 = 
EFAB_DEV_NAME
;

451 
	$ci_chrdev_ùÜ
(
fe_İ”©iÚs
 *
fİs
, cÚ¡ *
Çme
)

453 
rc
, 
majÜ
 = 0;

455 ià((
rc
 = 
	`»gi¡”_chrdev
(
majÜ
, 
Çme
, 
fİs
)) < 0) {

456 
	`ci_log
("%s: cª'ˆ»gi¡” ch¬ deviû %d", 
Çme
, 
rc
);

457  
rc
;

459 ià(
majÜ
 == 0)

460 
majÜ
 = 
rc
;

461 
oo_dev_majÜ
 = 
majÜ
;

463 #ifdeà
NEED_IOCTL32


468 
ioc
;

469  
ioc
 = 0; ioø< 
OO_OP_END
; ++ioc )

470 
	`»gi¡”_ioùl32_cÚv”siÚ
(
oo_İ”©iÚs
[
ioc
].
ioc_cmd
, 
NULL
);

474  
rc
;

475 
	}
}

479 
	$ci_chrdev_dtÜ
(cÚ¡ * 
Çme
)

481 ifĞ
oo_dev_majÜ
 )

482 
	`uÄegi¡”_chrdev
(
oo_dev_majÜ
, 
Çme
);

484 #ifdeà
NEED_IOCTL32


487 
ioc
;

488  
ioc
 = 0; ioø< 
OO_OP_END
; ++ioc )

489 
	`uÄegi¡”_ioùl32_cÚv”siÚ
(
oo_İ”©iÚs
[
ioc
].
ioc_cmd
);

492 
	}
}

495 
	$Úlßd_§n™y_checks
()

497 cÚ¡ 
dma_¡¬t_off
 = 
	`CI_MEMBER_OFFSET
(
ci__pkt_fmt
, 
dma_¡¬t
);

498 ifĞ
FALCON_RX_USR_BUF_SIZE
 + 
dma_¡¬t_off
 > 
CI_CFG_PKT_BUF_SIZE
 ) {

499 
	`ci_log
("ERROR: FALCON_RX_USR_BUF_SIZE=%d dma_start_off=%d BUF_SIZE=%d",

500 
FALCON_RX_USR_BUF_SIZE
, 
dma_¡¬t_off
, 
CI_CFG_PKT_BUF_SIZE
);

501  -
EINVAL
;

503 ifĞ
FALCON_RX_USR_BUF_SIZE
 + 
dma_¡¬t_off
 < 
CI_CFG_PKT_BUF_SIZE
 - 64 )

504 
	`ci_log
("WARNING: FALCON_RX_USR_BUF_SIZE=%d could be bigger",

505 
FALCON_RX_USR_BUF_SIZE
);

507 
	}
}

516 
__š™
 
	$Úlßd_moduË_š™
()

518 
rc
;

520 
	`ci_£t_log_´efix
("[onload] ");

521 
	`ci_log
("% %s", 
ONLOAD_PRODUCT
, 
ONLOAD_VERSION
);

522 
	`ci_log
("%s", 
ONLOAD_COPYRIGHT
);

526 
lšux_tı_h–³r_fİs_tı
.
owÃr
 = 
THIS_MODULE
;

527 
lšux_tı_h–³r_fİs_udp
.
owÃr
 = 
THIS_MODULE
;

528 #ià
CI_CFG_USERSPACE_PIPE


529 
lšux_tı_h–³r_fİs_pe_wr™”
.
owÃr
 = 
THIS_MODULE
;

530 
lšux_tı_h–³r_fİs_pe_»ad”
.
owÃr
 = 
THIS_MODULE
;

533 
rc
 = 
	`Úlßd_§n™y_checks
();

534 ifĞ
rc
 < 0 )

535 
ç_§n™y
;

537 
rc
 = 
	`ci_cfg_drv_ùÜ
();

538 ifĞ
rc
 < 0 ) {

539 
	`ci_log
("%s: ERROR: ci_cfg_drv_ùÜ faed (%d)", 
__FUNCTION__
, 
rc
);

540 
ç_cfg_drv_ùÜ
;

543 
	`oo_mm_tbl_š™
();

545 
rc
 = 
	`eçb_lšux_ŒampŞše_ùÜ
(
no_ù
);

546 ifĞ
rc
 < 0 ) {

547 
	`ci_log
("%s: ERROR:ƒfab_linux_trampoline_ctor failed (%d)",

548 
__FUNCTION__
, 
rc
);

549 
çed_ŒampŞše
;

552 
rc
 = 
	`ci_š¡®l_´oc_’Œ›s
();

553 ifĞ
rc
 < 0 ) {

554 
	`ci_log
("%s: ERROR: ci_š¡®l_´oc_’Œ› çed (%d)", 
__FUNCTION__
, 
rc
);

555 
ç_´oc
;

558 
rc
 = 
	`eçb_tı_driv”_ùÜ
(
max_Ãighs
, 
max_Ïy”2_š‹rçûs
, 
max_rou‹s
);

559 ifĞ
rc
 != 0 )

560 
ç__ùÜ
;

562 
rc
 = 
	`ci_bÚdšg_š™
();

563 ifĞ
rc
 < 0 ) {

564 
	`ci_log
("%s: ERROR: ci_bÚdšg_š™ faed (%d)", 
__FUNCTION__
, 
rc
);

565 
ç_bÚdšg
;

568 
	`eçb_´•¬e_fÜ_iscsi
();

570 
rc
 = 
	`oo_driv”lšk_»gi¡”
();

571 ifĞ
rc
 < 0 )

572 
çed_driv”lšk
;

575 
rc
 = 
	`Úlßdfs_š™
();

576 if(
rc
 < 0 )

577 
çed_Úlßdfs
;

580 
rc
 = 
	`ci_chrdev_ùÜ
(&
oo_fİs
, 
oo_dev_Çme
);

581 ifĞ
rc
 < 0 )

582 
çed_chrdev
;

584 
rc
 = 
	`oo_•Şl_chrdev_ùÜ
();

585 ifĞ
rc
 < 0 )

586 
çed_•Şldev_ùÜ
;

588 
	`OO_DEBUG_LOAD
(
	`ci_log
("Onload module initialised successfully."));

591 
	`oo_•Şl_chrdev_dtÜ
();

592 
çed_•Şldev_ùÜ
:

593 
	`ci_chrdev_dtÜ
(
EFAB_DEV_NAME
);

594 
çed_chrdev
:

595 
	`Úlßdfs_fši
();

596 
çed_Úlßdfs
:

597 
	`oo_driv”lšk_uÄegi¡”_nf
();

598 
	`oo_driv”lšk_uÄegi¡”_dl
();

599 
çed_driv”lšk
:

600 
	`ci_bÚdšg_fši
();

601 
ç_bÚdšg
:

602 
	`eçb_tı_driv”_dtÜ
();

603 
ç__ùÜ
:

604 
	`ci_unš¡®l_´oc_’Œ›s
();

605 
ç_´oc
:

606 
	`eçb_lšux_ŒampŞše_dtÜ
(
no_ù
);

607 
çed_ŒampŞše
:

608 
	`ci_cfg_drv_dtÜ
();

609 
ç_cfg_drv_ùÜ
:

610 
ç_§n™y
:

611  
rc
;

612 
	}
}

614 
moduË_š™
(
Úlßd_moduË_š™
);

617 
	$Úlßd_moduË_ex™
()

619 
	`OO_DEBUG_LOAD
(
	`ci_log
("Onload module unloading"));

621 
	`oo_•Şl_chrdev_dtÜ
();

622 
	`ci_chrdev_dtÜ
(
oo_dev_Çme
);

623 
	`Úlßdfs_fši
();

625 
	`ci_bÚdšg_fši
();

627 
	`oo_driv”lšk_uÄegi¡”_nf
();

636 
	`eçb_tı_driv”_dtÜ
();

638 
	`oo_driv”lšk_uÄegi¡”_dl
();

640 
	`ci_unš¡®l_´oc_’Œ›s
();

641 
	`OO_DEBUG_VERB
(
	`ci_log
("Unregistered client driver"));

643 
	`eçb_lšux_ŒampŞše_dtÜ
(
no_ù
);

645 
	`eçb_ş—nup_š_iscsi
();

646 
	`ci_cfg_drv_dtÜ
();

647 
	`OO_DEBUG_LOAD
(
	`ci_log
("Onload module unloaded"));

648 
	}
}

650 
moduË_ex™
(
Úlßd_moduË_ex™
);

655 
EXPORT_SYMBOL
(
ci_Ãtif_ùÜ
);

656 
EXPORT_SYMBOL
(
ci_Ãtif_dtÜ
);

	@driverlink_ip.c

11 
	~<lšux/Ãtf‹r.h
>

12 
	~<lšux/Ãtf‹r_¬p.h
>

13 
	~<lšux/Ãtf‹r_v4.h
>

15 
	~<ci/š‹º®/.h
>

16 
	~<Úlßd/driv”lšk_f‹r.h
>

17 
	~<Úlßd/ıÏÃ.h
>

18 
	~<driv”/lšux_Ãt/driv”lšk_­i.h
>

19 
	~<Úlßd/lšux_Úlßd_š‹º®.h
>

20 
	~<ci/š‹º®/ıÏÃ_hªdË.h
>

21 
	~<Úlßd/tı_h–³r_âs.h
>

22 
	~<Úlßd/nic.h
>

23 
	~<Úlßd/oof_š‹rçû.h
>

24 
	~<ci/eäm/eäm_ş›Á.h
>

25 
	~"Úlßd_š‹º®.h
"

26 
	~"Úlßd_k”Ãl_com·t.h
"

27 
	~<ci/driv”/eçb/h¬dw¬e.h
>

30 
	goo_u£_vÏns
 = 1;

31 
moduË_·¿m
(
oo_u£_vÏns
, , 
S_IRUGO
);

32 
MODULE_PARM_DESC
(
oo_u£_vÏns
,

35 
	goo_bÚd_pŞl_³ak
 = (
HZ
/100);

36 
moduË_·¿m
(
oo_bÚd_pŞl_³ak
, , 
S_IRUGO
 | 
S_IWUSR
);

37 
MODULE_PARM_DESC
(
oo_bÚd_pŞl_³ak
,

41 
	goo_bÚd_³ak_pŞls
 = 20;

42 
moduË_·¿m
(
oo_bÚd_³ak_pŞls
, , 
S_IRUGO
 | 
S_IWUSR
);

43 
MODULE_PARM_DESC
(
oo_bÚd_³ak_pŞls
,

48 #ià
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,27)

51 #iâdeà
VLAN_DEV_INFO


52 
	#VLAN_DEV_INFO
(
Ãtdev
è
	`vÏn_dev_šfo
Ò‘dev)

	)

54 #iâdeà
vÏn_dev_»®_dev


55 
šlše
 
Ãt_deviû
 *

56 
	$vÏn_dev_»®_dev
(cÚ¡ 
Ãt_deviû
 *
dev
)

58  
	`VLAN_DEV_INFO
(
dev
)->
»®_dev
;

59 
	}
}

61 #iâdeà
vÏn_dev_vÏn_id


62 
šlše
 
u16
 
	$vÏn_dev_vÏn_id
(cÚ¡ 
Ãt_deviû
 *
dev
)

64  
	`VLAN_DEV_INFO
(
dev
)->
vÏn_id
;

65 
	}
}

70 #ià
CI_CFG_TEAMING


71 #ifdeà
IFF_BONDING


72 
	#NETDEV_IS_BOND_MASTER
(
_dev
) \

73 ((
_dev
->
æags
 & (
IFF_MASTER
)è&& (_dev->
´iv_æags
 & 
IFF_BONDING
))

	)

74 
	#NETDEV_IS_BOND
(
_dev
) \

75 ((
_dev
->
æags
 & (
IFF_MASTER
 | 
IFF_SLAVE
)è&& (_dev->
´iv_æags
 & 
IFF_BONDING
))

	)

77 
	#NETDEV_IS_BOND_MASTER
(
_dev
è(_dev->
æags
 & (
IFF_MASTER
))

	)

78 
	#NETDEV_IS_BOND
(
_dev
è(_dev->
æags
 & (
IFF_MASTER
 | 
IFF_SLAVE
))

	)

81 
	#NETDEV_IS_BOND_MASTER
(
_dev
è0

	)

82 
	#NETDEV_IS_BOND
(
_dev
è0

	)

87 
šlše
 
	$oo_nf_dev_m©ch
(cÚ¡ 
Ãt_deviû
 *
Ãt_dev
)

89 ifĞ
Ãt_dev
->
´iv_æags
 & 
IFF_802_1Q_VLAN
 )

90 
Ãt_dev
 = 
	`vÏn_dev_»®_dev
(net_dev);

92 #ià
CI_CFG_TEAMING


93 ifĞ
	`NETDEV_IS_BOND_MASTER
(
Ãt_dev
) )

97  
	`efx_dl_Ãtdev_is_ours
(
Ãt_dev
);

98 
	}
}

101 
	$oo_nf_skb_g‘_·ylßd
(
sk_buff
* 
skb
, ** 
pd©a
, * 
¶’
)

103 ifĞ
	`skb_is_nÚlš—r
(
skb
) ) {

105 
h—d_Ën
 = 
	`skb_h—dËn
(
skb
);

106 
skb_äag_t
* 
äag
 = &
	`skb_shšfo
(
skb
)->
äags
[0];

108 ifĞ
	`skb_shšfo
(
skb
)->
äag_li¡
 || 
äag
->
·ge_off£t
 < 
h—d_Ën
 )

110 *
pd©a
 = 
	`skb_äag_add»ss
(
äag
è- 
h—d_Ën
;

111 *
¶’
 = 
äag
->
size
 + 
h—d_Ën
;

114 *
pd©a
 = 
skb
->
d©a
;

115 *
¶’
 = 
skb
->
Ën
;

118 
	}
}

120 #ià
defšed
 (
RHEL_MAJOR
è&& defšed (
RHEL_MINOR
)

121 #ià
RHEL_MAJOR
 =ğ7 && 
RHEL_MINOR
 >= 2

123 
	#EFRM_HAVE_NETFILTER_INDEV_OUTDEV
 
yes


	)

128 
oo_Ãtf‹r_¬p
(

129 #ifdeà
EFRM_HAVE_NETFILTER_HOOK_STATE


130 cÚ¡ 
nf_hook_İs
* 
İs
,

131 
sk_buff
* 
skb
,

132 #ifdeà
EFRM_HAVE_NETFILTER_INDEV_OUTDEV


133 cÚ¡ 
Ãt_deviû
* 
šdev
,

134 cÚ¡ 
Ãt_deviû
* 
outdev
,

136 
	#šdev
 
¡©e
->
š


	)

138 cÚ¡ 
nf_hook_¡©e
 *
¡©e


140 #ifdeà
EFRM_HAVE_NETFILTER_HOOK_OPS


141 cÚ¡ 
nf_hook_İs
* 
İs
,

142 
sk_buff
* 
skb
,

144 
hooknum
,

145 #ifdeà
EFRM_HAVE_NETFILTER_INDIRECT_SKB


147 
sk_buff
** 
pskb
,

148 
	#skb
 (*
pskb
)

	)

150 
sk_buff
* 
skb
,

153 cÚ¡ 
Ãt_deviû
* 
šdev
,

154 cÚ¡ 
Ãt_deviû
* 
outdev
,

155 (*
okâ
)(
sk_buff
*)

160 * 
d©a
;

161 
Ën
;

163 ifĞ
	`oo_nf_dev_m©ch
(
šdev
) &&

164 
	`oo_nf_skb_g‘_·ylßd
(
skb
, &
d©a
, &
Ën
) &&

165 
Ën
 >ğ(
ci_‘h”_¬p
) ) {

166 
	`ciı¶_hªdË_¬p_pkt
(&
CI_GLOBAL_CPLANE
,

167 (
ci_‘h”_hdr
*è
	`skb_mac_h—d”
(
skb
),

168 (
ci_‘h”_¬p
*è
d©a
,

169 
šdev
->
ifšdex
, indev->
æags
 & 
IFF_SLAVE
);

172  
NF_ACCEPT
;

173 
	}
}

174 #undeà
šdev


175 #undeà
skb


178 #iâdeà
CONFIG_NETFILTER


183 
nf_hook_İs
 
	goo_Ãtf‹r_¬p_hook
 = {

184 .
hook
 = 
oo_Ãtf‹r_¬p
,

185 .
	gowÃr
 = 
THIS_MODULE
,

186 #ifdeà
EFX_HAVE_NFPROTO_CONSTANTS


187 .
	gpf
 = 
NFPROTO_ARP
,

189 .
	gpf
 = 
NF_ARP
,

191 .
	ghooknum
 = 
NF_ARP_IN
,

194 
oo_Ãtf‹r_
(

195 #ifdeà
EFRM_HAVE_NETFILTER_HOOK_STATE


196 cÚ¡ 
nf_hook_İs
* 
İs
,

197 
sk_buff
* 
skb
,

198 #ifdeà
EFRM_HAVE_NETFILTER_INDEV_OUTDEV


199 cÚ¡ 
Ãt_deviû
* 
šdev
,

200 cÚ¡ 
Ãt_deviû
* 
outdev
,

202 
	#šdev
 
¡©e
->
š


	)

204 cÚ¡ 
nf_hook_¡©e
 *
¡©e


206 #ifdeà
EFRM_HAVE_NETFILTER_HOOK_OPS


207 cÚ¡ 
nf_hook_İs
* 
İs
,

208 
sk_buff
* 
skb
,

210 
hooknum
,

211 #ifdeà
EFRM_HAVE_NETFILTER_INDIRECT_SKB


213 
sk_buff
** 
pskb
,

214 
	#skb
 (*
pskb
)

	)

216 
sk_buff
* 
skb
,

219 cÚ¡ 
Ãt_deviû
* 
šdev
,

220 cÚ¡ 
Ãt_deviû
* 
outdev
,

221 (*
okâ
)(
sk_buff
*)

225 * 
d©a
;

226 
Ën
;

228 ifĞ
	`oo_nf_dev_m©ch
(
šdev
) &&

229 
	`oo_nf_skb_g‘_·ylßd
(
skb
, &
d©a
, &
Ën
) &&

230 
	`efx_dlf‹r_hªdËr
(
šdev
->
ifšdex
, 
eçb_tı_driv”
.
dlf‹r
,

231 (cÚ¡ 
ci_‘h”_hdr
*è
	`skb_mac_h—d”
(
skb
),

232 
d©a
, 
Ën
) ) {

233 
	`kä“_skb
(
skb
);

234  
NF_STOLEN
;

236  
NF_ACCEPT
;

238 
	}
}

239 #undeà
šdev


240 #undeà
skb


242 
nf_hook_İs
 
	goo_Ãtf‹r__hook
 = {

243 .
hook
 = 
oo_Ãtf‹r_
,

244 .
	gowÃr
 = 
THIS_MODULE
,

245 #ifdeà
EFX_HAVE_NFPROTO_CONSTANTS


246 .
	gpf
 = 
NFPROTO_IPV4
,

248 .
	gpf
 = 
PF_INET
,

250 #ifdeà
NF_IP_PRE_ROUTING


251 .
	ghooknum
 = 
NF_IP_PRE_ROUTING
,

253 .
	ghooknum
 = 
NF_INET_PRE_ROUTING
,

255 .
	g´iÜ™y
 = 
NF_IP_PRI_FIRST
,

259 
	$oo_eäm_»£t_ÿÎback
(
eäm_ş›Á
* 
ş›Á
, * 
¬g
)

261 
oo_nic
* 
Úic
;

262 
ci_Ãtif
* 
ni
;

263 
hwpÜt
, 
štf_i
;

264 
ifšdex
 = 
	`eäm_ş›Á_g‘_ifšdex
(
ş›Á
);

265 
ci_œqlock_¡©e_t
 
lock_æags
;

266 
ci_dÎšk
 *
lšk
;

268 ifĞ(
Úic
 = 
	`oo_nic_fšd_ifšdex
(
ifšdex
)è!ğ
NULL
 ) {

269 
hwpÜt
 = 
Úic
 - 
oo_nics
;

277 
	`ci_œqlock_lock
(&
THR_TABLE
.
lock
, &
lock_æags
);

278 
	`CI_DLLIST_FOR_EACH
(
lšk
, &
THR_TABLE
.
¡¬‹d_¡acks
) {

279 
tı_h–³r_»sourû_t
 *
thr
;

280 
thr
 = 
	`CI_CONTAINER
(
tı_h–³r_»sourû_t
, 
®l_¡acks_lšk
, 
lšk
);

281 
ni
 = &
thr
->
Ãtif
;

284 ifĞ(
štf_i
 = 
ni
->
hwpÜt_to_štf_i
[
hwpÜt
]) >= 0 )

285 
	`tı_h–³r_»£t_¡ack
(
ni
, 
štf_i
);

287 
	`ci_œqlock_uÆock
(&
THR_TABLE
.
lock
, &
lock_æags
);

289 
ni
 = 
NULL
;

290  
	`™”©e_Ãtifs_uÆocked
(&
ni
) == 0 )

291 ifĞ(
štf_i
 = 
ni
->
hwpÜt_to_štf_i
[
hwpÜt
]) >= 0 )

292 
	`tı_h–³r_»£t_¡ack
(
ni
, 
štf_i
);

294 
	}
}

296 
eäm_ş›Á_ÿÎbacks
 
	goo_eäm_ş›Á_ÿÎbacks
 = {

297 
oo_eäm_»£t_ÿÎback


314 
oo_nic
 *
	$oo_Ãtdev_may_add
(cÚ¡ 
Ãt_deviû
 *
Ãt_dev
)

316 
eäm_ş›Á
*ƒfrm_client;

317 
efhw_nic
*ƒfhw_nic;

318 
oo_nic
* 
Úic
;

319 
rc
;

321 
	`BUG_ON
(!
	`Ãtif_ruÂšg
(
Ãt_dev
));

323 
Úic
 = 
	`oo_nic_fšd_ifšdex
(
Ãt_dev
->
ifšdex
);

325 ifĞ
Úic
 =ğ
NULL
 ) {

326 
rc
 = 
	`eäm_ş›Á_g‘
(
Ãt_dev
->
ifšdex
, &
oo_eäm_ş›Á_ÿÎbacks
,

327 
NULL
, &
eäm_ş›Á
);

328 ifĞ
rc
 != 0 )

330 
ç1
;

332 
Úic
 = 
	`oo_nic_add
(
eäm_ş›Á
);

333 ifĞ
Úic
 =ğ
NULL
 ) {

334 
	`ci_log
("%s: oo_nic_add(ifšdex=%dèçed", 
__func__
, 
Ãt_dev
->
ifšdex
);

335 
ç2
;

339 ifĞ
Ãt_dev
->
æags
 & 
IFF_UP
 ) {

340 
efhw_nic
 = 
	`eäm_ş›Á_g‘_nic
(
Úic
->
eäm_ş›Á
);

341 
	`oof_hwpÜt_up_down
(
	`oo_nic_hwpÜt
(
Úic
), 1,

342 
efhw_nic
->
devty³
.
¬ch
 =ğ
EFHW_ARCH_EF10
 ? 1:0,

343 
efhw_nic
->
æags
 & 
NIC_FLAG_VLAN_FILTERS
);

346  
Úic
;

348 
ç2
:

349 
	`eäm_ş›Á_put
(
eäm_ş›Á
);

350 
ç1
:

351  
NULL
;

352 
	}
}

354 
	$oo_Ãtdev_»move
(
oo_nic
 *
Úic
)

356 
eäm_ş›Á
 *efrm_client;

358 
eäm_ş›Á
 = 
Úic
->efrm_client;

359 
	`oo_nic_»move
(
Úic
);

360 
	`eäm_ş›Á_put
(
eäm_ş›Á
);

361 
	}
}

363 
	$oo_dl_´obe
(
efx_dl_deviû
* 
dl_dev
,

364 cÚ¡ 
Ãt_deviû
* 
Ãt_dev
,

365 cÚ¡ 
efx_dl_deviû_šfo
* 
dev_šfo
,

366 cÚ¡ * 
sicÚ_»v
)

368 
oo_nic
* 
Úic
 = 
NULL
;

370 #ià
EFX_DRIVERLINK_API_VERSION
 >= 8

371 
efx_dl_çlcÚ_»sourûs
 *
»s
;

373 
	`efx_dl_fÜ_—ch_deviû_šfo_m©chšg
(
dev_šfo
, 
EFX_DL_FALCON_RESOURCES
,

374 
efx_dl_çlcÚ_»sourûs
,

375 
hdr
, 
»s
) {

376 ifĞ
»s
->
rx_u¤_buf_size
 > 
FALCON_RX_USR_BUF_SIZE
 ) {

377 
	`ci_log
("%s: ERROR: N‘ driv”„x_u¤_buf_siz%u > %u", 
__func__
,

378 
»s
->
rx_u¤_buf_size
, 
FALCON_RX_USR_BUF_SIZE
);

384 ifĞ
	`Ãtif_ruÂšg
(
Ãt_dev
) ) {

385 
Úic
 = 
	`oo_Ãtdev_may_add
(
Ãt_dev
);

386 ifĞ
Úic
 =ğ
NULL
 )

389 
dl_dev
->
´iv
 = (*)
Ãt_dev
;

391 
	}
}

394 
	$oo_dl_»move
(
efx_dl_deviû
* 
dl_dev
)

396 
Ãt_deviû
 *
Ãt_dev
 = 
dl_dev
->
´iv
;

397 
oo_nic
* 
Úic
;

398 
ci_œqlock_¡©e_t
 
lock_æags
;

400 
	`ci_œqlock_lock
(&
THR_TABLE
.
lock
, &
lock_æags
);

401 ifĞ
	`ci_dÎi¡_nÙ_em±y
(&
THR_TABLE
.
®l_¡acks
) ) {

402 
	`ci_log
("Driverlink unregistering but still stacks…resent");

403 
	`ci_as£¹
(0);

405 
	`ci_œqlock_uÆock
(&
THR_TABLE
.
lock
, &
lock_æags
);

407 
Úic
 = 
	`oo_nic_fšd_ifšdex
(
Ãt_dev
->
ifšdex
);

408 ifĞ
Úic
 !ğ
NULL
 )

409 
	`oo_Ãtdev_»move
(
Úic
);

410 
	}
}

413 
	$oo_dl_»£t_su¥’d
(
efx_dl_deviû
* 
dl_dev
)

415 
	`ci_log
("%s:", 
__FUNCTION__
);

416 
	}
}

419 
	$oo_dl_»£t_»sume
(
efx_dl_deviû
* 
dl_dev
, 
ok
)

421 
	`ci_log
("%s:", 
__FUNCTION__
);

422 
	}
}

425 
	$oo_fixup_wakeup_b»akage
(
ifšdex
)

435 
oo_nic
* 
Úic
;

436 
ci_Ãtif
* 
ni
 = 
NULL
;

437 
hwpÜt
, 
štf_i
;

438 ifĞ(
Úic
 = 
	`oo_nic_fšd_ifšdex
(
ifšdex
)è!ğ
NULL
 ) {

439 
hwpÜt
 = 
Úic
 - 
oo_nics
;

440  
	`™”©e_Ãtifs_uÆocked
(&
ni
) == 0 )

441 ifĞ(
štf_i
 = 
ni
->
hwpÜt_to_štf_i
[
hwpÜt
]) >= 0 )

442 
	`ci_b™_ş—r
(&
ni
->
¡©e
->
evq_´imed
, 
štf_i
);

444 
	}
}

447 
	$oo_Ãtdev_up
(
Ãt_deviû
* 
Ãtdev
)

449 
oo_nic
* 
Úic
;

452 ifĞ
	`eäm_nic_´e£Á
(
Ãtdev
->
ifšdex
) ) {

453 
	`oo_Ãtdev_may_add
(
Ãtdev
);

454 
	`oo_fixup_wakeup_b»akage
(
Ãtdev
->
ifšdex
);

457 
ciı_’ÿp_t
 
’ÿp
;

459 
’ÿp
.
ty³
 = 
CICP_LLAP_TYPE_NONE
;

460 
’ÿp
.
vÏn_id
 = 0;

462 #ià
CI_CFG_TEAMING


463 ifĞ
	`NETDEV_IS_BOND_MASTER
(
Ãtdev
) ) {

464 
	`OO_DEBUG_BONDING
(
	`ci_log
("BÚd ma¡” % UP", 
Ãtdev
->
Çme
));

465 
’ÿp
.
ty³
 |ğ
CICP_LLAP_TYPE_BOND
;

469 ifĞ
oo_u£_vÏns
 && (
Ãtdev
->
´iv_æags
 & 
IFF_802_1Q_VLAN
) ) {

470 
’ÿp
.
ty³
 |ğ
CICP_LLAP_TYPE_VLAN
;

471 
’ÿp
.
vÏn_id
 = 
	`vÏn_dev_vÏn_id
(
Ãtdev
);

473 ifĞ
	`NETDEV_IS_BOND_MASTER
(
	`vÏn_dev_»®_dev
(
Ãtdev
)) )

474 
’ÿp
.
ty³
 |ğ
CICP_LLAP_TYPE_BOND
;

477 ifĞ
’ÿp
.
ty³
 !ğ
CICP_LLAP_TYPE_NONE
 ) {

478 #ià
CI_CFG_TEAMING


479 ifĞ
’ÿp
.
ty³
 & 
CICP_LLAP_TYPE_BOND
 ) {

480 
ciı_’ÿp_t
 
Şd_’ÿp
;

481 
ci_ifid_t
 
ma¡”_ifšdex
;

483 ifĞ
’ÿp
.
ty³
 & 
CICP_LLAP_TYPE_VLAN
 ) {

484 
Ãt_deviû
 *
»®_dev
 = 
	`vÏn_dev_»®_dev
(
Ãtdev
);

485 
ma¡”_ifšdex
 = 
»®_dev
->
ifšdex
;

486 
	`ci_bÚdšg_g‘_xm™_pŞicy_æags
(
»®_dev
, &
’ÿp
.
ty³
);

489 
ma¡”_ifšdex
 = 
Ãtdev
->
ifšdex
;

490 
	`ci_bÚdšg_g‘_xm™_pŞicy_æags
(
Ãtdev
, &
’ÿp
.
ty³
);

493 ifĞ
	`ciı_Î­_g‘_’ÿpsuÏtiÚ
(&
CI_GLOBAL_CPLANE
, 
Ãtdev
->
ifšdex
,

494 &
Şd_’ÿp
) != 0 )

495 
	`ciıos_Î­_impÜt
(&
CI_GLOBAL_CPLANE
, 
NULL
, 
Ãtdev
->
ifšdex
,

496 
Ãtdev
->
mtu
, 1,‚‘dev->
Çme
, 
NULL
, NULL);

498 
OO_DEBUG_BONDING


499 (
	`ci_log
("NETDEV_UP changingƒncap on %d from %do %d",

500 
Ãtdev
->
ifšdex
, 
Şd_’ÿp
.
ty³
, 
’ÿp
.type));

502 
	`ciı_Î­_£t_bÚd
(&
CI_GLOBAL_CPLANE
, 
Ãtdev
->
ifšdex
,

503 
ma¡”_ifšdex
, &
’ÿp
);

504 ifĞ
’ÿp
.
ty³
 & 
CICP_LLAP_TYPE_VLAN
 )

505 
	`ciı_Î­_£t_vÏn
(&
CI_GLOBAL_CPLANE
, 
Ãtdev
->
ifšdex
,

506 
ma¡”_ifšdex
);

510 ifĞ(
’ÿp
.
ty³
 & 
CICP_LLAP_TYPE_VLAN
) &&

511 
	`eäm_nic_´e£Á
(
	`vÏn_dev_»®_dev
(
Ãtdev
)->
ifšdex
) ) {

512 
Ãt_deviû
* 
»®_dev
 = 
	`vÏn_dev_»®_dev
(
Ãtdev
);

513 
Úic
 = 
	`oo_nic_fšd_ifšdex
(
»®_dev
->
ifšdex
);

514 ifĞ
Úic
 =ğ
NULL
 )

516 
Úic
 = 
	`oo_Ãtdev_may_add
(
»®_dev
);

517 ifĞ
Úic
 !ğ
NULL
 ) {

518 
	`ciı_Î­_£t_hwpÜt
(&
CI_GLOBAL_CPLANE
, 
Ãtdev
->
ifšdex
,

519 
	`CI_HWPORT_ID
(
Úic
 - 
oo_nics
), &
’ÿp
);

520 ifĞ
’ÿp
.
ty³
 & 
CICP_LLAP_TYPE_VLAN
 )

521 
	`ciı_Î­_£t_vÏn
(&
CI_GLOBAL_CPLANE
, 
Ãtdev
->
ifšdex
,

522 
»®_dev
->
ifšdex
);

525 
	`OO_DEBUG_BONDING
(
	`ci_log
("Failedo configure VLAN if %d‡s…arent "

527 
Ãtdev
->
ifšdex
, 
»®_dev
->ifindex));

531 #ià
CI_CFG_TEAMING


532 ifĞ
	`NETDEV_IS_BOND
(
Ãtdev
) )

533 
	`ci_bÚdšg_£t_tim”_³riod
(
oo_bÚd_pŞl_³ak
, 
oo_bÚd_³ak_pŞls
);

535 
	}
}

538 
	$oo_Ãtdev_gošg_down
(
Ãt_deviû
* 
Ãtdev
)

540 
ci_œqlock_¡©e_t
 
lock_æags
;

541 
oo_nic
 *
Úic
;

543 
Úic
 = 
	`oo_nic_fšd_ifšdex
(
Ãtdev
->
ifšdex
);

544 ifĞ
Úic
 !ğ
NULL
 ) {

545 
	`oof_hwpÜt_up_down
(
	`oo_nic_hwpÜt
(
Úic
), 0, 0, 0);

546 
	`ci_œqlock_lock
(&
THR_TABLE
.
lock
, &
lock_æags
);

547 ifĞ
	`ci_dÎi¡_is_em±y
(&
THR_TABLE
.
®l_¡acks
) )

548 
	`oo_Ãtdev_»move
(
Úic
);

550 
	`ci_log
("Unableo oo_nic_remove(ifindex=%d, hwport=%d) because of "

551 "İ’ scks", 
Ãtdev
->
ifšdex
, 
	`oo_nic_hwpÜt
(
Úic
));

552 
	`ci_œqlock_uÆock
(&
THR_TABLE
.
lock
, &
lock_æags
);

555 ifĞ(
Ãtdev
->
´iv_æags
 & 
IFF_802_1Q_VLAN
) ||

556 
	`NETDEV_IS_BOND_MASTER
(
Ãtdev
) ) {

560 
	`ciı_Î­_£t_hwpÜt
(&
CI_GLOBAL_CPLANE
, 
Ãtdev
->
ifšdex
,

561 
CI_HWPORT_ID_BAD
, 
NULL
);

564 #ià
CI_CFG_TEAMING


565 ifĞ
	`NETDEV_IS_BOND_MASTER
(
Ãtdev
) )

566 
	`ciı_bÚd_»move_ma¡”
(&
CI_GLOBAL_CPLANE
, 
Ãtdev
->
ifšdex
);

569 #ià
CI_CFG_TEAMING


570 ifĞ
	`NETDEV_IS_BOND
(
Ãtdev
) )

571 
	`ci_bÚdšg_£t_tim”_³riod
(
oo_bÚd_pŞl_³ak
, 
oo_bÚd_³ak_pŞls
);

573 
	}
}

577 
	$oo_Ãtdev_ev’t
(
nÙif›r_block
 *
this
,

578 
ev’t
, *
±r
)

580 
Ãt_deviû
 *
Ãtdev
 = 
	`Ãtdev_nÙif›r_šfo_to_dev
(
±r
);

582  
ev’t
 ) {

583 
NETDEV_UP
:

584 
	`oo_Ãtdev_up
(
Ãtdev
);

587 
NETDEV_GOING_DOWN
:

588 
	`oo_Ãtdev_gošg_down
(
Ãtdev
);

591 
NETDEV_CHANGEMTU
:

592 
	`oo_fixup_wakeup_b»akage
(
Ãtdev
->
ifšdex
);

595 #ià
CI_CFG_TEAMING
 && 
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(2,6,27)

596 
NETDEV_BONDING_FAILOVER
:

597 
	`ci_bÚdšg_£t_tim”_³riod
(
oo_bÚd_pŞl_³ak
, 
oo_bÚd_³ak_pŞls
);

605  
NOTIFY_DONE
;

606 
	}
}

609 
nÙif›r_block
 
	goo_Ãtdev_nÙif›r
 = {

610 .
nÙif›r_ÿÎ
 = 
oo_Ãtdev_ev’t
,

614 
efx_dl_driv”
 
	goo_dl_driv”
 = {

615 .
Çme
 = "onload",

616 #ià
EFX_DRIVERLINK_API_VERSION
 >= 8

617 .
	gæags
 = 
EFX_DL_DRIVER_CHECKS_FALCON_RX_USR_BUF_SIZE
,

619 .
	g´obe
 = 
oo_dl_´obe
,

620 .
	g»move
 = 
oo_dl_»move
,

621 .
	g»£t_su¥’d
 = 
oo_dl_»£t_su¥’d
,

622 .
	g»£t_»sume
 = 
oo_dl_»£t_»sume


626 
	$oo_driv”lšk_»gi¡”
()

628 
rc
;

630 
rc
 = 
	`»gi¡”_Ãtdeviû_nÙif›r
(&
oo_Ãtdev_nÙif›r
);

631 ià(
rc
 != 0)

632 
ç1
;

634 
rc
 = 
	`efx_dl_»gi¡”_driv”
(&
oo_dl_driv”
);

635 ià(
rc
 != 0)

636 
ç2
;

638 
rc
 = 
	`nf_»gi¡”_hook
(&
oo_Ãtf‹r_¬p_hook
);

639 ifĞ
rc
 < 0 )

640 
ç3
;

642 
rc
 = 
	`nf_»gi¡”_hook
(&
oo_Ãtf‹r__hook
);

643 ifĞ
rc
 < 0 )

644 
ç4
;

648 
ç4
:

649 
	`nf_uÄegi¡”_hook
(&
oo_Ãtf‹r_¬p_hook
);

650 
ç3
:

651 
	`efx_dl_uÄegi¡”_driv”
(&
oo_dl_driv”
);

652 
ç2
:

653 
	`uÄegi¡”_Ãtdeviû_nÙif›r
(&
oo_Ãtdev_nÙif›r
);

654 
ç1
:

655 
	`ci_log
("%s:ƒfx_dl_»gi¡”_driv” faed (%d)", 
__FUNCTION__
, 
rc
);

656  
rc
;

657 
	}
}

660 
	$oo_driv”lšk_uÄegi¡”_nf
()

662 
	`nf_uÄegi¡”_hook
(&
oo_Ãtf‹r__hook
);

663 
	`nf_uÄegi¡”_hook
(&
oo_Ãtf‹r_¬p_hook
);

664 
	`uÄegi¡”_Ãtdeviû_nÙif›r
(&
oo_Ãtdev_nÙif›r
);

665 
	}
}

667 
	$oo_driv”lšk_uÄegi¡”_dl
()

669 
	`efx_dl_uÄegi¡”_driv”
(&
oo_dl_driv”
);

670 
	}
}

	@epoll_device.c

12 
	~<ci/š‹º®/Œª¥Üt_cÚfig_İt.h
>

14 #ià
CI_CFG_USERSPACE_EPOLL


16 
	~<Úlßd/lšux_Úlßd_š‹º®.h
>

17 
	~<Úlßd/lšux_Úlßd.h
>

18 
	~<Úlßd/tı_h–³r_âs.h
>

19 
	~<Úlßd/•Şl.h
>

20 
	~<lšux/ev’Şl.h
>

21 
	~<lšux/uni¡d.h
>

22 
	~"Úlßd_š‹º®.h
"

23 
	~<ci/š‹º®/ıÏÃ_İs.h
>

25 #ià
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(2,6,29)

28 
	#OO_EPOLL_NEED_NEST_PROTECTION


	)

32 #iâdeà
__MODULE_PARM_TYPE


33 
	#__MODULE_PARM_TYPE
(
Çme
, 
_ty³
) \

34 
	`__MODULE_INFO
(
·rmty³
, 
Çme
##
ty³
, #Çm":" 
_ty³
)

	)

40 
£t_max_¡acks
(cÚ¡ *
v®
, 
k”Ãl_·¿m
 *
kp
);

41 
	g•Şl2_max_¡acks
 = 
CI_CFG_EPOLL_MAX_STACKS
;

42 
moduË_·¿m_ÿÎ
(
•Şl2_max_¡acks
, 
£t_max_¡acks
, 
·¿m_g‘_ušt
,

43 &
•Şl2_max_¡acks
, 
S_IRUGO
);

44 
__MODULE_PARM_TYPE
(
•Şl2_max_¡acks
, "uint");

45 
	g•Şl_max_¡acks
 = 
CI_CFG_EPOLL_MAX_STACKS
;

46 
moduË_·¿m_ÿÎ
(
•Şl_max_¡acks
, 
£t_max_¡acks
, 
·¿m_g‘_ušt
,

47 &
•Şl_max_¡acks
, 
S_IRUGO
);

48 
__MODULE_PARM_TYPE
(
•Şl_max_¡acks
, "uint");

49 
MODULE_PARM_DESC
(
•Şl_max_¡acks
,

52 
	soo_•Şl2_´iv©e
 {

53 
fe
 *
	mk•o
;

54 
¥šlock_t
 
	mlock
;

55 
	mdo_¥š
;

56 #ifdeà
OO_EPOLL_NEED_NEST_PROTECTION


57 
li¡_h—d
 
	mbusy_sks
;

59 
tı_h–³r_»sourû_t
** 
	m¡acks
;

61 #ifdeà
OO_EPOLL_NEED_NEST_PROTECTION


62 
	soo_•Şl_busy_sk
 {

63 
li¡_h—d
 
	mlšk
;

64 
sk_¡ruù
 *
	msk
;

72 
	soo_•Şl1_´iv©e
 {

74 
oo_•Şl1_sh¬ed
 *
	msh
;

75 
·ge
 *
	m·ge
;

78 
pŞl_bË
 
	m±
;

79 
wa™_queue_t
 
	mwa™
;

80 
wa™_queue_h—d_t
 *
	mwh—d
;

83 
fe
 *
	mos_fe
;

85 
¥šlock_t
 
	mlock
;

86 
tı_h–³r_»sourû_t
** 
	m¡acks
;

92 
	soo_•Şl_fe_´iv©e
 {

93 
	mty³
;

94 
	#OO_EPOLL_TYPE_UNKNOWN
 0

	)

95 
	#OO_EPOLL_TYPE_1
 1

	)

96 
	#OO_EPOLL_TYPE_2
 2

	)

98 
oo_•Şl1_´iv©e
 
	mp1
;

99 
oo_•Şl2_´iv©e
 
	mp2
;

100 } 
	mp
;

104 
šlše
 
	$oo_•Şl_ùl_cİy_to_k”Ãl
(
oo_•Şl_™em
 *
™em_u
,

105 
ci_ušt32
 
•Şl_ùl_n
,

106 
oo_•Şl_™em
 *
de¡
)

108 ifĞ
•Şl_ùl_n
 > 
CI_CFG_EPOLL_MAX_POSTPONED
 )

109  -
EFAULT
;

110 ifĞ
	`cİy_äom_u£r
(
de¡
, 
™em_u
,

111 (
oo_•Şl_™em
è* 
•Şl_ùl_n
) )

112  -
EFAULT
;

114 
	}
}

117 
šlše
 
	$oo_•Şl_w¬n_po¡pÚe_”rÜ
(
ci_ušt32
 
ùl_n
,

118 
fd
, 
i
, 
rc
,

119 
ci_št32
 
maxev’ts
)

121 ifĞ
rc
 && (
i
 !ğ
ùl_n
 - 1 || 
maxev’ts
 != 0) ) {

122 
	`ci_log
("postponedƒpoll_ctl(fd=%d)„eturnedƒrror %d; ignoring",

123 
fd
, 
rc
);

124 
	`ci_log
("consider disabling EF_EPOLL_CTL_FASTo get "

127 
	}
}

133 
	$£t_max_¡acks
(cÚ¡ *
v®
, 
k”Ãl_·¿m
 *
kp
)

135 
rc
 = 
	`·¿m_£t_ušt
(
v®
, 
kp
);

136 ifĞ
rc
 != 0 )

137  
rc
;

140 ifĞ
•Şl2_max_¡acks
 !ğ
CI_CFG_EPOLL_MAX_STACKS
 &&

141 
•Şl_max_¡acks
 =ğ
CI_CFG_EPOLL_MAX_STACKS
)

142 
•Şl_max_¡acks
 = 
•Şl2_max_¡acks
;

145 ifĞ
•Şl_max_¡acks
 == 0 )

146 
•Şl_max_¡acks
 = 
CI_CFG_EPOLL_MAX_STACKS
;

149 
	}
}

151 
	$oo_•Şl2_ùÜ
(
oo_•Şl2_´iv©e
 *
´iv
, 
k•fd
)

153 
fe
 *
k•o
 = 
	`fg‘
(
k•fd
);

154 
size
 = (
´iv
->
¡acks
[0]è* 
•Şl_max_¡acks
;

156 ifĞ
k•o
 =ğ
NULL
 )

157  -
EBADF
;

159 
´iv
->
¡acks
 = 
	`km®loc
(
size
, 
GFP_KERNEL
);

160 ifĞ
´iv
->
¡acks
 =ğ
NULL
 )

161  -
ENOMEM
;

162 
	`mem£t
(
´iv
->
¡acks
, 0, 
size
);

164 
	`¥š_lock_š™
(&
´iv
->
lock
);

165 #ifdeà
OO_EPOLL_NEED_NEST_PROTECTION


166 
	`INIT_LIST_HEAD
(&
´iv
->
busy_sks
);

168 
´iv
->
k•o
 = kepo;

170 
	}
}

172 
	$oo_•Şl2_š™
(
oo_•Şl_fe_´iv©e
 *
´iv
,

173 
ci_fixed_desütÜ_t
 
k•fd
)

175 
rc
;

177 
rc
 = 
	`oo_•Şl2_ùÜ
(&
´iv
->
p
.
p2
, ()
k•fd
);

178 ifĞ
rc
 != 0 )

179  
rc
;

180 
´iv
->
ty³
 = 
OO_EPOLL_TYPE_2
;

182 
	}
}

184 
	$oo_•Şl2_add_¡ack
(
oo_•Şl2_´iv©e
* 
´iv
,

185 
tı_h–³r_»sourû_t
* 
fd_thr
)

187 
i
;

192  
i
 = 0; i < 
•Şl_max_¡acks
; ++i )

193 ifĞ
´iv
->
¡acks
[
i
] =ğ
fd_thr
 )

195 if(
	`uÆik–y
Ğ
´iv
->
¡acks
[
i
] =ğ
NULL
 ))

199 
	`¥š_lock
(&
´iv
->
lock
);

200  
i
 = 0; i < 
•Şl_max_¡acks
; ++i ) {

201 ifĞ
´iv
->
¡acks
[
i
] =ğ
fd_thr
 )

203 ifĞ
´iv
->
¡acks
[
i
] !ğ
NULL
 )

205 
´iv
->
¡acks
[
i
] = 
fd_thr
;

208 
	`eçb_tı_h–³r_k_»f_couÁ_šc
(
fd_thr
);

211 
	`¥š_uÆock
(&
´iv
->
lock
);

212  
i
 < 
•Şl_max_¡acks
;

213 
	}
}

214 
	$oo_•Şl1_add_¡ack
(
oo_•Şl1_´iv©e
* 
´iv
,

215 
tı_h–³r_»sourû_t
* 
fd_thr
)

217 
i
;

222  
i
 = 0; i < 
•Şl_max_¡acks
; ++i )

223 ifĞ
´iv
->
¡acks
[
i
] =ğ
fd_thr
 )

225 if(
	`uÆik–y
Ğ
´iv
->
¡acks
[
i
] =ğ
NULL
 ))

229 
	`¥š_lock
(&
´iv
->
lock
);

230  
i
 = 0; i < 
•Şl_max_¡acks
; ++i ) {

231 ifĞ
´iv
->
¡acks
[
i
] =ğ
fd_thr
 )

233 ifĞ
´iv
->
¡acks
[
i
] !ğ
NULL
 )

235 
´iv
->
¡acks
[
i
] = 
fd_thr
;

238 
	`eçb_tı_h–³r_k_»f_couÁ_šc
(
fd_thr
);

241 
	`¥š_uÆock
(&
´iv
->
lock
);

242  
i
 < 
•Şl_max_¡acks
;

243 
	}
}

246 
	$oo_•Şl2_ùl
(
oo_•Şl2_´iv©e
 *
´iv
, 
İ_k•fd
,

247 
İ_İ
, 
İ_fd
, 
•Şl_ev’t
 *
İ_ev’t
)

249 
tı_h–³r_»sourû_t
 *
fd_thr
;

250 
fe
 *file;

251 
rc
;

252 
ci_ušt32
 
fd_sock_id
;

253 
c™p_wa™abË
 *
fd_w
;

256 ifĞ
İ_İ
 !ğ
EPOLL_CTL_ADD
 )

257  
	`eçb_lšux_sys_•Şl_ùl
(
İ_k•fd
, 
İ_İ
, 
İ_fd
, 
İ_ev’t
);

261 
fe
 = 
	`fg‘
(
İ_fd
);

262 if(
	`uÆik–y
Ğ
fe
 =ğ
NULL
 ))

263  -
EBADF
;

268 
oo_•Şl_fe_´iv©e
 *
p
 = 
fe
->
´iv©e_d©a
;

269 if(
	`uÆik–y
Ğ&
p
->p.
p2
 =ğ
´iv
 )) {

270 
	`åut
(
fe
);

271  -
EINVAL
;

277 ifĞ
fe
->
f_İ
 !ğ&
lšux_tı_h–³r_fİs_udp
 &&

278 
fe
->
f_İ
 !ğ&
lšux_tı_h–³r_fİs_tı
 ) {

279 
rc
;

280 #ifdeà
OO_EPOLL_NEED_NEST_PROTECTION


281 
oo_•Şl_busy_sk
 
t
;

282 
t
.
sk
 = 
cu¼’t
;

283 
	`¥š_lock
(&
´iv
->
lock
);

284 
	`li¡_add
(&
t
.
lšk
, &
´iv
->
busy_sks
);

285 
	`¥š_uÆock
(&
´iv
->
lock
);

288 #ià
CI_CFG_USERSPACE_PIPE


289 ifĞĞ
fe
->
f_İ
 =ğ&
lšux_tı_h–³r_fİs_pe_»ad”
 ||

290 
fe
->
f_İ
 =ğ&
lšux_tı_h–³r_fİs_pe_wr™”
 ) )

291 
´iv
->
do_¥š
 = 1;

293 
	`åut
(
fe
);

294 
rc
 = 
	`eçb_lšux_sys_•Şl_ùl
(
İ_k•fd
, 
İ_İ
, 
İ_fd
, 
İ_ev’t
);

295 #ifdeà
OO_EPOLL_NEED_NEST_PROTECTION


296 
	`¥š_lock
(&
´iv
->
lock
);

297 
	`li¡_d–
(&
t
.
lšk
);

298 
	`¥š_uÆock
(&
´iv
->
lock
);

300  
rc
;

304 
fd_thr
 = ((
ci_´iv©e_t
 *)
fe
->
´iv©e_d©a
)->
thr
;

305 
fd_sock_id
 = ((
ci_´iv©e_t
 *)
fe
->
´iv©e_d©a
)->
sock_id
;

306 
´iv
->
do_¥š
 = 1;

308 if(
	`uÆik–y
Ğ! 
	`oo_•Şl2_add_¡ack
(
´iv
, 
fd_thr
) )) {

309 
´š‹d
;

310 ifĞ!
´š‹d
 )

311 
	`ci_log
("Can't‡dd stack %doƒpoll set: consider "

312 "šü—sšgƒpŞl_max_¡ack moduË o±iÚ", 
fd_thr
->
id
);

319 
fd_w
 = 
	`SP_TO_WAITABLE
(&
fd_thr
->
Ãtif
, 
fd_sock_id
);

320 
	`ci_b™_£t
(&
fd_w
->
sb_aæags
, 
CI_SB_AFLAG_AVOID_INTERRUPTS_BIT
);

321 
rc
 = 
	`eçb_lšux_sys_•Şl_ùl
(
İ_k•fd
, 
İ_İ
, 
İ_fd
, 
İ_ev’t
);

322 
	`ci_b™_ş—r
(&
fd_w
->
sb_aæags
, 
CI_SB_AFLAG_AVOID_INTERRUPTS_BIT
);

323 
	`åut
(
fe
);

325  
rc
;

326 
	}
}

330 
	$oo_•Şl2_­¶y_ùl
(
oo_•Şl2_´iv©e
 *
´iv
,

331 
oo_•Şl2_aùiÚ_¬g
 *
İ
)

333 
oo_•Şl_™em
 
po¡pÚed_k
[
CI_CFG_EPOLL_MAX_POSTPONED
];

334 
oo_•Şl_™em
 *
po¡pÚed_u
 = 
	`CI_USER_PTR_GET
(
İ
->
•Şl_ùl
);

335 
i
;

336 
rc
 = 0;

338 
rc
 = 
	`oo_•Şl_ùl_cİy_to_k”Ãl
(
po¡pÚed_u
, 
İ
->
•Şl_ùl_n
, 
po¡pÚed_k
);

339 ifĞ
rc
 != 0 )

340  
rc
;

342  
i
 = 0; i < 
İ
->
•Şl_ùl_n
; i++ ) {

343 ifĞ
po¡pÚed_k
[
i
].
fd
 != -1 ) {

344 
rc
 = 
	`oo_•Şl2_ùl
(
´iv
, 
İ
->
k•fd
, 
po¡pÚed_k
[
i
].op,

345 
po¡pÚed_k
[
i
].
fd
, &
po¡pÚed_u
[i].
ev’t
);

346 
	`oo_•Şl_w¬n_po¡pÚe_”rÜ
(
İ
->
•Şl_ùl_n
, 
po¡pÚed_k
[
i
].
fd
, i, 
rc
,

347 
İ
->
maxev’ts
);

352  
rc
;

353 
	}
}

356 
	#OO_EPOLL_FOR_EACH_STACK
(
´iv
, 
i
, 
thr
, 
ni
) \

357  
i
 = 0; i < 
•Şl_max_¡acks
; ++i ) \

358 ifĞ(
thr
 = (
´iv
)->
¡acks
[
i
]è=ğ
NULL
 ) \

360 if(
	`uÆik–y
Ğ
thr
->
k_»f_couÁ
 & 
TCP_HELPER_K_RC_NO_USERLAND
 )) \

362 ifĞ(
ni
 = &
thr
->
Ãtif
è|| 1 )

	)

365 
	$oo_•Şl2_wa™
(
oo_•Şl2_´iv©e
 *
´iv
,

366 
oo_•Şl2_aùiÚ_¬g
 *
İ
)

373 
ci_ušt64
 
¡¬t_äc
 = 0, 
now_äc
 = 0;

374 
tı_h–³r_»sourû_t
* 
thr
;

375 
ci_Ãtif
* 
ni
;

376 
i
;

377 
ci_št32
 
timeout
 = 
İ
->timeout;

380 ifĞ
timeout
 > 0 || (imeouˆ< 0 && 
İ
->
¥š_cyşes
 ) )

381 
	`ci_äc64
(&
¡¬t_äc
);

384 
	`OO_EPOLL_FOR_EACH_STACK
(
´iv
, 
i
, 
thr
, 
ni
)

385 
	`ci_©omic32_šc
(&
ni
->
¡©e
->
n_¥šÃrs
);

388 
İ
->
rc
 = -
ENOEXEC
;

389 
	`OO_EPOLL_FOR_EACH_STACK
(
´iv
, 
i
, 
thr
, 
ni
) {

390 ifĞ
	`ci_Ãtif_may_pŞl
(
ni
è&& 
	`ci_Ãtif_has_ev’t
(ni) &&

391 
	`ci_Ãtif_Œylock
(
ni
) ) {

392 
did_wake
;

393 
ni
->
¡©e
->
pŞl_did_wake
 = 0;

394 
	`ci_Ãtif_pŞl
(
ni
);

395 
did_wake
 = 
ni
->
¡©e
->
pŞl_did_wake
;

396 
	`ci_Ãtif_uÆock
(
ni
);

399 ifĞ
did_wake
 ) {

400 
İ
->
rc
 = 
	`eçb_lšux_sys_•Şl_wa™
(İ->
k•fd
,

401 
	`CI_USER_PTR_GET
(
İ
->
ev’ts
),

402 
İ
->
maxev’ts
, 0);

403 ifĞ
İ
->
rc
 != 0 )

404 
do_ex™
;

410 ifĞ
İ
->
rc
 =ğ-
ENOEXEC
 ) {

413 
İ
->
rc
 = 
	`eçb_lšux_sys_•Şl_wa™
(İ->
k•fd
, 
	`CI_USER_PTR_GET
(İ->
ev’ts
),

414 
İ
->
maxev’ts
, 0);

416 ifĞ
İ
->
rc
 !ğ0 || 
timeout
 == 0 )

417 
do_ex™
;

424 ifĞ
İ
->
¥š_cyşes
 ) {

425 
ci_ušt64
 
scheduË_äc
;

426 
ci_ušt64
 
max_¥š
 = 
İ
->
¥š_cyşes
;

427 
¥š_lim™ed_by_timeout
 = 0;

428 
	`ci_as£¹
(
¡¬t_äc
);

430 ifĞ
timeout
 > 0) {

431 
ci_ušt64
 
max_timeout_¥š
 = (ci_ušt64)
timeout
 * 
oo_timesync_ıu_khz
;

432 ifĞ
max_timeout_¥š
 <ğ
max_¥š
 ) {

433 
max_¥š
 = 
max_timeout_¥š
;

434 
¥š_lim™ed_by_timeout
 = 1;

439 
now_äc
 = 
scheduË_äc
 = 
¡¬t_äc
;

441 if(
	`uÆik–y
Ğ
	`sigÇl_³ndšg
(
cu¼’t
) )) {

442 
İ
->
rc
 = -
EINTR
;

443 
do_ex™
;

446 
	`OO_EPOLL_FOR_EACH_STACK
(
´iv
, 
i
, 
thr
, 
ni
)

447 ifĞ
	`ci_Ãtif_may_pŞl
(
ni
) &&

448 
	`ci_Ãtif_Ãed_pŞl_¥šnšg
(
ni
, 
now_äc
) &&

449 
	`ci_Ãtif_Œylock
(
ni
) ) {

450 
	`ci_Ãtif_pŞl
(
ni
);

451 
	`ci_Ãtif_uÆock
(
ni
);

454 
İ
->
rc
 = 
	`eçb_lšux_sys_•Şl_wa™
(İ->
k•fd
, 
	`CI_USER_PTR_GET
(İ->
ev’ts
),

455 
İ
->
maxev’ts
, 0);

456 ifĞ
İ
->
rc
 != 0 )

457 
do_ex™
;

459 
	`ci_äc64
(&
now_äc
);

460 if(
	`uÆik–y
Ğ
now_äc
 - 
scheduË_äc
 > 
oo_timesync_ıu_khz
 )) {

461 
	`scheduË
();

462 
scheduË_äc
 = 
now_äc
;

465 
	`ci_¥šloİ_·u£
();

466 }  
now_äc
 - 
¡¬t_äc
 < 
max_¥š
 );

468 ifĞ
¥š_lim™ed_by_timeout
 )

469 
do_ex™
;

474 ifĞ
timeout
 > 0 ) {

475 
ci_ušt64
 
¥’d_ms
;

476 ifĞ! 
İ
->
¥š_cyşes
 )

477 
	`ci_äc64
(&
now_äc
);

478 
¥’d_ms
 = 
now_äc
 - 
¡¬t_äc
;

479 
	`do_div
(
¥’d_ms
, 
oo_timesync_ıu_khz
);

480 
	`ci_as£¹_ge
(()
¥’d_ms
, 0);

481 ifĞ
timeout
 > ()
¥’d_ms
 ) {

482 
timeout
 -ğ
¥’d_ms
;

485 
do_ex™
;

489 
	`OO_EPOLL_FOR_EACH_STACK
(
´iv
, 
i
, 
thr
, 
ni
) {

490 
	`ci_©omic32_dec
(&
ni
->
¡©e
->
n_¥šÃrs
);

491 
	`tı_h–³r_»que¡_wakeup
(
thr
);

496 
İ
->
rc
 = 
	`eçb_lšux_sys_•Şl_wa™
(İ->
k•fd
, 
	`CI_USER_PTR_GET
(İ->
ev’ts
),

497 
İ
->
maxev’ts
, 
timeout
);

500 
do_ex™
:

501 
	`OO_EPOLL_FOR_EACH_STACK
(
´iv
, 
i
, 
thr
, 
ni
)

502 
	`ci_©omic32_dec
(&
ni
->
¡©e
->
n_¥šÃrs
);

504 
	}
}

507 
	$oo_•Şl2_aùiÚ
(
oo_•Şl2_´iv©e
 *
´iv
,

508 
oo_•Şl2_aùiÚ_¬g
 *
İ
)

510 #ifdeà
__NR_•Şl_pwa™


511 
sig£t_t
 
ksigmask
, 
sig§ved
;

513 
»tuº_z”o
 = 
çl£
;

515 
İ
->
rc
 = 0;

518 if(
	`uÆik–y
Ğ
İ
->
k•fd
 == -1 )) {

519 
İ
->
k•fd
 = 
	`oo_š¡®l_fe_to_fd
(
´iv
->
k•o
, 
O_CLOEXEC
);

520 ifĞ
İ
->
k•fd
 < 0 )

521  
İ
->
k•fd
;

523 
»tuº_z”o
 = 
Œue
;

527 ifĞ
İ
->
•Şl_ùl_n
 )

528 
İ
->
rc
 = 
	`oo_•Şl2_­¶y_ùl
(
´iv
, op);

530 ifĞ
İ
->
maxev’ts
 ) {

531 ifĞ
	`CI_USER_PTR_GET
(
İ
->
sigmask
) ) {

532 #ifdeà
__NR_•Şl_pwa™


533 ià(
	`cİy_äom_u£r
(&
ksigmask
, 
	`CI_USER_PTR_GET
(
İ
->
sigmask
),

534 (
ksigmask
))) {

535 ifĞ
»tuº_z”o
 ) {

536 
İ
->
rc
 = -
EFAULT
;

540  -
EFAULT
;

542 
	`sigd–£tmask
(&
ksigmask
, 
	`sigmask
(
SIGKILL
è| sigmask(
SIGSTOP
));

543 
	`sig´ocmask
(
SIG_SETMASK
, &
ksigmask
, &
sig§ved
);

547 
	`ci_log
("Your kernel does‚ot supportƒpoll_pwait(), but you‡re "

552 #ifdeà
OO_EPOLL_NEED_NEST_PROTECTION


554 
oo_•Şl_busy_sk
 
t
;

555 
t
.
sk
 = 
cu¼’t
;

556 
	`¥š_lock
(&
´iv
->
lock
);

557 
	`li¡_add
(&
t
.
lšk
, &
´iv
->
busy_sks
);

558 
	`¥š_uÆock
(&
´iv
->
lock
);

560 ifĞ
´iv
->
do_¥š
 )

561 
	`oo_•Şl2_wa™
(
´iv
, 
İ
);

563 
İ
->
rc
 = 
	`eçb_lšux_sys_•Şl_wa™
(İ->
k•fd
,

564 
	`CI_USER_PTR_GET
(
İ
->
ev’ts
),

565 
İ
->
maxev’ts
, op->
timeout
);

567 #ifdeà
OO_EPOLL_NEED_NEST_PROTECTION


568 
	`¥š_lock
(&
´iv
->
lock
);

569 
	`li¡_d–
(&
t
.
lšk
);

570 
	`¥š_uÆock
(&
´iv
->
lock
);

574 ifĞ
	`CI_USER_PTR_GET
(
İ
->
sigmask
) ) {

575 #ifdeà
__NR_•Şl_pwa™


576 ià(
İ
->
rc
 =ğ-
EINTR
) {

577 
	`memıy
(&
cu¼’t
->
§ved_sigmask
, &
sig§ved
, (sigsaved));

578 #ifdeà
HAVE_SET_RESTORE_SIGMASK


579 
	`£t_»¡Üe_sigmask
();

581 
	`£t_th»ad_æag
(
TIF_RESTORE_SIGMASK
);

585 
	`sig´ocmask
(
SIG_SETMASK
, &
sig§ved
, 
NULL
);

591 ifĞ
»tuº_z”o
 || 
İ
->
rc
 >= 0 )

594  
İ
->
rc
;

595 
	}
}

597 
	$oo_•Şl2_»Ëa£
(
oo_•Şl2_´iv©e
 *
´iv
)

599 
i
;

600 
	`ci_as£¹
(
´iv
);

603 ifĞ
´iv
->
k•o
 )

604 
	`åut
(
´iv
->
k•o
);

607  
i
 = 0; i < 
•Şl_max_¡acks
; i++ ) {

608 ifĞ
´iv
->
¡acks
[
i
] =ğ
NULL
 )

610 
	`eçb_tı_h–³r_k_»f_couÁ_dec
(
´iv
->
¡acks
[
i
]);

611 
´iv
->
¡acks
[
i
] = 
NULL
;

614 #ifdeà
OO_EPOLL_NEED_NEST_PROTECTION


615 
	`ci_as£¹
(
	`li¡_em±y
(&
´iv
->
busy_sks
));

617 
	}
}

619 
	$oo_•Şl2_pŞl
(
oo_•Şl2_´iv©e
* 
´iv
,

620 
pŞl_bË
* 
wa™
)

622 #ifdeà
OO_EPOLL_NEED_NEST_PROTECTION


623 ifĞ
cu¼’t
 ) {

624 
oo_•Şl_busy_sk
 *
t
;

625 
	`¥š_lock
(&
´iv
->
lock
);

626 
	`li¡_fÜ_—ch_’Œy
(
t
, &
´iv
->
busy_sks
, 
lšk
) {

627 ifĞ
t
->
sk
 =ğ
cu¼’t
) {

628 
	`¥š_uÆock
(&
´iv
->
lock
);

629  
POLLNVAL
;

632 
	`¥š_uÆock
(&
´iv
->
lock
);

638  
´iv
->
k•o
->
f_İ
->
	`pŞl
Õriv->k•o, 
wa™
);

639 
	}
}

645 
	$oo_•Şl1_ÿÎback
(
wa™_queue_t
 *
wa™
, 
mode
, 
sync
,

646 *
key
)

648 
oo_•Şl1_´iv©e
* 
´iv
 = 
	`cÚš”_of
(
wa™
,

649 
oo_•Şl1_´iv©e
,

650 
wa™
);

651 
ci_ušt32
 
tmp
;

653 
tmp
 = 
´iv
->
sh
->
æag
;

654 }  
	`ci_ÿs32u_ç
(&
´iv
->
sh
->
æag
, 
tmp
,

655 (
tmp
 + (1 << 
OO_EPOLL1_FLAG_SEQ_SHIFT
)) |

656 
OO_EPOLL1_FLAG_EVENT
) );

658 
	}
}

659 
	$oo_•Şl1_queue_´oc
(
fe
 *file,

660 
wa™_queue_h—d_t
 *
wh—d
,

661 
pŞl_bË
 *
±
)

663 
oo_•Şl1_´iv©e
* 
´iv
 = 
	`cÚš”_of
(
±
,

664 
oo_•Şl1_´iv©e
,

665 
±
);

666 
	`š™_wa™queue_func_’Œy
(&
´iv
->
wa™
, 
oo_•Şl1_ÿÎback
);

667 
´iv
->
wh—d
 = whead;

668 
	`add_wa™_queue
(
wh—d
, &
´iv
->
wa™
);

669 
	}
}

670 
	$oo_•Şl1_mm­
(
oo_•Şl1_´iv©e
* 
´iv
,

671 
vm_¬—_¡ruù
* 
vma
)

673 
rc
;

675 ià(
vma
->
vm_’d
 - vma->
vm_¡¬t
 !ğ
PAGE_SIZE
)

676  -
EINVAL
;

677 ià(
vma
->
vm_æags
 & 
VM_WRITE
)

678  -
EPERM
;

681 #ifdeà
__GFP_ZERO


682 
´iv
->
·ge
 = 
	`®loc_·ge
(
GFP_KERNEL
|
__GFP_ZERO
);

684 
´iv
->
·ge
 = 
	`®loc_·ge
(
GFP_KERNEL
);

686 ifĞ
´iv
->
·ge
 =ğ
NULL
 )

687  -
ENOMEM
;

688 
´iv
->
sh
 = 
	`·ge_add»ss
Õriv->
·ge
);

689 #iâdeà
__GFP_ZERO


690 
	`mem£t
(
´iv
->
sh
, 0, 
PAGE_SIZE
);

695 
´iv
->
sh
->
•fd
 = 
	`eçb_lšux_sys_•Şl_ü—‹1
(
EPOLL_CLOEXEC
);

696 ifĞ()
´iv
->
sh
->
•fd
 < 0 ) {

697 
rc
 = 
´iv
->
sh
->
•fd
;

698 
ç1
;

700 
´iv
->
os_fe
 = 
	`fg‘
Õriv->
sh
->
•fd
);

701 ifĞ
´iv
->
os_fe
 =ğ
NULL
 ) {

702 
rc
 = -
EINVAL
;

703 
ç2
;

707 ifĞ
	`»m­_pâ_¿nge
(
vma
, vma->
vm_¡¬t
, 
	`·ge_to_pâ
(
´iv
->
·ge
),

708 
PAGE_SIZE
, 
vma
->
vm_·ge_´Ù
) < 0) {

709 
rc
 = -
EIO
;

710 
ç3
;

714 
	`š™_pŞl_funıŒ
(&
´iv
->
±
, 
oo_•Şl1_queue_´oc
);

715 
´iv
->
os_fe
->
f_İ
->
	`pŞl
Õriv->os_fe, &´iv->
±
);

719 
ç3
:

720 
	`åut
(
´iv
->
os_fe
);

721 
ç2
:

722 
	`eçb_lšux_sys_şo£
(
´iv
->
sh
->
•fd
);

723 
ç1
:

724 
´iv
->
sh
 = 
NULL
;

725 
	`__ä“_·ge
(
´iv
->
·ge
);

726  
rc
;

727 
	}
}

729 
	$oo_•Şl1_»Ëa£
(
oo_•Şl1_´iv©e
* 
´iv
)

731 
i
;

733 
	`ci_as£¹
(
´iv
->
wh—d
);

734 
	`»move_wa™_queue
(
´iv
->
wh—d
, &´iv->
wa™
);

736 
	`åut
(
´iv
->
os_fe
);

738 
	`__ä“_·ge
(
´iv
->
·ge
);

741  
i
 = 0; i < 
•Şl_max_¡acks
; i++ ) {

742 ifĞ
´iv
->
¡acks
[
i
] =ğ
NULL
 )

744 
	`eçb_tı_h–³r_k_»f_couÁ_dec
(
´iv
->
¡acks
[
i
]);

745 
´iv
->
¡acks
[
i
] = 
NULL
;

747 
	`kä“
(
´iv
->
¡acks
);

750 
	}
}

752 
	$oo_•Şl1_aùiÚ
(
oo_•Şl1_´iv©e
 *
´iv
,

753 
oo_•Şl1_aùiÚ_¬g
 *
İ
)

755 
oo_•Şl_™em
 
™em
[
CI_CFG_EPOLL_MAX_POSTPONED
];

756 
oo_•Şl_™em
 *
™em_u
 = 
	`CI_USER_PTR_GET
(
İ
->
•Şl_ùl
);

757 
i
;

758 
rc
 = 0;

760 ifĞ
İ
->
•Şl_ùl_n
 ) {

761 
rc
 = 
	`oo_•Şl_ùl_cİy_to_k”Ãl
(
™em_u
, 
İ
->
•Şl_ùl_n
, 
™em
);

762 ifĞ
rc
 )

763  
rc
;

765  
i
 = 0; i < 
İ
->
•Şl_ùl_n
; i++ ) {

766 
rc
 = 
	`eçb_lšux_sys_•Şl_ùl
(
İ
->
•fd
, 
™em
[
i
].op,

767 
™em
[
i
].
fd
, &
™em_u
[i].
ev’t
);

769 ifĞ
rc
 =ğ0 ||„ø=ğ-
EEXIST
 ) {

770 
rc
 = 
	`eçb_lšux_sys_•Şl_ùl
(
´iv
->
sh
->
•fd
, 
™em
[
i
].
İ
,

771 
™em
[
i
].
fd
, &
™em_u
[i].
ev’t
);

774 
	`oo_•Şl_w¬n_po¡pÚe_”rÜ
(
İ
->
•Şl_ùl_n
, 
™em
[
i
].
fd
, i, 
rc
,

775 
İ
->
maxev’ts
);

779 ifĞ
İ
->
maxev’ts
 ) {

780 
ci_ušt32
 
tmp
;

781 
İ
->
rc
 = 
	`eçb_lšux_sys_•Şl_wa™
(
´iv
->
sh
->
•fd
,

782 
	`CI_USER_PTR_GET
(
İ
->
ev’ts
),

783 
İ
->
maxev’ts
, 0 );

784 ifĞ
İ
->
rc
 < 0 )

785 
rc
 = 
İ
->rc;

787 
tmp
 = 
´iv
->
sh
->
æag
;

788 ifĞ(
tmp
 & 1) == 0 )

790 ifĞ
´iv
->
os_fe
->
f_İ
->
	`pŞl
Õriv->os_fe, 
NULL
) )

792 }  
	`ci_ÿs32u_ç
(&
´iv
->
sh
->
æag
, 
tmp
,

793 
tmp
 & ~
OO_EPOLL1_FLAG_EVENT
) );

796 
İ
->
rc
 =„c;

798  
rc
;

799 
	}
}

804 
	$oo_•Şl_fİ_uÆocked_ioùl
(
fe
* 
fp
,

805 
cmd
, 
¬g
)

807 
oo_•Şl_fe_´iv©e
 *
´iv
 = 
fp
->
´iv©e_d©a
;

808 
__u£r
* 
¬gp
 = (__u£r*è
¬g
;

809 
rc
;

811  
cmd
 ) {

812 
OO_EPOLL2_IOC_ACTION
: {

813 
oo_•Şl2_aùiÚ_¬g
 
loÿl_¬g
;

815 
	`ci_as£¹_equ®
(
	`_IOC_SIZE
(
cmd
), (
loÿl_¬g
));

816 ifĞ
´iv
->
ty³
 !ğ
OO_EPOLL_TYPE_2
 )

817  -
EINVAL
;

818 ifĞ
	`cİy_äom_u£r
(&
loÿl_¬g
, 
¬gp
, 
	`_IOC_SIZE
(
cmd
)) )

819  -
EFAULT
;

821 
rc
 = 
	`oo_•Şl2_aùiÚ
(&
´iv
->
p
.
p2
, &
loÿl_¬g
);

823 ifĞ
rc
 =ğ0 && 
	`cİy_to_u£r
(
¬gp
, &
loÿl_¬g
, 
	`_IOC_SIZE
(
cmd
)) )

824  -
EFAULT
;

828 
OO_EPOLL2_IOC_INIT
: {

829 
ci_fixed_desütÜ_t
 
loÿl_¬g
;

830 
	`ci_as£¹_equ®
(
	`_IOC_SIZE
(
cmd
), (
loÿl_¬g
));

831 ifĞ
´iv
->
ty³
 !ğ
OO_EPOLL_TYPE_UNKNOWN
 )

832  -
EINVAL
;

833 ifĞ
	`cİy_äom_u£r
(&
loÿl_¬g
, 
¬gp
, 
	`_IOC_SIZE
(
cmd
)) )

834  -
EFAULT
;

836 
rc
 = 
	`oo_•Şl2_š™
(
´iv
, 
loÿl_¬g
);

840 
OO_EPOLL1_IOC_ACTION
: {

841 
oo_•Şl1_aùiÚ_¬g
 
loÿl_¬g
;

842 
	`ci_as£¹_equ®
(
	`_IOC_SIZE
(
cmd
), (
loÿl_¬g
));

843 ifĞ
´iv
->
ty³
 !ğ
OO_EPOLL_TYPE_1
 )

844  -
EINVAL
;

845 ifĞ
	`cİy_äom_u£r
(&
loÿl_¬g
, 
¬gp
, 
	`_IOC_SIZE
(
cmd
)) )

846  -
EFAULT
;

848 
rc
 = 
	`oo_•Şl1_aùiÚ
(&
´iv
->
p
.
p1
, &
loÿl_¬g
);

850 ifĞ
rc
 =ğ0 && 
	`cİy_to_u£r
(
¬gp
, &
loÿl_¬g
, 
	`_IOC_SIZE
(
cmd
)) )

851  -
EFAULT
;

855 
OO_EPOLL1_IOC_ADD_STACK
: {

856 
ci_fixed_desütÜ_t
 
sock_fd
;

857 
fe
 *
sock_fe
;

858 
ci_´iv©e_t
 *
sock_´iv
;

859 
	`ci_as£¹_equ®
(
	`_IOC_SIZE
(
cmd
), (
sock_fd
));

860 ifĞ
´iv
->
ty³
 !ğ
OO_EPOLL_TYPE_1
 )

861  -
EINVAL
;

862 ifĞ
	`cİy_äom_u£r
(&
sock_fd
, 
¬gp
, 
	`_IOC_SIZE
(
cmd
)) )

863  -
EFAULT
;

865 
sock_fe
 = 
	`fg‘
(
sock_fd
);

866 ifĞ
sock_fe
 =ğ
NULL
 )

867  -
EINVAL
;

868 ifĞ
sock_fe
->
f_İ
 !ğ&
lšux_tı_h–³r_fİs_udp
 &&

869 
sock_fe
->
f_İ
 !ğ&
lšux_tı_h–³r_fİs_tı
 ) {

870 
	`åut
(
sock_fe
);

871  -
EINVAL
;

873 
sock_´iv
 = 
sock_fe
->
´iv©e_d©a
;

875 
rc
 = 
	`oo_•Şl1_add_¡ack
(&
´iv
->
p
.
p1
, 
sock_´iv
->
thr
);

876 ifĞ
sock_fe
 =ğ
NULL
 )

877  -
EINVAL
;

879 
	`åut
(
sock_fe
);

883 
OO_EPOLL1_IOC_PRIME
: {

884 
i
;

885 
tı_h–³r_»sourû_t
* 
thr
;

886 
ci_Ãtif
* 
ni
;

888 
	`OO_EPOLL_FOR_EACH_STACK
(&
´iv
->
p
.
p1
, 
i
, 
thr
, 
ni
) {

890 
	`ci_log
("%s: PRIME [%d]:‡Ì—dy=%d", 
__func__
,

891 
thr
->
id
, 
	`ci_Ãtif_is_´imed
(
ni
));

893 
	`tı_h–³r_»que¡_wakeup
(
thr
);

895 
rc
 = 0;

900 
	`ci_log
("unknowÀ•ŞÈdeviû ioùl: 0x%x", 
cmd
);

901 
rc
 = -
EINVAL
;

903  
rc
;

904 
	}
}

906 #ià!
HAVE_UNLOCKED_IOCTL


907 
	$oo_•Şl_fİ_ioùl
(
šode
* inode, 
fe
 *
fp
,

908 
cmd
, 
¬g
)

910  
	`oo_•Şl_fİ_uÆocked_ioùl
(
fp
, 
cmd
, 
¬g
);

911 
	}
}

914 
	$oo_•Şl_fİ_İ’
(
šode
* inode, 
fe
* 
fp
)

916 
oo_•Şl_fe_´iv©e
 *
´iv
 = 
	`km®loc
((*´iv), 
GFP_KERNEL
);

921 
	`oo_timesync_wa™_fÜ_ıu_khz_to_¡abize
();

923 if(
	`uÆik–y
Ğ
´iv
 =ğ
NULL
 ))

924  -
ENOMEM
;

925 
	`mem£t
(
´iv
, 0, (*priv));

927 
fp
->
´iv©e_d©a
 = (*è
´iv
;

928 
fp
->
f_İ
 = &
oo_•Şl_fİs
;

931 
	}
}

933 
	$oo_•Şl_fİ_»Ëa£
(
šode
* inode, 
fe
* 
fp
)

935 
oo_•Şl_fe_´iv©e
 *
´iv
 = 
fp
->
´iv©e_d©a
;

937 
	`ci_as£¹
(
´iv
);

940  
´iv
->
ty³
 ) {

941 
OO_EPOLL_TYPE_1
: 
	`oo_•Şl1_»Ëa£
(&
´iv
->
p
.
p1
); ;

942 
OO_EPOLL_TYPE_2
: 
	`oo_•Şl2_»Ëa£
(&
´iv
->
p
.
p2
); ;

943 : 
	`ci_as£¹_equ®
(
´iv
->
ty³
, 
OO_EPOLL_TYPE_UNKNOWN
);

947 
	`kä“
(
´iv
);

950 
	}
}

952 
	$oo_•Şl_fİ_pŞl
(
fe
* 
fp
, 
pŞl_bË
* 
wa™
)

954 
oo_•Şl_fe_´iv©e
 *
´iv
 = 
fp
->
´iv©e_d©a
;

956 
	`ci_as£¹
(
´iv
);

957 ifĞ
´iv
->
ty³
 !ğ
OO_EPOLL_TYPE_2
 )

958  
POLLNVAL
;

959  
	`oo_•Şl2_pŞl
(&
´iv
->
p
.
p2
, 
wa™
);

960 
	}
}

962 
	$oo_•Şl_fİ_mm­
(
fe
* 
fp
, 
vm_¬—_¡ruù
* 
vma
)

964 
oo_•Şl_fe_´iv©e
 *
´iv
 = 
fp
->
´iv©e_d©a
;

965 
size
 = (
´iv
->
p
.
p1
.
¡acks
[0]è* 
•Şl_max_¡acks
;

966 
rc
;

968 
	`ci_as£¹
(
´iv
);

969 ifĞ
´iv
->
ty³
 !ğ
OO_EPOLL_TYPE_UNKNOWN
)

970  -
EINVAL
;

972 
´iv
->
p
.
p1
.
¡acks
 = 
	`km®loc
(
size
, 
GFP_KERNEL
);

973 ifĞ
´iv
->
p
.
p1
.
¡acks
 =ğ
NULL
 )

974  -
ENOMEM
;

975 
	`mem£t
(
´iv
->
p
.
p1
.
¡acks
, 0, 
size
);

976 
	`¥š_lock_š™
(&
´iv
->
p
.
p1
.
lock
);

978 
rc
 = 
	`oo_•Şl1_mm­
(&
´iv
->
p
.
p1
, 
vma
);

979 ifĞ
rc
 != 0 ) {

980 
	`kä“
(
´iv
->
p
.
p1
.
¡acks
);

981  
rc
;

984 
´iv
->
ty³
 = 
OO_EPOLL_TYPE_1
;

985  
rc
;

986 
	}
}

988 
fe_İ”©iÚs
 
	goo_•Şl_fİs
 =

990 
CI_STRUCT_MBR
(
owÃr
, 
THIS_MODULE
),

991 
CI_STRUCT_MBR
(
pŞl
, 
oo_•Şl_fİ_pŞl
),

992 #ià
HAVE_UNLOCKED_IOCTL


993 
CI_STRUCT_MBR
(
uÆocked_ioùl
, 
oo_•Şl_fİ_uÆocked_ioùl
),

995 
CI_STRUCT_MBR
(
ioùl
, 
oo_•Şl_fİ_ioùl
),

997 #ià
HAVE_COMPAT_IOCTL


998 
CI_STRUCT_MBR
(
com·t_ioùl
, 
oo_•Şl_fİ_uÆocked_ioùl
),

1000 
CI_STRUCT_MBR
(
İ’
, 
oo_•Şl_fİ_İ’
),

1001 
CI_STRUCT_MBR
(
»Ëa£
, 
oo_•Şl_fİ_»Ëa£
),

1002 
CI_STRUCT_MBR
(
mm­
, 
oo_•Şl_fİ_mm­
),

1005 
	goo_•Şl_majÜ
;

1008 
__š™
 
	$oo_•Şl_chrdev_ùÜ
()

1010 
rc
, 
majÜ
 = 0;

1012 
rc
 = 
	`»gi¡”_chrdev
(
majÜ
, 
OO_EPOLL_DEV_NAME
, &
oo_•Şl_fİs
);

1013 ifĞ
rc
 < 0 ) {

1014 
	`ci_log
("%s: cª'ˆ»gi¡” ch¬ deviû %d", 
OO_EPOLL_DEV_NAME
, 
rc
);

1015  
rc
;

1017 ifĞ
majÜ
 == 0 )

1018 
majÜ
 = 
rc
;

1019 
oo_•Şl_majÜ
 = 
majÜ
;

1021 #ifdeà
NEED_IOCTL32


1026 
ioc
;

1027  
ioc
 = 0; ioø< 
OO_OP_END
; ++ioc )

1028 
	`»gi¡”_ioùl32_cÚv”siÚ
(
oo_•Şl_İ”©iÚs
[
ioc
].
ioc_cmd
, 
NULL
);

1033 
	}
}

1035 
	$oo_•Şl_chrdev_dtÜ
()

1037 ifĞ
oo_•Şl_majÜ
 )

1038 
	`uÄegi¡”_chrdev
(
oo_•Şl_majÜ
, 
OO_EPOLL_DEV_NAME
);

1040 #ifdeà
NEED_IOCTL32


1043 
ioc
;

1044  
ioc
 = 0; ioø< 
OO_OP_END
; ++ioc )

1045 
	`uÄegi¡”_ioùl32_cÚv”siÚ
(
oo_•Şl_İ”©iÚs
[
ioc
].
ioc_cmd
);

1048 
	}
}

	@iscsi_support.c

21 
	~<ci/driv”/š‹º®.h
>

22 
	~<ci/driv”/eçb/lšux_iscsi.h
>

23 
	~<Úlßd/fd_´iv©e.h
>

26 
	gok_fÜ_iscsi
;

27 
moduË
 *
	gci_iscsi_moduË
;

28 
£m­hÜe
 
	gci_iscsi_ioùl_mu‹x
;

29 (*
ci_iscsi_ùÜ_â
)();

30 (*
ci_iscsi_hªdË_ioùl_â
)(
fe
 *, 
ci_iscsi_cÚŒŞ_·¿ms
 *);

31 (*
ci_iscsi_cÚŒŞ_ùÜ_â
)() = 0;

32 (*
ci_iscsi_cÚŒŞ_dtÜ_â
)() = 0;

33 (*
ci_iscsi_dtÜ_â
)() = 0;

37 
	$eçb_´•¬e_fÜ_iscsi
()

40 
	`£ma_š™
(&
ci_iscsi_ioùl_mu‹x
, 1);

44 
	`ci_as£¹_equ®
(
ci_iscsi_ùÜ_â
, 
NULL
);

45 
ok_fÜ_iscsi
 = 1;

46 
	}
}

49 
	$eçb_ş—nup_š_iscsi
()

51 
	`ci_as£¹_equ®
(
ci_iscsi_ùÜ_â
, 
NULL
);

52 
	}
}

56 
	$ci_´Ùeù_moduË
(
moduË
 *
m
)

58  
	`Œy_moduË_g‘
(
m
);

59 
	}
}

60 
	$ci_uÅrÙeù_moduË
(
moduË
 *
m
)

63 
	`moduË_put
(
m
);

64 
	}
}

67 
	$ioùl_iscsi_cÚŒŞ_İ
 (
ci_´iv©e_t
 *
´iv
, *
¬g
)

69 
ci_iscsi_cÚŒŞ_·¿ms
 *
·¿ms
 = 
¬g
;

70 
rc
;

71 
moduË
 *
iscsi_moduË
;

73 ifĞ!
	`ci_is_sy§dmš
(èè -
EPERM
;

75 
iscsi_moduË
 = 
ci_iscsi_moduË
;

76 if(
iscsi_moduË
 !ğ
NULL
 && 
	`ci_´Ùeù_moduË
(iscsi_module))

78 ià(
	`down_š‹¼u±ibË
(&
ci_iscsi_ioùl_mu‹x
è!ğ0è -
EINTR
;

80 
rc
 = 
	`ci_iscsi_hªdË_ioùl_â
(
´iv
->
_fp
, 
·¿ms
);

82 
	`ci_as£¹
(
	`down_Œylock
(&
ci_iscsi_ioùl_mu‹x
));

83 
	`up
(&
ci_iscsi_ioùl_mu‹x
);

85 
	`ci_uÅrÙeù_moduË
(
iscsi_moduË
);

89  -
EUNATCH
;

92  
rc
;

93 
	}
}

96 
	$eçb_»gi¡”_iscsi_driv”
(
eçb_iscsi_driv”_t
 *
iscsi
)

98 
ùÜ_h”e
;

99 
rc
 = 0;

100 
	`ci_as£¹
(
iscsi
);

101 
	`ci_as£¹
(
iscsi
->
iscsi_ùÜ
);

102 
	`ci_as£¹
(
iscsi
->
iscsi_ù¾_ùÜ
);

103 
	`ci_as£¹
(
iscsi
->
iscsi_dtÜ
);

104 
	`ci_as£¹
(
iscsi
->
iscsi_ù¾_dtÜ
);

105 
	`ci_as£¹
(
iscsi
->
iscsi_ioùl
);

106 
	`ci_as£¹_equ®
(
ci_iscsi_moduË
, 
NULL
);

107 
ùÜ_h”e
 = 
ok_fÜ_iscsi
;

109 
ci_iscsi_cÚŒŞ_ùÜ_â
 = 
iscsi
->
iscsi_ù¾_ùÜ
;

110 
ci_iscsi_ùÜ_â
 = 
iscsi
->
iscsi_ùÜ
;

112 
ci_iscsi_cÚŒŞ_dtÜ_â
 = 
iscsi
->
iscsi_ù¾_dtÜ
;

113 
ci_iscsi_dtÜ_â
 = 
iscsi
->
iscsi_dtÜ
;

115 
ci_iscsi_hªdË_ioùl_â
 = 
iscsi
->
iscsi_ioùl
;

116 
ci_iscsi_moduË
 = 
iscsi
->
iscsi_moduË
;

118 iàĞ
ùÜ_h”e
 ) {

119 
rc
 = 
	`ci_iscsi_ùÜ_â
();

120 ià(
rc
 == 0)

121 
rc
 = 
	`ci_iscsi_cÚŒŞ_ùÜ_â
();

123  
rc
;

124 
	}
}

126 
	$eçb_uÄegi¡”_iscsi_driv”
(
eçb_iscsi_driv”_t
 *
iscsi
)

128 ()
iscsi
;

129 
	`ci_as£¹_equ®
(
ci_iscsi_moduË
, 
iscsi
->
iscsi_moduË
);

130 
ci_iscsi_moduË
 = 
NULL
;

131 
ci_iscsi_hªdË_ioùl_â
 = 
NULL
;

132 
	`ci_iscsi_cÚŒŞ_dtÜ_â
();

133 
	`ci_iscsi_dtÜ_â
();

134 
ci_iscsi_ùÜ_â
 = 0;

135 
	}
}

136 
EXPORT_SYMBOL
(
eçb_»gi¡”_iscsi_driv”
);

137 
EXPORT_SYMBOL
(
eçb_uÄegi¡”_iscsi_driv”
);

	@linux_cplane.c

57 
	~"Úlßd_š‹º®.h
"

58 
	~<Úlßd/ıÏÃ.h
>

59 
	~<Úlßd/debug.h
>

60 
	~<ci/š‹º®/ıÏÃ_hªdË.h
>

61 
	~<Ãt/¬p.h
>

62 
	~<lšux/š‘deviû.h
>

64 
	~<lšux/times.h
>

65 
	~"../lšux_»sourû/k”Ãl_com·t.h
"

69 #iâdeà
TRUE


70 
	#TRUE
 1

	)

71 
	#FALSE
 0

	)

76 
	#NL_BUFSIZE
 16384

	)

90 
	#CICPOS_USE_NETLINK
 1

	)

96 
	#CICPOS_PROCFS
 1

	)

98 
	#CICPOS_PROCFS_FILE_HWPORT
 "mib-hwpÜt"

	)

99 
	#CICPOS_PROCFS_FILE_LLAP
 "mib-Î­"

	)

100 
	#CICPOS_PROCFS_FILE_MAC
 "mib-mac"

	)

101 
	#CICPOS_PROCFS_FILE_IPIF
 "mib-if"

	)

102 
	#CICPOS_PROCFS_FILE_FWDINFO
 "mib-fwd"

	)

103 
	#CICPOS_PROCFS_FILE_BONDINFO
 "mib-bÚd"

	)

104 
	#CICPOS_PROCFS_FILE_PMTU
 "mib-pmtu"

	)

118 
	#CICPOS_SCAN_INTERVAL
 (
HZ
/2)

	)

130 #ifdeà
IGNORE


131 #undeà
IGNORE


134 #ifdeà
DO


135 #undeà
DO


138 
	#DO
(
_x
è
	)
_x

139 
	#IGNORE
(
_x
)

	)

145 #ifdeà
NDEBUG


146 #undeà
DEBUGNETLINK


147 #undeà
DEBUGINJECT


151 #iâdeà
DEBUGNETLINK


152 
	#DEBUGNETLINK
 
IGNORE


	)

154 #iâdeà
DEBUGINJECT


155 
	#DEBUGINJECT
 
IGNORE


	)

158 
	#DPRINTF
 
ci_log


	)

159 
	#CICP_LOG
 
LOG_ARP


	)

161 
	#CODEID
 "ıÏÃ sync"

	)

172 #iâdeà
NDA_RTA


173 
	#NDA_RTA
(
r
) \

174 ((
¹©Œ
*)(((*)(
r
)è+ 
	`NLMSG_ALIGN
((
ndmsg
))))

	)

177 #iâdeà
IFLA_RTA


178 
	#IFLA_RTA
(
r
) \

179 ((
¹©Œ
*)(((*)(
r
)è+ 
	`NLMSG_ALIGN
((
ifšfomsg
))))

	)

182 #iâdeà
IFA_RTA


183 
	#IFA_RTA
(
r
) \

184 ((
¹©Œ
*)(((*)(
r
)è+ 
	`NLMSG_ALIGN
((
içddrmsg
))))

	)

207 
sock‘
 *
	gciı_¿w_sock
;

208 
sock‘
 *
	gciı_bšdtodev_¿w_sock
;

215 
	$ciı_¿w_sock_ùÜ
(
sock‘
 **
¿w_sock
)

217 
rc
 = 
	`sock_ü—‹
(
PF_INET
, 
SOCK_RAW
, 
IPPROTO_RAW
, 
¿w_sock
);

218 ià(
	`CI_UNLIKELY
(
rc
 < 0)) {

219 
	`ci_log
("%s: faedØü—‹h¿w sock‘,„c=%d", 
__FUNCTION__
, 
rc
);

220  
rc
;

223 ià(
	`CI_UNLIKELY
((*
¿w_sock
)->
sk
 == 0)) {

224 
	`ci_log
("ERROR:%s: ciı_¿w_sock->sk i z”o!", 
__FUNCTION__
);

225 
	`sock_»Ëa£
(*
¿w_sock
);

226  -
EINVAL
;

229 (*
¿w_sock
)->
sk
->
sk_®loÿtiÚ
 = 
GFP_ATOMIC
;

231 
	}
}

238 
	$ciı_¿w_sock_dtÜ
(
sock‘
 *
¿w_sock
)

240 
	`sock_»Ëa£
(
¿w_sock
);

241 
	}
}

247 
	$ciı_¿w_sock_£nd
(
sock‘
 *
¿w_sock
, 
ci__addr_t
 
_be32
,

248 cÚ¡ * 
buf
, 
size
)

250 
msghdr
 
msg
;

251 
iovec
 
iov
;

252 
mm_£gm’t_t
 
Şdfs
;

253 
sockaddr_š
 
addr
;

254 
rc
;

256 
	`mem£t
(&
addr
, 0, (addr));

257 
addr
.
sš_çmy
 = 
AF_INET
;

258 
addr
.
sš_pÜt
 = 0;

259 
addr
.
sš_addr
.
s_addr
 = 
_be32
;

261 
msg
.
msg_Çme
 = &
addr
;

262 
msg
.
msg_Çm–’
 = (
addr
);

263 
msg
.
msg_iov
 = &
iov
;

264 
msg
.
msg_iovËn
 = 1;

265 
msg
.
msg_cÚŒŞ
 = 
NULL
;

266 
msg
.
msg_cÚŒŞËn
 = 0;

267 
msg
.
msg_æags
 = 
MSG_DONTWAIT
;

269 
iov
.
iov_ba£
 = (*è
buf
;

270 
iov
.
iov_Ën
=
size
;

272 
Şdfs
 = 
	`g‘_fs
();

273 
	`£t_fs
(
KERNEL_DS
);

274 
rc
 = 
	`sock_£ndmsg
(
¿w_sock
, &
msg
, 
size
);

275 
	`£t_fs
(
Şdfs
);

277  
rc
;

278 
	}
}

282 
	$ciı_¿w_sock_£nd_bšdtodev
(
ifšdex
, *
iâame
,

283 
ci__addr_t
 
_be32
,

284 cÚ¡ * 
buf
, 
size
)

286 
Ï¡_ifšdex
 = -1;

287 
Ãt_deviû
 *
dev
 = 
NULL
;

288 
mm_£gm’t_t
 
Şdfs
;

289 
rc
;

291 ifĞ
ifšdex
 !ğ
Ï¡_ifšdex
 ) {

292 ifĞ
iâame
 =ğ
NULL
 ) {

293 
dev
 = 
	`dev_g‘_by_šdex
(&
š™_Ãt
, 
ifšdex
);

294 ifĞ
dev
 !ğ
NULL
 )

295 
iâame
 = 
dev
->
Çme
;

297 
	`OO_DEBUG_ARP
(
	`ci_log
("%s: bad‚‘ deviû index %d", 
__FUNCTION__
,

298 
ifšdex
));

299  -
EINVAL
;

303 
Şdfs
 = 
	`g‘_fs
();

304 
	`£t_fs
(
KERNEL_DS
);

305 
rc
 = 
	`sock_£tsockİt
(
ciı_bšdtodev_¿w_sock
, 
SOL_SOCKET
, 
SO_BINDTODEVICE
,

306 
iâame
, 
	`¡¾’
(ifname));

307 
	`£t_fs
(
Şdfs
);

309 ifĞ
dev
 !ğ
NULL
 )

310 
	`dev_put
(
dev
);

312 ifĞ
rc
 != 0 ) {

313 
	`OO_DEBUG_ARP
(
	`ci_log
("%s: faedØBINDTODEVICE %d", 
__FUNCTION__
, 
rc
));

314  
rc
;

317 
Ï¡_ifšdex
 = 
ifšdex
;

320  
	`ciı_¿w_sock_£nd
(
ciı_bšdtodev_¿w_sock
, 
_be32
, 
buf
, 
size
);

321 
	}
}

336 
ciı_buåoŞ_t
 *
	gciı¶_pkoŞ
 = 
NULL
;

351 
	$ciı¶__pkt_hªdov”
(
ci_Ãtif
 *
Ãtif
, 
oo_pkt_p
 
¤c_pktid
)

353 
ciı_buåoŞ_pkt
* 
d¡_pkt
;

354 
d¡_pktid
;

355 
rc
;

357 
	`ci_as£¹
(
Ãtif
);

358 
	`ASSERT_VALID_PKT
(
Ãtif
, 
	`PKT_CHK
Ò‘if, 
¤c_pktid
));

361 
	`CICP_BUFPOOL_LOCK
(
ciı¶_pkoŞ
,

362 
d¡_pktid
 = 
	`ciı¶_pktbuf_®loc
(
ciı¶_pkoŞ
));

363 if(
d¡_pktid
 < 0) {

364  -
ENOBUFS
;

366 
	`ci_as£¹
(
	`ciı¶_pktbuf_is_v®id_id
(
ciı¶_pkoŞ
, 
d¡_pktid
));

369 
d¡_pkt
 = 
	`ciı¶_pktbuf_pkt
(
ciı¶_pkoŞ
, 
d¡_pktid
);

370 
rc
 = 
	`ciı¶__pkt_æ©‹n_cİy
(
Ãtif
, 
¤c_pktid
, 
d¡_pkt
);

371 ià(
rc
 < 0) {

372 
	`CICP_BUFPOOL_LOCK
(
ciı¶_pkoŞ
,

373 
	`ciı¶_pktbuf_ä“
(
ciı¶_pkoŞ
, 
d¡_pktid
));

374  
rc
;

377  
d¡_pktid
;

378 
	}
}

381 
	$ciı_¿w__£nd
(cÚ¡ 
ci_4_hdr
* 

, 
Ën
, 
ci_ifid_t
 
ifšdex
)

383 * 
_d©a
 = (*è

 + 
	`CI_IP4_IHL
(ip);

384 
ci_tı_hdr
* 
tı
;

385 
ci_udp_hdr
* 
udp
;

387  

->
_´ÙocŞ
 ) {

388 
IPPROTO_TCP
:

389 
	`ci_as£¹_equ®
(

->
_äag_off_be16
, 
CI_IP4_FRAG_DONT
);

390 
tı
 = 
_d©a
;

391 
tı
->
tı_check_be16
 = 
	`ci_tı_checksum
(

,ı, 
	`CI_TCP_PAYLOAD
(tcp));

393 
IPPROTO_UDP
:

395 
ci_iovec
 
iov
;

397 ifĞ

->
_äag_off_be16
 & ~
CI_IP4_FRAG_DONT
 )

399 
udp
 = 
_d©a
;

400 
iov
.
iov_ba£
 = 
	`CI_UDP_PAYLOAD
(
udp
);

401 
iov
.
iov_Ën
 = 
	`CI_BSWAP_BE16
(

->
_tÙ_Ën_be16
è- 
	`CI_IP4_IHL
(ip) -

402 (
ci_udp_hdr
);

403 
udp
->
udp_check_be16
 = 
	`ci_udp_checksum
(

, udp, &
iov
, 1);

408 ifĞ
ifšdex
 !ğ
CI_IFID_BAD
 )

409  
	`ciı_¿w_sock_£nd_bšdtodev
(
ifšdex
, 
NULL
, 

->
_daddr_be32
,

410 

, 
Ën
);

412  
	`ciı_¿w_sock_£nd
(
ciı_¿w_sock
, 

->
_daddr_be32
, ip, 
Ën
);

413 
	}
}

416 
	sciı_¿w_sock_wÜk_·rûl
 {

417 
ci_wÜk™em_t
 
	mwqi
;

418 
	mpktid
;

419 cÚ¡ 
ciı_hªdË_t
 *
	mcÚŒŞ_¶ªe
;

420 
ci_ifid_t
 
	mifšdex
;

425 
	$ciı¶_¬p_pkt_tx_queue
(*
cÚ‹xt
)

427 
ciı_¿w_sock_wÜk_·rûl
 *
wp
 = 
cÚ‹xt
;

428 
ciı_buåoŞ_pkt
* 
pkt
;

429 
ci_4_hdr
* 

;

430 
rc
;

434 ià(
wp
->
pktid
 < 0è
out
;

436 
	`ci_as£¹
(
	`ciı¶_pktbuf_is_v®id_id
(
ciı¶_pkoŞ
, 
wp
->
pktid
));

438 
pkt
 = 
	`ciı¶_pktbuf_pkt
(
ciı¶_pkoŞ
, 
wp
->
pktid
);

439 ià(
	`CI_UNLIKELY
(
pkt
 == 0)) {

440 
	`ci_log
("%s: BAD…ack‘ %d", 
__FUNCTION__
, 
wp
->
pktid
);

441 
out
;

443 

 = (*è(
pkt
 + 1);

445 
rc
 = 
	`ciı_¿w__£nd
(

, 
pkt
->
Ën
, 
wp
->
ifšdex
);

446 
	`OO_DEBUG_ARP
(
	`ci_log
("%s: s’d…ack‘Ø"
CI_IP_PRINTF_FORMAT
" via„aw "

447 "sock‘,„c=%d", 
__FUNCTION__
,

448 
	`CI_IP_PRINTF_ARGS
(&

->
_daddr_be32
), 
rc
));

449 ià(
	`CI_UNLIKELY
(
rc
 < 0)) {

454 
	`CICP_STAT_INC_DROPPED_IP
((
ciı_hªdË_t
 *)
wp
->
cÚŒŞ_¶ªe
);

455 
	`OO_DEBUG_ARP
(
	`ci_log
("%s: faedØqueu·ck‘,„c=%d", 
__FUNCTION__
, 
rc
));

459 
	`CICP_BUFPOOL_LOCK
(
ciı¶_pkoŞ
,

460 
	`ciı¶_pktbuf_ä“
(
ciı¶_pkoŞ
, 
wp
->
pktid
));

461 
out
:

463 
	`ci_ä“
(
wp
);

464 
	}
}

475 
	$ciı¶os_pktbuf_deãr_£nd
(cÚ¡ 
ciı_hªdË_t
 *
cÚŒŞ_¶ªe
,

476 
ci__addr_t
 

, 
³ndabË_pktid
,

477 
ci_ifid_t
 
ifšdex
)

480 
ciı_¿w_sock_wÜk_·rûl
 *
wp
 = 
	`ci_©omic_®loc
((*wp));

482 ià(
	`CI_LIKELY
(
wp
 !ğ
NULL
)) {

483 
wp
->
pktid
 = 
³ndabË_pktid
;

484 
wp
->
cÚŒŞ_¶ªe
 = control_plane;

485 
wp
->
ifšdex
 = ifindex;

486 
	`ci_wÜk™em_š™
(&
wp
->
wqi
, 
ciı¶_¬p_pkt_tx_queue
, wp);

487 
	`ci_v”ify
(
	`ci_wÜkqueue_add
(&
CI_GLOBAL_WORKQUEUE
, &
wp
->
wqi
) == 0);

490  -
ENOMEM
;

492 
	}
}

502 
	$ciı¶_mac_deãr_£nd
(
ci_Ãtif
 *
Ãtif
, *
»f_os_rc
,

503 
ci__addr_t
 

, 
oo_pkt_p
 
_pktid
, 
ci_ifid_t
 
ifšdex
)

504 { 
³ndabË_pktid
;

506 
	`OO_DEBUG_ARP
(
	`ci_log
(
CODEID
":‚˜%°(ID:%dè "
CI_IP_PRINTF_FORMAT
"…kt ID %d",

507 
Ãtif
, 
	`NI_ID
Ò‘if), 
	`CI_IP_PRINTF_ARGS
(&

),

508 
	`OO_PP_FMT
(
_pktid
)));

510 
	`ci_as£¹
(
	`ci_Ãtif_is_locked
(
Ãtif
));

511 
	`ASSERT_VALID_PKT
(
Ãtif
, 
	`PKT_CHK
Ò‘if, 
_pktid
));

514 ià(
	`OO_PP_IS_NULL
(
_pktid
))

515 { *
»f_os_rc
 = -
EINVAL
;

516  
FALSE
;

520 
³ndabË_pktid
 = 
	`ciı¶__pkt_hªdov”
(
Ãtif
, 
_pktid
);

521 ià(
³ndabË_pktid
 < 0) {

522 
	`LOG_U
(

523 
ci_4_hdr
 *
h
 = 
	`oo_tx__hdr
(
	`PKT
(
Ãtif
, 
_pktid
));

524 
	`ci_log
(
CODEID
": IP "
CI_IP_PRINTF_FORMAT
"->"CI_IP_PRINTF_FORMAT

526 
	`CI_IP_PRINTF_ARGS
(&
h
->
_§ddr_be32
),

527 
	`CI_IP_PRINTF_ARGS
(&

),

528 
h
->
_´ÙocŞ
 =ğ
IPPROTO_TCP
 ? "TCP" : "UDP",

529 
³ndabË_pktid
);

531 *
»f_os_rc
 = 
³ndabË_pktid
;

532  
FALSE
;

535 
ciı_hªdË_t
 *
cÚŒŞ_¶ªe
 = 
	`CICP_HANDLE
(
Ãtif
);

538 
	`ci_as£¹
(
	`ciı¶_pktbuf_is_v®id_id
(
ciı¶_pkoŞ
, 
³ndabË_pktid
));

541 *
»f_os_rc
 = 
	`ciı¶os_pktbuf_deãr_£nd
(
cÚŒŞ_¶ªe
, 

,

542 
³ndabË_pktid
, 
ifšdex
);

544  (*
»f_os_rc
 == 0);

547 
	}
}

569 
	$ciı¶os_ùÜ
(
ciı_mibs_k”n_t
 *
cÚŒŞ_¶ªe
)

571 
rc
;

574 
rc
 = 
	`ciı¶_pktbuf_ùÜ
(&
ciı¶_pkoŞ
);

575 ià(
	`CI_UNLIKELY
(
rc
 < 0)) {

576 
	`ci_log
(
CODEID
": ERROR - couldn't construct ARPable buffers,„c=%d",

577 -
rc
);

578  
rc
;

582 ià(
	`CI_UNLIKELY
((
rc
 = 
	`ciı_¿w_sock_ùÜ
(&
ciı_¿w_sock
)) < 0)) {

583 
	`ci_log
(
CODEID
": ERROR - couldn't construct„aw socket module,„c=%d",

584 -
rc
);

585 
	`ciı¶_pktbuf_dtÜ
(&
ciı¶_pkoŞ
);

586  
rc
;

590 ià(
	`CI_UNLIKELY
((
rc
 = 
	`ciı_¿w_sock_ùÜ
(&
ciı_bšdtodev_¿w_sock
)) < 0)) {

591 
	`ci_log
(
CODEID
": ERROR - couldn't construct„aw socket module,„c=%d",

592 -
rc
);

593 
	`ciı_¿w_sock_dtÜ
(
ciı_¿w_sock
);

594 
	`ciı¶_pktbuf_dtÜ
(&
ciı¶_pkoŞ
);

595  
rc
;

599 
	}
}

602 #ià
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(3,6,0)

605 
	#Ãigh_cÚfœm
(
Ãigh
) \

607 (
Ãigh
)->
cÚfœmed
 = 
jiff›s
; \

608 } 0)

	)

611 
	$ciıos_¬p_¡®e_upd©e
(
ci__addr_t
 
d¡
, 
ci_ifid_t
 
ifšdex
, 
cÚfœm
)

613 
Ãt_deviû
 *
dev
;

614 
Ãighbour
 *
Ãigh
;

616 
dev
 = 
	`dev_g‘_by_šdex
(&
š™_Ãt
, 
ifšdex
);

618 ifĞ
dev
 =ğ
NULL
 )

620 
Ãigh
 = 
	`Ãigh_lookup
(&
¬p_tbl
, &
d¡
, 
dev
);

621 ifĞ
Ãigh
 =ğ
NULL
 ) {

622 
	`dev_put
(
dev
);

632 ifĞ
cÚfœm
) {

633 ifĞ
Ãigh
->
nud_¡©e
 =ğ
NUD_STALE
)

634 
	`Ãigh_upd©e
(
Ãigh
, 
NULL
, 
NUD_REACHABLE
, 
NEIGH_UPDATE_F_ADMIN
);

636 
	`Ãigh_cÚfœm
(
Ãigh
);

638 ià(!
cÚfœm
 && 
Ãigh
->
nud_¡©e
 =ğ
NUD_STALE
 ) {

639 
	`¬p_£nd
(
ARPOP_REQUEST
, 
ETH_P_ARP
, 
d¡
, 
dev
,

640 
	`š‘_£Ëù_addr
(
dev
, 
d¡
, 
RT_SCOPE_LINK
),

641 
Ãigh
->
ha
, 
dev
->
dev_addr
, 
NULL
);

642 
	`Ãigh_upd©e
(
Ãigh
, 
NULL
, 
NUD_DELAY
, 
NEIGH_UPDATE_F_ADMIN
);

644 
	`Ãigh_»Ëa£
(
Ãigh
);

645 
	`dev_put
(
dev
);

646 
	}
}

652 
	$ciı¶os_dtÜ
(
ciı_mibs_k”n_t
 *
cÚŒŞ_¶ªe
)

654 
	`ciı_¿w_sock_dtÜ
(
ciı_bšdtodev_¿w_sock
);

655 
	`ciı_¿w_sock_dtÜ
(
ciı_¿w_sock
);

656 
	`ciı¶_pktbuf_dtÜ
(&
ciı¶_pkoŞ
);

657 
	}
}

737 #ià
CICPOS_PROCFS


743 
	#´ocfs_cÚŒŞ_¶ªe
(
ÿÎ”_šfo
è(&
CI_GLOBAL_CPLANE
)

	)

754 
	$ci_rou‹_scİe_¡r
(
scİe
) {

755 
scİe
) {

756 
RT_SCOPE_UNIVERSE
:  "univ";

757 
RT_SCOPE_SITE
:  "site";

758 
RT_SCOPE_LINK
:  "link";

759 
RT_SCOPE_HOST
:  "host";

760 
RT_SCOPE_NOWHERE
:  "nwhr";

763 
	}
}

767 
	$ciı_¡©_»ad_´oc
(
£q_fe
 *
£q
, *
s
)

769 
ciı_¡©_t
 *
¡©p
 = &(
	`´ocfs_cÚŒŞ_¶ªe
(
£q
->
´iv©e
)->
¡©
);

770 
	`ci_as£¹
(
¡©p
);

773 
	#CICP_READ_PROC_PRINT_CTR
(
couÁ”
) \

774 
	`£q_´štf
(
£q
, "%14 ğ%u\n", #couÁ”, 
¡©p
->
couÁ”
)

	)

775 
	#CICP_READ_PROC_PRINT_TIME
(
tim”
) \

776 
	`£q_´štf
(
£q
, "%17 ğ%u\n", #tim”, 
¡©p
->
tim”
)

	)

780 
	`CICP_READ_PROC_PRINT_CTR
(
drİ³d_
);

781 
	`CICP_READ_PROC_PRINT_CTR
(
tbl_fuÎ
);

782 
	`CICP_READ_PROC_PRINT_CTR
(
tbl_şashes
);

783 
	`CICP_READ_PROC_PRINT_CTR
(
unsuµÜ‹d
);

784 
	`CICP_READ_PROC_PRINT_CTR
(
pkt_»jeù
);

785 
	`CICP_READ_PROC_PRINT_CTR
(
Æ_msg_»jeù
);

786 
	`CICP_READ_PROC_PRINT_CTR
(
»Œªs
);

787 
	`CICP_READ_PROC_PRINT_CTR
(
timeouts
);

788 
	`CICP_READ_PROC_PRINT_CTR
(
»q_£Á
);

789 
	`CICP_READ_PROC_PRINT_CTR
(
»q_»cv
);

790 
	`CICP_READ_PROC_PRINT_CTR
(
»¶_»cv
);

791 
	`CICP_READ_PROC_PRINT_CTR
(
»šfÜûm’ts
);

792 
	`CICP_READ_PROC_PRINT_CTR
(
fifo_ov”æow
);

793 
	`CICP_READ_PROC_PRINT_CTR
(
dl_c2n_tx_”r
);

794 
	`CICP_READ_PROC_PRINT_CTR
(
Ùh”_”rÜs
);

796 
	`CICP_READ_PROC_PRINT_TIME
(
¬pgc_Ï¡_¡¬t
);

797 
	`CICP_READ_PROC_PRINT_TIME
(
¬pgc_Ï¡_’d
);

799 
	`CICP_READ_PROC_PRINT_TIME
(
Ï¡_pŞl_bgn
);

800 
	`CICP_READ_PROC_PRINT_TIME
(
Ï¡_pŞl_’d
);

801 
	`CICP_READ_PROC_PRINT_TIME
(
pkt_Ï¡_»cv
);

802 
	`£q_´štf
(
£q
, "%17 ğ%lu (%dHz)\n", "TimNow", 
jiff›s
, 
HZ
);

804 
	}
}

805 
	$ciı_¡©_İ’_´oc
(
šode
 *šode, 
fe
 *file)

807  
	`sšgË_İ’
(
fe
, 
ciı_¡©_»ad_´oc
, 
	`PDE_DATA
(
šode
));

808 
	}
}

809 cÚ¡ 
fe_İ”©iÚs
 
ciı_¡©_fİs
 = {

810 .
owÃr
 = 
THIS_MODULE
,

811 .
İ’
 = 
ciı_¡©_İ’_´oc
,

812 .
»ad
 = 
£q_»ad
,

813 .
Î£ek
 = 
£q_l£ek
,

814 .
»Ëa£
 = 
sšgË_»Ëa£
,

821 
	$ciıos_hwpÜt_»ad
(
£q_fe
 *
£q
, *
s
)

822 { 
ciı_mibs_k”n_t
 *
cÚŒŞ_¶ªe
 = 
	`´ocfs_cÚŒŞ_¶ªe
(
£q
->
´iv©e
);

823 cÚ¡ 
ciı_hwpÜt_kmib_t
 *
hwpÜ‰
 = 
cÚŒŞ_¶ªe
->
hwpÜt_bË
;

825 ià(
NULL
 =ğ
hwpÜ‰
)

826 
	`£q_´štf
(
£q
, "hardware…ortable unallocated\n");

828 { 
n
 = 0;

829 
nicid
;

831 
nicid
 = 0;‚icid <ğ
CI_HWPORT_ID_MAX
;‚icid++)

832 { cÚ¡ 
ciı_hwpÜt_row_t
 *
row
 = &
hwpÜ‰
->
nic
[
nicid
];

834 ià(
	`ciı_hwpÜt_row_®loÿ‹d
(
row
))

835 { 
	`CICP_LOCK_BEGIN
(
cÚŒŞ_¶ªe
)

837 
	`£q_´štf
(
£q
, "nic %02d: max mtu %d\n",

838 
nicid
, 
row
->
max_mtu
);

839 
CICP_LOCK_END


840 
n
++;

844 
	`£q_´štf
(
£q
, "%d (of %d)‡llocated\n",

845 
n
, 
CI_HWPORT_ID_MAX
+1);

848 
	}
}

849 
	$ciıos_hwpÜt_İ’
(
šode
 *šode, 
fe
 *file)

851  
	`sšgË_İ’
(
fe
, 
ciıos_hwpÜt_»ad
, 
	`PDE_DATA
(
šode
));

852 
	}
}

853 cÚ¡ 
fe_İ”©iÚs
 
	gciıos_hwpÜt_fİs
 = {

854 .
owÃr
 = 
THIS_MODULE
,

855 .
	gİ’
 = 
ciıos_hwpÜt_İ’
,

856 .
	g»ad
 = 
£q_»ad
,

857 .
	gÎ£ek
 = 
£q_l£ek
,

858 .
	g»Ëa£
 = 
sšgË_»Ëa£
,

864 
	$ciıos_Î­_»ad
(
£q_fe
 *
£q
, *
s
)

865 { 
ciı_mibs_k”n_t
 *
cÚŒŞ_¶ªe
 = 
	`´ocfs_cÚŒŞ_¶ªe
(
£q
->
´iv©e
);

867 cÚ¡ 
ciı_Î­_kmib_t
 *
Î­t
 = 
cÚŒŞ_¶ªe
->
Î­_bË
;

869 ià(
NULL
 =ğ
Î­t
)

870 
	`£q_´štf
(
£q
, "link†ayer‡ccess…ointable unallocated\n");

872 { 
ciı_Î­_rowid_t
 
Î­_šdex
;

873 
n
 = 0;

875 
Î­_šdex
 = 0;

876 
Î­_šdex
 < 
Î­t
->
rows_max
;

877 
Î­_šdex
++)

878 { cÚ¡ 
ciı_Î­_row_t
 *
row
 = &
Î­t
->
Î­
[
Î­_šdex
];

880 ià(
	`ciı_Î­_row_®loÿ‹d
(
row
))

881 { 
	`CICP_LOCK_BEGIN
(
cÚŒŞ_¶ªe
)

884 
	`£q_´štf
(
£q
, "%02d:†lap %02d %4s %4s…ort ",

885 
Î­_šdex
, 
row
->
ifšdex
,„ow->
Çme
,

886 
row
->
up
? "UP ": "DOWN");

887 ià(
	`ciı_Î­_row_ha¢ic
(&
cÚŒŞ_¶ªe
->
u£r
, 
row
))

889 
	`£q_´štf
(
£q
, "%1d ", 
row
->
hwpÜt
);

890 
	`£q_´štf
(
£q
, "maø"
CI_MAC_PRINTF_FORMAT


892 
	`CI_MAC_PRINTF_ARGS
(&
row
->
mac
),

893 
row
->
mtu
);

895 { 
	`£q_´štf
(
£q
, "X ");

897 ià(
row
->
’ÿpsuÏtiÚ
.
ty³
 & 
CICP_LLAP_TYPE_VLAN
) {

898 
	`£q_´štf
(
£q
, " VLAN %d",

899 
row
->
’ÿpsuÏtiÚ
.
vÏn_id
);

901 ià(
row
->
’ÿpsuÏtiÚ
.
ty³
 & 
CICP_LLAP_TYPE_BOND
) {

902 
	`£q_´štf
(
£q
, " BOND HW%d ROW%d",

903 
row
->
hwpÜt
,„ow->
bÚd_rowid
);

905 ià(
row
->
’ÿpsuÏtiÚ
.
ty³
 &

906 
CICP_LLAP_TYPE_USES_HASH
) {

907 
	`£q_´štf
(
£q
, " HASH");

908 ià(
row
->
’ÿpsuÏtiÚ
.
ty³
 &

909 
CICP_LLAP_TYPE_XMIT_HASH_LAYER4
) {

910 
	`£q_´štf
(
£q
, "-L4");

914 
	`£q_´štf
(
£q
, "\n");

916 
CICP_LOCK_END


917 
n
++;

921 
	`£q_´štf
(
£q
, "%d (oà%dè®loÿ‹d\n", 
n
, 
Î­t
->
rows_max
);

924 
	}
}

925 
	$ciıos_Î­_İ’
(
šode
 *šode, 
fe
 *file)

927  
	`sšgË_İ’
(
fe
, 
ciıos_Î­_»ad
, 
	`PDE_DATA
(
šode
));

928 
	}
}

929 cÚ¡ 
fe_İ”©iÚs
 
	gciıos_Î­_fİs
 = {

930 .
owÃr
 = 
THIS_MODULE
,

931 .
	gİ’
 = 
ciıos_Î­_İ’
,

932 .
	g»ad
 = 
£q_»ad
,

933 .
	gÎ£ek
 = 
£q_l£ek
,

934 .
	g»Ëa£
 = 
sšgË_»Ëa£
,

938 *
	$ciıos_mac_»ad_¡¬t
(
£q_fe
 *
£q
, 
loff_t
 *
pos
)

940 
ciı_mibs_k”n_t
 *
cÚŒŞ_¶ªe
 = 
	`´ocfs_cÚŒŞ_¶ªe
(
£q
->
´iv©e
);

941 cÚ¡ 
ciı_mac_mib_t
 *
umaù
 = 
cÚŒŞ_¶ªe
->
u£r
.
mac_ubË
;

942 ià(
umaù
 =ğ
NULL
)

943  
NULL
;

944  (*
pos
 <ğ
	`ciı_mac_mib_rows
(
umaù
)è?…o : 
NULL
;

945 
	}
}

946 *
	$ciıos_mac_»ad_Ãxt
(
£q_fe
 *
£q
, *
v
, 
loff_t
 *
pos
)

948 (*
pos
)++;

949  
	`ciıos_mac_»ad_¡¬t
(
£q
, 
pos
);

950 
	}
}

951 
	$ciıos_mac_»ad_¡İ
(
£q_fe
 *
£q
, *
s
)

953 
	}
}

955 
	$ciıos_mac_»ad
(
£q_fe
 *
£q
, *
s
)

957 
ciı_mibs_k”n_t
 *
cÚŒŞ_¶ªe
 = 
	`´ocfs_cÚŒŞ_¶ªe
(
£q
->
´iv©e
);

958 cÚ¡ 
ciı_mac_mib_t
 *
umaù
 = 
cÚŒŞ_¶ªe
->
u£r
.
mac_ubË
;

959 cÚ¡ 
ciı_mac_kmib_t
 *
kmaù
 = 
cÚŒŞ_¶ªe
->
mac_bË
;

960 
ciı_mac_rowid_t
 
mac_šdex
 = *(
loff_t
 *)
s
;

962 ià(
NULL
 =ğ
umaù
)

964 
	`£q_´štf
(
£q
, "user‡ddress„esolutionable unallocated\n");

966 ià(
mac_šdex
 =ğ
	`ciı_mac_mib_rows
(
umaù
))

968 
n
 = 0;

969 
mac_šdex
 = 0; mac_šdex < 
	`ciı_mac_mib_rows
(
umaù
);

970 
mac_šdex
++)

971 ià(
	`ciı_mac_row_®loÿ‹d
(&
umaù
->
mac
[
mac_šdex
]))

972 
n
++;

973 
	`£q_´štf
(
£q
, "%d (of %d)‡llocated\n",

974 
n
, 
	`ciı_mac_mib_rows
(
umaù
));

976 ià(
	`ciı_mac_row_®loÿ‹d
(&
umaù
->
mac
[
mac_šdex
]))

978 cÚ¡ 
ciı_mac_row_t
 *
row
 = &
umaù
->
mac
[
mac_šdex
];

979 cÚ¡ 
ciı_mac_k”Äow_t
 *
krow
 = &
kmaù
->
’Œy
[
mac_šdex
];

980 cÚ¡ 
ciıos_mac_row_t
 *
sync
 = &
krow
->sync;

982 
	`CICP_LOCK_BEGIN
(
cÚŒŞ_¶ªe
)

986 
	`£q_´štf
(
£q
, "#%04x:†Ï°%02d %4  "
CI_IP_PRINTF_FORMAT


987 " maø"
CI_MAC_PRINTF_FORMAT
" on %3d%s%s",

988 
mac_šdex
, 
row
->
ifšdex
,

989 
	`_ciı_Î­_g‘_Çme
(
cÚŒŞ_¶ªe
, 
row
->
ifšdex
),

990 
	`CI_IP_PRINTF_ARGS
(&
row
->
_addr
),

991 
	`CI_MAC_PRINTF_ARGS
(&
row
->
mac_addr
),

992 
	`ciı_mac_row_u£couÁ
(
row
),

993 
	`ciı_mac_row_’‹r_»que¡ed
(
row
) ? " !service!": "",

994 
row
->
Ãed_upd©e
 =ğ
CICP_MAC_ROW_NEED_UPDATE_STALE
 ?

996 
row
->
Ãed_upd©e
 =ğ
CICP_MAC_ROW_NEED_UPDATE_SOON
 ?

999 
	`£q_´štf
(
£q
, " [u %08x up %08x„ef %d %s%s%s%s%s%s%s%s%s%02X "

1001 
sync
->
os
.
u£d
, sync->os.
upd©ed
, sync->os.
»fút
,

1002 0 =ğ
sync
->
os
.
¡©e
? "NONE ":"",

1003 0 !ğ(
sync
->
os
.
¡©e
 & 
CICPOS_IPMAC_INCOMPLETE
)?

1005 0 !ğ(
sync
->
os
.
¡©e
 & 
CICPOS_IPMAC_REACHABLE
)?

1007 0 !ğ(
sync
->
os
.
¡©e
 & 
CICPOS_IPMAC_STALE
) ? "STALE ":"",

1008 0 !ğ(
sync
->
os
.
¡©e
 & 
CICPOS_IPMAC_DELAY
) ? "DELAY ":"",

1009 0 !ğ(
sync
->
os
.
¡©e
 & 
CICPOS_IPMAC_PROBE
) ? "PROBE ":"",

1010 0 !ğ(
sync
->
os
.
¡©e
 & 
CICPOS_IPMAC_FAILED
) ?

1012 0 !ğ(
sync
->
os
.
¡©e
 & 
CICPOS_IPMAC_NOARP
)? "NOARP ":"",

1013 0 !ğ(
sync
->
os
.
¡©e
 & 
CICPOS_IPMAC_PERMANENT
)?

1015 
sync
->
os
.
æags
, sync->os.
çmy
,

1016 0 !ğ
sync
->
sourû_sync
? "S": "s",

1017 0 !ğ
sync
->
sourû_´Ù
? "P": "p",

1018 0 !ğ
sync
->
»ûÁ_sync
? "R": "r");

1019 
	`£q_´štf
(
£q
, " v%d„ø%d\n", 
row
->
v”siÚ
, (
ci_št16
ìow->
rc
);

1021 
CICP_LOCK_END


1025 
	}
}

1026 
£q_İ”©iÚs
 
	gciıos_mac_£q_İs
 = {

1027 .
¡¬t
 = 
ciıos_mac_»ad_¡¬t
,

1028 .
	gÃxt
 = 
ciıos_mac_»ad_Ãxt
,

1029 .
	g¡İ
 = 
ciıos_mac_»ad_¡İ
,

1030 .
	gshow
 = 
ciıos_mac_»ad
,

1032 
	$ciıos_mac_İ’
(
šode
 *šode, 
fe
 *file)

1034 
rc
;

1035 
rc
 = 
	`£q_İ’
(
fe
, &
ciıos_mac_£q_İs
);

1036 ià(
rc
 != 0)

1037 ((
£q_fe
 *)
fe
->
´iv©e_d©a
)->
´iv©e
 = 
	`PDE_DATA
(
šode
);

1038  
rc
;

1039 
	}
}

1040 cÚ¡ 
fe_İ”©iÚs
 
	gciıos_mac_fİs
 = {

1041 .
owÃr
 = 
THIS_MODULE
,

1042 .
	gİ’
 = 
ciıos_mac_İ’
,

1043 .
	g»ad
 = 
£q_»ad
,

1044 .
	gÎ£ek
 = 
£q_l£ek
,

1045 .
	g»Ëa£
 = 
£q_»Ëa£
,

1053 
	$ciıos_if_»ad
(
£q_fe
 *
£q
, *
s
)

1054 { 
ciı_mibs_k”n_t
 *
cÚŒŞ_¶ªe
 = 
	`´ocfs_cÚŒŞ_¶ªe
(
£q
->
´iv©e
);

1055 cÚ¡ 
ciı_if_kmib_t
 *
iá
 = 
cÚŒŞ_¶ªe
->
if_bË
;

1057 ià(
NULL
 =ğ
iá
)

1058 
	`£q_´štf
(
£q
, "IP interfaceable unallocated\n");

1060 { 
ciı_if_rowid_t
 
if_šdex
;

1061 
n
 = 0;

1063 
if_šdex
 = 0;

1064 
if_šdex
 < 
iá
->
rows_max
;

1065 
if_šdex
++)

1066 { cÚ¡ 
ciı_if_row_t
 *
row
 = &
iá
->
if
[
if_šdex
];

1068 ià(
	`ciı_if_row_®loÿ‹d
(
row
))

1069 { 
	`CICP_LOCK_BEGIN
(
cÚŒŞ_¶ªe
)

1071 
	`£q_´štf
(
£q
, "%02d:†lap %02d %4s "

1072 
CI_IP_PRINTF_FORMAT


1073 "/%d\ˆbÿ¡ "
CI_IP_PRINTF_FORMAT


1076 
if_šdex
,

1077 
row
->
ifšdex
,

1078 
	`_ciı_Î­_g‘_Çme
(
cÚŒŞ_¶ªe
,

1079 
row
->
ifšdex
),

1080 
	`CI_IP_PRINTF_ARGS
(&
row
->
Ãt_
),

1081 
row
->
Ãt_£t
,

1082 
	`CI_IP_PRINTF_ARGS
(&
row
->
bÿ¡_
),

1083 
	`ci_rou‹_scİe_¡r
(
row
->
scİe
));

1084 
CICP_LOCK_END


1085 
n
++;

1089 
	`£q_´štf
(
£q
, "%d (oà%dè®loÿ‹d\n", 
n
, 
iá
->
rows_max
);

1092 
	}
}

1093 
	$ciıos_if_İ’
(
šode
 *šode, 
fe
 *file)

1095  
	`sšgË_İ’
(
fe
, 
ciıos_if_»ad
, 
	`PDE_DATA
(
šode
));

1096 
	}
}

1097 cÚ¡ 
fe_İ”©iÚs
 
	gciıos_if_fİs
 = {

1098 .
owÃr
 = 
THIS_MODULE
,

1099 .
	gİ’
 = 
ciıos_if_İ’
,

1100 .
	g»ad
 = 
£q_»ad
,

1101 .
	gÎ£ek
 = 
£q_l£ek
,

1102 .
	g»Ëa£
 = 
sšgË_»Ëa£
,

1107 
	$ciıos_bÚd_»ad
(
£q_fe
 *
£q
, *
s
)

1109 
ciı_mibs_k”n_t
 *
cÚŒŞ_¶ªe
 = 
	`´ocfs_cÚŒŞ_¶ªe
(
£q
->
´iv©e
);

1110 cÚ¡ 
ciı_bÚdšfo_t
 *
bÚdt
;

1111 
n
 = 0;

1112 
i
;

1114 
bÚdt
 = 
cÚŒŞ_¶ªe
->
u£r
.
bÚdšfo_ubË
;

1117 ifĞ
bÚdt
 =ğ
NULL
 )

1118 
	`£q_´štf
(
£q
, "bondable unallocated\n");

1120  
i
 = 0; i < 
bÚdt
->
rows_max
; i++ ) {

1121 cÚ¡ 
ciı_bÚd_row_t
 *
row
 = &
bÚdt
->
bÚd
[
i
];

1122 ifĞ
	`ciı_bÚd_row_®loÿ‹d
(
row
) ) {

1123 
	`CICP_LOCK_BEGIN
(
cÚŒŞ_¶ªe
);

1125 ifĞ
row
->
ty³
 =ğ
CICP_BOND_ROW_TYPE_MASTER
 )

1126 
	`£q_´štf
(
£q
, "Row %d: MST if %d,‚ext %d, "

1129 
i
, 
row
->
ifid
,„ow->
Ãxt
,

1130 
row
->
ma¡”
.
mode
,„ow->ma¡”.
hash_pŞicy
,

1131 
row
->
ma¡”
.
n_¦aves
,

1132 
row
->
ma¡”
.
n_aùive_¦aves
,

1133 
row
->
ma¡”
.
aùive_hwpÜt
);

1134 ifĞ
row
->
ty³
 =ğ
CICP_BOND_ROW_TYPE_SLAVE
 )

1135 
	`£q_´štf
(
£q
, "Row %d: SLV if %d,‚ext %d, "

1137 
i
, 
row
->
ifid
,„ow->
Ãxt
,„ow->
¦ave
.
hwpÜt
,

1138 
row
->
¦ave
.
æags
,

1139 
row
->
¦ave
.
æags
 & 
CICP_BOND_ROW_FLAG_ACTIVE
 ?

1142 
	`£q_´štf
(
£q
, "Bond„ow %d: BADype %d\n",

1143 
i
, 
row
->
ty³
);

1144 
CICP_LOCK_END
;

1146 ++
n
;

1149 
	`£q_´štf
(
£q
, "%d (oà%dè®loÿ‹d\n", 
n
, 
bÚdt
->
rows_max
);

1153 
	}
}

1154 
	$ciıos_bÚd_İ’
(
šode
 *šode, 
fe
 *file)

1156  
	`sšgË_İ’
(
fe
, 
ciıos_bÚd_»ad
, 
	`PDE_DATA
(
šode
));

1157 
	}
}

1158 cÚ¡ 
fe_İ”©iÚs
 
	gciıos_bÚd_fİs
 = {

1159 .
owÃr
 = 
THIS_MODULE
,

1160 .
	gİ’
 = 
ciıos_bÚd_İ’
,

1161 .
	g»ad
 = 
£q_»ad
,

1162 .
	gÎ£ek
 = 
£q_l£ek
,

1163 .
	g»Ëa£
 = 
sšgË_»Ëa£
,

1168 *
	$ciıos_fwd_»ad_¡¬t
(
£q_fe
 *
£q
, 
loff_t
 *
pos
)

1170 
ciı_mibs_k”n_t
 *
cÚŒŞ_¶ªe
 = 
	`´ocfs_cÚŒŞ_¶ªe
(
£q
->
´iv©e
);

1171 cÚ¡ 
ciı_fwdšfo_t
 *
fwdt
 = 
cÚŒŞ_¶ªe
->
u£r
.
fwdšfo_ubË
;

1172 ià(
fwdt
 =ğ
NULL
)

1173  
NULL
;

1174  (*
pos
 <ğ
fwdt
->
rows_max
è?…o : 
NULL
;

1175 
	}
}

1176 *
	$ciıos_fwd_»ad_Ãxt
(
£q_fe
 *
£q
, *
v
, 
loff_t
 *
pos
)

1178 (*
pos
)++;

1179  
	`ciıos_fwd_»ad_¡¬t
(
£q
, 
pos
);

1180 
	}
}

1181 
	$ciıos_fwd_»ad_¡İ
(
£q_fe
 *
£q
, *
s
)

1183 
	}
}

1188 
	$ciıos_fwd_»ad
(
£q_fe
 *
£q
, *
s
)

1189 { 
ciı_mibs_k”n_t
 *
cÚŒŞ_¶ªe
 = 
	`´ocfs_cÚŒŞ_¶ªe
(
£q
->
´iv©e
);

1190 cÚ¡ 
ciı_fwdšfo_t
 *
fwdt
 = 
cÚŒŞ_¶ªe
->
u£r
.
fwdšfo_ubË
;

1191 
ciı_fwd_rowid_t
 
fwd_šdex
 = *(
loff_t
 *)
s
;

1193 ià(
NULL
 =ğ
fwdt
)

1195 
	`£q_´štf
(
£q
, "user forwarding information unallocated\n");

1197 ià(
fwd_šdex
 =ğ
fwdt
->
rows_max
) {

1198 
n
 = 0;

1199 
fwd_šdex
 = 0; fwd_šdex < 
fwdt
->
rows_max
; fwd_index++)

1200 ià(
	`ciı_fwd_row_®loÿ‹d
(&
fwdt
->
·th
[
fwd_šdex
]))

1201 
n
++;

1202 
	`£q_´štf
(
£q
, "%d (oà%dè®loÿ‹d\n", 
n
, 
fwdt
->
rows_max
);

1204 ià(
	`ciı_fwd_row_®loÿ‹d
(&
fwdt
->
·th
[
fwd_šdex
]))

1206 cÚ¡ 
ciı_fwd_row_t
 *
row
 = &
fwdt
->
·th
[
fwd_šdex
];

1208 
	`CICP_LOCK_BEGIN
(
cÚŒŞ_¶ªe
)

1210 
	`£q_´štf
(
£q
, 
CI_IP_PRINTF_FORMAT
"/%u -> "CI_IP_PRINTF_FORMAT

1212 
	`CI_IP_PRINTF_ARGS
(&
row
->
de¡Ãt_
),

1213 
row
->
de¡Ãt_£t
,

1214 
	`CI_IP_PRINTF_ARGS
(&
row
->
fœ¡_hİ
),

1215 
row
->
de¡_ifšdex
,

1216 
	`_ciı_Î­_g‘_Çme
(
cÚŒŞ_¶ªe
, 
row
->
de¡_ifšdex
));

1217 ià(
	`ciı_fwd_row_ha¢ic
(&
cÚŒŞ_¶ªe
->
u£r
, 
row
))

1218 
	`£q_´štf
(
£q
, "%1dƒnÿ°" 
CICP_ENCAP_NAME_FMT
,

1219 
row
->
hwpÜt
, 
	`ciı_’ÿp_Çme
Ôow->
’ÿp
.
ty³
));

1221 
	`£q_´štf
(
£q
, "X");

1222 
	`£q_´štf
(
£q
, "\n");

1224 
	`£q_´štf
(
£q
, "\td¡ "
CI_IP_PRINTF_FORMAT
"/%d "

1225 "bÿ¡ "
CI_IP_PRINTF_FORMAT
" mtu %dos %d metric %d",

1226 
	`CI_IP_PRINTF_ARGS
(&
row
->
Ãt_
),„ow->
Ãt_£t
,

1227 
	`CI_IP_PRINTF_ARGS
(&
row
->
Ãt_bÿ¡
),

1228 
row
->
mtu
,„ow->
tos
,„ow->
m‘ric
);

1229 
	`£q_´štf
(
£q
, "\n");

1231 
	`£q_´štf
(
£q
, "\t¤ø "
CI_IP_PRINTF_FORMAT


1232 " maø"
CI_MAC_PRINTF_FORMAT
"\n",

1233 
	`CI_IP_PRINTF_ARGS
(&
row
->
´ef_sourû
),

1234 
	`CI_MAC_PRINTF_ARGS
(&
row
->
´ef_¤c_mac
));

1235 
CICP_LOCK_END


1239 
	}
}

1240 
£q_İ”©iÚs
 
	gciıos_fwd_£q_İs
 = {

1241 .
¡¬t
 = 
ciıos_fwd_»ad_¡¬t
,

1242 .
	gÃxt
 = 
ciıos_fwd_»ad_Ãxt
,

1243 .
	g¡İ
 = 
ciıos_fwd_»ad_¡İ
,

1244 .
	gshow
 = 
ciıos_fwd_»ad
,

1246 
	$ciıos_fwd_İ’
(
šode
 *šode, 
fe
 *file)

1248 
rc
;

1249 
rc
 = 
	`£q_İ’
(
fe
, &
ciıos_fwd_£q_İs
);

1250 ià(
rc
 != 0)

1251 ((
£q_fe
 *)
fe
->
´iv©e_d©a
)->
´iv©e
 = 
	`PDE_DATA
(
šode
);

1252  
rc
;

1253 
	}
}

1254 cÚ¡ 
fe_İ”©iÚs
 
	gciıos_fwd_fİs
 = {

1255 .
owÃr
 = 
THIS_MODULE
,

1256 .
	gİ’
 = 
ciıos_fwd_İ’
,

1257 .
	g»ad
 = 
£q_»ad
,

1258 .
	gÎ£ek
 = 
£q_l£ek
,

1259 .
	g»Ëa£
 = 
£q_»Ëa£
,

1264 
	$ciıos_pmtu_»ad
(
£q_fe
 *
£q
, *
s
)

1266 
ciı_mibs_k”n_t
 *
cÚŒŞ_¶ªe
 = 
	`´ocfs_cÚŒŞ_¶ªe
(
£q
->
´iv©e
);

1267 
ciı_pmtu_kmib_t
 *
pmtu_bË
 = 
cÚŒŞ_¶ªe
->pmtu_table;

1268 
i
, 
n
 = 0;

1270  
i
 = 0; i < 
pmtu_bË
->
u£d_rows_max
; i++ ) {

1271 
ciı_pmtu_row_t
 *
row
 = &
pmtu_bË
->
’Œ›s
[
i
];

1272 
	`CICP_LOCK_BEGIN
(
cÚŒŞ_¶ªe
)

1273 ifĞ
	`ciı_pmtu_row_®loÿ‹d
(
row
) ) {

1274 
	`£q_´štf
(
£q
, "%d: "
CI_IP_PRINTF_FORMAT
"imestamp=0x%lx\n",

1275 
i
, 
	`CI_IP_PRINTF_ARGS
(&
row
->
Ãt_
),„ow->
time¡amp
);

1276 
n
++;

1278 
CICP_LOCK_END
;

1281 
	`£q_´štf
(
£q
, "%d (of %d)‡llocated, with maximum %d\n",

1282 
n
, 
pmtu_bË
->
rows_max
,…mtu_bË->
u£d_rows_max
);

1284 
	}
}

1285 
	$ciıos_pmtu_İ’
(
šode
 *šode, 
fe
 *file)

1287  
	`sšgË_İ’
(
fe
, 
ciıos_pmtu_»ad
, 
	`PDE_DATA
(
šode
));

1288 
	}
}

1289 cÚ¡ 
fe_İ”©iÚs
 
	gciıos_pmtu_fİs
 = {

1290 .
owÃr
 = 
THIS_MODULE
,

1291 .
	gİ’
 = 
ciıos_pmtu_İ’
,

1292 .
	g»ad
 = 
£q_»ad
,

1293 .
	gÎ£ek
 = 
£q_l£ek
,

1294 .
	g»Ëa£
 = 
sšgË_»Ëa£
,

1299 
	$ciıos_´ocfs_ùÜ
(
ciı_mibs_k”n_t
 *
cÚŒŞ_¶ªe
)

1300 { *
ÿÎ”_šfo
 = 
cÚŒŞ_¶ªe
;

1304 
	`ci_as£¹
(
NULL
 !ğ
cÚŒŞ_¶ªe
);

1309 ià(
cÚŒŞ_¶ªe
 =ğ&
CI_GLOBAL_CPLANE
)

1311 
	`ci_as£¹
(
NULL
 !ğ
oo_´oc_roÙ
);

1313 
	`´oc_ü—‹_d©a
(
CICPOS_PROCFS_FILE_HWPORT
, 0, 
oo_´oc_roÙ
,

1314 &
ciıos_hwpÜt_fİs
, 
ÿÎ”_šfo
);

1315 
	`´oc_ü—‹_d©a
(
CICPOS_PROCFS_FILE_LLAP
, 0, 
oo_´oc_roÙ
,

1316 &
ciıos_Î­_fİs
, 
ÿÎ”_šfo
);

1317 
	`´oc_ü—‹_d©a
(
CICPOS_PROCFS_FILE_MAC
, 0, 
oo_´oc_roÙ
,

1318 &
ciıos_mac_fİs
, 
ÿÎ”_šfo
);

1319 
	`´oc_ü—‹_d©a
(
CICPOS_PROCFS_FILE_IPIF
, 0, 
oo_´oc_roÙ
,

1320 &
ciıos_if_fİs
, 
ÿÎ”_šfo
);

1321 
	`´oc_ü—‹_d©a
(
CICPOS_PROCFS_FILE_FWDINFO
, 0, 
oo_´oc_roÙ
,

1322 &
ciıos_fwd_fİs
, 
ÿÎ”_šfo
);

1323 
	`´oc_ü—‹_d©a
(
CICPOS_PROCFS_FILE_BONDINFO
, 0, 
oo_´oc_roÙ
,

1324 &
ciıos_bÚd_fİs
, 
ÿÎ”_šfo
);

1325 
	`´oc_ü—‹_d©a
(
CICPOS_PROCFS_FILE_PMTU
, 0, 
oo_´oc_roÙ
,

1326 &
ciıos_pmtu_fİs
, 
ÿÎ”_šfo
);

1328 
	}
}

1335 
	$ciıos_´ocfs_dtÜ
(
ciı_mibs_k”n_t
 *
cÚŒŞ_¶ªe
)

1336 { ià(
NULL
 !ğ
oo_´oc_roÙ
)

1337 { 
	`»move_´oc_’Œy
(
CICPOS_PROCFS_FILE_HWPORT
, 
oo_´oc_roÙ
);

1338 
	`»move_´oc_’Œy
(
CICPOS_PROCFS_FILE_LLAP
, 
oo_´oc_roÙ
);

1339 
	`»move_´oc_’Œy
(
CICPOS_PROCFS_FILE_MAC
, 
oo_´oc_roÙ
);

1340 
	`»move_´oc_’Œy
(
CICPOS_PROCFS_FILE_IPIF
, 
oo_´oc_roÙ
);

1341 
	`»move_´oc_’Œy
(
CICPOS_PROCFS_FILE_FWDINFO
, 
oo_´oc_roÙ
);

1342 
	`»move_´oc_’Œy
(
CICPOS_PROCFS_FILE_BONDINFO
, 
oo_´oc_roÙ
);

1343 
	`»move_´oc_’Œy
(
CICPOS_PROCFS_FILE_PMTU
, 
oo_´oc_roÙ
);

1345 
	}
}

1355 
	#ciıos_´ocfs_ùÜ
(
cÚŒŞ_¶ªe
)

	)

1356 
	#ciıos_´ocfs_dtÜ
(
cÚŒŞ_¶ªe
)

	)

1387 
	~<lšux/skbuff.h
>

1388 
	~<lšux/Ãšk.h
>

1389 
	~<lšux/¹Ãšk.h
>

1390 #ià
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(2,6,19)

1391 
	~<lšux/if_addr.h
>

1393 
	~<lšux/if_¬p.h
>

1411 #ià
CICPOS_USE_NETLINK


1414 
	tci_¹Æ_msg_hªdËr_t
(
	tciıos_·r£_¡©e_t
 *, 
	tÆmsghdr
 *);

1419 
ciıos_hªdË_¹Æ_msg
(
ciıos_·r£_¡©e_t
 *
£ssiÚ
, 
Æmsghdr
 *
Æhdr
);

1422 
ciıos_dump_bËs
(
ciı_hªdË_t
 *
cÚŒŞ_¶ªe
, 
mac_Úly
,

1423 *
buf
);

1426 
sock‘
 *
	msock
;

1427 
__u32
 
	m£q
;

1428 } 
	tciı_Æsock_t
;

1439 
	$ci_rou‹_ty³_¡r
(
ty³
) {

1440 
ty³
) {

1441 
RTN_UNSPEC
:  "UNSPEC";

1442 
RTN_UNICAST
:  "UNICAST";

1443 
RTN_LOCAL
:  "LOCAL";

1444 
RTN_BROADCAST
:  "BROADCAST";

1445 
RTN_ANYCAST
:  "ANYCAST";

1446 
RTN_MULTICAST
:  "MULTICAST";

1447 
RTN_BLACKHOLE
:  "BLACKHOLE";

1448 
RTN_UNREACHABLE
:  "UNREACHABLE";

1449 
RTN_PROHIBIT
:  "PROHIBIT";

1450 
RTN_THROW
:  "THROW";

1451 
RTN_NAT
:  "NAT";

1452 
RTN_XRESOLVE
:  "XRESOLVE";

1455 
	}
}

1462 
	$ci_rou‹_´ÙocŞ_¡r
(
´ÙocŞ
) {

1463 
´ÙocŞ
) {

1464 
RTPROT_REDIRECT
:  "REDIRECT";

1465 
RTPROT_KERNEL
:  "KERNEL";

1466 
RTPROT_BOOT
:  "BOOT";

1467 
RTPROT_STATIC
:  "STATIC";

1468 
RTPROT_GATED
:  "GATED";

1469 
RTPROT_RA
:  "RA";

1470 
RTPROT_MRT
:  "MRT";

1471 
RTPROT_ZEBRA
:  "ZEBRA";

1472 
RTPROT_BIRD
:  "BIRD";

1473 
RTPROT_DNROUTED
:  "DNROUTED";

1476 
	}
}

1483 cÚ¡ * 
	$ci_rou‹_bË_¡r
(
bË
) {

1484 
bË
) {

1485 
RT_TABLE_UNSPEC
:  "unspec";

1486 
RT_TABLE_DEFAULT
:  "def";

1487 
RT_TABLE_MAIN
:  "main";

1488 
RT_TABLE_LOCAL
:  "local";

1491 
	}
}

1499 
	$ciıos_µršt_¹msg
(
¹msg
 *
p
)

1501 
	`ci_as£¹
(
NULL
 !ğ
p
);

1502 
	`DPRINTF
("rtbl_entry(%p) fam=%d dlen=%d slen=%dos=%dbl=%s \n"

1504 
p
,…->
¹m_çmy
,…->
¹m_d¡_Ën
,…->
¹m_¤c_Ën
,…->
¹m_tos
,

1505 
	`ci_rou‹_bË_¡r
(
p
->
¹m_bË
),

1506 
	`ci_rou‹_´ÙocŞ_¡r
(
p
->
¹m_´ÙocŞ
),

1507 
	`ci_rou‹_scİe_¡r
(
p
->
¹m_scİe
),

1508 
	`ci_rou‹_ty³_¡r
(
p
->
¹m_ty³
),

1509 
p
->
¹m_æags
);

1510 
	}
}

1519 
	$ci_bšd_Ãšk_sock‘
(
sock‘
 *
sockp
, 
__u32
 
Æ_groups
)

1521 
sockaddr_Æ
 
addr
;

1522 
	`mem£t
(&
addr
, 0, (addr));

1523 
addr
.
Æ_çmy
 = 
AF_NETLINK
;

1524 
addr
.
Æ_groups
 =‚l_groups;

1525  (
sockp
)->
İs
->
	`bšd
(sockp, (
sockaddr
*)&
addr
, (addr));

1526 
	}
}

1533 
	$ci_add_Ãšk_memb”shs
(
sock‘
 *
sockp
)

1541 #ià
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(2,6,14)

1542  
ci_bšd_Ãšk_sock‘


1543 (
sockp
, 
RTMGRP_LINK
 | 
RTMGRP_IPV4_ROUTE
 | 
RTMGRP_IPV4_IFADDR
);

1545 
mm_£gm’t_t
 
fs
;

1546 
İtv®
, 
rc
;

1548 
rc
 = 
	`ci_bšd_Ãšk_sock‘
(
sockp
, 0);

1549 ià(
rc
 < 0) „c;

1553 
fs
 = 
	`g‘_fs
();

1554 
	`£t_fs
 (
	`g‘_ds
());

1557 
İtv®
 = 
RTNLGRP_LINK
;

1558 
rc
 = (
sockp
)->
İs
->
	`£tsockİt
(sockp, 
SOL_NETLINK
, 
NETLINK_ADD_MEMBERSHIP
,

1559 (*)&
İtv®
, ());

1560 ià(
rc
 < 0) {

1561 
	`ci_log
("****** ERROR:‚‘lšk s‘sockİtÖškèçed,„c=%d ******", 
rc
);

1562 
’d
;

1566 
İtv®
 = 
RTNLGRP_IPV4_ROUTE
;

1567 
rc
 = (
sockp
)->
İs
->
	`£tsockİt
(sockp, 
SOL_NETLINK
, 
NETLINK_ADD_MEMBERSHIP
,

1568 (*)&
İtv®
, ());

1569 ià(
rc
 < 0) {

1570 
	`ci_log
("****** ERROR:‚‘lšk s‘sockİtÔou‹èçed,„c=%d ******", 
rc
);

1571 
’d
;

1575 
İtv®
 = 
RTNLGRP_IPV4_IFADDR
;

1576 
rc
 = (
sockp
)->
İs
->
	`£tsockİt
(sockp, 
SOL_NETLINK
, 
NETLINK_ADD_MEMBERSHIP
,

1577 (*)&
İtv®
, ());

1578 ià(
rc
 < 0) {

1579 
	`ci_log
("****** ERROR:‚‘lšk s‘sockİt(içddrèçed,„c=%d ******", 
rc
);

1580 
’d
;

1583 
’d
:

1584 
	`£t_fs
(
fs
);

1585  
rc
;

1587 
	}
}

1595 
	$ü—‹_Ãšk_sock‘
(
sock‘
 **
sockp
)

1597  
	`sock_ü—‹
(
PF_NETLINK
, 
SOCK_RAW
, 
NETLINK_ROUTE
, 
sockp
);

1598 
	}
}

1606 
	$ü—‹_li¡’šg_Ãšk_sock‘
(
sock‘
 **
sockp
)

1608 
rc
, 
¡•
=0;

1610 
rc
 = 
	`sock_ü—‹
(
PF_NETLINK
, 
SOCK_RAW
, 
NETLINK_ROUTE
, 
sockp
);

1611 ià(
rc
 < 0è
”rÜ
;

1613 
¡•
++;

1614 
rc
 = 
	`ci_add_Ãšk_memb”shs
(*
sockp
);

1615 ià(
rc
 < 0è
”rÜ
;

1619 
”rÜ
:

1620 
	`ci_log
("%s: couldn't create†istening‚etlink socket,„c=%d, step=%d",

1621 
__FUNCTION__
, 
rc
, 
¡•
);

1622 
	`sock_»Ëa£
(*
sockp
);

1623 *
sockp
=0;

1624  
rc
;

1625 
	}
}

1636 
	$»que¡_bË
(
ciı_Æsock_t
 *
Æsock
, 
Æmsg_ty³
, 
¹m_æags
,

1637 * 
buf
)

1639 
msghdr
 
msg
;

1640 
iovec
 
iov
;

1641 
Æmsghdr
 *
Æhdr
 = (Æmsghd¸*è
buf
;

1642 
¹msg
 *
¹m
 = (*)(
Æhdr
+1);

1643 
»t
;

1645 
	`mem£t
(
buf
, 0, 
NL_BUFSIZE
);

1646 ifĞ
Æmsg_ty³
 =ğ
RTM_GETROUTE
 )

1647 
Æhdr
->
Æmsg_Ën
 = 
	`NLMSG_LENGTH
((
¹msg
));

1649 
Æhdr
->
Æmsg_Ën
 = 
	`NLMSG_LENGTH
((
¹g’msg
));

1650 
Æhdr
->
Æmsg_ty³
 =‚lmsg_type;

1651 
Æhdr
->
Æmsg_æags
 = 
NLM_F_ROOT
 | 
NLM_F_REQUEST
;

1652 
Æhdr
->
Æmsg_£q
 = ++
Æsock
->
£q
;

1653 
¹m
->
¹m_çmy
 = 
AF_INET
;

1654 
¹m
->
¹m_æags
 =„tm_flags;

1656 
iov
.
iov_ba£
 = (*)
buf
;

1657 
iov
.
iov_Ën
 = 
Æhdr
->
Æmsg_Ën
;

1658 
msg
.
msg_Çme
=
NULL
;

1659 
msg
.
msg_Çm–’
=0;

1660 
msg
.
msg_cÚŒŞËn
=0;

1661 
msg
.
msg_æags
=0;

1662 
msg
.
msg_iov
=&
iov
;

1663 
msg
.
msg_iovËn
=1;

1665 
»t
 = 
	`sock_£ndmsg
(
Æsock
->
sock
, &
msg
, 
Æhdr
->
Æmsg_Ën
);

1667 ià(
»t
 < 0) {

1668 
	`ci_log
("%s():sock_£ndmsg faed,ƒ¼=%d", 
__FUNCTION__
, 
»t
);

1669  
»t
;

1672 if(
»t
 !ğ
Æhdr
->
Æmsg_Ën
) {

1673 
	`ci_log
("%s():sock_sendmsg failed. Read %d bytes butƒxpected %d.",

1674 
__FUNCTION__
, 
»t
, 
Æhdr
->
Æmsg_Ën
);

1675  -
ENODATA
;

1679 
	}
}

1686 
ssize_t


1687 
	$Ãšk_»ad
(
sock‘
 *
sock
, *
buf
, 
size_t
 
couÁ
,

1688 
blockšg
, 
»Œy
)

1689 { 
sockaddr_Æ
 
Æaddr
;

1690 
msghdr
 
msg
;

1691 
iovec
 
iov
;

1692 
rc
;

1694 
	`mem£t
(&
Æaddr
, 0, (nladdr));

1695 
Æaddr
.
Æ_çmy
 = 
AF_NETLINK
;

1696 
Æaddr
.
Æ_pid
 = 0;

1697 
Æaddr
.
Æ_groups
 = 0;

1699 
iov
.
iov_ba£
 = 
buf
;

1700 
iov
.
iov_Ën
 = 
couÁ
;

1702 
msg
.
msg_Çme
=&
Æaddr
;

1703 
msg
.
msg_Çm–’
=(
Æaddr
);

1704 
msg
.
msg_iov
=&
iov
;

1705 
msg
.
msg_iovËn
=1;

1706 
msg
.
msg_cÚŒŞ
=0;

1707 
msg
.
msg_cÚŒŞËn
=0;

1708 
msg
.
msg_æags
 = 
blockšg
 ? 0 : 
MSG_DONTWAIT
;

1710 
rc
 = 
	`sock_»cvmsg
(
sock
, &
msg
, 
couÁ
, msg.
msg_æags
);

1713 ià(
»Œy
 && 
rc
 =ğ-
EAGAIN
) {

1714 
	`DEBUGNETLINK
(
	`DPRINTF
(
CODEID
":„e-read‚etlink #1"));

1715 
	`£t_cu¼’t_¡©e
(
TASK_INTERRUPTIBLE
);

1716 
	`scheduË_timeout
(
HZ
/100);

1717 
rc
 = 
	`sock_»cvmsg
(
sock
, &
msg
, 
couÁ
, msg.
msg_æags
);

1719 ià(
»Œy
 && 
rc
 =ğ-
EAGAIN
) {

1720 
	`DEBUGNETLINK
(
	`DPRINTF
(
CODEID
":„e-read‚etlink #2"));

1721 
	`£t_cu¼’t_¡©e
(
TASK_INTERRUPTIBLE
);

1722 
	`scheduË_timeout
(
HZ
/10);

1723 
rc
 = 
	`sock_»cvmsg
(
sock
, &
msg
, 
couÁ
, msg.
msg_æags
);

1727  
rc
;

1728 
	}
}

1735 
	$»ad_Æ_msg
(
sock‘
 *
sock
, *
buf
, 
blockšg
,

1736 
»Œy
)

1737 { 
by‹s
;

1739 
	`mem£t
(
buf
, 0, 
NL_BUFSIZE
);

1740 
by‹s
 = 
	`Ãšk_»ad
(
sock
, (*è
buf
, 
NL_BUFSIZE
, 
blockšg
, 
»Œy
);

1741 ià(
by‹s
 < 0)

1742 { 
	`DEBUGNETLINK
(

1743 ià(
by‹s
 !ğ-
EAGAIN
)

1744 
	`DPRINTF
(
CODEID
":‚‘lšk„—d faed,„ø%d", -
by‹s
);

1746  
by‹s
;

1748 ià(
by‹s
 == 0) {

1749 
	`DEBUGNETLINK
(
	`DPRINTF
(
CODEID
": EOF,‚etlink socket closed"));

1750  -
EIO
;

1752  
by‹s
;

1753 
	}
}

1764 
	$»ad_¹Æ_»¥Ú£
(
ciı_Æsock_t
 *
Æsock
, 
ci_¹Æ_msg_hªdËr_t
 *
hf
,

1765 
ciıos_·r£_¡©e_t
 *
£ssiÚ
,

1766 
ci_po¡_hªdlšg_â_t
 *
po¡_hªdlšg_â
,

1767 * 
buf
)

1769 
rc
, 
by‹s
;

1770 
Æmsghdr
 *
Æhdr
;

1775 
rc
 = 
by‹s
 = 
	`»ad_Æ_msg
(
Æsock
->
sock
, 
buf
, 0, 1);

1776 ià(
rc
 < 0)

1777  
rc
;

1779 { 
Æhdr
 = (
Æmsghdr
 *)
buf
;

1780 
	`NLMSG_OK
(
Æhdr
, 
by‹s
)) {

1782 ià(
Æhdr
->
Æmsg_£q
 !ğ
Æsock
->
£q
) {

1784 
	`ci_log
("%s: Unsolicited‚etlink msg, msg_seq=%d,ƒxpected_seq=%d",

1785 
__FUNCTION__
, 
Æhdr
->
Æmsg_£q
, 
Æsock
->
£q
);

1787 } ià(
Æhdr
->
Æmsg_ty³
 =ğ
NLMSG_DONE
) {

1789 
rc
 = 0;

1790 
dÚe
;

1792 } ià(
Æhdr
->
Æmsg_ty³
 =ğ
NLMSG_NOOP
) {

1794 
	`DEBUGNETLINK
(
	`DPRINTF
(
CODEID
": ignoring NOOP‚etlink…acket"));

1796 } ià(
Æhdr
->
Æmsg_ty³
 =ğ
NLMSG_ERROR
) {

1797 
	`ci_log
(
CODEID
":‚etlinkƒrror…acket„eceived!");

1798  -
EIO
;

1802 ià((
rc
 = (*
hf
)(
£ssiÚ
, 
Æhdr
)) < 0) {

1803 
	`ci_log
(
CODEID
":‚etlink message handling function failed,„c=%d",

1804 
rc
);

1809 
Æhdr
 = 
	`NLMSG_NEXT
Òlhdr, 
by‹s
);

1815 
dÚe
:

1817 ià(
NULL
 !ğ
po¡_hªdlšg_â
)

1818 (*
po¡_hªdlšg_â
)(
£ssiÚ
);

1820  
rc
;

1821 
	}
}

1829 
ci_šlše
 

1830 
	$¹Æ_pŞl
(
sock‘
 *
sock
, 
ci_¹Æ_msg_hªdËr_t
 *
hf
,

1831 
ciıos_·r£_¡©e_t
 *
£ssiÚ
, * 
buf
)

1833 
rc
, 
by‹s
;

1834 
Æmsghdr
 *
Æhdr
 = (Æmsghd¸*è
buf
;

1837 
rc
 = 
by‹s
 = 
	`»ad_Æ_msg
(
sock
, 
buf
, 0, 0);

1838 ià(
rc
 < 0) {

1839 ià(
rc
 !ğ-
ERESTART
 &&„ø!ğ-
EAGAIN
)

1840 
	`ci_log
(
CODEID
": faedØ»ad‚‘lšk mes§gduršg…Şl,„c=%d", -
rc
);

1841  
rc
;

1844 
	`NLMSG_OK
(
Æhdr
, 
by‹s
)) {

1845 ià(
Æhdr
->
Æmsg_ty³
 =ğ
NLMSG_DONE
) {

1847 } ià(
Æhdr
->
Æmsg_ty³
 =ğ
NLMSG_NOOP
) {

1849 
	`DEBUGNETLINK
(
	`DPRINTF
(
CODEID
": ignoring NOOP‚etlink…acket in…oll"));

1850 } ià(
Æhdr
->
Æmsg_ty³
 =ğ
NLMSG_ERROR
) {

1851 
	`ci_log
(
CODEID
":‚etlinkƒrror…acket„eceived in…oll!");

1852  -
EIO
;

1855 ià((
rc
 = (*
hf
)(
£ssiÚ
, 
Æhdr
)) < 0)

1856 
	`ci_log
(
CODEID
": hªdlšg funùiÚ faed‡á”…Şl,„c=%d", -
rc
);

1858 
Æhdr
 = 
	`NLMSG_NEXT
Òlhdr, 
by‹s
);

1862 
	}
}

1886 #ià
CICPOS_USE_NETLINK


1893 
ciı_hªdË_t
 *
	mcÚŒŞ_¶ªe
;

1895 
	m¡İ
;

1896 } 
	tciıos_tim”_d©a_t
;

1901 
ciıos_tim”_d©a_t
 
	gciıos_tim”_d©a
;

1908 
tim”_li¡
 
	gciıos_tim”_node
;

1911 
sock‘
 *
	gNL_SOCKET
;

1917 
	gciıos_ruÂšg
 = 0;

1932 
	$eçb_Ãšk_pŞl_fÜ_upd©es
(
ciı_hªdË_t
 *
cÚŒŞ_¶ªe
, * 
buf
)

1934 
rc
;

1935 
ciıos_·r£_¡©e_t
 *
£ssiÚ
 = 
	`ciıos_·r£_¡©e_®loc
(
cÚŒŞ_¶ªe
);

1937 ifĞ
NULL
 =ğ
£ssiÚ
 )

1938 
rc
 = -
ENOMEM
;

1940 
	`ciıos_·r£_š™
(
£ssiÚ
, 
cÚŒŞ_¶ªe
);

1943 
rc
 = 
	`¹Æ_pŞl
(
NL_SOCKET
, &
ciıos_hªdË_¹Æ_msg
, 
£ssiÚ
, 
buf
);

1944  
rc
 == 0 );

1946 
	`ciıos_·r£_¡©e_ä“
(
£ssiÚ
);

1948  
rc
 =ğ-
EAGAIN
 ? 0 :„c;

1949 
	}
}

1956 
	$ciıos_wÜk”
(*
cÚ‹xt_ıÏÃ
)

1958 
couÁ
 = 0;

1959 
buf
[
NL_BUFSIZE
];

1961 ià(
ciıos_ruÂšg
)

1962 { 
ciı_hªdË_t
 *
cÚŒŞ_¶ªe
 = (ciı_hªdË_ˆ*)
cÚ‹xt_ıÏÃ
;

1963 
	`eçb_Ãšk_pŞl_fÜ_upd©es
(
cÚŒŞ_¶ªe
, 
buf
);

1964 ià(
couÁ
 % 2 == 0)

1965 
	`ciıos_dump_bËs
(
cÚŒŞ_¶ªe
, 
couÁ
%20, 
buf
);

1966 
couÁ
++;

1968 
	}
}

1976 
	$ciıos_tim”
(
š_d©a
)

1978 
ciıos_tim”_d©a_t
 *
d©­
 = (*è
š_d©a
;

1980 ià(! 
d©­
->
¡İ
) {

1981 
ci_wÜk™em_t
 
wi
 =

1982 
	`CI_WORKITEM_INITIALISER
(
wi
, (
CI_WITEM_ROUTINE
è&
ciıos_wÜk”
, 
NULL
);

1983 
	`CI_WORKITEM_SET_CONTEXT
(&
wi
, 
d©­
->
cÚŒŞ_¶ªe
);

1984 
	`ci_wÜkqueue_add
(&
CI_GLOBAL_WORKQUEUE
, &
wi
);

1986 
	`mod_tim”
(&
ciıos_tim”_node
, 
jiff›s
 + 
CICPOS_SCAN_INTERVAL
);

1988 
	}
}

1995 
	gcÚ¡ruùed
 = 
FALSE
;

2001 
	$ciıos_sync_ùÜ
(
ciı_hªdË_t
 *
cÚŒŞ_¶ªe
)

2002 { 
rc
;

2004 ià(
cÚ¡ruùed
)

2005 { 
	`ci_log
(
CODEID
": duplicate synchronizer construction detected!");

2006 
rc
 = 0;

2008 { 
cÚ¡ruùed
 = 
TRUE
;

2010 
	`DEBUGNETLINK
(
	`DPRINTF
(
CODEID
 ": constructing synchronizer"));

2014 
rc
 = 
	`ü—‹_li¡’šg_Ãšk_sock‘
(&
NL_SOCKET
);

2015 ià(
	`CI_LIKELY
(
rc
 >= 0)) {

2017 
ciıos_tim”_d©a
.
cÚŒŞ_¶ªe
 = control_plane;

2019 
ciıos_tim”_d©a
.
¡İ
 = 0;

2022 
	`š™_tim”
(&
ciıos_tim”_node
);

2023 
ciıos_tim”_node
.
expœes
 = 
jiff›s
 + 
CICPOS_SCAN_INTERVAL
;

2024 
ciıos_tim”_node
.
d©a
 = (è&
ciıos_tim”_d©a
;

2025 
ciıos_tim”_node
.
funùiÚ
 = &
ciıos_tim”
;

2032 
	`add_tim”
(&
ciıos_tim”_node
);

2034 
	`DEBUGNETLINK
(
	`DPRINTF
(
CODEID
": constructed"));

2035 
rc
 = 0;

2037 
	`ci_log
(
CODEID
": cª'ˆü—‹‚‘lšk sock‘,„c=%d.", 
rc
);

2039  
rc
;

2040 
	}
}

2048 
	$ciıos_sync_dtÜ
(
ciı_hªdË_t
 *
cÚŒŞ_¶ªe
)

2050 
	`DEBUGNETLINK
(
	`DPRINTF
(
CODEID
": destroying synchronizer"));

2052 ià(!
cÚ¡ruùed
)

2053 
	`ci_log
(
CODEID
": duplicate synchronizer destruction detected!");

2061 
ciıos_tim”_d©a
.
¡İ
 = 1;

2064 
	`DEBUGNETLINK
(
	`DPRINTF
("Deleting synchronizerimer"));

2075 
	`ci_v”ify
(
	`ci_wÜkqueue_æush
(&
CI_GLOBAL_WORKQUEUE
) == 0);

2076 
	`d–_tim”_sync
(&
ciıos_tim”_node
);

2077 
	`ci_v”ify
(
	`ci_wÜkqueue_æush
(&
CI_GLOBAL_WORKQUEUE
) == 0);

2080 
	`sock_»Ëa£
(
NL_SOCKET
);

2082 
	`DEBUGNETLINK
(
	`DPRINTF
(
CODEID
": synchronizer destroyed"));

2084 
	}
}

2091 
	#ciıos_sync_ùÜ
(
cÚŒŞ_¶ªe
è(0)

	)

2092 
	#ciıos_sync_dtÜ
(
cÚŒŞ_¶ªe
)

	)

2116 
	$ciıos_rou‹_kmib_row_ùÜ
(
ciıos_rou‹_row_t
 *
sync_row
)

2117 { 
	`ci_as£¹
(
NULL
 !ğ
sync_row
);

2119 
	`mem£t
(
sync_row
, 0, (*sync_row));

2120 
	}
}

2127 
	$ciıos_rou‹_kmib_row_upd©e
(
ciıos_rou‹_row_t
 *
sync_row
,

2128 cÚ¡ 
ciıos_rou‹_row_t
 *
sync_Ãwrow
)

2129 { 
chªged
;

2131 
	`ci_as£¹
(
NULL
 !ğ
sync_row
);

2133 ià(
NULL
 =ğ
sync_Ãwrow
)

2134 { 
chªged
 = 
FALSE
;

2135 
	`mem£t
(
sync_row
, 0, (*sync_row));

2137 { 
chªged
 = (0 !ğ
	`memcmp
(
sync_row
, 
sync_Ãwrow
, (*sync_row)));

2138 
	`memıy
(
sync_row
, 
sync_Ãwrow
, (*sync_row));

2141  
chªged
;

2142 
	}
}

2150 #ià
CICPOS_USE_NETLINK


2155 
ci_nošlše
 

2156 
	$ciıos_hªdË_rou‹_msg
(
ciıos_·r£_¡©e_t
 *
£ssiÚ
, 
Æmsghdr
 *
Æhdr
)

2157 { 
rc
 = 0;

2158 
¾’
 = 
	`RTM_PAYLOAD
(
Æhdr
);

2159 
¹msg
 *¹msg = (¹msg *)
	`NLMSG_DATA
(
Æhdr
);

2161 
¹©Œ
 *
©Œ
;

2162 
ci__addr_t
 
de¡_
;

2163 
ci__addr£t_t
 
de¡_£t
 = 
CI_IP_ADDRSET_BAD
;

2164 
ci__addr_t
 
Ãxt_hİ_
;

2165 
ci__addr_t
 
´ef_sourû
;

2166 
ci_ifid_t
 
ifšdex
 = 
CI_IFID_BAD
;

2167 
ciı_m‘ric_t
 
m‘ric
 = 1;

2168 
ci__tos_t
 
tos
 = 0;

2169 
ci_mtu_t
 
mtu
 = 0;

2170 
ignÜe
 = 0;

2172 
unsuµÜ‹d_´št_Úû
 = 0;

2173 
unsuµÜ‹d_m‘rics_´št_Úû
 = 0;

2175 
	`ci_as£¹
(
NULL
 !ğ
Æhdr
);

2176 
	`ci_as£¹
(
NULL
 !ğ
£ssiÚ
);

2177 
	`ci_as£¹_gt
(
¾’
, 0);

2178 
	`ci_as£¹
(
NULL
 !ğ
¹msg
);

2180 ià(
¹msg
->
¹m_çmy
 !ğ
PF_INET
)

2181 { 
	`DEBUGNETLINK
(
	`DPRINTF
(
CODEID
": ignoring‚on IPƒntry (fam=%x)",

2182 
¹msg
->
¹m_çmy
));

2188 ià(
¹msg
->
¹m_bË
 !ğ
RT_TABLE_MAIN
 &&

2189 
¹msg
->
¹m_bË
 !ğ
RT_TABLE_LOCAL
)

2192 
©Œ
 = (
¹©Œ
 *)
	`RTM_RTA
(
¹msg
);

2193 
	`ci_as£¹
(
NULL
 !ğ
©Œ
);

2195 
	`mem£t
(&
de¡_
, 0, (dest_ip));

2196 
	`mem£t
(&
´ef_sourû
, 0, (pref_source));

2197 
	`mem£t
(&
Ãxt_hİ_
, 0, (next_hop_ip));

2199 
	`RTA_OK
(
©Œ
, 
¾’
))

2201 
©Œ
->
¹a_ty³
)

2203 
RTA_DST
:

2204 
de¡_
 = *((
ci_ušt32
 *)
	`RTA_DATA
(
©Œ
));

2211 
RTA_OIF
:

2212 
ifšdex
 = *((*)
	`RTA_DATA
(
©Œ
));

2216 
RTA_GATEWAY
:

2217 
Ãxt_hİ_
 = *((
ci_ušt32
 *)
	`RTA_DATA
(
©Œ
));

2223 
RTA_PRIORITY
:

2226 
RTA_SRC
:

2227 
	`ci_as£¹
(
¹msg
->
¹m_æags
 & 
RTM_F_CLONED
);

2230 
RTA_PREFSRC
:

2231 
´ef_sourû
 = *((
ci_ušt32
 *)
	`RTA_DATA
(
©Œ
));

2237 
RTA_METRICS
: {

2238 
¹©Œ
 *
¹a
 = 
	`RTA_DATA
(
©Œ
);

2239 
Ën
 = 
	`RTA_PAYLOAD
(
©Œ
);

2240 
	`RTA_OK
(
¹a
, 
Ën
)) {

2241  
¹a
->
¹a_ty³
 ) {

2242 
RTAX_MTU
:

2243 
mtu
 = *((
ci_ušt32
 *)
	`RTA_DATA
(
¹a
));

2245 
	#RTAX_UNSUPPORTED_METRICS_PRINT_ONCE
(
¹ax
) \

2246 
¹ax
: \

2247 ifĞ~
unsuµÜ‹d_m‘rics_´št_Úû
 & (1 << 
¹ax
) ) { \

2248 
	`ci_log
(
CODEID
": ignoring "#rtax); \

2249 
unsuµÜ‹d_m‘rics_´št_Úû
 |ğ(1 << 
¹ax
); \

2251 

	)

2253 
	`RTAX_UNSUPPORTED_METRICS_PRINT_ONCE
(
RTAX_RTT
);

2254 
	`RTAX_UNSUPPORTED_METRICS_PRINT_ONCE
(
RTAX_RTTVAR
);

2255 
	`RTAX_UNSUPPORTED_METRICS_PRINT_ONCE
(
RTAX_SSTHRESH
);

2256 
	`RTAX_UNSUPPORTED_METRICS_PRINT_ONCE
(
RTAX_ADVMSS
);

2257 
	`RTAX_UNSUPPORTED_METRICS_PRINT_ONCE
(
RTAX_CWND
);

2258 
	`RTAX_UNSUPPORTED_METRICS_PRINT_ONCE
(
RTAX_HOPLIMIT
);

2259 
	`RTAX_UNSUPPORTED_METRICS_PRINT_ONCE
(
RTAX_REORDERING
);

2261 
	`RTAX_UNSUPPORTED_METRICS_PRINT_ONCE
(
RTAX_UNSPEC
);

2262 
	`RTAX_UNSUPPORTED_METRICS_PRINT_ONCE
(
RTAX_LOCK
);

2263 
	`RTAX_UNSUPPORTED_METRICS_PRINT_ONCE
(
RTAX_WINDOW
);

2264 
	`RTAX_UNSUPPORTED_METRICS_PRINT_ONCE
(
RTAX_INITCWND
);

2265 
	`RTAX_UNSUPPORTED_METRICS_PRINT_ONCE
(
RTAX_FEATURES
);

2266 #ifdeà
RTAX_RTO_MIN


2267 
	`RTAX_UNSUPPORTED_METRICS_PRINT_ONCE
(
RTAX_RTO_MIN
);

2269 #undeà
RTAX_UNSUPPORTED_METRICS_PRINT_ONCE


2271 
¹a
 = 
	`RTA_NEXT
Ô, 
Ën
);

2276 
RTA_CACHEINFO
: {

2281 
RTA_IIF
: {

2284 
ignÜe
 = 1;

2288 
	#RTA_UNSUPPORTED_PRINT_ONCE
(
¹a
) \

2289 
¹a
: \

2290 ifĞ~
unsuµÜ‹d_´št_Úû
 & (1 << 
¹a
) ) { \

2291 
	`ci_log
(
CODEID
": ignoring "#rta); \

2292 
unsuµÜ‹d_´št_Úû
 |ğ(1 << 
¹a
); \

2294 

	)

2296 
	`RTA_UNSUPPORTED_PRINT_ONCE
(
RTA_MULTIPATH
);

2297 
	`RTA_UNSUPPORTED_PRINT_ONCE
(
RTA_PROTOINFO
);

2298 
	`RTA_UNSUPPORTED_PRINT_ONCE
(
RTA_FLOW
);

2299 #undeà
RTA_UNSUPPORTED_PRINT_ONCE


2302 
	`DEBUGNETLINK
(
	`ci_log
Ğ
CODEID
": ignoring unknown„ta_type %d",

2303 
©Œ
->
¹a_ty³
));

2306 
©Œ
 = 
	`RTA_NEXT
×‰r, 
¾’
);

2309 
de¡_£t
 = 
¹msg
->
¹m_d¡_Ën
;

2310 
tos
 = 
¹msg
->
¹m_tos
;

2316 ià(
ignÜe
 ||

2317 (
¹msg
->
¹m_ty³
 =ğ
RTN_LOCAL
 && (¹msg->
¹m_æags
 & 
RTM_F_CLONED
))

2322 ià(
	`CI_UNLIKELY
(
¹msg
->
¹m_ty³
 !ğ
RTN_UNICAST
 &&

2323 !(
¹msg
->
¹m_ty³
 =ğ
RTN_LOCAL
 &&

2324 
de¡_£t
 == 32)))

2326 ià(
¹msg
->
¹m_bË
 !ğ
RT_TABLE_LOCAL
 &&

2327 !(
¹msg
->
¹m_æags
 & 
RTM_F_CLONED
))

2329 
	`ci_log
("%s: We only support unicastƒntries. "

2331 
__FUNCTION__
, 
¹msg
->
¹m_bË
,„tmsg->
¹m_ty³
,„tmsg->
¹m_æags
);

2332 
	`ci_log
("d¡=" 
CI_IP_PRINTF_FORMAT
 "/%u"

2333 " gw=" 
CI_IP_PRINTF_FORMAT


2334 " src=" 
CI_IP_PRINTF_FORMAT


2336 
	`CI_IP_PRINTF_ARGS
(&
de¡_
), 
de¡_£t
,

2337 
	`CI_IP_PRINTF_ARGS
(&
Ãxt_hİ_
),

2338 
	`CI_IP_PRINTF_ARGS
(&
´ef_sourû
),

2339 
tos
, 
ifšdex
);

2343 
ciıos_rou‹_row_t
 
sync
;

2344 
ci_scİe_t
 
scİe
;

2346 
	`mem£t
(&
sync
, 0, (sync));

2348 ià(
¹msg
->
¹m_scİe
 =ğ
RT_SCOPE_HOST
)

2349 
	`ci_scİe_£t_ho¡
(&
scİe
);

2351 
	`ci_scİe_£t_glob®
(&
scİe
);

2353 ifĞ(
¹msg
->
¹m_æags
 & 
RTM_F_CLONED
) ) {

2354 
rowid
;

2355 
	`ci_as£¹_equ®
(
de¡_£t
, 32);

2356 
	`ci_as£¹_equ®
(
Æhdr
->
Æmsg_ty³
, 
RTM_NEWROUTE
);

2357 
rowid
 = 
	`ciıos_pmtu_check
(
£ssiÚ
->
cÚŒŞ_¶ªe
,

2358 
de¡_
, 
ifšdex
, 
mtu
);

2359 ifĞ
rowid
 != -1 )

2360 
	`ci_b™£t_add
(
	`CI_BITSET_REF
(
£ssiÚ
->
impÜ‹d_pmtu
), 
rowid
);

2362 
ignÜe
 = 1;

2365 ià(
Æhdr
->
Æmsg_ty³
 =ğ
RTM_NEWROUTE
 && !
ignÜe
)

2366 { 
ciı_rou‹_rowid_t
 
rowid
;

2368 
rc
 = 
	`ciıos_rou‹_impÜt
(
£ssiÚ
-> 
cÚŒŞ_¶ªe
, &
rowid
,

2369 
de¡_
, 
de¡_£t
, 
scİe
,

2370 
Ãxt_hİ_
, 
tos
, 
m‘ric
,

2371 
´ef_sourû
, 
ifšdex
, 
mtu
,

2372 
mtu
 != 0 &&

2373 !(
¹msg
->
¹m_æags
 & 
RTM_F_CLONED
) ?

2374 
CICP_FLAG_ROUTE_MTU
 : 0,

2375 &
sync
, 
£ssiÚ
->
nosÜt
);

2377 ià(0 =ğ
rc
)

2378 { 
	`ci_as£¹
(
CICP_ROUTE_ROWID_BAD
 !ğ
rowid
);

2379 
	`ci_as£¹
(
rowid
 >= 0);

2380 
	`ci_b™£t_add
(
	`CI_BITSET_REF
(
£ssiÚ
->
impÜ‹d_rou‹
),

2381 
rowid
);

2384 
DEBUGNETLINK


2385 (
	`ci_log
(
CODEID
": ciıos_rou‹_impÜˆçed,„c=%d ", 
rc
));

2389 ifĞ
Æhdr
->
Æmsg_ty³
 =ğ
RTM_DELROUTE
 ) {

2390 
	`ciıos_rou‹_d–‘e
(
£ssiÚ
->
cÚŒŞ_¶ªe
, 
de¡_
,

2391 
de¡_£t
, 
ifšdex
);

2392 ià(
£ssiÚ
->
nosÜt
) {

2393 
£ssiÚ
->
nosÜt
 = 
CI_FALSE
;

2394 
	`DEBUGNETLINK
(
	`ci_log
("%s: delete„oute when dumping",

2395 
__FUNCTION__
));

2401  
rc
;

2402 
	}
}

2412 
ci_šlše
 

2413 
	$ciıos_dump_rou‹t
(
ciı_Æsock_t
 *
Æsock
,

2414 
ciıos_·r£_¡©e_t
 *
£ssiÚ
, *
buf
)

2415 { 
rc
;

2418 ià((
rc
 = 
	`»que¡_bË
(
Æsock
, 
RTM_GETROUTE
, 0, 
buf
)) < 0 )

2419 
	`ci_log
(
CODEID
":„outeable„equest "

2420 "çed,„ø%d", -
rc
);

2423 ià((
rc
 = 
	`»ad_¹Æ_»¥Ú£
(
Æsock
,

2424 &
ciıos_hªdË_rou‹_msg
,

2425 
£ssiÚ
,

2426 
NULL
,

2427 
buf
))

2429 
	`ci_log
(
CODEID
": failedo„ead„outeable from "

2430 "¹Ãšk,„ø%d", -
rc
);

2432  
rc
;

2433 
	}
}

2439 
ci_šlše
 

2440 
	$ciıos_dump_rou‹_ÿche
(
ciı_Æsock_t
 *
Æsock
,

2441 
ciıos_·r£_¡©e_t
 *
£ssiÚ
, *
buf
)

2442 { 
rc
;

2445 ià((
rc
 = 
	`»que¡_bË
(
Æsock
, 
RTM_GETROUTE
, 
RTM_F_CLONED
, 
buf
)) < 0 )

2446 
	`ci_log
(
CODEID
":„oute cacheable„equest "

2447 "çed,„ø%d", -
rc
);

2450 ià((
rc
 = 
	`»ad_¹Æ_»¥Ú£
(
Æsock
,

2451 &
ciıos_hªdË_rou‹_msg
,

2452 
£ssiÚ
,

2453 
NULL
,

2454 
buf
))

2456 
	`ci_log
(
CODEID
": failedo„ead„oute cacheable from "

2457 "¹Ãšk,„ø%d", -
rc
);

2459  
rc
;

2460 
	}
}

2465 
ci_šlše
 

2466 
	$ciıos_dump_pmtu_row
(
ciı_Æsock_t
 *
Æsock
, 
rowid
,

2467 
ciıos_·r£_¡©e_t
 *
£ssiÚ
, *
buf
)

2469 
rc
;

2470 
msghdr
 
msg
;

2471 
iovec
 
iov
;

2472 
ci__addr_Ãt_t
 
Ãt_
 = 
	`CICP_MIBS
(
£ssiÚ
->
cÚŒŞ_¶ªe
)->

2473 
pmtu_bË
->
’Œ›s
[
rowid
].
Ãt_
;

2474 
Æmsghdr
 *
Æhdr
 = (Æmsghd¸*è
buf
;

2475 
¹msg
 *
¹m
 = (*)(
Æhdr
+1);

2476 
¹©Œ
 *
¹a
;

2478 ifĞ
Ãt_
 =ğ
INADDR_ANY
 )

2481 
	`mem£t
(
buf
, 0, 
NL_BUFSIZE
);

2482 
Æhdr
->
Æmsg_ty³
 = 
RTM_GETROUTE
;

2483 
Æhdr
->
Æmsg_Ën
 = 
	`NLMSG_LENGTH
((
¹msg
));

2484 
Æhdr
->
Æmsg_æags
 = 
NLM_F_REQUEST
;

2485 
Æhdr
->
Æmsg_£q
 = ++
Æsock
->
£q
;

2486 
¹m
->
¹m_çmy
 = 
AF_INET
;

2487 
¹m
->
¹m_æags
 = 
RTM_F_CLONED
;

2488 
¹a
 = (*)(
¹m
+1);

2489 
¹a
->
¹a_ty³
 = 
RTA_DST
;

2490 
¹a
->
¹a_Ën
 = 
	`RTA_LENGTH
(4);

2491 
	`memıy
(
	`RTA_DATA
(
¹a
), &
Ãt_
, 4);

2492 
¹m
->
¹m_d¡_Ën
 = 32;

2493 
Æhdr
->
Æmsg_Ën
 = 
	`NLMSG_ALIGN
Òlhdr->Æmsg_Ënè+ 
	`RTA_LENGTH
(4);

2495 
iov
.
iov_ba£
 = (*)
buf
;

2496 
iov
.
iov_Ën
 = 
Æhdr
->
Æmsg_Ën
;

2497 
msg
.
msg_Çme
=
NULL
;

2498 
msg
.
msg_Çm–’
=0;

2499 
msg
.
msg_cÚŒŞËn
=0;

2500 
msg
.
msg_æags
=0;

2501 
msg
.
msg_iov
=&
iov
;

2502 
msg
.
msg_iovËn
=1;

2504 
rc
 = 
	`sock_£ndmsg
(
Æsock
->
sock
, &
msg
, 
Æhdr
->
Æmsg_Ën
);

2505 ifĞ
rc
 < 0 )

2508 
rc
 = 
	`»ad_¹Æ_»¥Ú£
(
Æsock
, &
ciıos_hªdË_rou‹_msg
,

2509 
£ssiÚ
, 
NULL
, 
buf
);

2510 
	}
}

2512 
ci_šlše
 

2513 
	$ciıos_dump_pmtu_ÿche
(
ciı_Æsock_t
 *
Æsock
,

2514 
ciıos_·r£_¡©e_t
 *
£ssiÚ
, *
buf
)

2516 
ciı_pmtu_kmib_t
 *
pmtu_bË
 =

2517 
	`CICP_MIBS
(
£ssiÚ
->
cÚŒŞ_¶ªe
)->
pmtu_bË
;

2518 
i
;

2519  
i
 = 0; i < 
pmtu_bË
->
u£d_rows_max
; i++)

2520 ifĞ
	`ciı_pmtu_row_®loÿ‹d
(&
pmtu_bË
->
’Œ›s
[
i
]) ) {

2521 
	`ciıos_dump_pmtu_row
(
Æsock
, 
i
, 
£ssiÚ
, 
buf
);

2523 
	}
}

2548 
	$ciıos_mac_kmib_row_ùÜ
(
ciıos_mac_row_t
 *
sync_row
,

2549 cÚ¡ 
ciıos_mac_row_sync_t
 *
os
)

2550 { 
	`ci_as£¹
(
NULL
 !ğ
sync_row
);

2552 
	`mem£t
(
sync_row
, 0, (*sync_row));

2554 
sync_row
->
m­pšg_£t
 = 0;

2556 ià(
NULL
 =ğ
os
)

2557 
sync_row
->
sourû_´Ù
 = 1;

2559 { 
	`memıy
(&
sync_row
->
os
, os, (sync_row->os));

2560 
sync_row
->
sourû_sync
 = 1;

2562 
	}
}

2572 
	$ciıos_mac_kmib_ùÜ
(
ciıos_mac_mib_t
 *
sync
)

2573 { 
	`ci_as£¹
(
NULL
 !ğ
sync
);

2575 
	}
}

2584 
	$ciıos_mac_kmib_dtÜ
(
ciıos_mac_mib_t
 *
sync
)

2585 { ()
sync
;

2587 
	`ci_v”ify
(
	`ci_wÜkqueue_æush
(&
CI_GLOBAL_WORKQUEUE
) == 0);

2588 
	}
}

2598 
	$ciıos_mac_kmib_row_upd©e
(
ciı_hªdË_t
 *
cÚŒŞ_¶ªe
,

2599 
ciıos_mac_row_t
 *
sync_row
, 
ciı_mac_row_t
 *
row
,

2600 cÚ¡ 
ciıos_mac_row_sync_t
 *
os
,

2601 cÚ¡ 
ci_mac_addr_t
 *
mac
,

2602 
®‹¿tiÚ
,

2603 *
out_ignÜe_şash
)

2605 
Ãwly_v®id
 = 
®‹¿tiÚ
;

2607 
	`ci_as£¹
(
NULL
 !ğ
sync_row
);

2608 *
out_ignÜe_şash
 = 0;

2619 ià(
os
 !ğ
NULL
 &&

2620 (
os
->
¡©e
 =ğ
CICPOS_IPMAC_INCOMPLETE
 ||

2621 
os
->
¡©e
 =ğ
CICPOS_IPMAC_NONE
))

2623 ià(
sync_row
->
sourû_sync
 && sync_row->
os
.
¡©e
 !ğ
CICPOS_IPMAC_FAILED
 &&

2624 
os
 =ğ
NULL
)

2626 ià(
os
 =ğ
NULL
 && !
sync_row
->
sourû_sync
 && 
®‹¿tiÚ
 &&

2627 !
	`CI_MAC_ADDR_EQ
(&
row
->
mac_addr
, 
mac
))

2631 ià(
os
 !ğ
NULL
 && 
sync_row
->
sourû_sync
)

2632 *
out_ignÜe_şash
 = 1;

2636 ià(
os
 !ğ
NULL
)

2637 { 
ci_ušt16
 
Üig_¡©e
 = 
sync_row
->
os
.
¡©e
;

2638 
	`memıy
(&
sync_row
->
os
, os, (sync_row->os));

2639 
sync_row
->
sourû_sync
 = 1;

2640 ià(
	`CI_UNLIKELY
(0!=(
sync_row
->
os
.
¡©e
 & 
CICPOS_IPMAC_NOARP
)))

2641 
row
->
rc
 = -
EINVAL
;

2642 ià(
	`CI_UNLIKELY
(0!=(
sync_row
->
os
.
¡©e
 & 
CICPOS_IPMAC_FAILED
)))

2643 
row
->
rc
 = -
EHOSTUNREACH
;

2645 
row
->
rc
 = 0;

2647 ià(
os
->
¡©e
 & 
CICPOS_IPMAC_STALE
) {

2648 ià(
row
->
Ãed_upd©e
 !ğ
CICP_MAC_ROW_NEED_UPDATE_STALE
) {

2649 
row
->
Ãed_upd©e
 = 
CICP_MAC_ROW_NEED_UPDATE_STALE
;

2650 
®‹¿tiÚ
 = 1; *
out_ignÜe_şash
 = 1;

2653 ià(
os
->
¡©e
 =ğ
CICPOS_IPMAC_REACHABLE
 &&

2654 
os
->
cÚfœmed
 > 
¬p_tbl
.
·rms
.
»achabË_time
 / 3 ) {

2659 ià(
row
->
Ãed_upd©e
 !ğ
CICP_MAC_ROW_NEED_UPDATE_SOON
) {

2660 
row
->
Ãed_upd©e
 = 
CICP_MAC_ROW_NEED_UPDATE_SOON
;

2661 
®‹¿tiÚ
 = 1; *
out_ignÜe_şash
 = 1;

2665 
row
->
Ãed_upd©e
 = 0;

2667 ià(0 !ğ(
sync_row
->
os
.
¡©e
 & 
CICPOS_IPMAC_REACHABLE
) &&

2668 
sync_row
->
os
.
¡©e
 !ğ
Üig_¡©e
)

2669 
Ãwly_v®id
 = 1;

2671 { 
sync_row
->
sourû_´Ù
 = 1;

2672 
sync_row
->
os
.
¡©e
 = 
CICPOS_IPMAC_REACHABLE
;

2673 
row
->
rc
 = 0;

2676 ià(
Ãwly_v®id
)

2677 { 
sync_row
->
m­pšg_£t
 = 
jiff›s
;

2681  
®‹¿tiÚ
;

2682 
	}
}

2691 
	$ciıos_mac_row_synûd
(
ciıos_mac_row_t
 *
row
)

2692 { 
row
->
»ûÁ_sync
 = 1;

2693 
	}
}

2707 
	$ciıos_mac_row_»ûÁ
(
ciıos_mac_row_t
 *
sync
)

2716 ifĞ!
sync
->
»ûÁ_sync
 )

2719 
sync
->
»ûÁ_sync
 = 0;

2721  
sync
->
sourû_sync
;

2722 
	}
}

2728 #ià
CICPOS_USE_NETLINK


2735 
ci_nošlše
 

2736 
	$ciıos_hªdË_mac_msg
(
ciıos_·r£_¡©e_t
 *
£ssiÚ
, 
Æmsghdr
 *
Æhdr
)

2737 { 
rc
 = 0;

2738 
¾’
 = 
	`NLMSG_PAYLOAD
(
Æhdr
, (
ndmsg
));

2739 
ndmsg
 *ndmsg = (ndmsg *)
	`NLMSG_DATA
(
Æhdr
);

2742 
ci_ifid_t
 
ifšdex
 = 
ndmsg
->
ndm_ifšdex
;

2744 
ciıos_mac_row_sync_t
 
os
;

2746 
ci_mac_addr_t
 
mac_addr
;

2747 
ci__addr_t
 
_addr
;

2748 
mac_v®id
 = 
FALSE
;

2749 
¹©Œ
 *
©Œ
 = (¹©Œ *)
	`NDA_RTA
(
ndmsg
);

2751 
	`ci_as£¹
(
NULL
 !ğ
Æhdr
);

2752 
	`ci_as£¹
(
NULL
 !ğ
£ssiÚ
);

2753 
	`ci_as£¹_gt
(
¾’
, 0);

2754 
	`ci_as£¹
(
NULL
 !ğ
ndmsg
);

2757 ià(
ndmsg
->
ndm_çmy
 !ğ
AF_INET
)

2758 { 
	`CICPOS_MAC_STAT_INC_NL_MSG_REJECT
(
£ssiÚ
->
cÚŒŞ_¶ªe
);

2763 
	`ci_as£¹
(
NULL
 !ğ
©Œ
);

2765 
	`mem£t
(&
mac_addr
, 0, (mac_addr));

2766 
	`mem£t
(&
_addr
, 0, (ip_addr));

2768 
	`mem£t
(&
os
, 0, (os));

2769 
os
.
çmy
 = 
ndmsg
->
ndm_çmy
;

2770 
os
.
¡©e
 = 
ndmsg
->
ndm_¡©e
;

2771 
os
.
æags
 = 
ndmsg
->
ndm_æags
;

2773 
	`RTA_OK
(
©Œ
, 
¾’
))

2775 
©Œ
->
¹a_ty³
)

2777 
NDA_DST
:

2778 
	`CI_IP_ADDR_SET
(&
_addr
, (cÚ¡ 
ci__addr_t
 *)
	`RTA_DATA
(
©Œ
));

2781 
NDA_LLADDR
:

2782 
	`CI_MAC_ADDR_SET
(&
mac_addr
,

2783 (cÚ¡ 
ci_mac_addr_t
 *)
	`RTA_DATA
(
©Œ
));

2784 
mac_v®id
 = 
TRUE
;

2787 
NDA_CACHEINFO
:

2788 { 
nda_ÿchešfo
 *
ÿchešfo
 =

2789 (
nda_ÿchešfo
 *)
	`RTA_DATA
(
©Œ
);

2792 #ià
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(2,6,26)

2793 
os
.
cÚfœmed
 = 
	`şock_t_to_jiff›s
(
ÿchešfo
->
ndm_cÚfœmed
);

2795 
os
.
cÚfœmed
 = 
ÿchešfo
->
ndm_cÚfœmed
;

2797 
os
.
u£d
 = 
ÿchešfo
->
ndm_u£d
;

2798 
os
.
upd©ed
 = 
ÿchešfo
->
ndm_upd©ed
;

2799 
os
.
»fút
 = 
ÿchešfo
->
ndm_»fút
;

2802 #ià
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(2,6,12)

2803 
NDA_PROBES
:

2811 
	`DEBUGNETLINK
(
	`ci_log
(

2813 
__FUNCTION__
, 
©Œ
->
¹a_ty³
));

2816 
©Œ
 = 
	`RTA_NEXT
×‰r, 
¾’
);

2819 ià(
rc
 != 0)

2820  
rc
;

2822 ià(
	`CI_UNLIKELY
(!
mac_v®id
 && (
os
.
¡©e
 & 
CICPOS_IPMAC_VALID
)))

2824 
	`ci_log
(
CODEID
": Linux volunteered‚o MAC‡ddress for "

2825 
CI_IP_PRINTF_FORMAT
" in state 0x%02x",

2826 
	`CI_IP_PRINTF_ARGS
(&
_addr
), 
os
.
¡©e
);

2828 { 
ciı_mib_v”šfo_t
 
rowšfo
;

2830 
rowšfo
.
row_v”siÚ
 = 
CI_VERLOCK_BAD
;

2831 
rowšfo
.
row_šdex
 = 
CICP_MAC_ROWID_BAD
;

2833 
	`ciıos_mac_£t
(
£ssiÚ
->
cÚŒŞ_¶ªe
, &
rowšfo
, 
ifšdex
, 
_addr
,

2834 (cÚ¡ 
ci_mac_addr_t
 *)&
mac_addr
, &
os
);

2836 ià(
CICP_MAC_ROWID_BAD
 !ğ
rowšfo
.
row_šdex
)

2837 
	`ciıos_mac_row_£’
(
£ssiÚ
->
cÚŒŞ_¶ªe
, &
rowšfo
);

2840  
rc
;

2841 
	}
}

2853 
	$ciıos_mac_po¡_pŞl
(
ciıos_·r£_¡©e_t
 *
£ssiÚ
)

2854 { 
	`ciıos_mac_purge_un£’
(
£ssiÚ
->
cÚŒŞ_¶ªe
);

2855 
	}
}

2862 
ci_šlše
 

2863 
	$ciıos_dump_maù
(
ciı_Æsock_t
 *
Æsock
,

2864 
ciıos_·r£_¡©e_t
 *
£ssiÚ
, *
buf
)

2865 { 
rc
;

2867 ià(
	`ciıos_maù_İ’
(
£ssiÚ
->
cÚŒŞ_¶ªe
))

2869 ià((
rc
 = 
	`»que¡_bË
(
Æsock
, 
RTM_GETNEIGH
, 0, 
buf
)) < 0)

2870 
	`ci_log
(
CODEID
":‡½abË„eque¡ faed,„ø%d", 
rc
);

2873 ià((
rc
 = 
	`»ad_¹Æ_»¥Ú£
(
Æsock
,

2874 &
ciıos_hªdË_mac_msg
,

2875 
£ssiÚ
,

2876 &
ciıos_mac_po¡_pŞl
,

2877 
buf
)) < 0)

2878 { 
	`DEBUGNETLINK
(
	`DPRINTF
(
CODEID
":„eading of‡rpable from "

2879 "¹Ãšk faed,„ø%d", -
rc
));

2882 
	`ciıos_maù_şo£
(
£ssiÚ
->
cÚŒŞ_¶ªe
);

2884 { 
	`DEBUGNETLINK
(
	`DPRINTF
(
CODEID
": IP-MAC mappings‡lready "

2886 
rc
 = -
EALREADY
;

2889  
rc
;

2890 
	}
}

2922 
	$ciıos_Î­_kmib_row_ùÜ
(
ciıos_Î­_row_t
 *
row
)

2924 
	`ci_as£¹
(
NULL
 !ğ
row
);

2925 
	}
}

2930 #ià
CICPOS_USE_NETLINK


2935 
ci_nošlše
 

2936 
	$ciıos_hªdË_Î­_msg
(
ciıos_·r£_¡©e_t
 *
£ssiÚ
, 
Æmsghdr
 *
Æhdr
)

2937 { 
rc
 = 0;

2938 
¾’
 = 
	`RTM_PAYLOAD
(
Æhdr
);

2939 
ifšfomsg
 *ifšfomsg = (ifšfomsg *)
	`NLMSG_DATA
(
Æhdr
);

2941 
¹©Œ
 *
©Œ
;

2942 
ci_ušt8
 
add
;

2943 
ci_ušt8
 
up
;

2944 
ci_mtu_t
 
mtu
 = 0;

2945 
Çme
[
CICP_LLAP_NAME_MAX
+1];

2946 
ci_mac_addr_t
 
mac
;

2947 
ciıos_Î­_row_t
 
sync
;

2949 
	`ci_as£¹
(
NULL
 !ğ
Æhdr
);

2950 
	`ci_as£¹
(
NULL
 !ğ
£ssiÚ
);

2951 
	`ci_as£¹_gt
(
¾’
, 0);

2952 
	`ci_as£¹
(
NULL
 !ğ
ifšfomsg
);

2955 ià(
ifšfomsg
->
ifi_ty³
 !ğ
ARPHRD_ETHER
)

2960 
©Œ
 = (
¹©Œ
 *)
	`IFLA_RTA
(
ifšfomsg
);

2961 
add
 = (
Æhdr
->
Æmsg_ty³
 =ğ
RTM_NEWLINK
);

2962 
up
 = (0 !ğ(
ifšfomsg
->
ifi_æags
 & 
IFF_UP
));

2964 
	`mem£t
(&
Çme
, 0, (name));

2965 
	`mem£t
(&
mac
, 0, (mac));

2966 
	`mem£t
(&
sync
, 0, (sync));

2969 
	`CI_TRACE
(
ifšfomsg
->
ifi_çmy
, "%d");

2971 
	`CI_TRACE
(
ifšfomsg
->
__ifi_·d
, "%d");

2972 
	`CI_TRACE
(
ifšfomsg
->
ifi_ty³
, "%d");

2973 
	`CI_TRACE
(
ifšfomsg
->
ifi_šdex
, "%d");

2974 
	`CI_TRACE
(
ifšfomsg
->
ifi_æags
, "0x%X");

2975 
	`CI_TRACE
(
ifšfomsg
->
ifi_chªge
, "%d");

2978 
	`ci_as£¹
(
add
 || (
Æhdr
->
Æmsg_ty³
 =ğ
RTM_DELLINK
));

2979 
	`ci_as£¹
(
NULL
 !ğ
©Œ
);

2981 
	`RTA_OK
(
©Œ
, 
¾’
))

2983 
©Œ
->
¹a_ty³
)

2985 
IFLA_UNSPEC
:

2988 
IFLA_ADDRESS
:

2989 
	`CI_MAC_ADDR_SET
(&
mac
, 
	`RTA_DATA
(
©Œ
));

2992 
IFLA_IFNAME
:

2993 
	`memıy
(&
Çme
, 
	`RTA_DATA
(
©Œ
), (name));

2996 
IFLA_MTU
:

2997 
mtu
 = (
ci_mtu_t
è*((*)
	`RTA_DATA
(
©Œ
));

3000 
IFLA_BROADCAST
:

3001 
IFLA_LINK
:

3002 
IFLA_QDISC
:

3003 
IFLA_STATS
:

3004 
IFLA_PRIORITY
:

3005 
IFLA_MASTER
:

3006 #ifdeà
IFLA_WIRELESS


3007 
IFLA_WIRELESS
:

3012 
	`DEBUGNETLINK
(
	`ci_log
("%s: Ignoring„ta_type %d",

3013 
__FUNCTION__
, 
©Œ
->
¹a_ty³
));

3016 
©Œ
 = 
	`RTA_NEXT
×‰r, 
¾’
);

3020 
	`ci_log
("%3d: % "
CI_MAC_PRINTF_FORMAT
" mtu=%u‚ame=%s",

3021 
ifšfomsg
->
ifi_šdex
, 
up
 ? " UP " : "DOWN",

3022 
	`CI_MAC_PRINTF_ARGS
(&
mac
), 
mtu
, 
Çme
);

3025 ià(
add
)

3026 { 
ciı_Î­_rowid_t
 
rowid
;

3028 
rc
 = 
	`ciıos_Î­_impÜt
(
£ssiÚ
->
cÚŒŞ_¶ªe
, &
rowid
,

3029 
ifšfomsg
->
ifi_šdex
,

3030 
mtu
, 
up
, &
Çme
[0], &
mac
, &
sync
);

3033 ià(0 =ğ
rc
)

3034 { 
	`ci_as£¹
(
CICP_LLAP_ROWID_BAD
 !ğ
rowid
);

3035 
	`ci_as£¹
(
rowid
 >= 0);

3036 
	`ci_b™£t_add
(
	`CI_BITSET_REF
(
£ssiÚ
->
impÜ‹d_Î­
), 
rowid
);

3040 
	`ciıos_Î­_d–‘e
(
£ssiÚ
->
cÚŒŞ_¶ªe
, 
ifšfomsg
->
ifi_šdex
);

3041 ià(
£ssiÚ
->
nosÜt
) {

3042 
£ssiÚ
->
nosÜt
 = 
CI_FALSE
;

3043 
	`DEBUGNETLINK
(
	`ci_log
("%s: delete LLAPƒntry when dumping",

3044 
__FUNCTION__
));

3050  
rc
;

3051 
	}
}

3058 
ci_šlše
 

3059 
	$ciıos_dump_Î­t
(
ciı_Æsock_t
 *
Æsock
,

3060 
ciıos_·r£_¡©e_t
 *
£ssiÚ
, *
buf
)

3061 { 
rc
;

3064 ià((
rc
 = 
	`»que¡_bË
(
Æsock
, 
RTM_GETLINK
, 0, 
buf
)) < 0 )

3065 
	`ci_log
(
CODEID
":„outeable„equest "

3066 "çed,„ø%d", -
rc
);

3069 ià((
rc
 = 
	`»ad_¹Æ_»¥Ú£
(
Æsock
,

3070 &
ciıos_hªdË_Î­_msg
,

3071 
£ssiÚ
,

3072 &
ciıos_Î­_po¡_pŞl
,

3073 
buf
))

3075 
	`ci_log
(
CODEID
": failedo„ead†inksable from "

3076 "¹Ãšk,„ø%d", -
rc
);

3078  
rc
;

3079 
	}
}

3107 #ià
CICPOS_USE_NETLINK


3110 
ci_nošlše
 

3111 
	$ciıos_hªdË_if_msg
(
ciıos_·r£_¡©e_t
 *
£ssiÚ
, 
Æmsghdr
 *
Æhdr
)

3112 { 
rc
 = 0;

3114 
¾’
 = 
	`NLMSG_PAYLOAD
(
Æhdr
, (
içddrmsg
));

3115 
içddrmsg
 *
ifmsg
 = (içddrmsg *)
	`NLMSG_DATA
(
Æhdr
);

3117 
¹©Œ
 *
©Œ
;

3118 
add
;

3120 
ci_ifid_t
 
ifšdex
;

3121 
ci__addr_Ãt_t
 
Ãt_
;

3122 
ci__addr£t_t
 
Ãt_£t
;

3123 
ci__addr_Ãt_t
 
Ãt_bÿ¡
;

3124 
Çme
[
IFNAMSIZ
];

3126 
	`ci_as£¹
(
NULL
 !ğ
Æhdr
);

3127 
	`ci_as£¹
(
NULL
 !ğ
£ssiÚ
);

3128 
	`ci_as£¹_gt
(
¾’
, 0);

3129 
	`ci_as£¹
(
NULL
 !ğ
ifmsg
);

3131 ià(
ifmsg
->
iç_çmy
 !ğ
AF_INET
)

3132 { 
	`DEBUGNETLINK
(
	`DPRINTF
("%s: ignÜšg‚Ú IPƒÁry", 
__FUNCTION__
));

3136 
©Œ
 = (
¹©Œ
 *)
	`IFA_RTA
(
ifmsg
);

3137 
ifšdex
 = 
ifmsg
->
iç_šdex
;

3138 
Ãt_£t
 = 
ifmsg
->
iç_´efixËn
;

3140 
	`mem£t
(&
Ãt_
, 0, (net_ip));

3141 
	`mem£t
(&
Ãt_bÿ¡
, 0, (net_bcast));

3142 
	`mem£t
(&
Çme
, 0, (name));

3144 
	`ci_as£¹
(
NULL
 !ğ
©Œ
);

3146 
	`RTA_OK
(
©Œ
, 
¾’
))

3147 { 
©Œ
->
¹a_ty³
)

3148 { 
IFA_ADDRESS
:

3159 
IFA_LOCAL
:

3160 
	`CI_IP_ADDR_SET
(&
Ãt_
, (
ci_ušt32
 *è
	`RTA_DATA
(
©Œ
));

3163 
IFA_LABEL
:

3164 
	`mem£t
(
Çme
, 0, (name));

3165 
	`memıy
(
Çme
, 
	`RTA_DATA
(
©Œ
),

3166 
	`CI_MIN
(
IFNAMSIZ
, (
Çme
)));

3169 
IFA_BROADCAST
:

3170 
	`CI_IP_ADDR_SET
(&
Ãt_bÿ¡
,(
ci_ušt32
 *)
	`RTA_DATA
(
©Œ
));

3173 
IFA_ANYCAST
:

3174 
	`ci_log
("Ignoring IFA_ANYCAST");

3177 
IFA_CACHEINFO
:

3186 
	`DEBUGNETLINK
(
	`ci_log
("%s: Ignoring„ta_type %d",

3187 
__FUNCTION__
, 
©Œ
->
¹a_ty³
));

3190 
©Œ
 = 
	`RTA_NEXT
×‰r, 
¾’
);

3193 
add
 = (
Æhdr
->
Æmsg_ty³
 =ğ
RTM_NEWADDR
);

3194 
	`ci_as£¹
(
add
 || 
Æhdr
->
Æmsg_ty³
 =ğ
RTM_DELADDR
);

3197 ià(
add
)

3198 { 
ciı_if_rowid_t
 
rowid
;

3199 
rc
 = 
	`ciıos_if_impÜt
(
£ssiÚ
->
cÚŒŞ_¶ªe
, &
rowid
,

3200 
ifšdex
, 
Ãt_
, 
Ãt_£t
, 
Ãt_bÿ¡
,

3201 
ifmsg
->
iç_scİe
);

3203 ià(0 =ğ
rc
)

3204 { 
	`ci_as£¹
(
CICP_IPIF_ROWID_BAD
 !ğ
rowid
);

3205 
	`ci_as£¹
(
rowid
 >= 0);

3206 
	`ci_b™£t_add
(
	`CI_BITSET_REF
(
£ssiÚ
->
impÜ‹d_if
), 
rowid
);

3209 
	`ci_log
("%s: ciıos_if_impÜˆçed,„c=%d", 
__FUNCTION__
, 
rc
);

3211 
	`ciıos_if_d–‘e
(
£ssiÚ
->
cÚŒŞ_¶ªe
, 
ifšdex
, 
Ãt_
, 
Ãt_£t
);

3212 ià(
£ssiÚ
->
nosÜt
) {

3213 
£ssiÚ
->
nosÜt
 = 
CI_FALSE
;

3214 
	`DEBUGNETLINK
(
	`ci_log
("%s: delete interface when dumping",

3215 
__FUNCTION__
));

3221  
rc
;

3222 
	}
}

3228 
ci_šlše
 

3229 
	$ciıos_dump_iá
(
ciı_Æsock_t
 *
Æsock
,

3230 
ciıos_·r£_¡©e_t
 *
£ssiÚ
, *
buf
)

3231 { 
rc
;

3234 ià((
rc
 = 
	`»que¡_bË
(
Æsock
, 
RTM_GETADDR
, 0, 
buf
)) < 0 )

3235 
	`ci_log
(
CODEID
": ip interface†ist„equest "

3236 "çed,„ø%d", -
rc
);

3239 ià((
rc
 = 
	`»ad_¹Æ_»¥Ú£
(
Æsock
,

3240 &
ciıos_hªdË_if_msg
,

3241 
£ssiÚ
,

3242 &
ciıos_if_po¡_pŞl
,

3243 
buf
)) < 0)

3244 
	`ci_log
(
CODEID
":„eading of IP i/f†ist from„tnetlink "

3245 "çed,„ø%d", -
rc
);

3247  
rc
;

3248 
	}
}

3279 #ià
CICPOS_USE_NETLINK


3287 
	$ciıos_hªdË_¹Æ_msg
(
ciıos_·r£_¡©e_t
 *
£ssiÚ
, 
Æmsghdr
 *
Æhdr
)

3289 
Æhdr
->
Æmsg_ty³
)

3291 
RTM_NEWNEIGH
:

3292 
RTM_DELNEIGH
:

3294 ià(
	`CI_UNLIKELY
(
Æhdr
->
Æmsg_ty³
 !ğ
RTM_NEWNEIGH
))

3295 { 
	`CICPOS_MAC_STAT_INC_NL_MSG_REJECT
(
£ssiÚ
->
cÚŒŞ_¶ªe
);

3296 
	`CICP_LOG
(
	`DPRINTF
("%s:‚lmsg_type isn't RTM_NEWNEIGH, "

3298 
__FUNCTION__
, 
Æhdr
->
Æmsg_ty³
));

3300  
	`ciıos_hªdË_mac_msg
(
£ssiÚ
, 
Æhdr
);

3302 
RTM_NEWADDR
:

3303 
RTM_DELADDR
:

3304 
	`ci_as£¹
(
NULL
 !ğ
£ssiÚ
->
impÜ‹d_if
);

3305  
	`ciıos_hªdË_if_msg
(
£ssiÚ
, 
Æhdr
);

3307 
RTM_NEWROUTE
:

3308 
RTM_DELROUTE
:

3309 
	`ci_as£¹
(
NULL
 !ğ
£ssiÚ
->
impÜ‹d_rou‹
);

3310  
	`ciıos_hªdË_rou‹_msg
(
£ssiÚ
, 
Æhdr
);

3312 
RTM_NEWLINK
:

3313 
RTM_DELLINK
:

3314 
	`ci_as£¹
(
NULL
 !ğ
£ssiÚ
->
impÜ‹d_Î­
);

3315  
	`ciıos_hªdË_Î­_msg
(
£ssiÚ
, 
Æhdr
);

3318 
	`ci_log
(
CODEID
": unhandled‚etlink messageype (%d) - "

3320 
Æhdr
->
Æmsg_ty³
);

3321  -
EINVAL
;

3323 
	}
}

3332 
	$ciıos_dump_bËs
(
ciı_hªdË_t
 *
cÚŒŞ_¶ªe
, 
mac_Úly
,

3333 *
buf
)

3334 { 
rc
;

3335 
ciıos_·r£_¡©e_t
 *
£ssiÚ
;

3336 
ciı_Æsock_t
 
Æsock
 = {

3337 .
sock
 = 
NULL
,

3338 .
£q
 = 1

3341 
£ssiÚ
 = 
	`ciıos_·r£_¡©e_®loc
(
cÚŒŞ_¶ªe
);

3343 ià(
NULL
 =ğ
£ssiÚ
)

3344 { 
	`DEBUGNETLINK
(
	`DPRINTF
(
CODEID
": (systemable„equest "

3349 
	`ciıos_·r£_š™
(
£ssiÚ
, 
cÚŒŞ_¶ªe
);

3350 
	`CICPOS_MAC_STAT_SET_POLLER_LAST_START
(
cÚŒŞ_¶ªe
);

3353 ià((
rc
 = 
	`ü—‹_Ãšk_sock‘
(&
Æsock
.
sock
)) < 0 )

3354 { 
	`ci_log
(
CODEID
": faedØü—‹‚‘lšk sock‘„ø%d", 
rc
);

3355 
	`kä“
(
£ssiÚ
);

3361 ià(!
mac_Úly
)

3362 { 
£ssiÚ
->
nosÜt
 = 
CI_TRUE
;

3365 
	`ciıos_dump_iá
(&
Æsock
, 
£ssiÚ
, 
buf
);

3366 
	`ciıos_dump_Î­t
(&
Æsock
, 
£ssiÚ
, 
buf
);

3367 
	`ciıos_dump_rou‹t
(&
Æsock
, 
£ssiÚ
, 
buf
);

3371 
	`ciıos_dump_pmtu_ÿche
(&
Æsock
, 
£ssiÚ
, 
buf
);

3372 
	`ciıos_dump_rou‹_ÿche
(&
Æsock
, 
£ssiÚ
, 
buf
);

3373 
	`ciıos_rou‹_po¡_pŞl
(
£ssiÚ
);

3377 
	`ciıos_dump_maù
(&
Æsock
, 
£ssiÚ
, 
buf
);

3379 
	`sock_»Ëa£
(
Æsock
.
sock
);

3381 
	`CICPOS_MAC_STAT_SET_POLLER_LAST_END
(
cÚŒŞ_¶ªe
);

3383 
	`ciıos_·r£_¡©e_ä“
(
£ssiÚ
);

3384 
	}
}

3400 
	$ciıos_ùÜ
(
ciı_mibs_k”n_t
 *
cÚŒŞ_¶ªe
)

3401 { 
	`ciıos_´ocfs_ùÜ
(
cÚŒŞ_¶ªe
);

3402  
	`ciıos_sync_ùÜ
(
cÚŒŞ_¶ªe
);

3403 
	}
}

3410 
	$ciıos_hw_»gi¡”ed
(
ciı_hªdË_t
 *
cÚŒŞ_¶ªe
)

3413 
	}
}

3420 
	$ciıos_dtÜ
(
ciı_mibs_k”n_t
 *
cÚŒŞ_¶ªe
)

3421 { 
	`ciıos_´ocfs_dtÜ
(
cÚŒŞ_¶ªe
);

3422 
	`ciıos_sync_dtÜ
(
cÚŒŞ_¶ªe
);

3423 
	}
}

3429 
	$ciıos_sync_bËs
(
ciı_hªdË_t
 *
cÚŒŞ_¶ªe
)

3431 *
buf
;

3436 
mm_£gm’t_t
 
fs
 = 
	`g‘_fs
();

3437 
	`£t_fs
(
	`g‘_ds
());

3439 
buf
 = 
	`ci_®loc
(
NL_BUFSIZE
);

3441 ifĞ
buf
 ) {

3443 
	`ciıos_dump_bËs
(
cÚŒŞ_¶ªe
, 0, 
buf
);

3444 
	`ci_ä“
(
buf
);

3447 
	`£t_fs
(
fs
);

3448 
	}
}

	@linux_efabcfg.c

13 
	~<Úlßd/eçbcfg.h
>

16 cÚ¡ * 
	$ci_cfg_´oc_Çme_g‘
(**
poš‹r_to_ä“
)

18 *
cmd
;

19 
cmd_Ën
;

20 cÚ¡ *
p
;

22 
cmd_Ën
 = 
cu¼’t
->
mm
->
¬g_’d
 - cu¼’t->mm->
¬g_¡¬t
;

23 
cmd
 = 
	`ci_®loc
(
cmd_Ën
+1);

24 ifĞ
cmd
 =ğ
NULL
 )

25  
NULL
;

27 ifĞ
	`cİy_äom_u£r
(
cmd
, (cÚ¡ *)(
cu¼’t
->
mm
->
¬g_¡¬t
),

28 
cmd_Ën
) != 0 ) {

29 
	`ci_ä“
(
cmd
);

30  
NULL
;

33 *
poš‹r_to_ä“
 = 
cmd
;

34 
cmd
[
cmd_Ën
] = '\0';

35 
p
 = 
	`¡¼chr
(
cmd
, '/');

41 ià(
p
 =ğ
NULL
)

42 
p
 = 
cmd
;

44 
p
++;

63 
	`ci_log
("cu¼’t->comm=%s", (*)
cu¼’t
->
comm
);

64 
	`ci_log
("cu¼’t->mm->¬g_¡¬t=%s", (*)
cmd
);

66  
p
;

67 
	}
}

70 
ci_cfg_uid_t
 
	$ci_cfg_uid_g‘
()

72 #ià
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(2,6,28)

73  (
cu¼’t
->
euid
);

74 #–ià
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(3,5,0)

75  
	`cu¼’t_euid
();

77  
	`__kuid_v®
(
	`cu¼’t_euid
());

79 
	}
}

82 
	$ci_cfg_is_sy§dmš
()

85  
	`ÿ·bË
(
CAP_SYS_ADMIN
);

86 
	}
}

	@linux_sock_ops.c

21 
	~<ci/driv”/š‹º®.h
>

22 
	~<Úlßd/lšux_sock_İs.h
>

32 
	$eçb_lšux_dump_šode
(
fd
)

34 
fe
 *
fp
;

35 
fp
 = 
	`fg‘
(
fd
);

36 ià(
fp
 && fp->
f_d’Œy
) {

37 
šode
 *šodğ
fp
->
f_d’Œy
->
d_šode
;

39 
	`ci_log
("dum°šode: fd %d => fp=%°-> d’Œy %p", 
fd
, 
fp
,

40 
fp
->
f_d’Œy
);

41 
	`ci_log
(" inod© %p", 
šode
);

42 
	`ci_log
(" i_ino=%lu i_rdev=%08x",

43 
šode
->
i_šo
, inode->
i_rdev
);

44 
	`ci_log
(" i_op=%p i_fop=%p i_sb=%p i_state=%08lx",

45 
šode
->
i_İ
, inode->
i_fİ
, inode->
i_sb
, inode->
i_¡©e
);

48 
i
;

49 
i
 = 
	`off£tof
(
šode
, 
u
); i < (inode); i+=4) {

50 
	`ci_log
("‡ˆ%d: %08lx", 
i
, *((*)(((*)
šode
)+i)));

54 
	`åut
(
fp
);

56 
	`ci_log
("dump_šode: couldn'ˆg‘ sŒuù ffÜ fd %d", 
fd
);

59 
	}
}

	@linux_stats.c

22 
	#__ci_driv”_sh–l__


	)

30 
	~"Úlßd_š‹º®.h
"

31 
	~<Úlßd/lšux_Úlßd_š‹º®.h
>

32 
	~<Úlßd/tı_h–³r_âs.h
>

33 
	~<Úlßd/tı_driv”.h
>

34 
	~<ci/š‹º®/.h
>

35 
	~<ci/š‹º®/_log.h
>

37 
	~<Úlßd/ıÏÃ.h
>

38 
	~<ci/š‹º®/.h
>

39 
	~<Úlßd/eçbcfg.h
>

40 
	~<Úlßd/v”siÚ.h
>

41 
	~<Úlßd/driv”lšk_f‹r.h
>

43 
	~<Ãt/tı.h
>

44 
	~<Ãt/udp.h
>

45 
	~<lšux/´oc_fs.h
>

46 
	~<lšux/moduË.h
>

47 
	~"../lšux_»sourû/k”Ãl_com·t.h
"

50 #undeà
LOG_STATS


51 
	#LOG_STATS
(
x
è
	)
x

63 
	#CI_LINUX_STATISTICS_UPDATE_FREQUENCY
 1

	)

67 
´oc_dœ_’Œy
 *
	goo_´oc_roÙ
 = 
NULL
;

76 cÚ¡ 
fe_İ”©iÚs
 
	geçb_wÜkq_fİs
;

77 cÚ¡ 
fe_İ”©iÚs
 
	geçb_v”siÚ_fİs
;

78 cÚ¡ 
fe_İ”©iÚs
 
	geçb_dlf‹rs_fİs
;

87 
	sci_´oc_eçb_’Œy_s
 {

88 *
	mÇme
;

89 cÚ¡ 
fe_İ”©iÚs
 *
	mfİs
;

90 } 
	tci_´oc_eçb_’Œy_t
;

91 
ci_´oc_eçb_’Œy_t
 
	gci_´oc_eçb_bË
[] = {

92 {"ıÏÃ", &
ciı_¡©_fİs
},

93 {"wÜkqueue", &
eçb_wÜkq_fİs
},

94 {"v”siÚ", &
eçb_v”siÚ_fİs
},

95 {"dlf‹rs", &
eçb_dlf‹rs_fİs
},

98 
	#CI_PROC_EFAB_TABLE_SIZE
 \

99 ((
ci_´oc_eçb_bË
è/ (
ci_´oc_eçb_’Œy_t
))

	)

103 
ci__¡©s
 
	gci__¡©s_glob®
;

112 
	$ci__¡©s_upd©e_glob®
(
ci__¡©s
 *
¡©s
) {

113 
	`ci_as£¹
(
¡©s
);

114 
	`ci__¡©s_upd©e
(&
ci__¡©s_glob®
, 
¡©s
);

115 
	}
}

116 
EXPORT_SYMBOL
(
ci__¡©s_upd©e_glob®
);

127 
	$eçb_wÜkq_»ad_´oc
(
£q_fe
 *
£q
, *
s
)

129 
ci_œqlock_¡©e_t
 
lock_æags
;

130 
ci_wÜkqueue_t
 *
wqueue
;

131 
wqueue
 = &
CI_GLOBAL_WORKQUEUE
;

132 
	`ci_œqlock_lock
(&
wqueue
->
lock
, &
lock_æags
);

133 ià(
wqueue
->
¡©e
 =ğ
CI_WQ_ALIVE
) {

134 
	#EFAB_WORKQ_READ_PROC_PRINT
(
v
) \

135 
	`£q_´štf
(
£q
, "%14 ğ%u\n", #v, 
wqueue
->
¡©s
.
v
)

	)

136 
	`EFAB_WORKQ_READ_PROC_PRINT
(
wÜkšg
);

137 
	`EFAB_WORKQ_READ_PROC_PRINT
(
™”
);

138 
	`EFAB_WORKQ_READ_PROC_PRINT
(
backlog
);

139 
	`EFAB_WORKQ_READ_PROC_PRINT
(
¡¬‹d
);

140 #undeà
EFAB_WORKQ_READ_PROC_PRINT


143 
	`£q_´štf
(
£q
, "The workqueue is‚ot„unning.\n");

145 
	`ci_œqlock_uÆock
(&
wqueue
->
lock
, &
lock_æags
);

148 
	}
}

149 
	$eçb_wÜkq_İ’_´oc
(
šode
 *šode, 
fe
 *file)

151  
	`sšgË_İ’
(
fe
, 
eçb_wÜkq_»ad_´oc
, 0);

152 
	}
}

153 cÚ¡ 
fe_İ”©iÚs
 
	geçb_wÜkq_fİs
 = {

154 .
owÃr
 = 
THIS_MODULE
,

155 .
	gİ’
 = 
eçb_wÜkq_İ’_´oc
,

156 .
	g»ad
 = 
£q_»ad
,

157 .
	gÎ£ek
 = 
£q_l£ek
,

158 .
	g»Ëa£
 = 
sšgË_»Ëa£
,

168 #ià
CI_CFG_STATS_NETIF


171 
	$eçb_¡acks_£q_¡¬t
(
£q_fe
 *
£q
, 
loff_t
 *
µos
)

173 
ci_Ãtif
 *
ni
 = 
NULL
;

174 
i
, 
rc
;

176  
i
 = 0; i <ğ*
µos
; i++) {

177 
rc
 = 
	`™”©e_Ãtifs_uÆocked
(&
ni
);

178 ifĞ
rc
 != 0 )

179  
NULL
;

181  
ni
;

182 
	}
}

185 
	$eçb_¡acks_£q_Ãxt
(
£q_fe
 *
£q
, *
v
, 
loff_t
 *
µos
)

187 
ci_Ãtif
 *
ni
 = 
v
;

188 
rc
;

189 (*
µos
)++;

190 
rc
 = 
	`™”©e_Ãtifs_uÆocked
(&
ni
);

191 ifĞ
rc
 != 0 )

192  
NULL
;

193  
ni
;

194 
	}
}

197 
	$eçb_¡acks_£q_¡İ
(
£q_fe
 *
£q
, *
v
)

199 ifĞ
v
 )

200 
	`™”©e_Ãtifs_uÆocked_drİ»f
(
v
);

201 
	}
}

204 
	$eçb_¡acks_£q_show
(
£q_fe
 *
£q
, *
v
)

206 
ci_Ãtif
 *
ni
 = 
v
;

207 
ci_Ãtif_¡©s
* 
s
 = &
ni
->
¡©e
->
¡©s
;

208 
	`£q_´štf
(
£q
,

210 
	`NI_ID
(
ni
), (èni->
¡©e
->
pid
, (èni->¡©e->
uid
,

211 
s
->
³riodic_pŞls
, s->
³riodic_evs
,

212 
s
->
timeout_š‹¼u±s
, s->
š‹¼u±s
, s->
š‹¼u±_pŞls
,

213 
s
->
š‹¼u±_wakes
, s->
š‹¼u±_evs
,

214 
s
->
š‹¼u±_´imes
, s->
£Ëù_´imes
,

215 
s
->
sock_wakes_rx
 + s->
sock_wakes_tx
 +

216 
s
->
sock_wakes_rx_os
 + s->
sock_wakes_tx_os
,

217 
s
->
pkt_wakes
, s->
uÆock_¦ow
,

218 
s
->
lock_wakes
, s->
deã¼ed_wÜk
, s->
sock_lock_¦“ps
,

219 
s
->
rx_evs
, s->
tx_evs
);

221 
	}
}

223 
£q_İ”©iÚs
 
	geçb_¡acks_£q_İs
 = {

224 .
¡¬t
 = 
eçb_¡acks_£q_¡¬t
,

225 .
	gÃxt
 = 
eçb_¡acks_£q_Ãxt
,

226 .
	g¡İ
 = 
eçb_¡acks_£q_¡İ
,

227 .
	gshow
 = 
eçb_¡acks_£q_show
,

231 
	$eçb_¡acks_£q_İ’
(
šode
 *šode, 
fe
 *file)

233  
	`£q_İ’
(
fe
, &
eçb_¡acks_£q_İs
);

235 
	}
}

236 
fe_İ”©iÚs
 
	geçb_¡acks_£q_fİs
 = {

237 .
owÃr
 = 
THIS_MODULE
,

238 .
	gİ’
 = 
eçb_¡acks_£q_İ’
,

239 .
	g»ad
 = 
£q_»ad
,

240 .
	gÎ£ek
 = 
£q_l£ek
,

241 .
	g»Ëa£
 = 
£q_»Ëa£_´iv©e
,

254 
	$eçb_v”siÚ_»ad_´oc
(
£q_fe
 *
£q
, *
s
)

256 
	`£q_´štf
(
£q
, "Úlßd_´oduù: %s\n", 
ONLOAD_PRODUCT
);

257 
	`£q_´štf
(
£q
, "Úlßd_v”siÚ: %s\n", 
ONLOAD_VERSION
);

258 
	`£q_´štf
(
£q
, "uk_štf_v”: %s\n", 
oo_uk_štf_v”
);

260 
	}
}

261 
	$eçb_v”siÚ_İ’_´oc
(
šode
 *šode, 
fe
 *file)

263  
	`sšgË_İ’
(
fe
, 
eçb_v”siÚ_»ad_´oc
, 0);

264 
	}
}

265 cÚ¡ 
fe_İ”©iÚs
 
	geçb_v”siÚ_fİs
 = {

266 .
owÃr
 = 
THIS_MODULE
,

267 .
	gİ’
 = 
eçb_v”siÚ_İ’_´oc
,

268 .
	g»ad
 = 
£q_»ad
,

269 .
	gÎ£ek
 = 
£q_l£ek
,

270 .
	g»Ëa£
 = 
sšgË_»Ëa£
,

281 
	$eçb_dlf‹rs_»ad_´oc
(
£q_fe
 *
£q
, *
s
)

283 
no_em±y
, 
no_tomb
, 
no_u£d
;

285 
	`efx_dlf‹r_couÁ_¡©s
(
eçb_tı_driv”
.
dlf‹r
,

286 &
no_em±y
, &
no_tomb
, &
no_u£d
);

287 
	`£q_´štf
(
£q
, "dlfilters:ƒmpty=%d,omb=%d, used=%d\n",

288 
no_em±y
, 
no_tomb
, 
no_u£d
);

290 
	}
}

291 
	$eçb_dlf‹rs_İ’_´oc
(
šode
 *šode, 
fe
 *file)

293  
	`sšgË_İ’
(
fe
, 
eçb_dlf‹rs_»ad_´oc
, 0);

294 
	}
}

295 cÚ¡ 
fe_İ”©iÚs
 
	geçb_dlf‹rs_fİs
 = {

296 .
owÃr
 = 
THIS_MODULE
,

297 .
	gİ’
 = 
eçb_dlf‹rs_İ’_´oc
,

298 .
	g»ad
 = 
£q_»ad
,

299 .
	gÎ£ek
 = 
£q_l£ek
,

300 .
	g»Ëa£
 = 
sšgË_»Ëa£
,

314 
	$ci_´oc_fes_š¡®l
(
´oc_dœ_’Œy
 *
roÙ
, *
roÙ_Çme
,

315 
ci_´oc_eçb_’Œy_t
 *
’Œ›s
, 
num_’Œ›s
)

317 
’Œy_no
;

320 
’Œy_no
 = 0;ƒÁry_nØ< 
num_’Œ›s
;ƒntry_no++) {

321 
ci_´oc_eçb_’Œy_t
 *
eçb_’Œy
 = &
’Œ›s
[
’Œy_no
];

323 
	`OO_DEBUG_STATS
(
	`ci_log
("Create %s/%s:„ead_proc=%p",

324 
roÙ_Çme
, 
eçb_’Œy
->
Çme
,ƒçb_’Œy->
fİs
));

326 ià(
	`´oc_ü—‹
(
eçb_’Œy
->
Çme
, 0, 
roÙ
,ƒçb_’Œy->
fİs
)

327 =ğ
NULL
) {

329 
	`ci_log
("Unableo create %s/%s: fops=%p",

330 
roÙ_Çme
, 
eçb_’Œy
->
Çme
,ƒçb_’Œy->
fİs
);

338 
	}
}

345 
	$ci_´oc_fes_unš¡®l
(
´oc_dœ_’Œy
 *
roÙ
,

346 
ci_´oc_eçb_’Œy_t
 *
’Œ›s
, 
num_’Œ›s
)

348 
’Œy_no
;

351 
’Œy_no
 = 0;ƒÁry_nØ< 
num_’Œ›s
;ƒntry_no++)

352 
	`»move_´oc_’Œy
(
’Œ›s
[
’Œy_no
].
Çme
, 
roÙ
);

353 
	}
}

357 
	$ci_š¡®l_´oc_’Œ›s
()

359 
oo_´oc_roÙ
 = 
	`´oc_mkdœ
("driv”/Úlßd", 
NULL
);

360 ifĞ! 
oo_´oc_roÙ
 ) {

361 
	`ci_log
("%s: faedØü—‹ driv”/Úlßd", 
__FUNCTION__
);

362  -
ENOMEM
;

365 
	`ci_´oc_fes_š¡®l
(
oo_´oc_roÙ
, "/proc/driver/onload",

366 
ci_´oc_eçb_bË
, 
CI_PROC_EFAB_TABLE_SIZE
);

369 #ià
CI_CFG_STATS_NETIF


370 
	`´oc_ü—‹
("¡acks", 0, 
oo_´oc_roÙ
, &
eçb_¡acks_£q_fİs
);

373 #ià
CI_MEMLEAK_DEBUG_ALLOC_TABLE


375 ifĞ
	`ü—‹_´oc_»ad_’Œy
("mem", 0, 
oo_´oc_roÙ
,

376 
ci_®loc_memËak_»ad´oc
, 
NULL
) == NULL )

377 
	`ci_log
("%s: faedØü—‹ 'mem'", 
__FUNCTION__
);

381 
	}
}

389 
	$ci_unš¡®l_´oc_’Œ›s
()

391 
	`ci__¡©s_ş—r
(&
ci__¡©s_glob®
);

393 ifĞ
oo_´oc_roÙ
 =ğ
NULL
 )

396 
	`ci_´oc_fes_unš¡®l
(
oo_´oc_roÙ
, 
ci_´oc_eçb_bË
,

397 
CI_PROC_EFAB_TABLE_SIZE
);

398 #ià
CI_CFG_STATS_NETIF


399 
	`»move_´oc_’Œy
("¡acks", 
oo_´oc_roÙ
);

401 #ià
CI_MEMLEAK_DEBUG_ALLOC_TABLE


402 
	`»move_´oc_’Œy
("mem", 
oo_´oc_roÙ
);

404 
	`»move_´oc_’Œy
("driv”/Úlßd", 
NULL
);

405 
oo_´oc_roÙ
 = 
NULL
;

406 
	}
}

	@linux_trampoline.c

20 
	~"Úlßd_k”Ãl_com·t.h
"

22 
	~<Úlßd/lšux_Úlßd_š‹º®.h
>

23 
	~<Úlßd/lšux_ŒampŞše.h
>

24 
	~<Úlßd/lšux_mm­.h
>

25 
	~<Úlßd/lšux_Úlßd.h
>

26 
	~<lšux/uni¡d.h
>

36 
	#TRAMP_DEBUG
(
x
...è
	`ci_log
(x)

	)

38 
	#TRAMP_DEBUG
(
x
...è()0

	)

49 
	$eçb_lšux_ŒampŞše_»gi¡”
 (
ci_´iv©e_t
 *
´iv
, *
¬g
)

51 cÚ¡ 
ci_Œamp_»g_¬gs_t
 *
¬gs
 = 
¬g
;

52 
rc
 = 0;

53 
mm_hash
 *
p
;

55 
	`TRAMP_DEBUG
 ("Regi¡”ƒÁry-pošˆ0x%"
CI_PRIx64
"(0x%"CI_PRIx64") for mm %p (pid %d)",

56 
¬gs
->
ŒampŞše_’Œy
.
±r
,‡rgs->
ŒampŞše_exşude
.±r, 
cu¼’t
->
mm
,

57 
cu¼’t
->
pid
);

59 
	`wr™e_lock
 (&
oo_mm_tbl_lock
);

61 
p
 = 
	`oo_mm_tbl_lookup
(
cu¼’t
->
mm
);

65 ià(!
p
) {

70 
	`ci_log
("Unexpectedrampoline„egistration with‚o maps");

71 
rc
 = -
ENOENT
;

72 
ex™
;

74 
	`ci_as£¹
 (
p
);

75 
	`ci_as£¹
 (
p
->
mm
 =ğ
cu¼’t
->mm);

76 
p
->
ŒampŞše_’Œy
 = 
¬gs
->trampoline_entry;

77 
p
->
ŒampŞše_exşude
 = 
¬gs
->trampoline_exclude;

78 
p
->
ŒampŞše_toc
 = 
¬gs
->trampoline_toc;

79 
p
->
ŒampŞše_u£r_fixup
 = 
¬gs
->trampoline_user_fixup;

80 
	`CI_DEBUG
(
p
->
ŒampŞše_ul_ç
 = 
¬gs
->trampoline_ul_fail;)

82 
rc
 = 
	`eçb_sigÇl_mm_š™
(
¬gs
, 
p
);

84 
	`TRAMP_DEBUG
("mm %°»gi¡”ed¿mpŞš’Œy %"
CI_PRIx64
"ƒxclude %"CI_PRIx64,

85 
p
->
mm
, 
¬gs
->
ŒampŞše_’Œy
.
±r
,‡rgs->
ŒampŞše_exşude
.ptr);

87 
ex™
:

88 ifĞ
rc
 =ğ0 && 
§ã_sigÇls_ªd_ex™
 )

89 
	`eçb_g‘_mm_hash_locked
(
p
);

90 
	`wr™e_uÆock
 (&
oo_mm_tbl_lock
);

92 ifĞ
rc
 =ğ0 && 
§ã_sigÇls_ªd_ex™
 ) {

93 
	`eçb_sigÇl_´oûss_š™
(&
p
->
sigÇl_d©a
);

94 
	`eçb_sigÇl_put_Œamp_d©a
(&
p
->
sigÇl_d©a
);

96  
rc
;

97 
	}
}

	@mmap.c

22 
	#__ci_driv”_sh–l__


	)

30 
	~<Úlßd/lšux_mm­.h
>

31 
	~<Úlßd/debug.h
>

32 
	~<Úlßd/tı_h–³r_âs.h
>

33 
	~<Úlßd/mm­.h
>

34 
	~<Úlßd/lšux_ŒampŞše.h
>

35 
	~<driv”/lšux_»sourû/k”Ãl_com·t.h
>

39 ’um {
	mMM_ENTRY_MAGIC
 = 0xabadf00l};

44 ’um {
	mMM_HASH_SIZE
=256};

47 
ci_dÎi¡
 
	gmm_hash_tbl
[
MM_HASH_SIZE
];

53 
DEFINE_RWLOCK
(
oo_mm_tbl_lock
);

56 
šlše
 

57 
	$OO_MMAP_OFFSET_TO_MAP_ID
(
off_t
 
off£t
)

58 {  
off£t
 >> 
CI_NETIF_MMAP_ID_SHIFT
; 
	}
}

61 
šlše
 

62 
	$hash_mm
 (
mm_¡ruù
 *
mm
) {

63 
ci_ušŒ_t
 
t
 = (ci_ušŒ_t)
mm
;

64 
	`ci_as£¹
 (
t
);

67  (
t
 / ()
L1_CACHE_BYTES
è& (
MM_HASH_SIZE
-1);

68 
	}
}

76 
mm_hash
* 
	$oo_mm_tbl_lookup
(
mm_¡ruù
 *
mm
)

78 
mm_hash
 *
p
;

79 
hash
 = 
	`hash_mm
 (
mm
);

80 
	`ci_as£¹
 (
mm_hash_tbl
 [
hash
].
l
.
Ãxt
);

81 
	`ci_as£¹
 (
mm_hash_tbl
 [
hash
].
l
.
´ev
);

82 
p
 = (
mm_hash
*è
	`ci_dÎi¡_h—d
 (&
mm_hash_tbl
 [
hash
]);

83 !
	`ci_dÎi¡_is_ªchÜ
 (&
mm_hash_tbl
 [
hash
], &
p
->
lšk
);

84 
p
 = (
mm_hash
*èp->
lšk
.
Ãxt
) {

85 
	`ci_as£¹
 (
p
->
magic
 =ğ
MM_ENTRY_MAGIC
);

86 ià(
p
->
mm
 == mm)

87  
p
;

90  
NULL
;

91 
	}
}

102 
mm_hash
*

103 
	$eçb_ü—‹_mm_’Œy
 (
mm_¡ruù
 *
mm
) {

104 
mm_hash
 *
p
;

106 
	`ci_as£¹
Ğ! 
	`oo_mm_tbl_lookup
(
mm
));

108 
p
 = 
	`km®loc
 ( *p, 0);

109 ià(
p
) {

110 
	`OO_DEBUG_TRAMP
(
	`ci_log
("Madmm_hash %°fÜ mm %p", 
p
, 
mm
));

111 
p
->
magic
 = 
MM_ENTRY_MAGIC
;

112 
p
->
mm
 = mm;

113 
p
->
»f
 = 0;

114 
	`CI_USER_PTR_SET
 (
p
->
ŒampŞše_’Œy
, 0);

115 
	`CI_USER_PTR_SET
 (
p
->
sigÇl_d©a
.
u£r_d©a
, 0);

116 
	`ci_dÎi¡_push
 (&
mm_hash_tbl
 [
	`hash_mm
 (
mm
)], &
p
->
lšk
);

119  
p
;

120 
	}
}

132 
	$eçb_add_mm_»f
 (
mm_¡ruù
 *
mm
) {

134 
rc
 = 0;

135 
mm_hash
 *
p
;

137 
	`ci_as£¹
 (
mm
);

138 
	`wr™e_lock
 (&
oo_mm_tbl_lock
);

141 
p
 = 
	`oo_mm_tbl_lookup
(
mm
);

142 ià(!
p
) {

144 
p
 = 
	`eçb_ü—‹_mm_’Œy
 (
mm
);

145 ià(!
p
) {

146 
rc
 = -
ENOMEM
;

147 
ex™
;

151 
	`ci_as£¹
 (
p
);

152 
p
->
»f
++;

154 
ex™
:

155 
	`wr™e_uÆock
 (&
oo_mm_tbl_lock
);

156  
rc
;

157 
	}
}

164 
	$eçb_put_mm_hash_locked
(
mm_hash
 *
p
)

166 ià(!--
p
->
»f
) {

167 
	`OO_DEBUG_TRAMP
(
	`ci_log
("D–‘šg mm_hash %p", 
p
));

168 
	`ci_dÎi¡_»move
 (&
p
->
lšk
);

172 
	}
}

178 
	$eçb_ä“_mm_hash
(
mm_hash
 *
p
)

180 
	`ci_as£¹_equ®
(
p
->
»f
, 0);

181 ifĞ
§ã_sigÇls_ªd_ex™
 )

182 
	`eçb_sigÇl_´oûss_fši
(&
p
->
sigÇl_d©a
);

183 
	`kä“
 (
p
);

184 
	}
}

193 
	$eçb_d–_mm_»f
 (
mm_¡ruù
 *
mm
) {

194 
mm_hash
 *
p
;

195 
do_ä“
 = 0;

197 
	`wr™e_lock
 (&
oo_mm_tbl_lock
);

199 
p
 = 
	`oo_mm_tbl_lookup
(
mm
);

200 ifĞ
p
 =ğ
NULL
 ) {

202 
	`ci_log
("%s: ERROR: cª‚Ù†ooku°thi mm", 
__func__
);

203 
	`wr™e_uÆock
 (&
oo_mm_tbl_lock
);

207 
	`ci_as£¹
 (
p
->
mm
 == mm);

209 
do_ä“
 = 
	`eçb_put_mm_hash_locked
(
p
);

211 
	`wr™e_uÆock
 (&
oo_mm_tbl_lock
);

213 ifĞ
do_ä“
 )

214 
	`eçb_ä“_mm_hash
(
p
);

215 
	}
}

218 
	$oo_mm_tbl_š™
()

220 
i
;

221  
i
 = 0; i < 
MM_HASH_SIZE
; i++ )

222 
	`ci_dÎi¡_š™
(&
mm_hash_tbl
[
i
]);

223 
	}
}

232 
	$vm_İ_İ’
(
vm_¬—_¡ruù
* 
vma
)

234 
tı_h–³r_»sourû_t
* 
m­
;

235 
rc
;

237 
m­
 = (
tı_h–³r_»sourû_t
*è
vma
->
vm_´iv©e_d©a
;

238 
	`TCP_HELPER_RESOURCE_ASSERT_VALID
(
m­
, 0);

240 
	`OO_DEBUG_TRAMP
(
	`ci_log
("vm_op_open: %u vma=%p„s_refs=%d",

241 
m­
->
id
, 
vma
, (è
	`oo_©omic_»ad
(&m­->
»f_couÁ
)));

243 
rc
 = 
	`eçb_add_mm_»f
 (
vma
->
vm_mm
);

244 ifĞ
rc
 != 0 )

245 
	`ci_log
("%s: ERROR: faedØ»gi¡” mm:„c=%d", 
__func__
, 
rc
);

246 
	}
}

249 
	$vm_İ_şo£
(
vm_¬—_¡ruù
* 
vma
)

251 
tı_h–³r_»sourû_t
* 
m­
;

252 
m­
 = (
tı_h–³r_»sourû_t
*è
vma
->
vm_´iv©e_d©a
;

254 
	`OO_DEBUG_TRAMP
(
	`ci_log
("vm_op_close: %u vma=%p„s_refs=%d",

255 
m­
->
id
, 
vma
, (è
	`oo_©omic_»ad
(&m­->
»f_couÁ
)));

257 
	`eçb_d–_mm_»f
 (
vma
->
vm_mm
);

259 
	`TCP_HELPER_RESOURCE_ASSERT_VALID
(
m­
, 0);

260 
	}
}

263 
	#VMA_OFFSET
(
vma
è((vma)->
vm_pgoff
 << 
PAGE_SHIFT
)

	)

265 #iâdeà
NOPAGE_SIGBUS


266 
	#NOPAGE_SIGBUS
 (
NULL
)

	)

269 
·ge
* 
	$vm_İ_nİage
(
vm_¬—_¡ruù
* 
vma
,

270 
add»ss
,

271 * 
ty³
)

273 
tı_h–³r_»sourû_t
* 
Œs
 = (tı_h–³r_»sourû_t*è
vma
->
vm_´iv©e_d©a
;

274 
pâ
;

275 
·ge
 *
pg
;

277 
	`TCP_HELPER_RESOURCE_ASSERT_VALID
(
Œs
, 0);

279 
pâ
 = 
	`tı_h–³r_rm_nİage
(
Œs
, 
vma
,

280 
	`OO_MMAP_OFFSET_TO_MAP_ID
(
	`VMA_OFFSET
(
vma
)),

281 
add»ss
 - 
vma
->
vm_¡¬t
);

282 ifĞ
pâ
 != () -1 ) {

283 
pg
 = 
	`pâ_to_·ge
(
pâ
);

295 #ifdeà
VM_PFNMAP


296 
	`g‘_·ge
(
pg
);

298 if(!
	`PageRe£rved
(
pg
))

299 
	`g‘_·ge
(
pg
);

302 ifĞ
ty³
 ) *ty³ = 
VM_FAULT_MINOR
;

304 
	`OO_DEBUG_TRAMP
(
	`ci_log
("%s: %u vma=%p sz=%lx…ageoff=%lx id=%d…fn=%lx",

305 
__FUNCTION__
, 
Œs
->
id
, 
vma
, vma->
vm_’d
 - vma->
vm_¡¬t
,

306 (
add»ss
 - 
vma
->
vm_¡¬t
è>> 
CI_PAGE_SHIFT
,

307 
	`OO_MMAP_OFFSET_TO_MAP_ID
(
	`VMA_OFFSET
(
vma
)), 
pâ
));

309  
pg
;

313 ifĞ~
cu¼’t
->
æags
 & 
PF_DUMPCORE
 )

314 
	`CI_DEBUG
(
	`ci_log
("%s: %u vma=%p sz=%lx…ageoff=%lx id=%d FAILED",

315 
__FUNCTION__
, 
Œs
->
id
, 
vma
, vma->
vm_’d
 - vma->
vm_¡¬t
,

316 (
add»ss
 - 
vma
->
vm_¡¬t
è>> 
CI_PAGE_SHIFT
,

317 
	`OO_MMAP_OFFSET_TO_MAP_ID
(
	`VMA_OFFSET
(
vma
))));

319  
NOPAGE_SIGBUS
;

320 
	}
}

322 #ià
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(2,6,23)

323 
	$vm_İ_çuÉ
(
vm_¬—_¡ruù
 *
vma
, 
vm_çuÉ
 *
vmf
) {

324 
·ge
*…age;

326 
·ge
 = 
	`vm_İ_nİage
(
vma
, ()
vmf
->
vœtu®_add»ss
, 
NULL
);

327 
vmf
->
·ge
 =…age;

329  ( 
·ge
 =ğ
NULL
 ) ? 
VM_FAULT_SIGBUS
 : 0;

330 
	}
}

334 
vm_İ”©iÚs_¡ruù
 
	gvm_İs
 = {

335 .
İ’
 = 
vm_İ_İ’
,

336 .
	gşo£
 = 
vm_İ_şo£
,

337 #ià
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,23)

338 .
	gnİage
 = 
vm_İ_nİage


340 .
çuÉ
 = 
vm_İ_çuÉ


352 
	$oo_fİ_mm­
(
fe
* fe, 
vm_¬—_¡ruù
* 
vma
)

354 
ci_´iv©e_t
* 
´iv
 = (ci_´iv©e_t*è
fe
->
´iv©e_d©a
;

355 
off_t
 
off£t
 = 
	`VMA_OFFSET
(
vma
);

356 
by‹s
 = 
vma
->
vm_’d
 - vma->
vm_¡¬t
;

357 
m­_off£t
;

358 
rc
, 
m­_num
;

360 ifĞ!
´iv
 )  -
EBADF
;

361 ifĞ!
´iv
->
thr
 )  -
ENODEV
;

363 ifĞ
by‹s
 == 0 ) {

364 
	`ci_log
("ci_char_fop_mmap: bytes == 0");

365  -
EINVAL
;

368 
	`ci_as£¹
((
off£t
 & 
PAGE_MASK
) == offset);

370 ifĞ(
rc
 = 
	`eçb_add_mm_»f
 (
vma
->
vm_mm
)) < 0 )

371  
rc
;

373 
vma
->
vm_æags
 |ğ
EFRM_VM_IO_FLAGS
;

378 
vma
->
vm_İs
 = &vm_ops;

379 
vma
->
vm_´iv©e_d©a
 = (*è
´iv
->
thr
;

382 
	`OO_DEBUG_TRAMP
(
	`ci_log
("mmap: -> %u %d…ages offset=0x%lx "

384 
´iv
->
thr
->
id
, (è(
by‹s
 >> 
CI_PAGE_SHIFT
), 
off£t
,

385 
vma
, vma->
vm_¡¬t
, vma->
vm_’d
));

387 
m­_off£t
 = 
m­_num
 = 0;

389 
rc
 = 
	`eçb_tı_h–³r_rm_mm­
(
´iv
->
thr
, &
by‹s
, 
vma
, &
m­_num
, &
m­_off£t
,

390 
	`OO_MMAP_OFFSET_TO_MAP_ID
(
off£t
));

391 ifĞ
rc
 < 0 )

392 
	`eçb_d–_mm_»f
 (
vma
->
vm_mm
);

397 #iâdeà
NDEBUG


398 ifĞ
by‹s
 && 
rc
 == 0 )

399 
	`ci_log
("mmap: %u %d…ages unmapped (offset=%lx "

401 
´iv
->
thr
->
id
, (è(
by‹s
>>
CI_PAGE_SHIFT
),

402 (è
off£t
, (è
	`OO_MMAP_OFFSET_TO_MAP_ID
(offset));

405  
rc
;

406 
	}
}

	@onload_internal.h

1 #iâdeà
__ONLOAD_INTERNAL_H__


2 
	#__ONLOAD_INTERNAL_H__


	)

4 
	~<lšux/š™.h
>

7 
oo_driv”lšk_»gi¡”
();

8 
oo_driv”lšk_uÄegi¡”_nf
();

9 
oo_driv”lšk_uÄegi¡”_dl
();

12 
ci_š¡®l_´oc_’Œ›s
();

13 
ci_unš¡®l_´oc_’Œ›s
();

15 
	g´oc_dœ_’Œy
;

16 
´oc_dœ_’Œy
* 
oo_´oc_roÙ
;

18 
ci_bÚdšg_š™
();

19 
ci_bÚdšg_fši
();

21 
ci_bÚdšg_£t_tim”_³riod
(
³riod
, 
occu»nûs
);

23 
ci_bÚdšg_g‘_xm™_pŞicy_æags
(*
Ãt_dev
, *
æags
);

25 
__š™
 
oo_•Şl_chrdev_ùÜ
();

26 
oo_•Şl_chrdev_dtÜ
();

28 
	gfe
;

29 
oo_š¡®l_fe_to_fd
(
fe
 *fe, 
æags
);

31 
__š™
 
Úlßdfs_š™
();

32 
Úlßdfs_fši
();

34 
	~<Úlßd/fd_´iv©e.h
>

35 
Úlßd_´iv_ä“
(
ci_´iv©e_t
 *
´iv
);

	@onload_kernel_compat.h

1 #iâdeà
__ONLOAD_KERNEL_COMPAT_H__


2 
	#__ONLOAD_KERNEL_COMPAT_H__


	)

4 
	~<driv”/lšux_Ãt/k”Ãl_com·t.h
>

5 
	~<driv”/lšux_affš™y/autocom·t.h
>

7 #iâdeà
cu¼’t_fsuid


8 
	#cu¼’t_fsuid
(è
cu¼’t
->
fsuid


	)

10 #iâdeà
cu¼’t_fsgid


11 
	#cu¼’t_fsgid
(è
cu¼’t
->
fsgid


	)

14 #ifdeà
EFX_HAVE_KMEM_CACHE_S


15 
	#kmem_ÿche
 
kmem_ÿche_s


	)

21 #iâdeà
sig_k”Ãl_Úly


23 #ifdeà
SIGEMT


24 
	#M_SIGEMT
 
	`M
(
SIGEMT
)

	)

26 
	#M_SIGEMT
 0

	)

29 #ià
SIGRTMIN
 > 
BITS_PER_LONG


30 
	#M
(
sig
è(1ULL << ((sig)-1))

	)

32 
	#M
(
sig
è(1UL << ((sig)-1))

	)

34 
	#T
(
sig
, 
mask
è(
	`M
(sigè& (mask))

	)

36 
	#SIG_KERNEL_ONLY_MASK
 (\

37 
	`M
(
SIGKILL
è| M(
SIGSTOP
è)

	)

39 
	#SIG_KERNEL_STOP_MASK
 (\

40 
	`M
(
SIGSTOP
è| M(
SIGTSTP
è| M(
SIGTTIN
è| M(
SIGTTOU
è)

	)

42 
	#SIG_KERNEL_COREDUMP_MASK
 (\

43 
	`M
(
SIGQUIT
è| M(
SIGILL
è| M(
SIGTRAP
è| M(
SIGABRT
) | \

44 
	`M
(
SIGFPE
è| M(
SIGSEGV
è| M(
SIGBUS
è| M(
SIGSYS
) | \

45 
	`M
(
SIGXCPU
è| M(
SIGXFSZ
è| 
M_SIGEMT
 )

	)

47 
	#SIG_KERNEL_IGNORE_MASK
 (\

48 
	`M
(
SIGCONT
è| M(
SIGCHLD
è| M(
SIGWINCH
è| M(
SIGURG
è)

	)

50 
	#sig_k”Ãl_Úly
(
sig
) \

51 (((
sig
è< 
SIGRTMIN
è&& 
	`T
(sig, 
SIG_KERNEL_ONLY_MASK
))

	)

52 
	#sig_k”Ãl_cÜedump
(
sig
) \

53 (((
sig
è< 
SIGRTMIN
è&& 
	`T
(sig, 
SIG_KERNEL_COREDUMP_MASK
))

	)

54 
	#sig_k”Ãl_ignÜe
(
sig
) \

55 (((
sig
è< 
SIGRTMIN
è&& 
	`T
(sig, 
SIG_KERNEL_IGNORE_MASK
))

	)

56 
	#sig_k”Ãl_¡İ
(
sig
) \

57 (((
sig
è< 
SIGRTMIN
è&& 
	`T
(sig, 
SIG_KERNEL_STOP_MASK
))

	)

61 #iâdeà
__NFDBITS


62 
	#__NFDBITS
 
BITS_PER_LONG


	)

66 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(3,9,0))

67 
	#f_vfsmÁ
 
f_·th
.
mÁ


	)

71 #iâdeà
EFRM_HAVE_NETDEV_NOTIFIER_INFO


72 
	#Ãtdev_nÙif›r_šfo_to_dev
(
šfo
è(šfo)

	)

	@onloadfs.c

10 
	~<Úlßd/fd_´iv©e.h
>

11 
	~<Úlßd/debug.h
>

12 
	~<Úlßd/tı_h–³r_âs.h
>

13 
	~<Úlßd/lšux_Úlßd.h
>

14 
	~"Úlßd_š‹º®.h
"

15 
	~<Úlßd/lšux_Úlßd_š‹º®.h
>

16 
	~"Úlßd_k”Ãl_com·t.h
"

19 
fe_İ”©iÚs
 *
	$oo_fİs_by_ty³
(
fd_ty³
)

21  
fd_ty³
 ) {

22 
CI_PRIV_TYPE_NETIF
:  &
oo_fİs
;

23 
CI_PRIV_TYPE_TCP_EP
:  &
lšux_tı_h–³r_fİs_tı
;

24 
CI_PRIV_TYPE_UDP_EP
:  &
lšux_tı_h–³r_fİs_udp
;

25 #ià
CI_CFG_USERSPACE_PIPE


26 
CI_PRIV_TYPE_PIPE_READER
:  &
lšux_tı_h–³r_fİs_pe_»ad”
;

27 
CI_PRIV_TYPE_PIPE_WRITER
:  &
lšux_tı_h–³r_fİs_pe_wr™”
;

30 
	`CI_DEBUG
(
	`ci_log
("%s:ƒrror fd_type = %d",

31 
__FUNCTION__
, 
fd_ty³
));

32  
NULL
;

35 
	}
}

40 
	sÚlßd_šode
 {

41 
ci_´iv©e_t
 
	m´iv
;

42 
šode
 
	mvfs_šode
;

45 
kmem_ÿche
 *
	gÚlßd_šode_ÿch•
;

46 
vfsmouÁ
 *
	gÚlßd_mÁ
;

48 
šode
 *
	$Úlßd_®loc_šode
(
su³r_block
 *
sb
)

50 
Úlßd_šode
 *
ei
;

52 
ei
 = 
	`kmem_ÿche_®loc
(
Úlßd_šode_ÿch•
, 
GFP_KERNEL
);

53 ià(!
ei
)

54  
NULL
;

57  &
ei
->
vfs_šode
;

58 
	}
}

60 
	$Úlßd_de¡roy_šode
(
šode
 *inode)

62 
Úlßd_šode
 *
ei
 = 
	`cÚš”_of
(
šode
, onload_inode,

63 
vfs_šode
);

65 
	`kmem_ÿche_ä“
(
Úlßd_šode_ÿch•
, 
ei
);

66 
	}
}

70 #ifdeà
EFX_HAVE_D_DNAME


73 
su³r_İ”©iÚs
 
	gÚlßdfs_İs
 = {

74 .
®loc_šode
 = 
Úlßd_®loc_šode
,

75 .
	gde¡roy_šode
 = 
Úlßd_de¡roy_šode
,

76 .
	g¡©fs
 = 
sim¶e_¡©fs
,

79 cÚ¡ *
	$´iv_ty³_to_¡r
(
fd_ty³
)

81  
fd_ty³
 ) {

82 
CI_PRIV_TYPE_TCP_EP
:  "tcp";

83 
CI_PRIV_TYPE_UDP_EP
:  "udp";

84 #ià
CI_CFG_USERSPACE_PIPE


85 
CI_PRIV_TYPE_PIPE_READER
:  "piper";

86 
CI_PRIV_TYPE_PIPE_WRITER
:  "pipew";

90  
NULL
;

91 
	}
}

92 
	$Úlßdfs_Çme
(
ci_´iv©e_t
 *
´iv
, *
bufãr
, 
buæ’
)

94 
Ën
;

96 ifĞ
´iv
->
fd_ty³
 =ğ
CI_PRIV_TYPE_NETIF
)

97 
Ën
 = 
	`¢´štf
(
bufãr
, 
buæ’
, "[¡ack:%d]", 
´iv
->
thr
->
id
);

98 #ifdeà
EFX_HAVE_D_DNAME


101 ifĞ
´iv
->
fd_ty³
 =ğ
CI_PRIV_TYPE_TCP_EP
 &&

102 
	`SP_TO_WAITABLE_OBJ
(&
´iv
->
thr
->
Ãtif
,

103 
´iv
->
sock_id
)->
wa™abË
.
¡©e
 ==

104 
CI_TCP_LISTEN
)

105 
Ën
 = 
	`¢´štf
(
bufãr
, 
buæ’
, "[tcpl:%d:%d]",

106 
´iv
->
thr
->
id
,…riv->
sock_id
);

109 
Ën
 = 
	`¢´štf
(
bufãr
, 
buæ’
, "[%s:%d:%d]",

110 
	`´iv_ty³_to_¡r
(
´iv
->
fd_ty³
),…riv->
thr
->
id
,

111 
´iv
->
sock_id
);

112 
bufãr
[
buæ’
-1] = '\0';

113  
Ën
 + 1;

114 
	}
}

115 #ifdeà
EFX_HAVE_D_DNAME


116 *
	$Úlßdfs_dÇme
(
d’Œy
 *d’Œy, *
bufãr
, 
buæ’
)

118 
Úlßd_šode
 *
ei
 = 
	`cÚš”_of
(
d’Œy
->
d_šode
,

119 
Úlßd_šode
, 
vfs_šode
);

120 
ci_´iv©e_t
 *
´iv
 = &
ei
->priv;

121 
Ën
;

122 
‹mp
[64];

125 
Ën
 = 
	`¢´štf
(
‹mp
, (temp), "onload:");

126 
Ën
 +ğ
	`Úlßdfs_Çme
(
´iv
, 
‹mp
 +†en, (temp) -†en);

127 ifĞ
Ën
 > (
‹mp
è||†’ > 
buæ’
 )

128  
	`ERR_PTR
(-
ENAMETOOLONG
);

130 
bufãr
 +ğ
buæ’
 - 
Ën
;

131  
	`memıy
(
bufãr
, 
‹mp
, 
Ën
);

132 
	}
}

135 #iâdeà
EFX_HAVE_STRUCT_PATH


136 
	$Úlßdfs_d–‘e_d’Œy
(
d’Œy
 *dentry)

138 #ifdeà
EFX_HAVE_D_DNAME


140 
d’Œy
->
d_æags
 |ğ
DCACHE_UNHASHED
;

145 
	}
}

150 #ifdeà
EFX_HAVE_CONST_D_OP


153 
d’Œy_İ”©iÚs
 
	gÚlßdfs_d’Œy_İ”©iÚs
 = {

154 #ifdeà
EFX_HAVE_D_DNAME


155 .
d_dÇme
 = 
Úlßdfs_dÇme
,

157 #iâdeà
EFX_HAVE_STRUCT_PATH


158 .
	gd_d–‘e
 = 
Úlßdfs_d–‘e_d’Œy
,

162 #ià
LINUX_VERSION_CODE
 =ğ
KERNEL_VERSION
(2,6,37)

163 
	#EFX_OLD_MOUNT_PSEUDO


	)

166 #ifdeà
EFX_FSTYPE_HAS_MOUNT


167 
d’Œy
 *

168 
	$Úlßdfs_mouÁ
(
fe_sy¡em_ty³
 *
fs_ty³
, 
æags
,

169 cÚ¡ *
dev_Çme
, *
d©a
)

171  
	`mouÁ_p£udo
(
fs_ty³
, "Úlßd:", &
Úlßdfs_İs
,

172 #iâdeà
EFX_OLD_MOUNT_PSEUDO


173 &
Úlßdfs_d’Œy_İ”©iÚs
,

175 
ONLOADFS_MAGIC
);

176 
	}
}

179 #ifdeà
EFX_NEED_VFSMOUNT_PARAM_IN_GET_SB


182 
	gsu³r_block
 *

184 
Úlßdfs_g‘_sb
(
fe_sy¡em_ty³
 *
fs_ty³
, 
æags
,

185 cÚ¡ *
dev_Çme
, *
d©a


186 #ifdeà
EFX_NEED_VFSMOUNT_PARAM_IN_GET_SB


187 , 
vfsmouÁ
 *
mÁ


191  
g‘_sb_p£udo
(
fs_ty³
, "Úlßd:", &
Úlßdfs_İs
, 
ONLOADFS_MAGIC


192 #ifdeà
EFX_NEED_VFSMOUNT_PARAM_IN_GET_SB


193 , 
mÁ


200 
fe_sy¡em_ty³
 
	gÚlßd_fs_ty³
 = {

201 .
Çme
 = "onloadfs",

202 #ifdeà
EFX_FSTYPE_HAS_MOUNT


203 .
	gmouÁ
 = 
Úlßdfs_mouÁ
,

205 .
	gg‘_sb
 = 
Úlßdfs_g‘_sb
,

207 .
	gkl_sb
 = 
kl_ªÚ_su³r
,

210 
š™_Úû
(

211 #ià
defšed
(
EFX_HAVE_KMEM_CACHE_DTOR
è|| defšed(
EFX_HAVE_KMEM_CACHE_FLAGS
)

212 *
foo
, 
kmem_ÿche
 *
ÿch•
,

213 
æags


215 #ifdeà
EFX_HAVE_KMEM_CACHE_CACHEP


216 
kmem_ÿche
 *
ÿch•
,

218 *
foo


222 
Úlßd_šode
 *
	gei
 = (Úlßd_šod*)
foo
;

223 #ià
defšed
(
EFX_HAVE_KMEM_CACHE_DTOR
è|| defšed(
EFX_HAVE_KMEM_CACHE_FLAGS
)

224 #ifdeà
SLAB_CTOR_VERIFY


225 if((
	gæags
 & 
	gSLAB_CTOR_VERIFY
) == 0)

227 #ifdeà
SLAB_CTOR_CONSTRUCTOR


228 if(
æags
 & 
SLAB_CTOR_CONSTRUCTOR
)

231 
šode_š™_Úû
(&
ei
->
vfs_šode
);

235 
__š™
 
	$Úlßdfs_š™
()

237 
”r
;

239 
Úlßd_šode_ÿch•
 = 
	`kmem_ÿche_ü—‹
("onloadfs_inode_cache",

240 (
Úlßd_šode
), 0, 0,

241 
š™_Úû


242 #ifdeà
EFX_HAVE_KMEM_CACHE_DTOR


243 , 
NULL


246 
”r
 = 
	`»gi¡”_fesy¡em
(&
Úlßd_fs_ty³
);

247 ifĞ
”r
 != 0 ) {

248 
	`kmem_ÿche_de¡roy
(
Úlßd_šode_ÿch•
);

249  
”r
;

251 
Úlßd_mÁ
 = 
	`k”n_mouÁ
(&
Úlßd_fs_ty³
);

252 ifĞ
	`IS_ERR
(
Úlßd_mÁ
) ) {

253 
	`uÄegi¡”_fesy¡em
(&
Úlßd_fs_ty³
);

254 
	`kmem_ÿche_de¡roy
(
Úlßd_šode_ÿch•
);

255  
	`PTR_ERR
(
Úlßd_mÁ
);

258 
	}
}

259 
	$Úlßdfs_fši
()

261 #ifdeà
EFX_HAVE_KERN_UMOUNT


262 
	`k”n_unmouÁ
(
Úlßd_mÁ
);

264 
	`mÁput
(
Úlßd_mÁ
);

266 
Úlßd_mÁ
 = 
NULL
;

267 
	`uÄegi¡”_fesy¡em
(&
Úlßd_fs_ty³
);

268 
	`kmem_ÿche_de¡roy
(
Úlßd_šode_ÿch•
);

269 
	}
}

271 #iâdeà
EFX_HAVE_ALLOC_FILE


272 
fe
 *
	$®loc_fe
(
vfsmouÁ
 *
mÁ
, 
d’Œy
 *dentry,

273 
mode_t
 
mode
, 
fe_İ”©iÚs
 *
fİ
)

275 
fe
 *fğ
	`g‘_em±y_fp
();

277 ifĞ
fe
 =ğ
NULL
 )

278  
NULL
;

280 
fe
->
f_d’Œy
 = 
d’Œy
;

281 
fe
->
f_vfsmÁ
 = 
	`mÁg‘
(
mÁ
);

282 
fe
->
f_m­pšg
 = 
d’Œy
->
d_šode
->
i_m­pšg
;

283 
fe
->
f_mode
 = 
mode
;

284 
fe
->
f_İ
 = 
fİ
;

285  
fe
;

286 
	}
}

289 
	$Úlßd_®loc_fe
(
tı_h–³r_»sourû_t
 *
thr
, 
oo_¥
 
•_id
, 
æags
,

290 
fd_ty³
)

292 
q¡r
 
Çme
 = { .name = "" };

293 #ifdeà
EFX_HAVE_STRUCT_PATH


294 
·th
…ath;

295 
	#my_d’Œy
 
·th
.
d’Œy


	)

297 
d’Œy
 *dentry;

298 
	#my_d’Œy
 
d’Œy


	)

300 
fe
 *file;

301 
fd
;

302 
šode
 *inode;

303 
ci_´iv©e_t
 *
´iv
;

304 
fe_İ”©iÚs
 *
fİs
;

306 
fİs
 = 
	`oo_fİs_by_ty³
(
fd_ty³
);

307 ifĞ
fİs
 =ğ
NULL
 )

308  -
EINVAL
;

309 
	`ci_as£¹_equ®
(
fİs
->
owÃr
, 
THIS_MODULE
);

311 
šode
 = 
	`Ãw_šode
(
Úlßd_mÁ
->
mÁ_sb
);

312 ifĞ
šode
 =ğ
NULL
 )

313  -
ENOMEM
;

314 #ifdeà
EFX_FSTYPE_HAS_MOUNT


315 
šode
->
i_šo
 = 
	`g‘_Ãxt_šo
();

317 ifĞ
fd_ty³
 =ğ
CI_PRIV_TYPE_NETIF
 )

318 
šode
->
i_mode
 = 
S_IRWXUGO
;

319 ifĞ
fd_ty³
 =ğ
CI_PRIV_TYPE_TCP_EP
 || fd_ty³ =ğ
CI_PRIV_TYPE_UDP_EP
 )

320 
šode
->
i_mode
 =

321 #ià
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(2,6,21)

324 
S_IFSOCK
 |

326 
S_IRWXUGO
;

328 
šode
->
i_mode
 = 
S_IFIFO
 | 
S_IRUSR
 | 
S_IWUSR
;

329 
šode
->
i_uid
 = 
	`cu¼’t_fsuid
();

330 
šode
->
i_gid
 = 
	`cu¼’t_fsgid
();

331 
´iv
 = &
	`cÚš”_of
(
šode
, 
Úlßd_šode
, 
vfs_šode
)->priv;

332 
´iv
->
thr
 =hr;

333 
´iv
->
sock_id
 = 
•_id
;

334 
´iv
->
fd_ty³
 = fd_type;

336 
fd
 = 
	`g‘_unu£d_fd
();

337 ifĞ
fd
 < 0 ) {

338 
	`ut
(
šode
);

339  
fd
;

344 #ifdeà
EFX_FSTYPE_HAS_MOUNT


345 #ià
LINUX_VERSION_CODE
 <ğ
	`KERNEL_VERSION
(2,6,37)

346 
·th
.
d’Œy
 = 
	`d_®loc
(
Úlßd_mÁ
->
mÁ_sb
->
s_roÙ
, &
Çme
);

347 ifĞ
·th
.
d’Œy
 !ğ
NULL
 )

348 
·th
.
d’Œy
->
d_İ
 = &
Úlßdfs_d’Œy_İ”©iÚs
;

350 
·th
.
d’Œy
 = 
	`d_®loc_p£udo
(
Úlßd_mÁ
->
mÁ_sb
, &
Çme
);

353 #ifdeà
EFX_HAVE_D_DNAME


354 
my_d’Œy
 = 
	`d_®loc
(
Úlßd_mÁ
->
mÁ_sb
->
s_roÙ
, &
Çme
);

357 
¡r
[32];

358 
Çme
.
Ën
 = 
	`Úlßdfs_Çme
(&
	`cÚš”_of
(
šode
, 
Úlßd_šode
,

359 
vfs_šode
)->
´iv
,

360 
¡r
, (str));

361 
Çme
.Çmğ
¡r
;

362 
Çme
.
hash
 = 
šode
->
i_šo
;

363 
my_d’Œy
 = 
	`d_®loc
(
Úlßd_mÁ
->
mÁ_sb
->
s_roÙ
, &
Çme
);

368 ifĞ
my_d’Œy
 =ğ
NULL
 ) {

369 
	`put_unu£d_fd
(
fd
);

370 
	`ut
(
šode
);

371  -
ENOMEM
;

374 #ià!
	`defšed
(
EFX_FSTYPE_HAS_MOUNT
è|| defšed(
EFX_OLD_MOUNT_PSEUDO
)

375 
my_d’Œy
->
d_İ
 = &
Úlßdfs_d’Œy_İ”©iÚs
;

376 #ià!
	`defšed
(
EFX_HAVE_STRUCT_PATH
è&& defšed(
EFX_HAVE_D_DNAME
)

377 
my_d’Œy
->
d_æags
 &ğ~
DCACHE_UNHASHED
;

380 
	`d_š¡ªtŸ‹
(
my_d’Œy
, 
šode
);

381 #iâdeà
EFX_HAVE_D_DNAME


382 
	`d_»hash
(
my_d’Œy
);

384 
šode
->
i_fİ
 = 
fİs
;

386 #ifdeà
EFX_HAVE_STRUCT_PATH


387 
·th
.
mÁ
 = 
	`mÁg‘
(
Úlßd_mÁ
);

388 
fe
 = 
	`®loc_fe
(&
·th
, 
FMODE_READ
 | 
FMODE_WRITE
, 
fİs
);

390 
fe
 = 
	`®loc_fe
(
Úlßd_mÁ
, 
d’Œy
, 
FMODE_READ
 | 
FMODE_WRITE
, 
fİs
);

392 ifĞ
fe
 =ğ
NULL
) {

393 #ifdeà
EFX_HAVE_STRUCT_PATH


394 
	`·th_put
(&
·th
);

396 
	`dput
(
d’Œy
);

397 
	`ut
(
šode
);

399 
	`put_unu£d_fd
(
fd
);

400  -
ENFILE
;

403 
´iv
->
_fp
 = 
fe
;

404 
fe
->
f_æags
 = 
O_RDWR
 | (
æags
 & 
O_NONBLOCK
);

405 
fe
->
f_pos
 = 0;

406 
fe
->
´iv©e_d©a
 = 
´iv
;

408 ifĞ
æags
 & 
O_CLOEXEC
 ) {

409 
fes_¡ruù
 *
fes
 = 
cu¼’t
->files;

410 
fdbË
 *
fdt
;

411 
	`¥š_lock
(&
fes
->
fe_lock
);

412 
fdt
 = 
	`fes_fdbË
(
fes
);

413 
	`rcu_assign_poš‹r
(
fdt
->
fd
[fd], 
fe
);

414 
	`efx_£t_şo£_Ú_exec
(
fd
, 
fdt
);

415 
	`¥š_uÆock
(&
fes
->
fe_lock
);

417 
	`fd_š¡®l
(
fd
, 
fe
);

418 
	`Œy_moduË_g‘
(
THIS_MODULE
);

420 
	`ci_as£¹_equ®
(
fe
->
f_İ
, 
fİs
);

421  
fd
;

422 
	}
}

424 
	$Úlßd_´iv_ä“
(
ci_´iv©e_t
 *
´iv
)

426 ifĞ
´iv
->
_fp
->
f_vfsmÁ
 !ğ
Úlßd_mÁ
)

427 
	`ci_ä“
(
´iv
);

429 
	}
}

433 
	$oo_ü—‹_fd
(
tı_h–³r_’dpošt_t
* 
•
, 
æags
, 
fd_ty³
)

435 
fd
;

436 
tı_h–³r_»sourû_t
 *
Œs
 = 
•
->
thr
;

437 
c™p_wa™abË_obj
 *
wo
 = 
	`SP_TO_WAITABLE_OBJ
(&
Œs
->
Ãtif
, 
•
->
id
);

439 
	`eçb_thr_»f
(
Œs
);

440 
fd
 = 
	`Úlßd_®loc_fe
(
Œs
, 
•
->
id
, 
æags
, 
fd_ty³
);

441 ifĞ
fd
 < 0 ) {

442 
	`eçb_thr_»Ëa£
(
Œs
);

443 
	`OO_DEBUG_ERR
(
	`ci_log
("%s: oÆßd_®loc_fçed (%d)", 
__FUNCTION__
, 
fd
));

444  
fd
;

446 
	`ci_©omic32_ªd
(&
wo
-> 
wa™abË
.
sb_aæags
,

447 ~(
CI_SB_AFLAG_ORPHAN
 | 
CI_SB_AFLAG_TCP_IN_ACCEPTQ
));

449  
fd
;

450 
	}
}

453 
	$oo_ü—‹_¡ack_fd
(
tı_h–³r_»sourû_t
 *
thr
)

455 
fd
;

457 
	`eçb_thr_»f
(
thr
);

458 
fd
 = 
	`Úlßd_®loc_fe
(
thr
, 
OO_SP_NULL
, 
O_CLOEXEC
, 
CI_PRIV_TYPE_NETIF
);

459 ifĞ
fd
 < 0 ) {

460 
	`eçb_thr_»Ëa£
(
thr
);

461 
	`OO_DEBUG_ERR
(
	`ci_log
("%s: oÆßd_®loc_fçed (%d)", 
__FUNCTION__
, 
fd
));

462  
fd
;

464  
fd
;

465 
	}
}

468 
	$Úlßdfs_g‘_dev_t
(
ci_´iv©e_t
* 
´iv
, * 
¬g
)

470 
ci_ušt32
 *
p_dev
 = 
¬g
;

471 *
p_dev
 = (
ci_ušt32
)
Úlßd_mÁ
->
mÁ_sb
->
s_dev
;

474 
	}
}

479 
	$oo_move_fe
(
ci_´iv©e_t
* 
´iv
, 
tı_h–³r_»sourû_t
 *
Ãw_thr
,

480 
oo_¥
 
Ãw_sockid
)

482 
´iv
->
thr
 = 
Ãw_thr
;

483 
´iv
->
sock_id
 = 
Ãw_sockid
;

484 #iâdeà
EFX_HAVE_D_DNAME


488 
d’Œy
 *d’Œy = 
´iv
->
_fp
->
f_d’Œy
;

489 ifĞ
	`dÇme_ex‹º®
(
d’Œy
) ) {

496 
	`d_drİ
(
d’Œy
);

497 
d’Œy
->
d_Çme
.
Ën
 = 
	`Úlßdfs_Çme
(
´iv
, d’Œy->
d_šame
,

498 (
d’Œy
->
d_šame
));

499 
	`d_»hash
(
d’Œy
);

502 
	}
}

	@ossock_calls.c

10 
	~<ci/š‹º®/.h
>

11 
	~<Úlßd/tı_h–³r.h
>

12 
	~<Úlßd/debug.h
>

13 
	~<Úlßd/fd_´iv©e.h
>

14 
	~<Úlßd/commÚ.h
>

16 
	~<Ãt/tı.h
>

17 
	~<lšux/com·t.h
>

19 
	~<Úlßd/tı_h–³r_âs.h
>

20 
	~<Úlßd/lšux_Úlßd.h
>

21 
	~<Úlßd/lšux_Úlßd_š‹º®.h
>

23 
	~"Úlßd_k”Ãl_com·t.h
"

25 #ià
CI_CFG_EPOLL_HANDOVER_WORKAROUND


27 
DECLARE_RWSEM
(
hªdov”_rwlock
);

29 
	$oo_fİ_»Ëa£_nÙhšg
(
šode
 *šode, 
fe
 *file)

32 
	}
}

33 
fe_İ”©iÚs
 
	goo_fİ_do_nÙhšg
 =

35 .
owÃr
 = 
THIS_MODULE
,

36 .
	g»Ëa£
 = 
oo_fİ_»Ëa£_nÙhšg
,

41 
	$oo_fd_hªdov”_ov”wr™e
(
fe
* 
oo_fe
, fe* 
os_fe
)

45 
d’Œy
 *
Şd_d’Œy
 = 
oo_fe
->
f_d’Œy
;

46 
vfsmouÁ
 *
Şd_vfsmÁ
 = 
oo_fe
->
f_vfsmÁ
;

49 
oo_fe
->
´iv©e_d©a
 = 
os_fe
->private_data;

50 
oo_fe
->
f_İ
 = 
os_fe
->f_op;

51 
oo_fe
->
f_d’Œy
 = 
os_fe
->f_dentry;

52 
oo_fe
->
f_vfsmÁ
 = 
os_fe
->f_vfsmnt;

53 
oo_fe
->
f_owÃr
.
pid
 = 
os_fe
->f_owner.pid;

54 #ià
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(2,6,19)

55 
oo_fe
->
f_owÃr
.
pid_ty³
 = 
os_fe
->f_owner.pid_type;

57 
oo_fe
->
f_owÃr
.
uid
 = 
os_fe
->f_owner.uid;

58 
oo_fe
->
f_owÃr
.
euid
 = 
os_fe
->f_owner.euid;

59 
oo_fe
->
f_owÃr
.
signum
 = 
os_fe
->f_owner.signum;

60 
oo_fe
->
f_æags
 = 
os_fe
->f_flags;

61 #ià
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(3,9,0)

62 
oo_fe
->
f_šode
 = 
os_fe
->f_inode;

67 
	`ci_as£¹
(
	`S_ISSOCK
(
os_fe
->
f_d’Œy
->
d_šode
->
i_mode
));

68 
	`SOCKET_I
(
os_fe
->
f_d’Œy
->
d_šode
)->
fe
 = 
oo_fe
;

71 
os_fe
->
f_İ
 = &
oo_fİ_do_nÙhšg
;

72 
os_fe
->
f_d’Œy
 = 
Şd_d’Œy
;

73 
os_fe
->
f_vfsmÁ
 = 
Şd_vfsmÁ
;

74 
	}
}

81 
	$eçb_fd_hªdov”_»¶aû
(
fe
* 
Şd_fp
,

82 
fe
* 
Ãw_fp
, 
fd
)

84 
rc
 = -
ENOENT
;

86 
	`¥š_lock
(&
cu¼’t
->
fes
->
fe_lock
);

87 ifĞ
	`fcheck
(
fd
è=ğ
Şd_fp
 ) {

88 
	`g‘_fe
(
Ãw_fp
);

89 
	`ci_fdbË_£t_fd
(
	`ci_fes_fdbË
(
cu¼’t
->
fes
), 
fd
, 
Ãw_fp
);

90 
rc
 = 0;

92 
	`¥š_uÆock
(&
cu¼’t
->
fes
->
fe_lock
);

94 ifĞ
rc
 == 0 )

95 
	`åut
(
Şd_fp
);

97  
rc
;

98 
	}
}

105 
	$eçb_tı_h–³r_hªdov”
(
ci_´iv©e_t
* 
´iv
, *
p_fd
)

107 
tı_h–³r_’dpošt_t
* 
•
;

108 
fd
 = *(
ci_št32
*è
p_fd
;

109 
fe
 *
oo_fe
, *
os_fe
;

110 
ci_´iv©e_t
 *
fd_´iv
;

111 
rc
, 
lše
;

117 ifĞ
´iv
->
fd_ty³
 !ğ
CI_PRIV_TYPE_NETIF
 ) {

118 
lše
 = 
__LINE__
;

119 
uÃx³ùed_”rÜ
;

122 
oo_fe
 = 
	`fg‘
(
fd
);

123 ifĞ
oo_fe
->
f_İ
 !ğ&
lšux_tı_h–³r_fİs_tı
 &&

124 
oo_fe
->
f_İ
 !ğ&
lšux_tı_h–³r_fİs_udp
 ) {

125 
lše
 = 
__LINE__
;

126 
uÃx³ùed_”rÜ
;

128 
fd_´iv
 = 
oo_fe
->
´iv©e_d©a
;

129 
	`ci_as£¹
Ğ
	`CI_PRIV_TYPE_IS_ENDPOINT
(
fd_´iv
->
fd_ty³
) );

130 ifĞ
´iv
->
thr
 !ğ
fd_´iv
->thr ) {

131 
lše
 = 
__LINE__
;

132 
uÃx³ùed_”rÜ
;

134 
•
 = 
	`ci_Œs_•_g‘
(
fd_´iv
->
thr
, fd_´iv->
sock_id
);

135 ifĞ
•
->
os_sock‘
 =ğ
NULL
 ) {

136 
lše
 = 
__LINE__
;

137 
uÃx³ùed_”rÜ
;

141 ifĞ
•
->
çsync_queue
 )

142 
	`çsync_h–³r
(-1, 
oo_fe
, 0, &
•
->
çsync_queue
);

144 
os_fe
 = 
•
->
os_sock‘
->
fe
;

145 
rc
 = 
	`eçb_fd_hªdov”_»¶aû
(
oo_fe
, 
os_fe
, 
fd
);

146 ifĞ
rc
 != 0 ) {

147 
	`LOG_E
(
	`ci_log
("%s: ERROR: %d:%d fd=%d: handover failed dueo„ace",

148 
__FUNCTION__
, 
•
->
thr
->
id
,ƒp->id, 
fd
));

149 
	`åut
(
oo_fe
);

150  
rc
;

154 #ià
CI_CFG_EPOLL_HANDOVER_WORKAROUND


155 ifĞ
	`fe_couÁ
(
oo_fe
) == 1

156 #ifdeà
NDEBUG


157 && ! 
	`li¡_em±y
(&
oo_fe
->
f_•_lšks
)

163 
ci_´iv©e_t
 *
´iv
 = (ci_´iv©e_ˆ*è
oo_fe
->
´iv©e_d©a
;

165 
	`down_wr™e
(&
hªdov”_rwlock
);

166 
	`¥š_lock
(&
cu¼’t
->
fes
->
fe_lock
);

167 ifĞ
	`fe_couÁ
(
oo_fe
è=ğ1 && 
	`fcheck
(
fd
è=ğ
os_fe
 ) {

168 
	`oo_fd_hªdov”_ov”wr™e
(
oo_fe
, 
os_fe
);

169 
	`ci_fdbË_£t_fd
(
	`ci_fes_fdbË
(
cu¼’t
->
fes
), 
fd
, 
oo_fe
);

172 
	`¥š_uÆock
(&
cu¼’t
->
fes
->
fe_lock
);

173 
	`up_wr™e
(&
hªdov”_rwlock
);

174 
	`LOG_E
(
	`ci_log
("%s: ERROR: %d:%d fd=%d:ƒpoll handover failed; socket "

176 
__FUNCTION__
, 
•
->
thr
->
id
,ƒp->id, 
fd
));

177 
nÚ_•Şl
;

179 
	`¥š_uÆock
(&
cu¼’t
->
fes
->
fe_lock
);

180 
	`up_wr™e
(&
hªdov”_rwlock
);

184 
	`g’”ic_tı_h–³r_şo£
(
´iv
);

185 
	`eçb_thr_»Ëa£
(
´iv
->
thr
);

188 
	`ci_as£¹_equ®
(
	`fe_couÁ
(
os_fe
), 1);

190 
os_fe
->
f_İ
 = &
oo_fİ_do_nÙhšg
;

191 
	`åut
(
os_fe
);

195 
nÚ_•Şl
:

207 ifĞ
	`fe_couÁ
(
oo_fe
) != 1 ) {

208 
	`LOG_E
(
	`ci_log
("%s: ERROR: handover of %d:%d fd=%d duplicated by dup or fork "

209 "Ôefs=%d)", 
__FUNCTION__
, 
•
->
thr
->
id
,ƒp->id, 
fd
,

210 (è
	`fe_couÁ
(
oo_fe
)));

216 
	`åut
(
oo_fe
);

220 
uÃx³ùed_”rÜ
:

221 
	`OO_DEBUG_ERR
(
	`ci_log
("%s: ERROR: unexpectedƒrror in HANDOVER‡t†ine %d",

222 
__FUNCTION__
, 
lše
));

223  -
EINVAL
;

224 
	}
}

227 #ifdeà
CONFIG_COMPAT


229 
	$cİy_com·t_iovec_äom_u£r
(
iovec
* iovec,

230 
com·t_iovec
 
__u£r
* 
uiovec
,

231 
iovËn
)

233 
com·t_u±r_t
 
iov_ba£
;

234 
com·t_size_t
 
iov_Ën
;

235 
i
;

237  
i
 = 0; i < 
iovËn
; ++i ) {

238 ifĞ
	`g‘_u£r
(
iov_Ën
, &
uiovec
[
i
].iov_len) ||

239 
	`g‘_u£r
(
iov_ba£
, &
uiovec
[
i
].iov_base) )

240  -
EFAULT
;

241 
iovec
[
i
].
iov_ba£
 = 
	`com·t_±r
(iov_base);

242 
iovec
[
i
].
iov_Ën
 = (
__k”Ãl_size_t
) iov_len;

245 
	}
}

256 #ià
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(3,7,0)

258 
	$oo_š¡®l_fe_to_fd
(
fe
 *fe, 
æags
)

260 
fd
 = 
	`g‘_unu£d_fd_æags
(
æags
);

262 if(
	`uÆik–y
Ğ
fd
 < 0 ))

263  
fd
;

265 
	`g‘_fe
(
fe
);

266 
	`fd_š¡®l
(
fd
, 
fe
);

268  
fd
;

269 
	}
}

273 
	$oo_š¡®l_fe_to_fd
(
fe
 *fe, 
æags
)

275 
fd
 = 
	`g‘_unu£d_fd
();

276 
fes_¡ruù
 *
fes
 = 
cu¼’t
->files;

277 
fdbË
 *
fdt
;

279 if(
	`uÆik–y
Ğ
fd
 < 0 ))

280  
fd
;

282 
	`g‘_fe
(
fe
);

285 
	`¥š_lock
(&
fes
->
fe_lock
);

286 
fdt
 = 
	`fes_fdbË
(
fes
);

287 
	`rcu_assign_poš‹r
(
fdt
->
fd
[fd], 
fe
);

288 ifĞ
æags
 & 
O_CLOEXEC
)

289 
	`efx_£t_şo£_Ú_exec
(
fd
, 
fdt
);

290 
	`¥š_uÆock
(&
fes
->
fe_lock
);

292  
fd
;

293 
	}
}

298 #ià
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(3,7,0)

300 
	$sock_m­_fd
(
sock‘
 *
sock
, 
æags
)

302 
fe
 *file;

303 
fd
;

305 ifĞ(
fd
 = 
	`g‘_unu£d_fd_æags
(
æags
)) < 0 )

306  
fd
;

307 ifĞ
	`IS_ERR
(
fe
 = 
	`sock_®loc_fe
(
sock
, 
æags
, 
NULL
)) ) {

308 
	`put_unu£d_fd
(
fd
);

309  
	`PTR_ERR
(
fe
);

311 
	`fd_š¡®l
(
fd
, 
fe
);

312  
fd
;

313 
	}
}

318 #ià
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(3,7,0)

322 
fe
 *
	$sock_®loc_fe
(
sock‘
 *
sock
, 
æags
, *
unu£d
)

324 
fd
;

325 
fe
 *file;

327 #ifdeà
SOCK_TYPE_MASK


328 
fd
 = 
	`sock_m­_fd
(
sock
, 
æags
 | 
SOCK_CLOEXEC
);

330 
fd
 = 
	`sock_m­_fd
(
sock
);

332 ifĞ
fd
 < 0 )

333  
	`ERR_PTR
(
fd
);

334 
fe
 = 
	`fg‘
(
fd
);

335 ifĞ
fe
 =ğ
NULL
 ) {

336 
	`ci_log
("%s: fd=%d clo£d und” f“t!", 
__func__
, 
fd
);

337  
	`ERR_PTR
(-
EFAULT
);

339 
	`eçb_lšux_sys_şo£
(
fd
);

340  
fe
;

341 
	}
}

344 
	$g‘_os_fd_äom_•
(
tı_h–³r_’dpošt_t
 *
•
)

346 
fe
 *
os_fe
;

348 ifĞ
	`oo_os_sock_g‘_äom_•
(
•
, &
os_fe
) != 0 )

349  -
EINVAL
;

351  
	`oo_š¡®l_fe_to_fd
(
os_fe
, 
O_CLOEXEC
);

352 
	}
}

359 
	$eçb_tı_h–³r_g‘_sock_fd
(
ci_´iv©e_t
* 
´iv
, *
¬g
)

361 
oo_os_sock_fd_g‘_t
 *
İ
 = 
¬g
;

362 
tı_h–³r_’dpošt_t
 *
•
;

363 
ci_št32
 
sock_id
 = 
İ
->sock_id;

365 ifĞ
İ
->
sock_id
 < 0 )

366 
sock_id
 = 
	`OO_SP_TO_INT
(
´iv
->sock_id);

367 
•
 = 
	`ci_Œs_g‘_v®id_•
(
´iv
->
thr
, 
sock_id
);

369 
İ
->
fd_out
 = 
	`g‘_os_fd_äom_•
(
•
);

371  
İ
->
fd_out
 >= 0 ? 0 : op->fd_out;

372 
	}
}

380 
sock‘
 *

381 
	$g‘_lšux_sock‘
(
tı_h–³r_’dpošt_t
* 
•
)

383 
ci_os_fe
 
sock‘p
;

384 
šode
 *inode;

385 
sock‘
 *
sock
;

386 
rc
;

388 
rc
 = 
	`oo_os_sock_g‘_äom_•
(
•
, &
sock‘p
);

389 ifĞ
rc
 != 0 )

390  
NULL
;

391 
šode
 = 
sock‘p
->
f_d’Œy
->
d_šode
;

392 ifĞ
šode
 =ğ
NULL
 )

393  
NULL
;

395 
	`ci_as£¹
(
	`S_ISSOCK
(
šode
->
i_mode
));

396 
sock
 = 
	`SOCKET_I
(
šode
);

397 
	`ci_as£¹_equ®
(
sock
->
fe
, 
sock‘p
);

398  
sock
;

399 
	}
}

401 
	$eçb_tı_h–³r_os_sock_£ndmsg
(
ci_´iv©e_t
* 
´iv
, *
¬g
)

403 
oo_os_sock_£ndmsg_t
 *
İ
 = 
¬g
;

411 
tı_h–³r_’dpošt_t
 *
•
;

412 
sock‘
* 
sock
;

413 
iovec
 
loÿl_iovec
[
UIO_FASTIOV
];

414 
iovec_by‹s
 = 0, 
tÙ®_by‹s
;

415 
sockaddr_¡Üage
 
addr
;

416 
msghdr
 
msg
;

417 
i
, 
rc
;

418 
loÿl_ùl
[(
cmsghdr
) + 20]

419 
	`__©Œibu‹__
 ((
	`®igÃd
((
__k”Ãl_size_t
))));

420 *
ùl_buf
 = 
loÿl_ùl
;

422 
•
 = 
	`ci_Œs_g‘_v®id_•
(
´iv
->
thr
, 
İ
->
sock_id
);

423 
sock
 = 
	`g‘_lšux_sock‘
(
•
);

424 ifĞ
sock
 =ğ
NULL
 )

425  -
EINVAL
;

427 
rc
 = -
EMSGSIZE
;

428 
msg
.
msg_iov
 = 
loÿl_iovec
;

429 
msg
.
msg_iovËn
 = 
İ
->msg_iovlen;

431 ifĞ
İ
->
msg_iovËn
 > 
UIO_MAXIOV
 )

432 
out
;

434 
iovec_by‹s
 = 
İ
->
msg_iovËn
 * (
loÿl_iovec
[0]);

435 
rc
 = -
ENOMEM
;

436 ifĞ
İ
->
msg_iovËn
 > 
UIO_FASTIOV
 )

437 
msg
.
msg_iov
 = 
	`sock_km®loc
(
sock
->
sk
, 
iovec_by‹s
, 
GFP_KERNEL
);

438 ifĞ
msg
.
msg_iov
 =ğ
NULL
 )

439 
out
;

441 ifĞ
İ
->
msg_cÚŒŞËn
 ) {

442 #ifdeà
CONFIG_COMPAT


444 
	`ci_as£¹_equ®
(
İ
->
sizeof_±r
, (*));

447 ifĞ
İ
->
msg_cÚŒŞËn
 > 
INT_MAX
 ) {

448 
rc
 = -
ENOBUFS
;

449 
out
;

451 ifĞ
İ
->
msg_cÚŒŞËn
 > (
loÿl_ùl
) ) {

452 
ùl_buf
 = 
	`sock_km®loc
(
sock
->
sk
, 
İ
->
msg_cÚŒŞËn
, 
GFP_KERNEL
);

453 ifĞ
ùl_buf
 =ğ
NULL
 )

454 
out
;

456 ifĞ
	`cİy_äom_u£r
(
ùl_buf
, 
	`CI_USER_PTR_GET
(
İ
->
msg_cÚŒŞ
),

457 
İ
->
msg_cÚŒŞËn
) ) {

458 
rc
 = -
EFAULT
;

459 
out
;

461 
msg
.
msg_cÚŒŞ
 = 
ùl_buf
;

462 
msg
.
msg_cÚŒŞËn
 = 
İ
->msg_controllen;

465 
msg
.
msg_cÚŒŞ
 = 
NULL
;

466 
msg
.
msg_cÚŒŞËn
 = 0;

469 
msg
.
msg_Çm–’
 = 
İ
->msg_namelen;

470 ifĞ
İ
->
msg_Çm–’
 == 0 )

471 
msg
.
msg_Çme
 = 
NULL
;

472 ifĞ
İ
->
msg_Çm–’
 < 0 ||

473 
İ
->
msg_Çm–’
 > (
sockaddr_¡Üage
) ) {

474 
rc
 = -
EINVAL
;

475 
out
;

477 ifĞ
	`cİy_äom_u£r
(&
addr
, 
	`CI_USER_PTR_GET
(
İ
->
msg_Çme
),

478 
İ
->
msg_Çm–’
) ) {

479 
rc
 = -
EFAULT
;

480 
out
;

483 
msg
.
msg_Çme
 = &
addr
;

485 
msg
.
msg_æags
 = 
İ
->
æags
;

487 
rc
 = -
EFAULT
;

488 #ifdeà
CONFIG_COMPAT


489 ifĞ
İ
->
sizeof_±r
 != (*) ) {

490 ifĞ
	`cİy_com·t_iovec_äom_u£r
(
msg
.
msg_iov
, 
	`CI_USER_PTR_GET
(
İ
->msg_iov),

491 
İ
->
msg_iovËn
) != 0 )

492 
out
;

496 ifĞ
	`cİy_äom_u£r
(
msg
.
msg_iov
, 
	`CI_USER_PTR_GET
(
İ
->msg_iov),

497 
İ
->
msg_iovËn
 * (
msg
.
msg_iov
[0])) != 0 )

498 
out
;

500 
tÙ®_by‹s
 = 0;

501  
i
 = 0; i < 
İ
->
msg_iovËn
; ++i )

502 
tÙ®_by‹s
 +ğ
msg
.
msg_iov
[
i
].
iov_Ën
;

503 
rc
 = -
EMSGSIZE
;

504 ifĞ
tÙ®_by‹s
 < 0 )

505 
out
;

507 
rc
 = 
	`sock_£ndmsg
(
sock
, &
msg
, 
tÙ®_by‹s
);

509 
	`oo_os_sock_¡©us_b™_ş—r
(
	`SP_TO_SOCK
(&
•
->
thr
->
Ãtif
,ƒp->
id
),

510 
OO_OS_STATUS_TX
,

511 
•
->
os_sock‘
->
fe
->
f_İ
->
	`pŞl
(

512 
•
->
os_sock‘
->
fe
, 
NULL
è& 
POLLOUT
);

514 
out
:

515 ifĞ
msg
.
msg_iov
 !ğ
loÿl_iovec
 && msg.msg_iov !ğ
NULL
)

516 
	`sock_kä“_s
(
sock
->
sk
, 
msg
.
msg_iov
, 
iovec_by‹s
);

517 ifĞ
ùl_buf
 !ğ
loÿl_ùl
 && c_buà!ğ
NULL
)

518 
	`sock_kä“_s
(
sock
->
sk
, 
ùl_buf
, 
İ
->
msg_cÚŒŞËn
);

519  
rc
;

520 
	}
}

522 
	$eçb_tı_h–³r_os_sock_£ndmsg_¿w
(
ci_´iv©e_t
* 
´iv
, *
¬g
)

524 
oo_os_sock_£ndmsg_¿w_t
 *
İ
 = 
¬g
;

525 
tı_h–³r_’dpošt_t
 *
•
 = 
	`ci_Œs_g‘_v®id_•
(
´iv
->
thr
, 
İ
->
sock_id
);

526 
fd
, 
rc
;

527 
æags
 = 
İ
->flags;

529 
•
 = 
	`ci_Œs_g‘_v®id_•
(
´iv
->
thr
, 
İ
->
sock_id
);

530 
fd
 = 
	`g‘_os_fd_äom_•
(
•
);

532 #ifdeà
CONFIG_COMPAT


533 ifĞ
İ
->
sizeof_±r
 != (*) )

534 
rc
 = 
	`eçb_lšux_sys_£ndmsg32
(
fd
, 
	`CI_USER_PTR_GET
(
İ
->
msg
),

535 
	`CI_USER_PTR_GET
(
İ
->
sock‘ÿÎ_¬gs
),

536 
æags
);

539 
rc
 = 
	`eçb_lšux_sys_£ndmsg
(
fd
, 
	`CI_USER_PTR_GET
(
İ
->
msg
),

540 
	`CI_USER_PTR_GET
(
İ
->
sock‘ÿÎ_¬gs
), 
æags
);

543 
	`oo_os_sock_¡©us_b™_ş—r
(
	`SP_TO_SOCK
(&
•
->
thr
->
Ãtif
,ƒp->
id
),

544 
OO_OS_STATUS_TX
,

545 
•
->
os_sock‘
->
fe
->
f_İ
->
	`pŞl
(

546 
•
->
os_sock‘
->
fe
, 
NULL
è& 
POLLOUT
);

547 
	`eçb_lšux_sys_şo£
(
fd
);

548  
rc
;

549 
	}
}

552 
	$eçb_tı_h–³r_os_sock_»cvmsg
(
ci_´iv©e_t
* 
´iv
, *
¬g
)

554 
oo_os_sock_»cvmsg_t
 *
İ
 = 
¬g
;

559 
tı_h–³r_’dpošt_t
 *
•
;

560 
sock‘
 *
sock
;

561 
sockaddr
[(
sockaddr_š6
)];

562 
iovec
 
loÿl_iovec
[
UIO_FASTIOV
];

563 
iovec_by‹s
 = 0, 
tÙ®_by‹s
;

564 
msghdr
 
msg
;

565 
i
, 
rc
;

567 
•
 = 
	`ci_Œs_g‘_v®id_•
(
´iv
->
thr
, 
İ
->
sock_id
);

568 
sock
 = 
	`g‘_lšux_sock‘
(
•
);

569 ifĞ
sock
 =ğ
NULL
 )

572 
rc
 = -
EMSGSIZE
;

573 
msg
.
msg_iov
 = 
loÿl_iovec
;

574 
msg
.
msg_iovËn
 = 
İ
->msg_iovlen;

576 ifĞ
İ
->
msg_iovËn
 > 
UIO_MAXIOV
 )

577 
out
;

579 
iovec_by‹s
 = 
İ
->
msg_iovËn
 * (
loÿl_iovec
[0]);

580 
rc
 = -
ENOMEM
;

581 ifĞ
İ
->
msg_iovËn
 > 
UIO_FASTIOV
 )

582 
msg
.
msg_iov
 = 
	`sock_km®loc
(
sock
->
sk
, 
iovec_by‹s
, 
GFP_KERNEL
);

583 ifĞ
msg
.
msg_iov
 =ğ
NULL
 )

584 
out
;

586 ifĞ
İ
->
msg_Çm–’
 ) {

587 
msg
.
msg_Çme
 = 
sockaddr
;

588 
msg
.
msg_Çm–’
 = (
sockaddr
);

591 
msg
.
msg_Çme
 = 
NULL
;

592 
msg
.
msg_Çm–’
 = 0;

595 ifĞ
İ
->
msg_cÚŒŞËn
 ) {

596 
msg
.
msg_cÚŒŞ
 = 
	`CI_USER_PTR_GET
(
İ
->msg_control);

597 
msg
.
msg_cÚŒŞËn
 = 
İ
->msg_controllen;

600 
msg
.
msg_cÚŒŞ
 = 
NULL
;

601 
msg
.
msg_cÚŒŞËn
 = 0;

604 
msg
.
msg_æags
 = 0;

605 ifĞ
İ
->
sizeof_±r
 != (*) )

606 
msg
.
msg_æags
 = 
MSG_CMSG_COMPAT
;

607 #ifdeà
MSG_CMSG_CLOEXEC


608 
msg
.
msg_æags
 |ğ
İ
->
æags
 & 
MSG_CMSG_CLOEXEC
;

611 
rc
 = -
EFAULT
;

612 #ifdeà
CONFIG_COMPAT


613 ifĞ
İ
->
sizeof_±r
 != (*) ) {

614 ifĞ
	`cİy_com·t_iovec_äom_u£r
(
msg
.
msg_iov
, 
	`CI_USER_PTR_GET
(
İ
->msg_iov),

615 
İ
->
msg_iovËn
) != 0 )

616 
out
;

620 ifĞ
	`cİy_äom_u£r
(
msg
.
msg_iov
, 
	`CI_USER_PTR_GET
(
İ
->msg_iov),

621 
İ
->
msg_iovËn
 * (
msg
.
msg_iov
[0])) != 0 )

622 
out
;

624 
tÙ®_by‹s
 = 0;

625  
i
 = 0; i < 
İ
->
msg_iovËn
; ++i )

626 
tÙ®_by‹s
 +ğ
msg
.
msg_iov
[
i
].
iov_Ën
;

627 
rc
 = -
EMSGSIZE
;

628 ifĞ
tÙ®_by‹s
 < 0 )

629 
out
;

631 ifĞ
sock
->
fe
->
f_æags
 & 
O_NONBLOCK
 )

632 
İ
->
æags
 |ğ
MSG_DONTWAIT
;

633 
rc
 = 
	`sock_»cvmsg
(
sock
, &
msg
, 
tÙ®_by‹s
, 
İ
->
æags
);

635 
	`oo_os_sock_¡©us_b™_ş—r
(
	`SP_TO_SOCK
(&
•
->
thr
->
Ãtif
,ƒp->
id
),

636 
OO_OS_STATUS_RX
,

637 
sock
->
fe
->
f_İ
->
	`pŞl
(sock->fe, 
NULL
) &

638 
POLLIN
);

639 ifĞ
rc
 < 0 )

640 
out
;

642 ifĞ
	`CI_USER_PTR_GET
(
İ
->
msg_Çme
) ) {

643 ifĞ
İ
->
msg_Çm–’
 > 
msg
.msg_namelen )

644 
İ
->
msg_Çm–’
 = 
msg
.msg_namelen;

645 ifĞ
	`cİy_to_u£r
(
	`CI_USER_PTR_GET
(
İ
->
msg_Çme
),

646 
sockaddr
, 
İ
->
msg_Çm–’
) != 0 )

647 
rc
 = -
EFAULT
;

649 
İ
->
msg_Çm–’
 = 
msg
.msg_namelen;

651 ifĞ
	`CI_USER_PTR_GET
(
İ
->
msg_cÚŒŞ
) ) {

652 
İ
->
msg_cÚŒŞËn
 = ()
msg
.
msg_cÚŒŞ
 -

653 ()
	`CI_USER_PTR_GET
(
İ
->
msg_cÚŒŞ
);

654 ifĞ
msg
.
msg_æags
 & 
MSG_ERRQUEUE
 ) {

657 
	`¥š_lock_bh
(&
sock
->
sk
->
sk_”rÜ_queue
.
lock
);

658 ifĞ
	`skb_queue_em±y
(&
sock
->
sk
->
sk_”rÜ_queue
) )

659 
	`SP_TO_SOCK_CMN
(&
•
->
thr
->
Ãtif
,ƒp->
id
)->
so_”rÜ
 = 0;

660 
	`¥š_uÆock_bh
(&
sock
->
sk
->
sk_”rÜ_queue
.
lock
);

663 
İ
->
æags
 = 
msg
.
msg_æags
 &~ 
MSG_CMSG_COMPAT
;

665 
out
:

666 ifĞ
msg
.
msg_iov
 !ğ
loÿl_iovec
 && msg.msg_iov !ğ
NULL
)

667 
	`sock_kä“_s
(
sock
->
sk
, 
msg
.
msg_iov
, 
iovec_by‹s
);

668 
İ
->
rc
 =„c;

669  
rc
 > 0 ? 0 :„c;

670 
	}
}

673 #ifdeà
CI_LINUX_NO_MOVE_ADDR


676 
	$eçb_move_addr_to_k”Ãl
(
__u£r
 *
uaddr
, 
uËn
, 
sockaddr
 *
kaddr
)

678 ià(
uËn
 < 0 || uËÀ> (
sockaddr_¡Üage
))

679  -
EINVAL
;

680 ià(
uËn
 == 0)

682 ià(
	`cİy_äom_u£r
(
kaddr
, 
uaddr
, 
uËn
))

683  -
EFAULT
;

685 
	}
}

696 
	$eçb_tı_h–³r_bšd_os_sock
 (
tı_h–³r_»sourû_t
 *
Œs
,

697 
oo_¥
 
sock_id
,

698 
sockaddr
 *
addr
,

699 
add¾’
, 
ci_ušt16
 *
out_pÜt
)

701 
rc
;

702 
tı_h–³r_’dpošt_t
 *
•
;

703 
sock‘
 *
sock
;

705 
	`ci_as£¹
(
Œs
);

707 
•
 = 
	`ci_Œs_g‘_v®id_•
(
Œs
, 
sock_id
);

708 ifĞ
•
 =ğ
NULL
 )

709  -
EINVAL
;

710 
sock
 = 
	`g‘_lšux_sock‘
(
•
);

711 ifĞ
sock
 =ğ
NULL
 )

712  -
EINVAL
;

714 
rc
 = 
sock
->
İs
->
	`bšd
(sock, 
addr
, 
add¾’
);

715 
	`LOG_TV
(
	`ci_log
("%s:„c=%d", 
__FUNCTION__
, 
rc
));

717 ià(
rc
 >= 0) {

722 
rc
 = 
sock
->
İs
->
	`g‘Çme
(sock, 
addr
, &
add¾’
, 0);

724 *
out_pÜt
 = ((
sockaddr_š
*)
addr
)->
sš_pÜt
;

727  
rc
;

728 
	}
}

731 
	$eçb_tı_h–³r_li¡’_os_sock
(
tı_h–³r_»sourû_t
* 
Œs
,

732 
oo_¥
 
sock_id
, 
backlog
)

734 
rc
 = -
EINVAL
;

735 
tı_h–³r_’dpošt_t
 *
•
;

736 
sock‘
 *
sock
;

738 
	`ci_as£¹
 (
Œs
);

740 
•
 = 
	`ci_Œs_g‘_v®id_•
(
Œs
, 
sock_id
);

741 
sock
 = 
	`g‘_lšux_sock‘
(
•
);

742 ifĞ
sock
 =ğ
NULL
 )

743  -
EINVAL
;

748 ifĞ
•
->
os_sock_±
.
wh—d
 =ğ
NULL
 )

749 
	`eçb_tı_h–³r_os_pŞlwa™_»gi¡”
(
•
);

751 
rc
 = 
sock
->
İs
->
	`li¡’
 (sock, 
backlog
);

752 
	`LOG_TV
(
	`ci_log
("%s:„c=%d", 
__FUNCTION__
, 
rc
));

754  
rc
;

755 
	}
}

757 
	$eçb_tı_h–³r_shutdown_os_sock
 (
tı_h–³r_’dpošt_t
 *
•
,

758 
ci_št32
 
how
)

760 
rc
 = -
EINVAL
;

761 
sock‘
 *
sock
;

763 
	`ci_as£¹
 (
•
);

765 
sock
 = 
	`g‘_lšux_sock‘
(
•
);

766 ifĞ
sock
 =ğ
NULL
 )

767  -
EINVAL
;

769 
rc
 = 
sock
->
İs
->
	`shutdown
 (sock, 
how
);

770 
	`LOG_TV
(
	`ci_log
("%s: shutdown(%dèrc=%d", 
__FUNCTION__
, 
how
, 
rc
));

772  
rc
;

773 
	}
}

775 #ià
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,19è&& !
defšed
(
RHEL_MAJOR
)

776 
	$k”Ãl_acû±
(
sock‘
 *
sock
, sock‘ **
Ãwsock
, 
æags
)

778 
sock
 *
sk
 = sock->sk;

779 
”r
;

781 
”r
 = 
	`sock_ü—‹_l™e
(
sk
->
sk_çmy
, sk->
sk_ty³
, sk->
sk_´ÙocŞ
,

782 
Ãwsock
);

783 ià(
”r
 < 0)

784  
”r
;

786 
”r
 = 
sock
->
İs
->
	`acû±
(sock, *
Ãwsock
, 
æags
);

787 ià(
”r
 < 0) {

788 
	`sock_»Ëa£
(*
Ãwsock
);

789 *
Ãwsock
 = 
NULL
;

790  
”r
;

793 (*
Ãwsock
)->
İs
 = 
sock
->ops;

794 
	`__moduË_g‘
((*
Ãwsock
)->
İs
->
owÃr
);

796 
	}
}

800 
	$eçb_tı_h–³r_os_sock_acû±
(
ci_´iv©e_t
* 
´iv
, *
¬g
)

802 
oo_os_sock_acû±_t
 *
İ
 = 
¬g
;

803 
tı_h–³r_’dpošt_t
 *
•
 = 
	`ci_Œs_g‘_v®id_•
(
´iv
->
thr
, 
İ
->
sock_id
);

804 
ci_sock_cmn
 *
s
 = 
	`SP_TO_SOCK
(&
•
->
thr
->
Ãtif
,ƒp->
id
);

805 
sock‘
 *
sock
 = 
	`g‘_lšux_sock‘
(
•
);

806 
sock‘
 *
Ãwsock
;

807 
rc
;

809 
rc
 = 
	`k”Ãl_acû±
(
sock
, &
Ãwsock
, 
İ
->
æags
);

812 
	`oo_os_sock_¡©us_b™_ş—r
(
s
, 
OO_OS_STATUS_RX
,

813 
•
->
os_sock‘
->
fe
->
f_İ
->
	`pŞl
(ep->os_socket->file,

814 
NULL
è& 
POLLIN
);

816 ifĞ
rc
 != 0 )

817  
rc
;

818 
Ãwsock
->
ty³
 = 
sock
->type;

820 ifĞ
	`CI_USER_PTR_GET
(
İ
->
addr
è!ğ
NULL
 ) {

821 
add»ss
[(
sockaddr_š6
)];

822 
Ën
, 
uËn
;

824 
rc
 = 
Ãwsock
->
İs
->
	`g‘Çme
Òewsock, (
sockaddr
 *)
add»ss
, &
Ën
, 2);

825 ifĞ
rc
 != 0 )

826  -
ECONNABORTED
;

827 
rc
 = 
	`g‘_u£r
(
uËn
, (*)
	`CI_USER_PTR_GET
(
İ
->
add¾’
));

828 ifĞ
rc
 != 0 )

829  
rc
;

830 ifĞ
uËn
 < 0 )

831  -
EINVAL
;

832 ifĞ
uËn
 ) {

833 ifĞ
	`cİy_to_u£r
(
	`CI_USER_PTR_GET
(
İ
->
addr
), 
add»ss
,

834 
	`mš
(
uËn
, 
Ën
)) )

835  -
EFAULT
;

838 
	`__put_u£r
(
Ën
, (*)
	`CI_USER_PTR_GET
(
İ
->
add¾’
));

843 ifĞ!
	`NI_OPTS
(&
•
->
thr
->
Ãtif
).
acû±_šh”™_nod–ay
 &&

844 (
s
->
s_aæags
 & 
CI_SOCK_AFLAG_NODELAY
) ) {

845 
nod–ay
 = 0;

846 
rc
 = 
Ãwsock
->
İs
->
	`£tsockİt
Òewsock, 
IPPROTO_TCP
, 
TCP_NODELAY
,

847 (*)&
nod–ay
, (nodelay));

852 #ifdeà
SOCK_TYPE_MASK


854 ifĞ
	`NI_OPTS
(&
•
->
thr
->
Ãtif
).
acû±_šh”™_nÚblock
 && 
İ
->
æags
 == 0 &&

855 
s
->
b
.
sb_aæags
 & 
CI_SB_AFLAG_O_NONBLOCK
)

856 
İ
->
æags
 |ğ
SOCK_NONBLOCK
;

857 
İ
->
rc
 = 
	`sock_m­_fd
(
Ãwsock
, op->
æags
);

859 
İ
->
rc
 = 
	`sock_m­_fd
(
Ãwsock
);

861 ifĞ
İ
->
rc
 < 0 ) {

862 
	`sock_»Ëa£
(
Ãwsock
);

863  
İ
->
rc
;

866 #iâdeà
SOCK_TYPE_MASK


868 ifĞ
	`NI_OPTS
(&
•
->
thr
->
Ãtif
).
acû±_šh”™_nÚblock
) {

871 
fe
 *fğ
	`fg‘
(
İ
->
rc
);

872 ifĞ
fe
 =ğ
NULL
 )

874 
	`lock_k”Ãl
();

875 ifĞ
s
->
b
.
sb_aæags
 & 
CI_SB_AFLAG_O_NONBLOCK
 )

876 
fe
->
f_æags
 |ğ
O_NONBLOCK
;

877 ifĞ
s
->
b
.
sb_aæags
 & 
CI_SB_AFLAG_O_NDELAY
 )

878 
fe
->
f_æags
 |ğ
O_NDELAY
;

879 
	`uÆock_k”Ãl
();

884 
	}
}

888 
	$eçb_tı_h–³r_cÚÃù_os_sock
(
ci_´iv©e_t
 *
´iv
, *
¬g
)

890 
oo_tı_sockaddr_w™h_Ën_t
 *
İ
 = 
¬g
;

891 
ci_sock_cmn
* 
s
;

892 
size_t
 
add¾’
;

893 
rc
;

894 
tı_h–³r_’dpošt_t
 *
•
;

895 
sock‘
* 
sock
;

896 
sockaddr_¡Üage
 
k_add»ss_buf
;

897 
sockaddr
 *
k_add»ss
 = (sockadd¸*)&
k_add»ss_buf
;

899 
	`ci_as£¹
 (
´iv
 && 
İ
);

900 ià(!
	`CI_PRIV_TYPE_IS_ENDPOINT
(
´iv
->
fd_ty³
))

901  -
EINVAL
;

902 
	`ci_as£¹
(
´iv
->
thr
);

904 
add¾’
 = 
İ
->addrlen;

907 
•
 = 
	`ci_Œs_g‘_v®id_•
(
´iv
->
thr
,…riv->
sock_id
);

908 
sock
 = 
	`g‘_lšux_sock‘
(
•
);

909 ifĞ
sock
 =ğ
NULL
 )

910  -
EINVAL
;

911 
s
 = 
	`SP_TO_SOCK
(&
´iv
->
thr
->
Ãtif
, 
•
->
id
);

913 
rc
 = 
	`move_addr_to_k”Ãl
(
	`CI_USER_PTR_GET
(
İ
->
add»ss
), 
add¾’
, 
k_add»ss
);

914 ià(
rc
 >=0) {

917 ià((
s
->
b
.
sb_aæags
 & 
CI_SB_AFLAG_O_NONBLOCK
))

918 
sock
->
fe
->
f_æags
 |ğ
O_NONBLOCK
;

919 
rc
 = 
sock
->
İs
->
	`cÚÃù
(sock, 
k_add»ss
, 
add¾’
, sock->
fe
->
f_æags
);

922  
rc
;

923 
	}
}

926 
	$eçb_tı_h–³r_£t_tı_şo£_os_sock
(
tı_h–³r_»sourû_t
 *
thr
,

927 
oo_¥
 
sock_id
)

929 
tı_h–³r_’dpošt_t
* 
•
;

930 
sock‘
* 
sock
;

932 
•
 = 
	`ci_Œs_g‘_v®id_•
(
thr
, 
sock_id
);

933 ifĞ
•
 =ğ
NULL
 )

934  -
EINVAL
;

935 
sock
 = 
	`g‘_lšux_sock‘
(
•
);

936 ifĞ
sock
 =ğ
NULL
 )

937  -
EINVAL
;

938 
	`tı_£t_¡©e
(
sock
->
sk
, 
TCP_CLOSE
);

940 
	}
}

943 
	$eçb_tı_h–³r_g‘sockİt
(
tı_h–³r_»sourû_t
* 
Œs
,

944 
oo_¥
 
sock_id
, 
Ëv–
, 
İŠame
,

945 * 
İtv®
, * 
İ’
 )

947 
tı_h–³r_’dpošt_t
* 
•
;

948 
sock‘
* 
sock
;

949 
rc
 = -
EINVAL
;

951 
•
 = 
	`ci_Œs_g‘_v®id_•
(
Œs
, 
sock_id
);

952 
sock
 = 
	`g‘_lšux_sock‘
(
•
);

953 ifĞ
sock
 =ğ
NULL
 )

954  -
EINVAL
;

955 
rc
 = 
sock
->
İs
->
	`g‘sockİt
(sock, 
Ëv–
, 
İŠame
, 
İtv®
, 
İ’
);

956 
	`LOG_SV
(
	`ci_log
("%s:„c=%d", 
__FUNCTION__
, 
rc
));

957  
rc
;

958 
	}
}

961 
	$eçb_tı_h–³r_£tsockİt
(
tı_h–³r_»sourû_t
* 
Œs
,

962 
oo_¥
 
sock_id
, 
Ëv–
,

963 
İŠame
, * 
İtv®
, 
İ’
 )

965 
tı_h–³r_’dpošt_t
* 
•
;

966 
sock‘
* 
sock
;

967 
rc
 = -
EINVAL
;

974 
•
 = 
	`ci_Œs_g‘_v®id_•
(
Œs
, 
sock_id
);

975 
sock
 = 
	`g‘_lšux_sock‘
(
•
);

976 ifĞ
sock
 =ğ
NULL
 )

977  -
EINVAL
;

978 
rc
 = 
sock
->
İs
->
	`£tsockİt
(sock, 
Ëv–
, 
İŠame
, 
İtv®
, 
İ’
);

979 
	`LOG_SV
(
	`ci_log
("%s:„c=%d", 
__FUNCTION__
, 
rc
));

981  
rc
;

982 
	}
}

	@pinbuf.c

13 
	~<ci/driv”/š‹º®.h
>

14 
	~<Úlßd/debug.h
>

17 
	#FPL
(
x
è
	`CI_DEBUG
(x)

	)

23 
·ge
* 
	$ci_fŞlow_·ge
(
ci_addr_¥c_t
 
addr_¥c
, 
ÿddr_t
 
uaddr
)

25 
pgd_t
* 
pgd
;

26 
pmd_t
* 
pmd
;

27 
±e_t
* 
±•
;

28 
±e_t
 
±e
;

29 #ià
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(2,6,11)

30 
pud_t
* 
pud
;

32 
·ge
* 
pg
 = 0;

33 
ci_ušŒ_t
 
add»ss
 = (ci_ušŒ_t)
uaddr
;

36 
	`¥š_lock
(&
addr_¥c
->
·ge_bË_lock
);

38 
pgd
 = 
	`pgd_off£t
(
addr_¥c
, 
add»ss
);

39 ifĞ
	`CI_UNLIKELY
(
	`pgd_nÚe
(*
pgd
è| 
	`pgd_bad
(*pgd)) ) {

40 
	`FPL
(
	`ci_log
("follow_page: %lx…gd_none=%d…gd_bad=%d",

41 ()
add»ss
, (è
	`pgd_nÚe
(*
pgd
), (è
	`pgd_bad
(*pgd)));

42 
dÚe
;

45 #ià
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(2,6,11)

46 
pud
 = 
	`pud_off£t
(
pgd
, 
add»ss
);

47 ifĞ
	`CI_UNLIKELY
(
	`pud_nÚe
(*
pud
è| 
	`pud_bad
(*pud)) ) {

48 
	`FPL
(
	`ci_log
("follow_page: %lx…ud_none=%d…ud_bad=%d",

49 ()
add»ss
, (è
	`pud_nÚe
(*
pud
), (è
	`pud_bad
(*pud)));

50 
dÚe
;

52 
pmd
 = 
	`pmd_off£t
(
pud
, 
add»ss
);

54 
pmd
 = 
	`pmd_off£t
(
pgd
, 
add»ss
);

57 ifĞ
	`CI_UNLIKELY
(
	`pmd_nÚe
(*
pmd
è| 
	`pmd_bad
(*pmd)) ) {

58 
	`FPL
(
	`ci_log
("follow_page: %lx…md_none=%d…md_bad=%d",

59 ()
add»ss
, (è
	`pmd_nÚe
(*
pmd
), (è
	`pmd_bad
(*pmd)));

60 
dÚe
;

63 
±•
 = 
	`±e_off£t_m­
(
pmd
, 
add»ss
);

64 ifĞ
	`CI_UNLIKELY
(!
±•
) ) {

65 
	`FPL
(
	`ci_log
("fŞlow_·ge: %lx‚Ø±e", ()
add»ss
));

66 
dÚe
;

69 
±e
 = *
±•
;

70 
	`±e_unm­
(
±•
);

71 ifĞ
	`CI_LIKELY
(
	`±e_´e£Á
(
±e
)) ) {

72 ifĞ
	`ci_±e_v®id
(
±e
) )

73 
pg
 = 
	`±e_·ge
(
±e
);

75 #ifdeà
±e_pâ


76 
	`FPL
(
	`ci_log
("fŞlow_·ge: %lx…â=%lx‚Ù v®id", ()
add»ss
, 
	`±e_pâ
(
±e
)));

78 
	`FPL
(
	`ci_log
("fŞlow_·ge: %lx‚Ù v®id", ()
add»ss
));

81 
	`g‘_·ge
(
pg
);

84 
	`OO_DEBUG_VERB
(
	`ci_log
("fŞlow_·ge: %lx‚Ù…»£Á", ()
add»ss
));

86 
dÚe
:

87 
	`¥š_uÆock
(&
addr_¥c
->
·ge_bË_lock
);

89  
pg
;

90 
	}
}

	@ppc64_linux_trampoline.c

34 
	~<Úlßd/lšux_Úlßd_š‹º®.h
>

35 
	~<Úlßd/lšux_ŒampŞše.h
>

36 
	~<Úlßd/lšux_mm­.h
>

37 
	~<Úlßd/lšux_Úlßd.h
>

38 
	~<lšux/uni¡d.h
>

39 
	~"µc64_lšux_ŒampŞše_š‹º®.h
"

42 
	#TRAMP_DEBUG
(
x
...è()0

	)

46 
	#TRAMPOLINE_BITS_64
 0

	)

47 
	#TRAMPOLINE_BITS_32
 1

	)

49 
	s¡©e_¡ruù


51 
sysÿÎ_’Œy_t
 *
	m»¶aû_şo£
;

52 
sysÿÎ_’Œy_t
 *
	m»¶aû_ex™_group
;

53 
sysÿÎ_’Œy_t
 *
	m»¶aû_¹_sigaùiÚ
;

58 #ià
CI_CFG_USERSPACE_EPOLL


59 
sysÿÎ_’Œy_t
 *
	mno_»¶aû_•Şl_ü—‹1
;

60 
sysÿÎ_’Œy_t
 *
	mno_»¶aû_•Şl_ü—‹
;

62 
sysÿÎ_’Œy_t
 *
	mno_»¶aû_•Şl_ùl
;

63 
sysÿÎ_’Œy_t
 *
	mno_»¶aû_•Şl_wa™
;

66 
sysÿÎ_’Œy_t
 *
	mno_»¶aû_sock‘ÿÎ
;

67 } 
	t¡©e_t
;

69 
¡©e_t
 
	g¡©e
;

70 
©omic_t
 
	geçb_sysÿÎ_u£d
;

72 
£tup_ŒampŞše
(
±_»gs
 *
»gs
,

73 
İcode
, 
¬g
,

74 
b™s
);

80 
asmlškage
 
	$eçb_lšux_sys_şo£
(
fd
)

82 
rc
;

84 ià(
¡©e
.
»¶aû_şo£
)

86 
	`TRAMP_DEBUG
 ("şo£ %d vŸ saved_sys_şo£=%p...", 
fd
, 
¡©e
.
»¶aû_şo£
->
Üigš®_’Œy64
);

87 
rc
 = (((*)())(
¡©e
.
»¶aû_şo£
->
Üigš®_’Œy64
))(
fd
);

88 
	`TRAMP_DEBUG
 (".. = %d", 
rc
);

92 
	`ci_log
("Unexpected close()„equest before full init");

93  -
EFAULT
;

95  
rc
;

96 
	}
}

98 
asmlškage
 
	$eçb_lšux_sys_ex™_group
(
¡©us
)

100 ià(
¡©e
.
»¶aû_ex™_group
)

102  (((*)())(
¡©e
.
»¶aû_ex™_group
->
Üigš®_’Œy64
))(
¡©us
);

106 
	`ci_log
("Unexpectedƒxit_group()„equest before full init");

107  -
EFAULT
;

109 
	}
}

111 #ià
CI_CFG_USERSPACE_EPOLL


112 
asmlškage
 
	$eçb_lšux_sys_•Şl_ü—‹1
(
æags
)

114 
asmlškage
 (*
sys_•Şl_ü—‹_â
)();

115 
rc
;

117 #ifdeà
__NR_•Şl_ü—‹1


118 ià(
¡©e
.
no_»¶aû_•Şl_ü—‹1
)

120 
sys_•Şl_ü—‹_â
 = ((*)())(
¡©e
.
no_»¶aû_•Şl_ü—‹1
->
Üigš®_’Œy64
);

121 
	`TRAMP_DEBUG
("•Şl_ü—‹1 vŸ %°.. ", 
sys_•Şl_ü—‹_â
);

122 
rc
 = 
	`sys_•Şl_ü—‹_â
(
æags
);

123 ià(
rc
 !ğ-
ENOSYS
)

124 
out
;

127 ià(!
¡©e
.
no_»¶aû_•Şl_ü—‹
)

129 
	`ci_log
("Unexpectedƒpoll_ctl()„equest before full init");

130  -
EFAULT
;

132 
sys_•Şl_ü—‹_â
 = ((*)())(
¡©e
.
no_»¶aû_•Şl_ü—‹
->
Üigš®_’Œy64
);

133 
	`TRAMP_DEBUG
("•Şl_ü—‹ vŸ %°.. ", 
sys_•Şl_ü—‹_â
);

134 
rc
 = 
	`sys_•Şl_ü—‹_â
(1);

135 
	`ci_as£¹_equ®
(
æags
 & ~
EPOLL_CLOEXEC
, 0);

136 ià(
rc
 >ğ0 && (
æags
 & 
EPOLL_CLOEXEC
))

138 
fes_¡ruù
 *
fes
 = 
cu¼’t
->files;

139 
fdbË
 *
fdt
;

140 
	`¥š_lock
(&
fes
->
fe_lock
);

141 
fdt
 = 
	`fes_fdbË
(
fes
);

142 
	`efx_£t_şo£_Ú_exec
(
rc
, 
fdt
);

143 
	`¥š_uÆock
(&
fes
->
fe_lock
);

146 
out
;

147 
out
:

148 
	`TRAMP_DEBUG
(" ... = %d ", 
rc
);

149  
rc
;

150 
	}
}

152 
asmlškage
 
	$eçb_lšux_sys_•Şl_ùl
(
•fd
, 
İ
, 
fd
,

153 
•Şl_ev’t
 *
ev’t
)

155 
asmlškage
 (*
sys_•Şl_ùl_â
)(, , , 
•Şl_ev’t
 *);

156 
rc
;

158 ià(!
¡©e
.
no_»¶aû_•Şl_ùl
)

160 
	`ci_log
("Unexpectedƒpoll_ctl()„equest before full init");

161  -
EFAULT
;

164 
sys_•Şl_ùl_â
 = ((*)(, , , 
•Şl_ev’t
 *))

165 (
¡©e
.
no_»¶aû_•Şl_ùl
->
Üigš®_’Œy64
);

166 
	`TRAMP_DEBUG
 ("•Şl_ùl(%d,%d,%d,%pèvŸ %p...", 
•fd
, 
İ
, 
fd
, 
ev’t
,

167 
sys_•Şl_ùl_â
);

168 
rc
 = 
	`sys_•Şl_ùl_â
(
•fd
, 
İ
, 
fd
, 
ev’t
);

169 
	`TRAMP_DEBUG
 ("... = %d", 
rc
);

170  
rc
;

171 
	}
}

173 
asmlškage
 
	$eçb_lšux_sys_•Şl_wa™
(
•fd
, 
•Şl_ev’t
 *
ev’ts
,

174 
maxev’ts
, 
timeout
)

176 
asmlškage
 (*
sys_•Şl_wa™_â
)(, 
•Şl_ev’t
 *, , );

177 
rc
;

179 ifĞ!
¡©e
.
no_»¶aû_•Şl_wa™
 ) {

180 
	`ci_log
("Unexpectedƒpoll_wait()„equest before full init");

181  -
EFAULT
;

184 
sys_•Şl_wa™_â
 = ((*)(, 
•Şl_ev’t
 *, , ))

185 (
¡©e
.
no_»¶aû_•Şl_wa™
->
Üigš®_’Œy64
);

186 
	`TRAMP_DEBUG
 ("•Şl_wa™(%d,%p,%d,%dèvŸ %p...", 
•fd
, 
ev’ts
, 
maxev’ts
,

187 
timeout
, 
sys_•Şl_wa™_â
);

188 
rc
 = 
	`sys_•Şl_wa™_â
(
•fd
, 
ev’ts
, 
maxev’ts
, 
timeout
);

189 
	`TRAMP_DEBUG
 ("... = %d", 
rc
);

190  
rc
;

191 
	}
}

195 
asmlškage
 
	$eçb_lšux_sys_£ndmsg
(
fd
, 
msghdr
 
__u£r
* 
msg
,

196 
__u£r
* 
sock‘ÿÎ_¬gs
,

197 
æags
)

199 
rc
;

200 
asmlškage
 (*
sys_sock‘ÿÎ_â
)(, *);

201 
¬gs
[3];

203 ifĞ
¡©e
.
no_»¶aû_sock‘ÿÎ
 =ğ
NULL
 ) {

204 
	`ci_log
("Unexpected sendmsg->socketcall()„equest before full init");

205  -
EFAULT
;

208 
sys_sock‘ÿÎ_â
 = (*)

209 
¡©e
.
no_»¶aû_sock‘ÿÎ
->
Üigš®_’Œy64
;

210 
	`TRAMP_DEBUG
 ("£ndmsg(%d,%p,%dèvŸ %p...", 
fd
, 
msg
,

211 
æags
, 
sys_sock‘ÿÎ_â
);

212 
	`mem£t
(
¬gs
, 0, (args));

213 
¬gs
[0] = ()
fd
;

214 
¬gs
[1] = ()
msg
;

215 
¬gs
[2] = ()
æags
;

216 
rc
 = -
EFAULT
;

217 ià(
	`cİy_to_u£r
(
sock‘ÿÎ_¬gs
, 
¬gs
, (args)) == 0)

218 
rc
 = (
sys_sock‘ÿÎ_â
è(
SYS_SENDMSG
, 
sock‘ÿÎ_¬gs
);

220 
	`TRAMP_DEBUG
 ("... = %d", 
rc
);

221  
rc
;

222 
	}
}

224 #ifdeà
CONFIG_COMPAT


225 
asmlškage
 

226 
	$eçb_lšux_sys_£ndmsg32
(
fd
, 
com·t_msghdr
 
__u£r
* 
msg
,

227 
__u£r
* 
sock‘ÿÎ_¬gs
,

228 
æags
)

230 
rc
;

231 
asmlškage
 (*
sys_sock‘ÿÎ_â
)(, *);

232 
com·t_ulÚg_t
 
¬gs
[3];

234 ifĞ
¡©e
.
no_»¶aû_sock‘ÿÎ
 =ğ
NULL
 ) {

235 
	`ci_log
("Unexpected sendmsg->socketcall()„equest before full init");

236  -
EFAULT
;

239 
sys_sock‘ÿÎ_â
 = (*)

240 
¡©e
.
no_»¶aû_sock‘ÿÎ
->
Üigš®_’Œy32
;

241 
	`TRAMP_DEBUG
 ("£ndmsg(%d,%p,%dèvŸ %p...", 
fd
, 
msg
,

242 
æags
, 
sys_sock‘ÿÎ_â
);

243 
	`mem£t
(
¬gs
, 0, (args));

244 
¬gs
[0] = ()
fd
;

245 
¬gs
[1] = ()
msg
;

246 
¬gs
[2] = ()
æags
;

247 
rc
 = -
EFAULT
;

248 ià(
	`cİy_to_u£r
(
sock‘ÿÎ_¬gs
, 
¬gs
, (args)) == 0)

249 
rc
 = (
sys_sock‘ÿÎ_â
è(
SYS_SENDMSG
, 
sock‘ÿÎ_¬gs
);

251 
	`TRAMP_DEBUG
 ("... = %d", 
rc
);

252  
rc
;

253 
	}
}

256 
asmlškage
 
	$eçb_lšux_sys_sigaùiÚ
(
signum
,

257 cÚ¡ 
sigaùiÚ
 *
aù
,

258 
sigaùiÚ
 *
ßù
)

260 
rc
;

262 ià(
¡©e
.
»¶aû_¹_sigaùiÚ
 =ğ
NULL
) {

263 
	`ci_log
("Unexpected„t_sigaction()„equest before full init");

264  -
EFAULT
;

267 
	`TRAMP_DEBUG
 ("sigaùiÚ(%d,%p,%p,%dèvŸ %p...", 
signum
, 
aù
, 
ßù
,

268 ()(
sig£t_t
), 
¡©e
.
»¶aû_¹_sigaùiÚ
->
Üigš®_’Œy64
);

269 
rc
 = (((*)(, cÚ¡ 
sigaùiÚ
 *, sigaùiÚ *, 
size_t
))

270 (
¡©e
.
»¶aû_¹_sigaùiÚ
->
Üigš®_’Œy64
))(
signum
, 
aù
, 
ßù
, (
sig£t_t
));

271 
	`TRAMP_DEBUG
 ("... = %d", 
rc
);

272  
rc
;

273 
	}
}

275 #ifdeà
CONFIG_COMPAT


276 
asmlškage
 
	$eçb_lšux_sys_sigaùiÚ32
(
signum
,

277 cÚ¡ 
sigaùiÚ32
 *
aù
,

278 
sigaùiÚ32
 *
ßù
)

280 
rc
;

282 ià(
¡©e
.
»¶aû_¹_sigaùiÚ
 =ğ
NULL
) {

283 
	`ci_log
("Unexpected„t_sigaction()„equest before full init");

284  -
EFAULT
;

287 
	`TRAMP_DEBUG
 ("sigaùiÚ(%d,%p,%p,%dèvŸ %p...", 
signum
, 
aù
, 
ßù
,

288 ()(
sig£t_t
), 
¡©e
.
»¶aû_¹_sigaùiÚ
->
Üigš®_’Œy32
);

289 
rc
 = (((*)(, cÚ¡ 
sigaùiÚ32
 *, sigaùiÚ32 *, 
size_t
))

290 (
¡©e
.
»¶aû_¹_sigaùiÚ
->
Üigš®_’Œy32
))(
signum
, 
aù
, 
ßù
, (
sig£t_t
));

291 
	`TRAMP_DEBUG
 ("... = %d", 
rc
);

292  
rc
;

293 
	}
}

297 
	$eçb_lšux_ŒampŞše_şo£64
(
fd
)

300 
fe
 *
f
;

301 
rc
;

303 
	`eçb_sysÿÎ_’‹r
();

305 
f
 = 
	`fg‘
 (
fd
);

306 ià(
f
) {

307 ià(
	`FILE_IS_ENDPOINT
(
f
)) {

314 ià(
	`£tup_ŒampŞše
 (
	`PT_REGS_FROM_SYSCALL
(),

315 
CI_TRAMP_OPCODE_CLOSE
, 
fd
, 
TRAMPOLINE_BITS_64
) == 0)

318 
	`åut
(
f
);

319 
	`eçb_sysÿÎ_ex™
();

324 
	`åut
(
f
);

328 
rc
 = (((*)())(
¡©e
.
»¶aû_şo£
->
Üigš®_’Œy64
))(
fd
);

329 
	`TRAMP_DEBUG
("Clo£64: Chaš„‘uº %d \n", 
rc
);

330 
	`eçb_sysÿÎ_ex™
();

331  
rc
;

332 
	}
}

334 #ifdeà
CONFIG_COMPAT


335 
	$eçb_lšux_ŒampŞše_şo£32
(
fd
)

338 
fe
 *
f
;

339 
rc
;

341 
	`eçb_sysÿÎ_’‹r
();

343 
f
 = 
	`fg‘
 (
fd
);

344 ià(
f
) {

345 ià(
	`FILE_IS_ENDPOINT
(
f
)) {

352 ià(
	`£tup_ŒampŞše
 (
	`PT_REGS_FROM_SYSCALL
(),

353 
CI_TRAMP_OPCODE_CLOSE
, 
fd
, 
TRAMPOLINE_BITS_32
) == 0)

356 
	`åut
(
f
);

357 
	`eçb_sysÿÎ_ex™
();

362 
	`åut
(
f
);

366 
rc
 = (((*)())(
¡©e
.
»¶aû_şo£
->
Üigš®_’Œy32
))(
fd
);

367 
	`TRAMP_DEBUG
("Clo£32: Chaš„‘uº %d \n", 
rc
);

368 
	`eçb_sysÿÎ_ex™
();

369  
rc
;

370 
	}
}

373 
	$£tup_ŒampŞše
(
±_»gs
 *
»gs
,

374 
İcode
, 
¬g
,

375 
b™s
)

377 
mm_hash
 *
p
;

378 
ci_ušŒ_t
 
ŒampŞše_’Œy
 = 0, 
ŒampŞše_exşude
 = 0,

379 
ŒampŞše_toc
 = 0, 
ŒampŞše_fixup
 = 0;

380 
rc
 = -
EBADF
;

382 
	`»ad_lock
(&
oo_mm_tbl_lock
);

383 
p
 = 
	`oo_mm_tbl_lookup
(
cu¼’t
->
mm
);

384 ià(
p
)

386 
ŒampŞše_’Œy
 = (
ci_ušŒ_t
è
	`CI_USER_PTR_GET
(
p
->trampoline_entry);

387 
ŒampŞše_exşude
 = (
ci_ušŒ_t
è
	`CI_USER_PTR_GET
(
p
->trampoline_exclude);

388 
ŒampŞše_toc
 = (
ci_ušŒ_t
è
	`CI_USER_PTR_GET
(
p
->trampoline_toc);

389 
ŒampŞše_fixup
 = (
ci_ušŒ_t
è
	`CI_USER_PTR_GET
(
p
->
ŒampŞše_u£r_fixup
);

391 
	`»ad_uÆock
(&
oo_mm_tbl_lock
);

393 
	`TRAMP_DEBUG
("%s:¿mpŞše_’Œy = %°\n", 
__func__
, (*)
ŒampŞše_’Œy
);

396 ià(
ŒampŞše_’Œy
)

398 ià(!
	`acûss_ok
(
VERIFY_READ
, 
ŒampŞše_’Œy
, 1))

401 
	`ci_log
("Pid %d (mm=%p) has badrampolineƒntry: %p",

402 
cu¼’t
->
tgid
, cu¼’t->
mm
, (*)
ŒampŞše_’Œy
);

403  -
EBADF
;

407 ià(
»gs
->
n
 =ğ
ŒampŞše_exşude
)

409 
	`TRAMP_DEBUG
("Ignoring call fromƒxcluded‡ddress 0x%08lx",

410 ()
ŒampŞše_exşude
);

411  -
EBUSY
;

414 
	`TRAMP_DEBUG
("%s: b™ ğ%d; s‘ u°ŒampŞše. \n", 
__func__
, 
b™s
);

415 ià(
b™s
 =ğ
TRAMPOLINE_BITS_64
)

417 
	`£tup_ŒampŞše64
(
»gs
, 
İcode
, 
¬g
,

418 (*)
ŒampŞše_’Œy
, (*)
ŒampŞše_toc
,

419 (*)
ŒampŞše_fixup
);

421 #ifdeà
CONFIG_COMPAT


424 
	`£tup_ŒampŞše32
(
»gs
, 
İcode
, 
¬g
,

425 (*)
ŒampŞše_’Œy
, (*)
ŒampŞše_toc
,

426 (*)
ŒampŞše_fixup
);

429 
rc
 = 0;

433 
	`OO_DEBUG_VERB
(
	`ci_log
("Error --‡ttemptorampoline for unknown…rocess"));

434 
rc
 = -
ENOENT
;

436  
rc
;

437 
	}
}

441 
	$eçb_lšux_ŒampŞše_ùÜ
(
no_sù
)

443 
rc
;

445 
	`©omic_£t
(&
eçb_sysÿÎ_u£d
, 0);

447 
	`mem£t
(&
¡©e
, '\0', (
¡©e_¡ruù
));

449 
rc
 = 
	`lšux_ŒampŞše_µc64_š‹º®_ùÜ
();

450 ià(!
rc
)

452 ià(
no_sù
)

454 
	`TRAMP_DEBUG
("syscalls NOT hooked -‚o_sct„equested");

458 
¡©e
.
»¶aû_şo£
 =

459 
	`lšux_ŒampŞše_µc64_š‹rû±_sysÿÎ
(
__NR_şo£
,

460 
eçb_lšux_ŒampŞše_şo£64
,

461 
eçb_lšux_ŒampŞše_şo£32
);

462 #ifdeà
OO_CAN_HANDLE_TERMINATION


463 
¡©e
.
»¶aû_ex™_group
 =

464 
	`lšux_ŒampŞše_µc64_š‹rû±_sysÿÎ
(
__NR_ex™_group
,

465 
eçb_lšux_ŒampŞše_ex™_group
,

466 
eçb_lšux_ŒampŞše_ex™_group
);

468 
¡©e
.
»¶aû_¹_sigaùiÚ
 =

469 
	`lšux_ŒampŞše_µc64_š‹rû±_sysÿÎ
(
__NR_¹_sigaùiÚ
,

470 
eçb_lšux_ŒampŞše_sigaùiÚ
,

471 
eçb_lšux_ŒampŞše_sigaùiÚ32
);

474 #ià
CI_CFG_USERSPACE_EPOLL


475 #ifdeà
__NR_•Şl_ü—‹1


476 
¡©e
.
no_»¶aû_•Şl_ü—‹1
 =

477 
	`lšux_ŒampŞše_µc64_š‹rû±_sysÿÎ
(
__NR_•Şl_ü—‹1
,

478 
NULL
, NULL);

480 
¡©e
.
no_»¶aû_•Şl_ü—‹
 =

481 
	`lšux_ŒampŞše_µc64_š‹rû±_sysÿÎ
(
__NR_•Şl_ü—‹
, 
NULL
, NULL);

482 
¡©e
.
no_»¶aû_•Şl_ùl
 =

483 
	`lšux_ŒampŞše_µc64_š‹rû±_sysÿÎ
(
__NR_•Şl_ùl
, 
NULL
, NULL);

484 
¡©e
.
no_»¶aû_•Şl_wa™
 =

485 
	`lšux_ŒampŞše_µc64_š‹rû±_sysÿÎ
(
__NR_•Şl_wa™
, 
NULL
, NULL);

488 
¡©e
.
no_»¶aû_sock‘ÿÎ
 =

489 
	`lšux_ŒampŞše_µc64_š‹rû±_sysÿÎ
(
__NR_sock‘ÿÎ
, 
NULL
, NULL);

493 
	`TRAMP_DEBUG
("Warning: syscallable‚ot found - can't„ead sys_close");

497 
	}
}

499 #ià
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,12)

500 
	#synchrÚize_sched
 
synchrÚize_k”Ãl


	)

503 
	$eçb_lšux_ŒampŞše_dtÜ
(
no_sù
)

505 
wa™šg
 = 0;

508 
	`lšux_ŒampŞše_µc64_»¡Üe_sysÿÎs
();

513 
	`synchrÚize_sched
();

514 #ifdeà
CONFIG_PREEMPT


515 
	`scheduË_timeout
(
	`m£cs_to_jiff›s
(50));

517 
	`©omic_»ad
(&
eçb_sysÿÎ_u£d
))

519 ià(!
wa™šg
)

521 
	`ci_log
("Waiting for intercepted syscallso finish .. ");

522 
wa™šg
 = 1;

524 
	`scheduË_timeout
(
	`m£cs_to_jiff›s
(50));

526 ià(
wa™šg
)

528 
	`ci_log
("\t .. OK");

529 
	`synchrÚize_sched
();

530 #ifdeà
CONFIG_PREEMPT


532 
	`scheduË_timeout
(
	`m£cs_to_jiff›s
(50));

533 
	`ci_log
("Unload is dangerous on RT kernels:…repareo crash.");

537 
	`lšux_ŒampŞše_µc64_di¥o£
();

540 
	}
}

542 
	$eçb_lšux_ŒampŞše_debug
 (
ci_ušŒ_t
 *
·¿m
)

544 
İ
 = *
·¿m
;

545 *
p
;

547 
	`TRAMP_DEBUG
("T¿mpŞšdebug op=%lx", 
İ
);

548 ()
İ
;

550 *
·¿m
 = ()
	`fšd_sysÿÎ_bË
(&
p
);

553 
	}
}

556 #iâdeà
NDEBUG


563 
	$eçb_lšux_ŒampŞše_ul_ç
()

565 
±_»gs
 *
»gs
 = 0;

566 
mm_hash
 *
p
;

567 
ci_ušŒ_t
 
ŒampŞše_ul_ç
 = 0;

569 
	`ci_as£¹
(
»gs
);

571 ià(
cu¼’t
->
mm
) {

572 
	`»ad_lock
 (&
oo_mm_tbl_lock
);

573 
p
 = 
	`oo_mm_tbl_lookup
(
cu¼’t
->
mm
);

574 
	`»ad_uÆock
 (&
oo_mm_tbl_lock
);

575 ià(
p
) {

576 
ŒampŞše_ul_ç
 = (
ci_ušŒ_t
è
	`CI_USER_PTR_GET
 (
p
->trampoline_ul_fail);

579 
	`ci_log
("%s:‚Ø’Œy fÜ…id %u", 
__FUNCTION__
, 
cu¼’t
->
tgid
);

584 
	`ci_log
("%s:…id %u i dyšg -‚Ømm", 
__FUNCTION__
, 
cu¼’t
->
tgid
);

588 
	`ci_log
("%s: sysÿÎ backŒaû (pid %d)", 
__FUNCTION__
, 
cu¼’t
->
tgid
);

589 
	`ci_backŒaû
();

590 
	`ci_log
("%s:…rovoking user-level fail on syscallƒxit for…id %d",

591 
__FUNCTION__
, 
cu¼’t
->
tgid
);

594 
	`ci_log
("(not„eally, don't know how onhis…latform)");

597 
	}
}

	@ppc64_linux_trampoline_internal.c

26 
	~<lšux/uni¡d.h
>

27 
	~<lšux/ùy³.h
>

28 
	~<lšux/v”siÚ.h
>

29 
	~<lšux/k®lsyms.h
>

30 
	~<lšux/v”siÚ.h
>

31 
	~<asm/·ÿ.h
>

32 
	~<asm/ÿcheæush.h
>

33 
	~<lšux/vm®loc.h
>

34 
	~<lšux/uacûss.h
>

35 
	~<asm/·ge.h
>

36 
	~<asm/io.h
>

37 
	~<asm/uni¡d.h
>

38 
	~<asm/·ge.h
>

39 
	~"µc64_lšux_ŒampŞše_š‹º®.h
"

40 
	~<Úlßd/lšux_Úlßd_š‹º®.h
>

41 
	~<Úlßd/lšux_ŒampŞše.h
>

46 
	#POWER_OPCODE
(
x
è(((xè>> 26)&0x3F)

	)

47 
	#POWER_B_ADDR
(
cŸ
, 
b
) \

48 (((
u64
)(
cŸ
)è+ ((
b
è& 0x03FFFFFC))

	)

49 #ià
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(2,6,28)

50 
	#KERNEL_BASE
(
·ÿ
è(Õaÿ)->
k”Ãlba£
)

	)

52 
	#KERNEL_BASE
(
·ÿ
è
KERNELBASE


	)

56 
	#TRAMP_DEBUG
(
x
...è()0

	)

61 
ušt32_t
 
__Úlßd_ŒampŞše_µc64
, 
__Úlßd_’d_ŒampŞše_µc64
;

63 
	sµc64_d©a_¡ruù


66 *
	msysÿÎ_bË
;

69 *
	msysÿÎ_»tuº_pošt
;

74 
ušt8_t
 *
	mthunks_p
, *
	mthunks_q
;

79 
	mthunks_u£d
;

82 
sysÿÎ_’Œy_t
 
	mš‹rû±
[
NR_MAX_SYSCALL_INTERCEPT
];

84 
	mÄ_š‹rû±
;

87 
µc64_d©a_¡ruù
 
	gµc64_d©a
;

90 
	#TOTAL_THUNK_BYTES
 
PAGE_SIZE


	)

92 *
	$g‘_sysÿÎ_»tuº_add»ss
(è{  
µc64_d©a
.
sysÿÎ_»tuº_pošt
; 
	}
}

96 
	$pow”_ld_ds
(
ušt32_t
 
š¡r
, 
št32_t
 *
off£t
)

98 
İcode
 = (
š¡r
 >> 26);

99 ià(
İcode
 == 58)

110 (*
off£t
èğ((
št32_t
)((
št16_t
)(
š¡r
 & 0xFFFE)));

117 
	}
}

120 
šlše
 *
	$fšd_toc
()

122 *
p
;

123 
	`asm
 ("m¸%0, 2" : "ô"(
p
));

124  
p
;

125 
	}
}

127 
	$»¡Üe_sysÿÎ_’Œy
(
sysÿÎ_’Œy_t
 *
’t
, *
sysÿÎ_bË
)

129 
ušt64_t
 **
sysÿÎ_p
 = &((((ušt64_ˆ**)
sysÿÎ_bË
))[
’t
->
sysÿÎ_Ä
 << 1]);

130 
	`TRAMP_DEBUG
("Re¡ÜsysÿÎƒÁry @ 0x%°tØ%p, %p\n", 
sysÿÎ_p
,

131 
’t
->
Üigš®_’Œy64
[0],ƒÁ->
Üigš®_’Œy32
[0]);

133 
sysÿÎ_p
[0] = (
ušt64_t
 *)
’t
->
Üigš®_’Œy64
[0];

134 #ifdeà
CONFIG_COMPAT


135 
sysÿÎ_p
[1] = (
ušt64_t
 *)
’t
->
Üigš®_’Œy32
[0];

137 
	`æush_dÿche_¿nge
(()
sysÿÎ_p
, ()syscall_p + 16);

138 
	}
}

140 
	$·tch_sysÿÎ_’Œy
(
sysÿÎ_’Œy_t
 *
to_·tch
, *
sysÿÎ_bË
)

142 
ušt64_t
 **
sysÿÎ_p
 = &((((ušt64_ˆ**)
sysÿÎ_bË
))[
to_·tch
->
sysÿÎ_Ä
 << 1]);

144 
	`TRAMP_DEBUG
("·tchšg sysÿÎƒÁry @ 0x%p\n", 
sysÿÎ_p
);

146 
·ÿ_¡ruù
 *
®·ÿ
 = 
	`g‘_·ÿ
();

148 
to_·tch
->
Üigš®_’Œy64
[0] = (
ušt64_t
 *)
sysÿÎ_p
[0];

149 
to_·tch
->
Üigš®_’Œy64
[1] = (
ušt64_t
 *)
®·ÿ
->
k”Ãl_toc
;

150 
	`TRAMP_DEBUG
("64-b™ 0x%°\n", 
to_·tch
->
Üigš®_’Œy64
[0],

151 
to_·tch
->
Üigš®_’Œy64
[1]);

152 #ifdeà
CONFIG_COMPAT


153 
to_·tch
->
Üigš®_’Œy32
[0] = (
ušt64_t
 *)
sysÿÎ_p
[1];

154 
to_·tch
->
Üigš®_’Œy32
[1] = (
ušt64_t
 *)
®·ÿ
->
k”Ãl_toc
;

155 
	`TRAMP_DEBUG
("64-b™ 0x%°0x%°\n", 
to_·tch
->
Üigš®_’Œy32
[0],

156 
to_·tch
->
Üigš®_’Œy32
[1]);

160 
	`TRAMP_DEBUG
("sysÿÎ_p[0] = 0x%°\n", 
sysÿÎ_p
[0]);

167 ià(
to_·tch
->
’Œy64
)

168 
sysÿÎ_p
[0] = (
ušt64_t
 *)
to_·tch
->
’Œy64
;

169 #ifdeà
CONFIG_COMPAT


170 ià(
to_·tch
->
’Œy32
)

171 
sysÿÎ_p
[1] = (
ušt64_t
 *)
to_·tch
->
’Œy32
;

174 
	`æush_dÿche_¿nge
(()
sysÿÎ_p
, ()syscall_p + 16);

175 
	}
}

178 
ušt64_t
 *
	$fšd_sysÿÎ_bË
(**
»tuº_addr
)

185 
ušt32_t
 *
pv
;

186 
·ÿ_¡ruù
 *
a_·ÿ
 =

187 
	`g‘_·ÿ
();

188 
i
;

189 
ušt32_t
 
sys_ÿÎ_’Œy_off£t
 = -1;

190 
ušt32_t
 *
sy¡em_ÿÎ_commÚ
 = 
NULL
;

191 
sysÿÎ_toc_off£t
 = 
INT_MIN
;

192 
ušt32_t
 *
ş¾dis_’ds_©
 = 
NULL
;

193 
ušt64_t
 *
rv
 = 
	`ERR_PTR
(-
ENOEXEC
);

195 
	`TRAMP_DEBUG
("%s: PACA = %°\n", 
__func__
, 
a_·ÿ
);

196 
pv
 = 
	`phys_to_vœt
(0xc00);

197 
	`TRAMP_DEBUG
("0xC00 = %p",

198 
pv
);

199 (*
»tuº_addr
èğ
NULL
;

202 #ià
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(2,6,28)

219 ()
sys_ÿÎ_’Œy_off£t
;

221 
	#POWER_CLRRDI_INSN
 0x79ac07c4

	)

222 
	#ORIS_SIGNATURE
 0x658c0000

	)

223 
	#ORI_SIGNATURE
 0x618c0000

	)

225 
i
= 0; i < (0x80 >> 2); ++i)

227 ià(
pv
[
i
] =ğ
POWER_CLRRDI_INSN
)

229 
ušt32_t
 
Üis
, 
Üi
;

230 
	`TRAMP_DEBUG
("Found our clrrdi .. \n");

231 
Üis
 = 
pv
[
i
+1];

232 
Üi
 = 
pv
[
i
+2];

234 ià((
Üis
 & 0xFFFF0000è=ğ
ORIS_SIGNATURE
 &&

235 (
Üi
 & 0xFFFF0000è=ğ
ORI_SIGNATURE
)

237 
sys_ÿÎ_’Œy_off£t
 =

238 ((
Üis
 & 0xFFFF) << 16) |

239 (
Üi
 & 0xFFFF);

245 ià(
sys_ÿÎ_’Œy_off£t
 & 0x80000000)

247 
	`TRAMP_DEBUG
("Failedo find CLRRDI/ORIS/ORI sequence. \n");

248 
rv
 = 
	`ERR_PTR
(-
EIO
);

249 
’d
;

252 
	`TRAMP_DEBUG
("Found ORIS: 0x%08x \n",

253 
sys_ÿÎ_’Œy_off£t
);

255 *
p
 = (*)((((
ušt64_t
)
a_·ÿ
) & (((uint64_t)0xFFFFFFFF) << 32)) |

256 ((
ušt64_t
)
sys_ÿÎ_’Œy_off£t
));

258 
	`TRAMP_DEBUG
("Found sy¡em_ÿÎ_commÚ @ %°\n", 
p
);

259 
sy¡em_ÿÎ_commÚ
 = 
p
;

265 #ià
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(3,0,0)

270 
	#ADDI_SIGNATURE
 0x398C0000

	)

276 
	#ADDI_SIGNATURE
 0x394A0000

	)

279 
i
 =0 ;i < (0x80>>2); ++i)

281 ià((
pv
[
i
] & 0xFFFF0000è=ğ
ADDI_SIGNATURE
 )

283 
sys_ÿÎ_’Œy_off£t
 = (
pv
[
i
] & 0xFFFF);

287 ià(
sys_ÿÎ_’Œy_off£t
 & 0x80000000)

289 
	`TRAMP_DEBUG
("Failedo find ADDI - sorry, chaps.\n");

290 
rv
 = 
	`ERR_PTR
(-
EIO
);

291 
’d
;

294 
	`TRAMP_DEBUG
("sys_call_entry_offset = 0x%08x \n",

295 
sys_ÿÎ_’Œy_off£t
);

298 
	`TRAMP_DEBUG
("Branch @ %p (kb = 0x%016llx)\n",

299 (
ušt32_t
 *)(
	`KERNEL_BASE
(
a_·ÿ
) +

300 
sys_ÿÎ_’Œy_off£t
),

301 (è
	`KERNEL_BASE
(
a_·ÿ
));

303 
ušt32_t
 *
b¿nch_addr
 =

304 (
ušt32_t
 *)(
	`KERNEL_BASE
(
a_·ÿ
è+ 
sys_ÿÎ_’Œy_off£t
);

305 
u64
 
b¿nch_loc
 = (u64)
b¿nch_addr
;

306 
ušt32_t
 
b¿nch
 = *
b¿nch_addr
;

312 ià(
	`POWER_OPCODE
(
b¿nch
) == 0x12)

314 
sy¡em_ÿÎ_commÚ
 = (
ušt32_t
 *)
	`POWER_B_ADDR
(
b¿nch_loc
, 
b¿nch
);

315 
	`TRAMP_DEBUG
("system_call_common = %p \n",

316 (
ušt32_t
 *)
	`POWER_B_ADDR
(
b¿nch_loc
, 
b¿nch
));

318 
	`TRAMP_DEBUG
("b¿nch = 0x%08x opcodğ0x%02x\n", 
b¿nch
,

319 
	`POWER_OPCODE
(
b¿nch
));

324 ià(!
sy¡em_ÿÎ_commÚ
)

326 
	`TRAMP_DEBUG
("Sorry: can't†ocate system_call_common.\n");

327 
rv
 = 
	`ERR_PTR
(-
EIO
);

328 
’d
;

337 cÚ¡ 
ušt32_t
 
ş¾dis_sig
[] =

346 
m©ch
 = 0;

347 
ušt32_t
 *
pv
 = (ušt32_ˆ*è
sy¡em_ÿÎ_commÚ
;

349 
i
 =0 ;i < 0x200>>2; ++i)

351 ià(
pv
[
i
] =ğ
ş¾dis_sig
[
m©ch
])

353 ++
m©ch
;

354 ià(
m©ch
 =ğ((
ş¾dis_sig
è/ (
ušt32_t
)))

357 
št32_t
 
ds
;

358 
ok
;

359 
ok
 = 
	`pow”_ld_ds
(
pv
[
i
-
m©ch
-3], &
ds
);

361 ià(
ok
 < 0)

363 
	`TRAMP_DEBUG
("LD @ 0x%08x - cannot disassemble. \n",

364 
pv
[
i
-
m©ch
-3]);

365 
rv
 = 
	`ERR_PTR
(-
EIO
);

366 
’d
;

368 
sysÿÎ_toc_off£t
 = 
ds
;

369 
ş¾dis_’ds_©
 = &
pv
[
i
];

371 
	`TRAMP_DEBUG
("Found our LD @ 0x%08x - DS = %d \n",

372 
pv
[
i
-
m©ch
-3],

373 
ds
);

378 
m©ch
 = 0;

382 ià(
sysÿÎ_toc_off£t
 =ğ
INT_MIN
)

384 
	`TRAMP_DEBUG
("Cannot find syscall TOC offset. \n");

385 
rv
 = 
	`ERR_PTR
(-
EIO
);

386 
’d
;

394 
i
;

395 
i
 =0; i < 0x20; ++i)

397 ià(
ş¾dis_’ds_©
[
i
] == 0x4e800421)

400 (*
»tuº_addr
èğ&
ş¾dis_’ds_©
[
i
+1];

405 ià(!(*
»tuº_addr
))

407 
	`TRAMP_DEBUG
("Cannot find brancho synthesise„eturn‡ddress from.\n");

408 
rv
 = 
	`ERR_PTR
(-
EIO
);

409 
’d
;

413 
ušt64_t
 **
sysÿÎ_toc
 =

414 (
ušt64_t
 **)(
a_·ÿ
->
k”Ãl_toc
 + 
sysÿÎ_toc_off£t
);

415 
ušt64_t
 *
sysÿÎ_bË
 = *
sysÿÎ_toc
;

416 
	`TRAMP_DEBUG
("sysÿÎ TOC @ %°(TOC @ 0x%16Îxè\n", 
sysÿÎ_toc
,

417 ()
a_·ÿ
->
k”Ãl_toc
);

418 
	`TRAMP_DEBUG
("sysÿÎabË @ %p\n", 
sysÿÎ_bË
);

420 
rv
 = 
sysÿÎ_bË
;

425 
’d
:

426  
rv
;

427 
	}
}

429 
	$thunks_š™
(
µc64_d©a_¡ruù
 *
µc64
)

431 
µc64
->
thunks_p
 =…pc64->
thunks_q
 = 0;

432 
µc64
->
thunks_u£d
 = 0;

434 
µc64
->
thunks_p
 = (
ušt8_t
 *)
	`__vm®loc
(
TOTAL_THUNK_BYTES
, 
GFP_KERNEL
, 
PAGE_KERNEL_EXEC
);

435 
	`TRAMP_DEBUG
("AÎoÿ‹dhunk @ 0x%°\n", 
µc64
->
thunks_p
);

436 
µc64
->
thunks_q
 = &µc64->
thunks_p
[
TOTAL_THUNK_BYTES
];

437 
µc64
->
thunks_u£d
 = 0;

438 ià(!
µc64
->
thunks_p
)

440  -
ENOSPC
;

443 
	}
}

445 
	$thunks_ex™
(
µc64_d©a_¡ruù
 *
µc64
)

447 ià(
µc64
->
thunks_p
)

449 
	`TRAMP_DEBUG
("F»memÜy @ 0x%°\n", 
µc64
->
thunks_p
);

450 
	`vä“
(
µc64
->
thunks_p
);

452 
	}
}

454 
	$thunks_add
(
µc64_d©a_¡ruù
 *
µc64
,

455 *
mod_func
, *
»tuº_addr
, *
»tuº_toc
, **
µŒ
)

458 
thunk_by‹s
 = (&
__Úlßd_’d_ŒampŞše_µc64
 - &
__Úlßd_ŒampŞše_µc64
) << 2;

459 
Ãw_u£d
 = 
µc64
->
thunks_u£d
 + 
thunk_by‹s
 + 32;

461 
	`TRAMP_DEBUG
("T:… = 0x%°by‹ ğ%d,‚ew_u£d = %d \n", 
µc64
->
thunks_p
, 
thunk_by‹s
, 
Ãw_u£d
);

462 (*
µŒ
) = 0;

464 ià(
Ãw_u£d
 > 
TOTAL_THUNK_BYTES
)

466  -
ENOSPC
;

470 
	`memıy
(&
µc64
->
thunks_p
[µc64->
thunks_u£d
], &
__Úlßd_ŒampŞše_µc64
, 
thunk_by‹s
);

472 
	`memıy
(&
µc64
->
thunks_p
[µc64->
thunks_u£d
 + 
thunk_by‹s
], (
ušt8_t
 *)
mod_func
, 16);

475 
ušt64_t
 **
»tuºp
 = (ušt64_ˆ**)(&
µc64
->
thunks_p
[µc64->
thunks_u£d
 + 
thunk_by‹s
 + 16]);

476 
»tuºp
[0] = 
»tuº_addr
;

477 
»tuºp
[1] = 
»tuº_toc
;

481 (*
µŒ
èğ(
ušt32_t
 *)&
µc64
->
thunks_p
[µc64->
thunks_u£d
];

482 
µc64
->
thunks_u£d
 = 
Ãw_u£d
;

485 
	`æush_dÿche_¿nge
(()
µc64
->
thunks_p
, (ípc64->
thunks_q
);

486 
	`æush_iÿche_¿nge
(()
µc64
->
thunks_p
, (ípc64->
thunks_q
);

489 
	}
}

491 
	$lšux_ŒampŞše_µc64_š‹º®_ùÜ
()

493 
rv
 = 0;

495 
	`mem£t
(&
µc64_d©a
, '\0', (
µc64_d©a_¡ruù
));

497 
	`TRAMP_DEBUG
("%s:„uÂšg.\n", 
__func__
);

499 
µc64_d©a
.
sysÿÎ_bË
 =

500 
	`fšd_sysÿÎ_bË
(&
µc64_d©a
.
sysÿÎ_»tuº_pošt
);

501 ià(
	`IS_ERR
(
µc64_d©a
.
sysÿÎ_bË
))

503 
	`´_”r
("CªnÙ fšd sysÿÎabË - %ld\n", 
	`PTR_ERR
(
µc64_d©a
.
sysÿÎ_bË
));

504 
rv
 = -
EIO
;

505 
’d
;

508 #ifdeà
OO_CAN_HANDLE_TERMINATION


509 ifĞ
µc64_d©a
.
sysÿÎ_bË
 )

510 
	`eçb_lšux_‹rmš©iÚ_ùÜ
();

513 
	`thunks_š™
(&
µc64_d©a
);

515 
’d
:

516  
rv
;

517 
	}
}

519 
	$lšux_ŒampŞše_µc64_»¡Üe_sysÿÎs
()

521 
i
;

522 
	`TRAMP_DEBUG
("%s:„uÂšg‚r_š‹rû± = %d… = 0x%p.\n", 
__func__
,

523 
µc64_d©a
.
Ä_š‹rû±
,…pc64_d©a.
thunks_p
);

524 
i
 =0 ;˜< 
µc64_d©a
.
Ä_š‹rû±
; ++i)

526 
	`»¡Üe_sysÿÎ_’Œy
(&
µc64_d©a
.
š‹rû±
[
i
],

527 
µc64_d©a
.
sysÿÎ_bË
);

529 
	}
}

531 
	$lšux_ŒampŞše_µc64_di¥o£
()

533 
	`thunks_ex™
(&
µc64_d©a
);

534 
	}
}

536 
sysÿÎ_’Œy_t
 *
	$lšux_ŒampŞše_µc64_š‹rû±_sysÿÎ
(
sysÿÎ_Ä
,

537 *
’Œy64
,

538 *
’Œy32
)

540 
sysÿÎ_’Œy_t
 *
’t
;

541 
rc
;

543 ià(
µc64_d©a
.
Ä_š‹rû±
 >ğ
NR_MAX_SYSCALL_INTERCEPT
)

545 
’t
 = 
	`ERR_PTR
(-
ENOSPC
);

546 
’d
;

549 
’t
 = &
µc64_d©a
.
š‹rû±
[µc64_d©a.
Ä_š‹rû±
];

550 
’t
->
sysÿÎ_Ä
 = syscall_nr;

558 ià(
’Œy64
)

560 
rc
 = 
	`thunks_add
(&
µc64_d©a
, 
’Œy64
,…pc64_d©a.
sysÿÎ_»tuº_pošt
,

561 (*)
	`g‘_·ÿ
()->
k”Ãl_toc
, &
’t
->
’Œy64
);

562 ià(
rc
)

564 
	`TRAMP_DEBUG
("CªnÙ c»©64-b™hunk: %d \n", 
rc
);

565 
’t
 = 
	`ERR_PTR
(
rc
);

566 
’d
;

571 
’t
->
’Œy64
 = 
NULL
;

574 #ifdeà
CONFIG_COMPAT


575 ià(
’Œy32
)

577 
rc
 = 
	`thunks_add
(&
µc64_d©a
, 
’Œy32
,…pc64_d©a.
sysÿÎ_»tuº_pošt
,

578 (*)
	`g‘_·ÿ
()->
k”Ãl_toc
, &
’t
->
’Œy32
);

579 ià(
rc
)

581 
	`TRAMP_DEBUG
("CªnÙ c»©32-b™hunk: %d \n", 
rc
);

582 
’t
 = 
	`ERR_PTR
(
rc
);

583 
’d
;

588 
’t
->
’Œy32
 = 
NULL
;

592 
	`TRAMP_DEBUG
("64-bithunk @ %p , 32-bithunk @ %p, \n",

593 
’t
->
’Œy64
,ƒÁ->
’Œy32
);

595 
	`TRAMP_DEBUG
("Patch syscallƒntry .. \n");

596 
	`·tch_sysÿÎ_’Œy
(
’t
, 
µc64_d©a
.
sysÿÎ_bË
);

598 
’d
:

599 ià(!
	`IS_ERR
(
’t
))

601 ++
µc64_d©a
.
Ä_š‹rû±
;

603  
’t
;

604 
	}
}

607 
	$£tup_ŒampŞše32
(
±_»gs
 *
»gs
, 
İcode
, 
d©a
,

608 
u32
 
__u£r
 *
â
, u32 __u£¸*
toc
,

609 
u32
 
__u£r
 *
fixup_â
)

614 
	#PPC32_STACK_FRAME_BYTES
 ((64+48è>> 1)

	)

615 
ušt32_t
 
Ãw_¡ack_buf
[(
PPC32_STACK_FRAME_BYTES
 >> 2)];

616 
ušt64_t
 
Ãw_u£r_¥
;

618 
	`TRAMP_DEBUG
("%s:…t_»g ğ0x%°\n", 
__func__
, 
»gs
);

619 
	`TRAMP_DEBUG
("userspace stack = 0x%p…t->nip 0x%poc = 0x%p…t->link 0x%p \n",

620 (*)
»gs
->
g´
[1], (*ìegs->
n
, (*ìegs->g´[2], (*ìegs->
lšk
);

622 
Ãw_u£r_¥
 = 
»gs
->
g´
[1] - 
PPC32_STACK_FRAME_BYTES
;

623 
	`mem£t
(
Ãw_¡ack_buf
, '\0', 
PPC32_STACK_FRAME_BYTES
);

632 
Ãw_¡ack_buf
[0] = 
»gs
->
g´
[1];

633 
Ãw_¡ack_buf
[9] = 
»gs
->
lšk
;

634 
Ãw_¡ack_buf
[10] = 
»gs
->
g´
[2];

635 
Ãw_¡ack_buf
[11] = 
»gs
->
n
;

643 
Ãw_¡ack_buf
[12] = 
İcode
;

644 
Ãw_¡ack_buf
[13] = 
d©a
;

645 ià(
	`cİy_to_u£r
((*)(
Ãw_u£r_¥
), 
Ãw_¡ack_buf
, 
PPC32_STACK_FRAME_BYTES
))

647 
	`TRAMP_DEBUG
("Can't copy‚ew userspace stackƒntry! \n");

648  -
EIO
;

654 
	`TRAMP_DEBUG
("U£r¥aû fÀğ0x%°,oøğ%°fixu°ğ0x%°\n", 
â
, 
toc
,

655 
fixup_â
);

656 
	`TRAMP_DEBUG
("New_u£r_¥ = 0x%°\n", (*)
Ãw_u£r_¥
);

657 
»gs
->
g´
[1] = 
Ãw_u£r_¥
;

658 
»gs
->
lšk
 = (
u64
)
fixup_â
;

659 
»gs
->
g´
[2] = (
u64
)
toc
;

660 
»gs
->
n
 = (
u64
)
â
;

663 
	`TRAMP_DEBUG
("Dum°Ãw u£r¥aû sck @ 0x%°\n", (*)
Ãw_u£r_¥
);

665 
ušt8_t
 
¡ack_buf
[0x200];

666 ià(
	`cİy_äom_u£r
(
¡ack_buf
, (* )
Ãw_u£r_¥
, 0x200))

668 
	`TRAMP_DEBUG
("Can't copy stack back! \n");

678 
	}
}

680 
	$£tup_ŒampŞše64
(
±_»gs
 *
»gs
, 
İcode
, 
d©a
,

681 
u32
 
__u£r
 *
â
, 
u64
 __u£¸*
toc
,

682 
u32
 
__u£r
 *
fixup_â
)

711 
	#PPC64_STACK_FRAME_BYTES
 (64+48)

	)

713 
ušt64_t
 
Ãw_¡ack_buf
[(
PPC64_STACK_FRAME_BYTES
 >> 3)];

714 
ušt64_t
 
Ãw_u£r_¥
;

716 
	`TRAMP_DEBUG
("%s:…t_»g ğ0x%°\n", 
__func__
, 
»gs
);

717 
	`TRAMP_DEBUG
("userspace stack = 0x%p…t->nip 0x%poc = 0x%p…t->link 0x%p \n",

718 (*)
»gs
->
g´
[1], (*ìegs->
n
, (*ìegs->g´[2], (*ìegs->
lšk
);

719 
Ãw_u£r_¥
 = 
»gs
->
g´
[1] - 
PPC64_STACK_FRAME_BYTES
;

720 
	`mem£t
(
Ãw_¡ack_buf
, '\0', 
PPC64_STACK_FRAME_BYTES
);

729 
Ãw_¡ack_buf
[0] = 
»gs
->
g´
[1];

730 
Ãw_¡ack_buf
[9] = 
»gs
->
lšk
;

731 
Ãw_¡ack_buf
[10] = 
»gs
->
g´
[2];

732 
Ãw_¡ack_buf
[11] = 
»gs
->
n
;

740 
Ãw_¡ack_buf
[12] = 
İcode
;

741 
Ãw_¡ack_buf
[13] = 
d©a
;

742 ià(
	`cİy_to_u£r
((*è
Ãw_u£r_¥
, 
Ãw_¡ack_buf
, 
PPC64_STACK_FRAME_BYTES
))

744 
	`TRAMP_DEBUG
("Can't copy‚ew userspace stackƒntry! \n");

745  -
EIO
;

752 
	`TRAMP_DEBUG
("U£r¥aû fÀğ0x%°,oøğ%°fixu°ğ0x%°\n",
â
, 
toc
,

753 
fixup_â
);

754 
	`TRAMP_DEBUG
("New_u£r_¥ = 0x%°\n", (*)
Ãw_u£r_¥
);

755 
»gs
->
g´
[1] = 
Ãw_u£r_¥
;

756 
»gs
->
lšk
 = (
u64
)
fixup_â
;

757 
»gs
->
g´
[2] = (
u64
)
toc
;

758 
»gs
->
n
 = (
u64
)
â
;

760 
	`TRAMP_DEBUG
("Dum°Ãw u£r¥aû sck @ 0x%°\n", (*)
Ãw_u£r_¥
);

762 
ušt8_t
 
¡ack_buf
[0x200];

763 ià(
	`cİy_äom_u£r
(
¡ack_buf
, (* )
Ãw_u£r_¥
, 0x200))

765 
	`TRAMP_DEBUG
("Can't copy stack back! \n");

774 
	}
}

	@ppc64_linux_trampoline_internal.h

27 #iâdeà
__ONLOAD_LINUX_TRAMPOLINE_PPC64_INTERNAL_H__


28 
	#__ONLOAD_LINUX_TRAMPOLINE_PPC64_INTERNAL_H__


	)

30 
	ssysÿÎ_’Œy_¡ruù


32 
	msysÿÎ_Ä
;

34 *
	m’Œy64
;

35 #ifdeà
CONFIG_COMPAT


36 *
	m’Œy32
;

48 *
	mÜigš®_’Œy64
[2];

49 #ifdeà
CONFIG_COMPAT


50 *
	mÜigš®_’Œy32
[2];

52 } 
	tsysÿÎ_’Œy_t
;

55 
lšux_ŒampŞše_µc64_š‹º®_ùÜ
();

58 
lšux_ŒampŞše_µc64_»¡Üe_sysÿÎs
();

61 
lšux_ŒampŞše_µc64_di¥o£
();

64 
	#NR_MAX_SYSCALL_INTERCEPT
 24

	)

74 
sysÿÎ_’Œy_t
 *
lšux_ŒampŞše_µc64_š‹rû±_sysÿÎ
(
sysÿÎ_Ä
,

75 *
’Œy64
,

76 *
’Œy32
);

79 (*
	tu£r_mode_ŒampŞše_â_t
)(
	tsys_rv
, 
	tİcode
, 
	td©a
);

90 
	`£tup_ŒampŞše64
(
±_»gs
 *
»gs
, 
İcode
, 
d©a
,

91 
u32
 
__u£r
 *
â
, 
u64
 __u£¸*
toc
,

92 
u32
 
__u£r
 *
fixup_â
);

96 
	`£tup_ŒampŞše32
(
±_»gs
 *
»gs
, 
İcode
, 
d©a
,

97 
u32
 
__u£r
 *
â
, u32 __u£¸*
toc
,

98 
u32
 
__u£r
 *
fixup_â
);

105 
	#PT_REGS_FROM_SYSCALL
(è((
±_»gs
 *)(&((
u8
 *)
	`__butš_äame_add»ss
(1))[
STACK_FRAME_OVERHEAD
]))

	)

108 
ušt64_t
 *
	`fšd_sysÿÎ_bË
(**
»tuº_addr
);

	@shmbuf.c

15 
	~<Úlßd/debug.h
>

16 
	~<Úlßd/shmbuf.h
>

18 
	$ci_shmbuf_®loc
(
ci_shmbuf_t
* 
b
, 
by‹s
)

20 
i
;

22 
	`ci_as£¹
(
b
);

24 
b
->
n_·ges
 = 
	`CI_ROUND_UP
(
by‹s
, 
CI_PAGE_SIZE
è>> 
CI_PAGE_SHIFT
;

25 
b
->
·ges
 = 
	`ci_®loc
(b->
n_·ges
 * (b->pages[0]));

26 ifĞ
b
->
·ges
 =ğ0 )  -
ENOMEM
;

28  
i
 = 0; i < 
b
->
n_·ges
; ++˜è
	`efhw_·ge_m¬k_šv®id
(&b->
·ges
[i]);

31 
	}
}

34 
	$ci_shmbuf_ä“
(
ci_shmbuf_t
* 
b
)

36 
i
;

38 
	`ci_as£¹
(
b
);

39 
	`ci_as£¹
(
b
->
·ges
);

41  
i
 = 0; i < 
b
->
n_·ges
; ++i )

42 ifĞ
	`efhw_·ge_is_v®id
(&
b
->
·ges
[
i
]) )

43 
	`efhw_·ge_ä“
(&
b
->
·ges
[
i
]);

45 
	`ci_ä“
(
b
->
·ges
);

46 
	}
}

49 
	$ci_shmbuf_demªd_·ge
(
ci_shmbuf_t
* 
b
, 
·ge_i
,

50 
ci_œqlock_t
* 
lock
)

52 
	`ci_as£¹
(
b
);

53 
	`ci_as£¹
(
·ge_i
 < 
b
->
n_·ges
);

55 ifĞ! 
	`efhw_·ge_is_v®id
(&
b
->
·ges
[
·ge_i
]) ) {

56 
efhw_·ge
 
p
;

57 ifĞ
	`efhw_·ge_®loc_z”Ûd
(&
p
) == 0 ) {

58 
ci_œqlock_¡©e_t
 
lock_æags
;

59 
	`ci_œqlock_lock
(
lock
, &
lock_æags
);

60 ifĞ! 
	`efhw_·ge_is_v®id
(&
b
->
·ges
[
·ge_i
]) ) {

61 
b
->
·ges
[
·ge_i
] = 
p
;

62 
	`efhw_·ge_m¬k_šv®id
(&
p
);

64 
	`ci_œqlock_uÆock
(
lock
, &
lock_æags
);

65 ifĞ
	`efhw_·ge_is_v®id
(&
p
èè
	`efhw_·ge_ä“
(&p);

68 
	`OO_DEBUG_VM
(
	`ci_log
("%s: ouˆoàmemÜy", 
__FUNCTION__
));

69  -
ENOMEM
;

73 
	}
}

	@sigaction_calls.c

12 
	~"Úlßd_k”Ãl_com·t.h
"

14 
	~<Úlßd/lšux_Úlßd_š‹º®.h
>

15 
	~<Úlßd/lšux_Úlßd.h
>

16 
	~<Úlßd/lšux_ŒampŞše.h
>

17 
	~<Úlßd/lšux_mm­.h
>

20 
	$eçb_sigÇl_hªdËr_ty³
(
sig
, 
__sighªdËr_t
 
u£r_hªdËr
)

22 ifĞ
u£r_hªdËr
 =ğ
SIG_IGN
 )

23  
OO_SIGHANGLER_IGN_BIT
;

24 ifĞ
u£r_hªdËr
 !ğ
SIG_DFL
 )

25  
OO_SIGHANGLER_USER
;

26 ifĞ
	`sig_k”Ãl_¡İ
(
sig
) )

27  
OO_SIGHANGLER_STOP
;

28 ifĞ
	`sig_k”Ãl_cÜedump
(
sig
) )

29  
OO_SIGHANGLER_CORE
;

30 ifĞ
	`sig_k”Ãl_ignÜe
(
sig
) )

31  
OO_SIGHANGLER_IGN_BIT
;

33  
OO_SIGHANGLER_TERM
;

34 
	}
}

38 
	$eçb_sigÇl_sub¡™u‹
(
sig
, 
sigaùiÚ
 *
Ãw_aù
,

39 
mm_sigÇl_d©a
 *
Œamp_d©a
)

41 
rc
;

42 
__sighªdËr_t
 
hªdËr
;

43 
k_sigaùiÚ
 *
k
;

44 
ty³
;

45 
__u£r
 
oo_sigaùiÚ
 *
u£r_d©a
;

46 
oo_sigaùiÚ
 *
sigÇl_d©a
 = &(
Œamp_d©a
->sigÇl_d©a[
sig
 - 1]);

47 
ci_št32
 
Şd_ty³
;

48 
ci_št32
 
£q
;

50 
u£r_d©a
 = &(((
oo_sigaùiÚ
 *)

51 (
	`CI_USER_PTR_GET
(
Œamp_d©a
->
u£r_d©a
)))[
sig
 - 1]);

52 ifĞ!
	`acûss_ok
(
VERIFY_WRITE
, 
u£r_d©a
, (
oo_sigaùiÚ
) ) )

53  -
EFAULT
;

56 
Şd_ty³
 = 
sigÇl_d©a
->
ty³
;

57 
£q
 = (
Şd_ty³
 & 
OO_SIGHANGLER_SEQ_MASK
è+ (1 << 
OO_SIGHANGLER_SEQ_SHIFT
);

58 }  
	`ci_ÿs32_ç
(&
sigÇl_d©a
->
ty³
, 
Şd_ty³
,

59 
OO_SIGHANGLER_BUSY
 | 
£q
) );

63 
rc
 = 
	`__put_u£r
(
sigÇl_d©a
->
ty³
, &
u£r_d©a
->type);

64 ifĞ
rc
 != 0 ) {

65 
sigÇl_d©a
->
ty³
 = 
Şd_ty³
;

66  -
EFAULT
;

69 
	`¥š_lock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

70 
k
 = &
cu¼’t
->
sighªd
->
aùiÚ
[
sig
 - 1];

71 ifĞ
Ãw_aù
 )

72 
k
->
§
 = *
Ãw_aù
;

73 
ty³
 = 
	`eçb_sigÇl_hªdËr_ty³
(
sig
, 
k
->
§
.
§_hªdËr
);

74 
hªdËr
 = 
ty³
 <ğ
OO_SIGHANGLER_DFL_MAX
 ? 
Œamp_d©a
->
hªdËrs
[ty³] : 
NULL
;

75 
	`BUILD_BUG_ON
(
SIG_DFL
 !ğ
NULL
);

78 ifĞ
ty³
 !ğ
OO_SIGHANGLER_USER
 && 
hªdËr
 =ğ
NULL
 ) {

79 
	`¥š_uÆock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

80 
sigÇl_d©a
->
ty³
 = 
Şd_ty³
 | 
OO_SIGHANGLER_IGN_BIT
 | 
£q
;

81 
	`ci_v”ify
(
	`__put_u£r
(
sigÇl_d©a
->
ty³
,

82 &
u£r_d©a
->
ty³
) == 0);

87 
	`OO_DEBUG_SIGNAL
(
	`ci_log
("%s: %d change sig=%d handler %p flags %lx "

88 "»¡Ü” %°ty³ %d", 
__func__
,

89 
cu¼’t
->
pid
, 
sig
, 
k
->
§
.
§_hªdËr
,

90 
k
->
§
.
§_æags
, k->§.
§_»¡Ü”
, 
ty³
));

91 
sigÇl_d©a
->
æags
 = 
k
->
§
.
§_æags
;

92 
k
->
§
.
§_æags
 |ğ
SA_SIGINFO
;

93 ifĞ
ty³
 =ğ
OO_SIGHANGLER_USER
 )

94 
	`CI_USER_PTR_SET
(
sigÇl_d©a
->
hªdËr
, 
k
->
§
.
§_hªdËr
);

96 
	`CI_USER_PTR_SET
(
sigÇl_d©a
->
hªdËr
, handler);

97 ifĞ
Œamp_d©a
->
§»¡Ü”
 ) {

98 
k
->
§
.
§_æags
 |ğ
SA_RESTORER
;

99 
k
->
§
.
§_»¡Ü”
 = 
Œamp_d©a
->
§»¡Ü”
;

102 
k
->
§
.
§_hªdËr
 = 
Œamp_d©a
->
hªdËr_po¡pÚe
;

103 
	`¥š_uÆock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

105 
	`OO_DEBUG_SIGNAL
(
	`ci_log
("%s: %d set sig=%d handler %p flags %lx„estorer %p",

106 
__func__
, 
cu¼’t
->
pid
, 
sig
, 
k
->
§
.
§_hªdËr
,

107 
k
->
§
.
§_æags
, k->§.
§_»¡Ü”
));

110 
rc
 = 
	`__cİy_to_u£r
(
u£r_d©a
, 
sigÇl_d©a
, (*signal_data));

111 
sigÇl_d©a
->
ty³
 =y³ | 
£q
;

112 ifĞ
rc
 != 0 )

113  -
EFAULT
;

115 
	`ci_v”ify
(
	`__put_u£r
(
sigÇl_d©a
->
ty³
, &
u£r_d©a
->type) == 0);

118 
	}
}

121 
	$eçb_sigÇl_»check
(
sig
, cÚ¡ 
mm_sigÇl_d©a
 *
Œamp_d©a
)

123 cÚ¡ 
oo_sigaùiÚ
 *
sigÇl_d©a
 = &(
Œamp_d©a
->sigÇl_d©a[
sig
 - 1]);

124 
k_sigaùiÚ
 *
k
;

126 ifĞ(
sigÇl_d©a
->
ty³
 & (
OO_SIGHANGLER_TYPE_MASK
 | 
OO_SIGHANGLER_IGN_BIT
)) !=

127 
OO_SIGHANGLER_USER
 )

130 
	`¥š_lock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

131 
k
 = &
cu¼’t
->
sighªd
->
aùiÚ
[
sig
 - 1];

132 ifĞ
k
->
§
.
§_hªdËr
 =ğ
NULL
 ) {

133 
k
->
§
.
§_æags
 = 
SA_SIGINFO
;

134 
k
->
§
.
§_hªdËr
 = 
Œamp_d©a
->
hªdËr_po¡pÚe
;

135 
	`OO_DEBUG_SIGNAL
(
	`ci_log
("%s: fix sig=%d;…robable SA_ONESHOT",

136 
__func__
, 
sig
));

138 
	`¥š_uÆock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

139 
	}
}

141 
	$eçb_sigÇl_mm_š™
(cÚ¡ 
ci_Œamp_»g_¬gs_t
 *
¬gs
, 
mm_hash
 *
p
)

143 
i
;

145 ifĞ
¬gs
->
max_signum
 < 
_NSIG
 )

146  -
E2BIG
;

148 
p
->
sigÇl_d©a
.
hªdËr_po¡pÚe
 =

149 
	`CI_USER_PTR_GET
(
¬gs
->
sigÇl_hªdËr_po¡pÚe
);

150 
p
->
sigÇl_d©a
.
§»¡Ü”
 = 
	`CI_USER_PTR_GET
(
¬gs
->
sigÇl_§»¡Ü”
);

152  
i
 = 0; i <ğ
OO_SIGHANGLER_DFL_MAX
; i++ )

153 
p
->
sigÇl_d©a
.
hªdËrs
[
i
] = 
	`CI_USER_PTR_GET
(
¬gs
->
sigÇl_hªdËrs
[i]);

155 
p
->
sigÇl_d©a
.
u£r_d©a
 = 
¬gs
->signal_data;

156 
p
->
sigÇl_d©a
.
§_Ú¡ack_š‹rû±
 = 
¬gs
->sa_onstack_intercept;

159 
	}
}

161 
	$eçb_sigÇl_´oûss_š™
(
mm_sigÇl_d©a
 *
Œamp_d©a
)

163 
sig
;

164 
rc
;

166 
	`OO_DEBUG_SIGNAL
(
	`ci_log
("%s(%p)…id %d",

167 
__func__
, 
Œamp_d©a
, 
cu¼’t
->
pid
));

171  
sig
 = 1; sig <ğ
_NSIG
; sig++ ) {

172 
k_sigaùiÚ
 *
k
;

174 
Œamp_d©a
->
sigÇl_d©a
[
sig
 - 1].
ty³
 = 
OO_SIGHANGLER_USER
 |

175 
OO_SIGHANGLER_IGN_BIT
;

176 
	`CI_USER_PTR_SET
(
Œamp_d©a
->
sigÇl_d©a
[
sig
 - 1].
hªdËr
, 
NULL
);

180 ifĞ
	`sig_k”Ãl_Úly
(
sig
) )

186 
	`¥š_lock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

187 
k
 = &
cu¼’t
->
sighªd
->
aùiÚ
[
sig
 - 1];

188 ifĞ
k
->
§
.
§_hªdËr
 =ğ
Œamp_d©a
->
hªdËr_po¡pÚe
 ) {

189 
	`¥š_uÆock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

190 
	`OO_DEBUG_SIGNAL
(
	`ci_log
("%s: double init…id=%d",

191 
__func__
, 
cu¼’t
->
pid
));

192 
rc
 = 
	`cİy_äom_u£r
(
Œamp_d©a
->
sigÇl_d©a
,

193 
	`CI_USER_PTR_GET
(
Œamp_d©a
->
u£r_d©a
),

194 (
Œamp_d©a
->
sigÇl_d©a
));

195 ifĞ
rc
 != 0 )

196 
	`ci_log
("%s: ERROR: faedØcİy sigÇÈd©¨(%d)", 
__func__
, 
rc
);

200 
	`¥š_uÆock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

203 (è
	`eçb_sigÇl_sub¡™u‹
(
sig
, 
NULL
, 
Œamp_d©a
);

206 
Œamp_d©a
->
k”Ãl_sighªd
 = 
cu¼’t
->
sighªd
;

207 
	}
}

213 
	$eçb_sigÇl_»pÜt_sigaùiÚ
(
sig
, 
sigaùiÚ
 *
§
,

214 
mm_sigÇl_d©a
 *
Œamp_d©a
)

216 
oo_sigaùiÚ
 *
sigÇl_d©a
 = &(
Œamp_d©a
->sigÇl_d©a[
sig
 - 1]);

217 
ci_št32
 
ty³
;

218 
	#MAX_TRIES_BUSY
 1000

	)

219 
Œ›d_busy
 = 0;

220 
Œ›d_chªged
 = 0;

221 
§_´ovided
 = (
§
 !ğ
NULL
);

223 
»_»ad_d©a
:

225 
Œ›d_busy
++;

226 
ty³
 = 
sigÇl_d©a
->type;

227 }  (
ty³
 & 
OO_SIGHANGLER_TYPE_MASK
è=ğ
OO_SIGHANGLER_BUSY
 &&

228 
Œ›d_busy
 <ğ
MAX_TRIES_BUSY
 );

229 ifĞ
Œ›d_busy
 > 
MAX_TRIES_BUSY
 ) {

230 
	`ci_log
("%s(%d):…id %d signal() or sigaction()„uns foroo†ong",

231 
__func__
, 
sig
, 
cu¼’t
->
pid
);

232  -
EBUSY
;

235 
»pÜt
:

236 
	`¥š_lock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

237 ifĞ
§_´ovided
 )

238 *
§
 = 
cu¼’t
->
sighªd
->
aùiÚ
[
sig
 - 1].sa;

240 
§
 = &
cu¼’t
->
sighªd
->
aùiÚ
[
sig
 - 1].sa;

242 ifĞ
§
->
§_hªdËr
 !ğ
Œamp_d©a
->
hªdËr_po¡pÚe
 ) {

243 
	`¥š_uÆock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

247 
	`OO_DEBUG_SIGNAL
(
	`ci_log
("%s: %d…rocess sig=%dype %d handler %p "

248 "æag %lx„e¡Ü” %p", 
__func__
, 
cu¼’t
->
pid
,

249 
sig
, 
ty³
 & 
OO_SIGHANGLER_TYPE_MASK
, 
§
->
§_hªdËr
,

250 
§
->
§_æags
, sa->
§_»¡Ü”
));

251 ifĞ(
sigÇl_d©a
->
ty³
 & 
OO_SIGHANGLER_TYPE_MASK
è=ğ
OO_SIGHANGLER_USER
)

252 
§
->
§_hªdËr
 = 
	`CI_USER_PTR_GET
(
sigÇl_d©a
->
hªdËr
);

253 ifĞ! (
sigÇl_d©a
->
ty³
 & 
OO_SIGHANGLER_IGN_BIT
) ) {

254 
§
->
§_hªdËr
 = 
SIG_DFL
;

255 
§
->
§_æags
 &ğ~
SA_RESTORER
;

256 ifĞ! (
sigÇl_d©a
->
æags
 & 
SA_SIGINFO
) )

257 
§
->
§_æags
 &ğ~
SA_SIGINFO
;

258 
§
->
§_»¡Ü”
 = 
NULL
;

260 
	`OO_DEBUG_SIGNAL
(
	`ci_log
("%s: %do user sig=%d handler %p flags %lx "

261 "»¡Ü” %p", 
__func__
,

262 
cu¼’t
->
pid
, 
sig
, 
§
->
§_hªdËr
,

263 
§
->
§_æags
, sa->
§_»¡Ü”
));

265 
	`¥š_uÆock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

268 ifĞ
ty³
 !ğ
sigÇl_d©a
->type ) {

269 
Œ›d_chªged
++;

270 ifĞ
Œ›d_chªged
 > 
MAX_TRIES_BUSY
 ) {

271 
	`ci_log
("%s: sigÇl(èÜ sigaùiÚ(èÿÎedoØç¡", 
__func__
);

272  -
EBUSY
;

274 ifĞ(
sigÇl_d©a
->
ty³
 & 
OO_SIGHANGLER_TYPE_MASK
è=ğ
OO_SIGHANGLER_BUSY
 ) {

275 
Œ›d_busy
 = 0;

276 
»_»ad_d©a
;

279 
»pÜt
;

283 
	}
}

285 
	$eçb_sigÇl_´oûss_fši
(
mm_sigÇl_d©a
 *
Œamp_d©a
)

287 
sig
;

289 
	`OO_DEBUG_SIGNAL
(
	`ci_log
("%s(%p)…id %d: current->flags=%x, "

290 "Œamp_d©a->u£r_d©a=%p", 
__func__
,

291 
Œamp_d©a
, 
cu¼’t
->
pid
, ()cu¼’t->
æags
,

292 
	`CI_USER_PTR_GET
(
Œamp_d©a
->
u£r_d©a
)));

294 ifĞ
cu¼’t
->
æags
 & 
PF_EXITING
 )

296 #ià
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(2,6,30)

297 ifĞ
cu¼’t
->
š_execve
 )

300 ifĞ
	`CI_USER_PTR_GET
(
Œamp_d©a
->
u£r_d©a
è=ğ
NULL
 )

303 
	`OO_DEBUG_SIGNAL
(
	`ci_log
("%s(%p)…id %d: uninstall interception",

304 
__func__
, 
Œamp_d©a
, 
cu¼’t
->
pid
));

305  
sig
 = 1; sig <ğ
_NSIG
; sig++ ) {

306 ifĞ
	`sig_k”Ãl_Úly
(
sig
) )

308 ifĞ
	`eçb_sigÇl_»pÜt_sigaùiÚ
(
sig
, 
NULL
, 
Œamp_d©a
) != 0 ) {

309 
	`ci_log
("%s: ERROR:…id %d failedo back off signal %d handler",

310 
__func__
, 
cu¼’t
->
pid
, 
sig
);

314 
	}
}

317 #ià
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,12)

318 
	#v®id_sigÇl
(
s
è((sè<ğ
_NSIG
)

	)

321 
	$eçb_sigÇl_do_sigaùiÚ
(
sig
, 
sigaùiÚ
 *
aù
,

322 
sigaùiÚ
 *
ßù
,

323 
mm_sigÇl_d©a
 *
Œamp_d©a
,

324 *
out_·ss_to_k”Ãl
)

326 
rc
 = 0;

328 ifĞ!
	`v®id_sigÇl
(
sig
è|| sig < 1 || (
aù
 !ğ
NULL
 && 
	`sig_k”Ãl_Úly
(sig)) )

329  -
EINVAL
;

332 ifĞ
ßù
 !ğ
NULL
 ) {

333 
rc
 = 
	`eçb_sigÇl_»pÜt_sigaùiÚ
(
sig
, 
ßù
, 
Œamp_d©a
);

334 ifĞ
rc
 != 0 )

335  
rc
;

338 ifĞ
aù
 !ğ
NULL
 ) {

339 
	`sigd–£tmask
(&
aù
->
§_mask
, 
	`sigmask
(
SIGKILL
è| sigmask(
SIGSTOP
));

343 ifĞ
aù
->
§_hªdËr
 =ğ
SIG_IGN
 ||

344 (
aù
->
§_hªdËr
 =ğ
SIG_DFL
 && 
	`sig_k”Ãl_ignÜe
(
sig
)) )

345 *
out_·ss_to_k”Ãl
 = 1;

346 ifĞ
aù
->
§_æags
 & 
SA_ONSTACK
 && !
Œamp_d©a
->
§_Ú¡ack_š‹rû±
 )

347 *
out_·ss_to_k”Ãl
 = 1;

349 
rc
 = 
	`eçb_sigÇl_sub¡™u‹
(
sig
, 
aù
, 
Œamp_d©a
);

352 
	`eçb_sigÇl_»check
(
sig
, 
Œamp_d©a
);

354  
rc
;

355 
	}
}

358 
	$eçb_sigÇl_g‘_Œamp_d©a
(
mm_sigÇl_d©a
 **
Œamp_d©a
)

360 
mm_hash
 *
p
;

362 
	`wr™e_lock
 (&
oo_mm_tbl_lock
);

363 
p
 = 
	`oo_mm_tbl_lookup
(
cu¼’t
->
mm
);

364 ifĞ
p
 =ğ
NULL
 || 
	`CI_USER_PTR_GET
Õ->
sigÇl_d©a
.
u£r_d©a
) == NULL) {

365 
	`wr™e_uÆock
 (&
oo_mm_tbl_lock
);

366  -
ENOSYS
;

368 
	`eçb_g‘_mm_hash_locked
(
p
);

369 *
Œamp_d©a
 = &
p
->
sigÇl_d©a
;

371 
	`wr™e_uÆock
 (&
oo_mm_tbl_lock
);

374 
	}
}

378 
	$eçb_sigÇl_put_Œamp_d©a
(
mm_sigÇl_d©a
 *
Œamp_d©a
)

380 
mm_hash
 *
p
 = 
	`cÚš”_of
(
Œamp_d©a
, mm_hash, 
sigÇl_d©a
);

381 
do_ä“
 = 0;

383 
	`wr™e_lock
 (&
oo_mm_tbl_lock
);

384 
	`eçb_put_mm_hash_locked
(
p
);

385 
	`wr™e_uÆock
 (&
oo_mm_tbl_lock
);

387 ifĞ
do_ä“
 )

388 
	`eçb_ä“_mm_hash
(
p
);

389 
	}
}

391 
asmlškage
 

392 
	$eçb_lšux_ŒampŞše_sigaùiÚ
(
sig
, cÚ¡ 
sigaùiÚ
 *
aù
,

393 
sigaùiÚ
 *
ßù
, 
size_t
 
sig£tsize
)

395 
rc
 = 0;

396 
sigaùiÚ
 
Şd
, 
Ãw
;

397 
mm_sigÇl_d©a
 *
Œamp_d©a
;

398 
·ss_to_k”Ãl
 = 0;

400 
	`eçb_sysÿÎ_’‹r
();

402 ifĞ
sig£tsize
 !ğ(
sig£t_t
) ) {

403 
	`eçb_sysÿÎ_ex™
();

404  -
EINVAL
;

408 ifĞ
	`eçb_sigÇl_g‘_Œamp_d©a
(&
Œamp_d©a
) ) {

409 
rc
 = 
	`eçb_lšux_sys_sigaùiÚ
(
sig
, 
aù
, 
ßù
);

410 
	`eçb_sysÿÎ_ex™
();

411  
rc
;

414 ifĞ
aù
 !ğ
NULL
 ) {

418 ifĞ
Œamp_d©a
->
k”Ãl_sighªd
 !ğ
cu¼’t
->
sighªd
 )

419 
·ss_to_k”Ãl
 = 1;

421 
rc
 = 
	`cİy_äom_u£r
(&
Ãw
, 
aù
, (new));

422 ifĞ
rc
 != 0 ) {

423 
	`eçb_sigÇl_put_Œamp_d©a
(
Œamp_d©a
);

424 
	`eçb_sysÿÎ_ex™
();

425  -
EFAULT
;

430 
rc
 = 
	`eçb_sigÇl_do_sigaùiÚ
(
sig
,

431 (
aù
 && !
·ss_to_k”Ãl
è? &
Ãw
 : 
NULL
,

432 
ßù
 ? &
Şd
 : 
NULL
, 
Œamp_d©a
,

433 &
·ss_to_k”Ãl
);

434 
	`eçb_sigÇl_put_Œamp_d©a
(
Œamp_d©a
);

436 ifĞ
·ss_to_k”Ãl
 )

437 
	`eçb_lšux_sys_sigaùiÚ
(
sig
, 
aù
, 
NULL
);

439 ifĞ
rc
 =ğ0 && 
ßù
 !ğ
NULL
 ) {

440 
rc
 = 
	`cİy_to_u£r
(
ßù
, &
Şd
, (old));

441 ifĞ
rc
 != 0 ) {

442 
	`eçb_sysÿÎ_ex™
();

443  -
EFAULT
;

446 
	`eçb_sysÿÎ_ex™
();

447  
rc
;

448 
	}
}

450 #ifdeà
CONFIG_COMPAT


451 #ià
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,12)

452 
šlše
 
com·t_u±r_t
 
	$±r_to_com·t
(
__u£r
 *
u±r
)

453 {  (
u32
)()
u±r
; 
	}
}

458 
asmlškage
 

459 
	$eçb_lšux_ŒampŞše_sigaùiÚ32
(
sig
, cÚ¡ 
sigaùiÚ32
 *
aù32
,

460 
sigaùiÚ32
 *
ßù32
,

461 
sig£tsize
)

463 
sigaùiÚ
 
aù
, 
ßù
;

464 
com·t_sig£t_t
 
£t32
;

465 
rc
;

466 
mm_sigÇl_d©a
 *
Œamp_d©a
;

467 
·ss_to_k”Ãl
 = 0;

469 
	`eçb_sysÿÎ_’‹r
();

471 ifĞ
sig£tsize
 !ğ(
com·t_sig£t_t
) ) {

472 
	`eçb_sysÿÎ_ex™
();

473  -
EINVAL
;

477 ifĞ
	`eçb_sigÇl_g‘_Œamp_d©a
(&
Œamp_d©a
) ) {

478 
rc
 = 
	`eçb_lšux_sys_sigaùiÚ32
(
sig
, 
aù32
, 
ßù32
);

479 
	`eçb_sysÿÎ_ex™
();

480  
rc
;

484 ifĞ
aù32
 !ğ
NULL
 && 
Œamp_d©a
->
k”Ãl_sighªd
 !ğ
cu¼’t
->
sighªd
 )

485 
·ss_to_k”Ãl
 = 1;

487 ifĞ
aù32
 !ğ
NULL
 && !
·ss_to_k”Ãl
 ) {

488 
com·t_u±r_t
 
hªdËr
, 
»¡Ü”
;

490 ifĞ!
	`acûss_ok
(
VERIFY_READ
, 
aù32
, (*act32)) ||

491 
	`__g‘_u£r
(
hªdËr
, &
aù32
->
§_hªdËr
) ||

492 
	`__g‘_u£r
(
aù
.
§_æags
, &
aù32
->sa_flags) ||

493 
	`__g‘_u£r
(
»¡Ü”
, &
aù32
->
§_»¡Ü”
) ||

494 
	`__cİy_äom_u£r
(&
£t32
, &
aù32
->
§_mask
, (
com·t_sig£t_t
)) ) {

495 
	`eçb_sigÇl_put_Œamp_d©a
(
Œamp_d©a
);

496 
	`eçb_sysÿÎ_ex™
();

497  -
EFAULT
;

499 
aù
.
§_hªdËr
 = 
	`com·t_±r
(
hªdËr
);

500 
aù
.
§_»¡Ü”
 = 
	`com·t_±r
(
»¡Ü”
);

502 
	`ci_as£¹_ge
(
_COMPAT_NSIG_WORDS
, 
_NSIG_WORDS
 << 1);

503 
_NSIG_WORDS
) {

504 4: 
aù
.
§_mask
.
sig
[3] = 
£t32
.sig[6] | ((()set32.sig[7]) << 32);

505 3: 
aù
.
§_mask
.
sig
[2] = 
£t32
.sig[4] | ((()set32.sig[5]) << 32);

506 2: 
aù
.
§_mask
.
sig
[1] = 
£t32
.sig[2] | ((()set32.sig[3]) << 32);

507 1: 
aù
.
§_mask
.
sig
[0] = 
£t32
.sig[0] | ((()set32.sig[1]) << 32);

511 
rc
 = 
	`eçb_sigÇl_do_sigaùiÚ
(
sig
,

512 (
aù32
 && !
·ss_to_k”Ãl
è? &
aù
 : 
NULL
,

513 
ßù32
 ? &
ßù
 : 
NULL
, 
Œamp_d©a
,

514 &
·ss_to_k”Ãl
);

515 
	`eçb_sigÇl_put_Œamp_d©a
(
Œamp_d©a
);

516 ifĞ
·ss_to_k”Ãl
 )

517 
	`eçb_lšux_sys_sigaùiÚ32
(
sig
, 
aù32
, 
NULL
);

519 ifĞ
rc
 =ğ0 && 
ßù32
 !ğ
NULL
 ) {

520 
_NSIG_WORDS
) {

522 
£t32
.
sig
[7] = (
ßù
.
§_mask
.sig[3] >> 32);

523 
£t32
.
sig
[6] = 
ßù
.
§_mask
.sig[3];

525 
£t32
.
sig
[5] = (
ßù
.
§_mask
.sig[2] >> 32);

526 
£t32
.
sig
[4] = 
ßù
.
§_mask
.sig[2];

528 
£t32
.
sig
[3] = (
ßù
.
§_mask
.sig[1] >> 32);

529 
£t32
.
sig
[2] = 
ßù
.
§_mask
.sig[1];

531 
£t32
.
sig
[1] = (
ßù
.
§_mask
.sig[0] >> 32);

532 
£t32
.
sig
[0] = 
ßù
.
§_mask
.sig[0];

535 ifĞ!
	`acûss_ok
(
VERIFY_WRITE
, 
ßù32
, (*oact32)) ||

536 
	`__put_u£r
(
	`±r_to_com·t
(
ßù
.
§_hªdËr
), &
ßù32
->sa_handler) ||

537 
	`__put_u£r
(
	`±r_to_com·t
(
ßù
.
§_»¡Ü”
), &
ßù32
->sa_restorer) ||

538 
	`__put_u£r
(
ßù
.
§_æags
, &
ßù32
->sa_flags) ||

539 
	`__cİy_to_u£r
(&
ßù32
->
§_mask
, &
£t32
, (
com·t_sig£t_t
))) {

540 
	`eçb_sysÿÎ_ex™
();

541  -
EFAULT
;

545 
	`eçb_sysÿÎ_ex™
();

546  
rc
;

547 
	}
}

	@tcp_sendpage.c

12 
	~<Úlßd/debug.h
>

13 
	~<Úlßd/tı_h–³r_âs.h
>

16 
CI_BUILD_ASSERT
(
CI_SB_AFLAG_O_NONBLOCK
 =ğ
MSG_DONTWAIT
);

19 
ci_šlše
 
	$£nd·ge_cİy
(
ci_Ãtif
* 
ni
, 
ci_tı_¡©e
* 
ts
, 
·ge
*…age,

20 
off£t
, 
size_t
 
size
, 
æags
)

22 
iovec
 
io
;

23 
msghdr
 
m
;

24 
rc
;

26 
	`CITP_STATS_NETIF
(++
ni
->
¡©e
->
¡©s
.
tı_£nd·ges
);

28 
io
.
iov_ba£
 = (*è
	`km­
(
·ge
è+ 
off£t
;

29 
io
.
iov_Ën
 = 
size
;

30 
m
.
msg_iov
 = &
io
;

31 
m
.
msg_iovËn
 = 1;

32 
m
.
msg_cÚŒŞËn
 = 0;

33 
m
.
msg_Çm–’
 = 0;

35 
rc
 = 
	`ci_tı_£ndmsg
(
ni
, 
ts
, &
m
,

36 (
ts
->
s
.
b
.
sb_aæags
 & 
CI_SB_AFLAG_O_NONBLOCK
è| 
æags
,

37 
CI_ADDR_SPC_KERNEL
);

39 
	`kunm­
(
·ge
);

40  
rc
;

41 
	}
}

44 
ssize_t
 
	$lšux_tı_h–³r_fİ_£nd·ge
(
fe
* 
fp
, 
·ge
*…age,

45 
off£t
, 
size_t
 
size
,

46 
loff_t
* 
µos
, 
æags
)

48 
ci_´iv©e_t
* 
´iv
 = 
fp
->
´iv©e_d©a
;

49 
tı_h–³r_»sourû_t
* 
Œs
 = 
	`eçb_´iv_to_thr
(
´iv
);

50 
ci_sock_cmn
* 
s
;

52 
	`OO_DEBUG_VERB
(
	`ci_log
("%s: %d:%d off£t=%d size=%d fÏgs=%x", 
__FUNCTION__
,

53 
	`NI_ID
(&
Œs
->
Ãtif
), 
	`OO_SP_FMT
(
´iv
->
sock_id
), 
off£t
,

54 (è
size
, 
æags
));

56 
	`ci_as£¹
(
·ge
);

57 
	`ci_as£¹_ge
(
off£t
, 0);

58 
	`ci_as£¹_gt
(
size
, 0);

59 
	`ci_as£¹_Ë
(
off£t
 + 
size
, 
CI_PAGE_SIZE
);

61 #iâdeà
MSG_SENDPAGE_NOTLAST


63 ifĞ
æags
 )

64 
æags
 = 
MSG_MORE
;

70 ifĞ
off£t
 + 
size
 < 
CI_PAGE_SIZE
 && 
æags
 )

71 
æags
 = 0;

74 
s
 = 
	`SP_TO_SOCK
(&
Œs
->
Ãtif
, 
´iv
->
sock_id
);

75 if(
	`CI_LIKELY
Ğ
s
->
b
.
¡©e
 & 
CI_TCP_STATE_TCP_CONN
 ))

76  
	`£nd·ge_cİy
(&
Œs
->
Ãtif
,
	`SOCK_TO_TCP
(
s
),
·ge
,
off£t
,
size
,
æags
);

80  -
s
->
tx_”ºo
;

81 
	}
}

83 
ssize_t
 
	$lšux_tı_h–³r_fİ_£nd·ge_udp
(
fe
* 
fp
,

84 
·ge
*…age,

85 
off£t
, 
size_t
 
size
,

86 
loff_t
* 
µos
, 
æags
)

88 
ci_´iv©e_t
* 
´iv
 = 
fp
->
´iv©e_d©a
;

89 
tı_h–³r_»sourû_t
* 
Œs
 = 
	`eçb_´iv_to_thr
(
´iv
);

90 
tı_h–³r_’dpošt_t
* 
•
 = 
	`ci_Œs_g‘_v®id_•
(
Œs
, 
´iv
->
sock_id
);

92  
•
->
os_sock‘
->
fe
->
f_İ
->
	`£nd·ge
(ep->os_socket->file,

93 
·ge
, 
off£t
, 
size
, 
µos
, 
æags
);

94 
	}
}

	@terminate.c

14 
	~<ci/š‹º®/Œª¥Üt_cÚfig_İt.h
>

16 
	~"Úlßd_k”Ãl_com·t.h
"

18 
	~<Úlßd/lšux_Úlßd_š‹º®.h
>

19 
	~<Úlßd/tı_h–³r_âs.h
>

20 
	~<Úlßd/lšux_Úlßd.h
>

21 
	~<Úlßd/lšux_ŒampŞše.h
>

23 #ifdeà
OO_CAN_HANDLE_TERMINATION


27 
	#TERMINATE_STACKS_NUM
 64

	)

30 
	#TERM_DEBUG
(
x
...è
	`ci_log
(x)

	)

32 
	#TERM_DEBUG
(
x
...è()0

	)

38 
šlše
 
	$eçb_sigÇl_wake_up
(
sk_¡ruù
* 
t
)

40 
	`DECLARE_WAITQUEUE
(
wq
, 
NULL
);

42 
	`£t_tsk_th»ad_æag
(
t
, 
TIF_SIGPENDING
);

48 
wq
.
´iv©e
 = 
t
;

49 #ià
LINUX_VERSION_CODE
 > 
	`KERNEL_VERSION
(2,6,30)

50 ifĞ!
	`deçuÉ_wake_funùiÚ
(&
wq
, 
TASK_WAKEKILL
 | 
TASK_INTERRUPTIBLE
, 0, 
NULL
) )

51 
	`kick_´oûss
(
t
);

53 #iâdeà
TASK_WAKEKILL


54 
	#TASK_WAKEKILL
 (
TASK_STOPPED
 | 
TASK_TRACED
)

	)

56 
	`deçuÉ_wake_funùiÚ
(&
wq
, 
TASK_WAKEKILL
 | 
TASK_INTERRUPTIBLE
, 0, 
NULL
);

58 
	}
}

65 
	$eçb_z­_Ùh”_th»ads
(
sk_¡ruù
 *
p
)

67 
sk_¡ruù
 *
t
;

69 
p
->
sigÇl
->
group_¡İ_couÁ
 = 0;

70 #ià
LINUX_VERSION_CODE
 <ğ
	`KERNEL_VERSION
(2,6,24)

71 #ià
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(2,6,10)

72 
p
->
sigÇl
->
æags
 = 
SIGNAL_GROUP_EXIT
;

76 #ià
LINUX_VERSION_CODE
 <ğ
	`KERNEL_VERSION
(2,6,22)

77 ifĞ
	`th»ad_group_em±y
(
p
) )

81 
t
 = 
	`Ãxt_th»ad
(
p
); !=…; =‚ext_thread(t)) {

85 ià(
t
->
ex™_¡©e
)

88 #ià
LINUX_VERSION_CODE
 <ğ
	`KERNEL_VERSION
(2,6,20)

89 ià(
t
 !ğ
p
->
group_Ëad”
)

90 
t
->
ex™_sigÇl
 = -1;

93 
	`sigadd£t
(&
t
->
³ndšg
.
sigÇl
, 
SIGKILL
);

94 #ià
LINUX_VERSION_CODE
 <ğ
	`KERNEL_VERSION
(2,6,14)

95 
	`rm_äom_queue
(
SIG_KERNEL_STOP_MASK
, &
t
->
³ndšg
);

97 
	`eçb_sigÇl_wake_up
(
t
);

99 
	}
}

101 (*
eçb_my_z­_Ùh”_th»ads
)(
sk_¡ruù
 *
p
);

107 
	$eçb_‹rmš©e_fšd_®l_¡acks
(
tı_h–³r_»sourû_t
 *
¡acks
[],

108 
max_¡acks_num
)

110 
fes_¡ruù
* 
fes
;

111 
fdbË
* 
fdt
;

112 
ci_ušt32
 
¡acks_num
 = 0;

113 
i
, 
j
 = 0;

116 ià(
	`th»ad_group_em±y
(
cu¼’t
))

119 
	`ci_as£¹
(
max_¡acks_num
);

120 
	`TERM_DEBUG
 ("%s:…id %d", 
__func__
, 
cu¼’t
->
pid
);

122 
fes
 = 
cu¼’t
->files;

123 
	`¥š_lock
(&
fes
->
fe_lock
);

124 
fdt
 = 
	`fes_fdbË
(
fes
);

127 
£t
;

129 
i
 = 
j
 * 
__NFDBITS
;

130 ifĞ
i
 >ğ
fdt
->
max_fds
 )

131 
uÆock
;

133 
£t
 = 
	`efx_g‘_İ’_fds
(
j
++, 
fdt
);

135  
£t
 ) {

136 ifĞ
£t
 & 1 ) {

137 
fe
 * fğ
fdt
->
fd
[
i
];

139 ifĞ
fe
 && fe->
f_İ
 =ğ&
oo_fİs
 ) {

141 
tı_h–³r_»sourû_t
 *
thr
;

143 
	`ci_as£¹
(
fe
->
´iv©e_d©a
);

144 
thr
 = ((
ci_´iv©e_t
* )
fe
->
´iv©e_d©a
)->thr;

146 ifĞ
thr
 !ğ
NULL
 ) {

147 ifĞ
¡acks_num
 =ğ
max_¡acks_num
 ) {

148 
	`OO_DEBUG_ERR
(
	`ci_log
("%s: sck couÁ ov”æow", 
__FUNCTION__
));

149 
uÆock
;

155 
	`eçb_thr_»f
(
thr
);

156 
¡acks
[
¡acks_num
++] = 
thr
;

160 
i
++;

161 
£t
 >>= 1;

165 
uÆock
:

166 
	`¥š_uÆock
(&
fes
->
fe_lock
);

168 
	`TERM_DEBUG
 ("%s:…id %d oÆßd sck %d", 
__func__
, 
cu¼’t
->
pid
,

169 
¡acks_num
);

170  
¡acks_num
;

171 
	}
}

175 
	$eçb_‹rmš©e_lock_®l_¡acks
(
tı_h–³r_»sourû_t
 *
¡acks
[],

176 
¡acks_num
)

178 
i
, 
Œ›s
 = 0, 
found_locked
;

179 
ci_ušt64
 
g‘_lock
 = 0;

180 
	`DEFINE_MUTEX
(
ex™_Ãtifs_lock
);

182 
	`TERM_DEBUG
("%s:…id=%d, scks_num=%d, scks[0]=%d", 
__func__
,

183 
cu¼’t
->
pid
, 
¡acks_num
, 
¡acks
[0]->
id
);

186 ifĞ
¡acks_num
 == 1 ) {

187 
tı_h–³r_»sourû_t
* 
thr
 = 
¡acks
[0];

188 ifĞ
	`eçb_•lock_lock_timeout
(&
thr
->
Ãtif
, 
	`m£cs_to_jiff›s
(500))

190 
	`OO_DEBUG_ERR
(
	`ci_log
("Pid %d failedoerminate stack %d…roperly",

191 
cu¼’t
->
pid
, 
thr
->
id
));

192 
	`eçb_thr_»Ëa£
(
thr
);

193 
¡acks
[0] = 
NULL
;

195 
	`ci_as£¹
(
	`ci_Ãtif_is_locked
(&
thr
->
Ãtif
));

203 
	#MAX_ADD_TRIES
 10

	)

205 
	`ci_as£¹_ge
((
g‘_lock
è* 8, 
¡acks_num
);

210 
	`TERM_DEBUG
("%s: %d g‘ƒx™_Ãtifs_lock", 
__FUNCTION__
, 
cu¼’t
->
pid
);

211 
	`mu‹x_lock
(&
ex™_Ãtifs_lock
);

212 
	`TERM_DEBUG
("%s: %d gÙƒx™_Ãtifs_lock", 
__FUNCTION__
, 
cu¼’t
->
pid
);

214 
found_locked
 = 0;

216 
	`TERM_DEBUG
("%s: %d g‘_lock=%Îx", 
__FUNCTION__
, 
cu¼’t
->
pid
, 
g‘_lock
);

217  
i
 = 0; i < 
¡acks_num
; i++ ) {

219 
tı_h–³r_»sourû_t
* 
thr
 = 
¡acks
[
i
];

220 
rc
;

222 ifĞ
g‘_lock
 & ((
ci_ušt64
)1 << 
i
) )

225 ++
Œ›s
;

226 
	`TERM_DEBUG
("%s: %dryØlock sck %d,r›s=%d", 
__FUNCTION__
,

227 
cu¼’t
->
pid
, 
thr
->
id
, 
Œ›s
);

228 
rc
 = 
	`eçb_•lock_lock_timeout
(&
thr
->
Ãtif
, 
	`m£cs_to_jiff›s
(50));

229 ifĞ
rc
 != 0 ) {

230 
	`OO_DEBUG_ERR
(
	`ci_log
("%s:…id %d failedo get‚etif†ock "

231 "fÜ sck %d (Œy %d/%d)", 
__FUNCTION__
,

232 
cu¼’t
->
pid
, 
thr
->
id
, 
Œ›s
,

233 
MAX_ADD_TRIES
 + 
¡acks_num
));

234 
found_locked
 = 1;

235 ifĞ
Œ›s
 >ğ
MAX_ADD_TRIES
 + 
¡acks_num
 ) {

236 
	`OO_DEBUG_ERR
(
	`ci_log
("Pid %d failedoerminate stack %d…roperly",

237 
cu¼’t
->
pid
, 
thr
->
id
));

238 
	`eçb_thr_»Ëa£
(
thr
);

239 
¡acks
[
i
] = 
NULL
;

243 
	`ci_as£¹
(
	`ci_Ãtif_is_locked
(&
thr
->
Ãtif
));

244 
g‘_lock
 |ğ(
ci_ušt64
)1 << 
i
;

245 
	`TERM_DEBUG
("%s: %d†ock sck %d", 
__FUNCTION__
, 
cu¼’t
->
pid
, 
thr
->
id
);

248 }  
found_locked
 && 
Œ›s
 < 
MAX_ADD_TRIES
 + 
¡acks_num
 );

249 
	`TERM_DEBUG
("%s: %d‡Î sck locked", 
__FUNCTION__
, 
cu¼’t
->
pid
);

250 
	`mu‹x_uÆock
(&
ex™_Ãtifs_lock
);

251 
	`TERM_DEBUG
("%s: %dƒx™_Ãtifs_lock„–—£d", 
__FUNCTION__
, 
cu¼’t
->
pid
);

252 
	}
}

256 
	$eçb_‹rmš©e_uÆock_®l_¡acks
(
tı_h–³r_»sourû_t
 *
¡acks
[],

257 
¡acks_num
)

259 
i
;

261  
i
 = 0; i < 
¡acks_num
; i++ ) {

262 ifĞ
¡acks
[
i
] =ğ
NULL
 )

264 
	`ci_Ãtif_uÆock
(&
¡acks
[
i
]->
Ãtif
);

265 
	`TERM_DEBUG
("%s: %d uÆock sck %d", 
__func__
, 
cu¼’t
->
pid
, 
¡acks
[
i
]->
id
);

266 
	`eçb_thr_»Ëa£
(
¡acks
[
i
]);

268 
	}
}

272 
	$eçb_ex™_group
(*
¡©us_p
)

274 
sighªd_¡ruù
 *cÚ¡ 
sighªd
 = 
cu¼’t
->sighand;

275 
sigÇl_¡ruù
 *
sig
 = 
cu¼’t
->
sigÇl
;

276 
sk_¡ruù
 *
tsk
;

277 
Œ›s
, 
found
;

279 ifĞ(
sig
->
æags
 & 
SIGNAL_GROUP_EXIT
è|| (sig->
group_ex™_sk
 !ğ
NULL
) )

280 *
¡©us_p
 = 
sig
->
group_ex™_code
;

282 #ià
LINUX_VERSION_CODE
 < 
	`KERNEL_VERSION
(2,6,17)

283 
	#TASKLIST_IS_NON_RCU


	)

285 #ifdeà
TASKLIST_IS_NON_RCU


286 
	`»ad_lock
(&
skli¡_lock
);

288 
	`¥š_lock_œq
(&
sighªd
->
siglock
);

290 ifĞ(
sig
->
æags
 & 
SIGNAL_GROUP_EXIT
è|| (sig->
group_ex™_sk
 !ğ
NULL
) ) {

292 *
¡©us_p
 = 
sig
->
group_ex™_code
;

295 
sig
->
group_ex™_code
 = *
¡©us_p
;

296 
sig
->
æags
 = 
SIGNAL_GROUP_EXIT
;

297 
	`eçb_my_z­_Ùh”_th»ads
(
cu¼’t
);

300 
	`¥š_uÆock_œq
(&
sighªd
->
siglock
);

301 #ifdeà
TASKLIST_IS_NON_RCU


302 
	`»ad_uÆock
(&
skli¡_lock
);

307 
Œ›s
 = 0;

309 
found
 = 0;

311 
tsk
 = 
cu¼’t
;

312 #ifdeà
TASKLIST_IS_NON_RCU


313 
	`»ad_lock
(&
skli¡_lock
);

315 
	`whe_—ch_th»ad
(
cu¼’t
, 
tsk
) {

316 ifĞ
tsk
->
ex™_code
 == 0 ) {

317 
found
 = 1;

321 #ifdeà
TASKLIST_IS_NON_RCU


322 
	`»ad_uÆock
(&
skli¡_lock
);

328 ifĞ
found
 )

329 
	`scheduË_timeout_unš‹¼u±ibË
(1);

331 
Œ›s
++;

332 } 
found
 && 
Œ›s
 < 
HZ
/2);

333 
	`TERM_DEBUG
("found=%dr›s=%d", 
found
, 
Œ›s
);

335 
	}
}

338 
asmlškage
 

339 
	$eçb_lšux_ŒampŞše_ex™_group
(
¡©us
)

341 
tı_h–³r_»sourû_t
 *
¡acks
[
TERMINATE_STACKS_NUM
];

342 
ci_ušt32
 
¡acks_num
 = 0;

344 
	`eçb_sysÿÎ_’‹r
();

346 
	`BUILD_BUG_ON
((
ci_ušt64
è* 8 < 
TERMINATE_STACKS_NUM
);

347 
¡acks_num
 = 
	`eçb_‹rmš©e_fšd_®l_¡acks
(
¡acks
, 
TERMINATE_STACKS_NUM
);

350 ifĞ
¡acks_num
 ) {

352 
	`eçb_‹rmš©e_lock_®l_¡acks
(
¡acks
, 
¡acks_num
);

355 
¡©us
 = (status & 0xff) << 8;

356 
	`eçb_ex™_group
(&
¡©us
);

358 
	`eçb_‹rmš©e_uÆock_®l_¡acks
(
¡acks
, 
¡acks_num
);

361 
	`eçb_sysÿÎ_ex™
();

362 
	`do_ex™
(
¡©us
);

368 
	`eçb_sysÿÎ_ex™
();

370  
	`eçb_lšux_sys_ex™_group
(
¡©us
);

372 
	}
}

376 
	$eçb_sigÇl_d›
(
ci_´iv©e_t
 *
´iv_unu£d
, *
¬g
)

378 
ci_št32
 
sig
 = *(ci_št32 *)
¬g
;

379 
tı_h–³r_»sourû_t
 *
¡acks
[
TERMINATE_STACKS_NUM
];

380 
ci_ušt32
 
¡acks_num
 = 0;

382 ifĞ
	`sig_k”Ãl_Úly
(
sig
è|| 
	`sig_k”Ãl_ignÜe
(sig) ||

383 
	`sig_k”Ãl_¡İ
(
sig
è|| 
	`sig_k”Ãl_cÜedump
(sig) )

384  -
EINVAL
;

386 
	`BUILD_BUG_ON
((
ci_ušt64
è* 8 < 
TERMINATE_STACKS_NUM
);

387 
¡acks_num
 = 
	`eçb_‹rmš©e_fšd_®l_¡acks
(
¡acks
, 
TERMINATE_STACKS_NUM
);

389 ifĞ
¡acks_num
 ) {

390 
¡©us
 = 
sig
;

393 
	`eçb_‹rmš©e_lock_®l_¡acks
(
¡acks
, 
¡acks_num
);

395 
	`eçb_ex™_group
(&
¡©us
);

397 
	`eçb_‹rmš©e_uÆock_®l_¡acks
(
¡acks
, 
¡acks_num
);

402 
	`¥š_lock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

403 
cu¼’t
->
sighªd
->
aùiÚ
[
sig
-1].
§
.
§_hªdËr
 = 
SIG_DFL
;

404 
	`¥š_uÆock_œq
(&
cu¼’t
->
sighªd
->
siglock
);

406 
	`£nd_sig
(
sig
, 
cu¼’t
, 0);

409 
	}
}

412 
	$eçb_lšux_‹rmš©iÚ_ùÜ
()

414 #ifdeà
EFRM_HAS_FIND_KSYM


415 
eçb_my_z­_Ùh”_th»ads
 = 
	`eäm_fšd_ksym
("zap_other_threads");

416 
	`TERM_DEBUG
("Fšd z­_Ùh”_th»ad vŸ k®lsym © %p", 
t
.
addr
);

418 ifĞ
eçb_my_z­_Ùh”_th»ads
 =ğ
NULL
 )

421 
eçb_my_z­_Ùh”_th»ads
 = 
eçb_z­_Ùh”_th»ads
;

422 
	`TERM_DEBUG
("Using our zap_other_threads implementation");

425 
	}
}

430 
	$eçb_sigÇl_d›
(
ci_´iv©e_t
 *
´iv_unu£d
, *
¬g
)

433 
	}
}

	@x86_linux_trampoline.c

35 
	~<Úlßd/lšux_Úlßd_š‹º®.h
>

36 
	~<Úlßd/lšux_ŒampŞše.h
>

37 
	~<Úlßd/lšux_mm­.h
>

38 
	~<Úlßd/lšux_Úlßd.h
>

39 
	~<lšux/uni¡d.h
>

47 #ifdeà
__x86_64__


48 
	~<asm/m¤.h
>

51 #ià
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,30)

52 
	#OLD_RSP_PROVIDED
 1

	)

53 
	~<asm/pda.h
>

55 
	#OLD_RSP_PROVIDED
 0

	)

56 
	~<asm/³rıu.h
>

57 
DECLARE_PER_CPU
(, 
k”Ãl_¡ack
);

65 #ià
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,32)

66 
	#³rıu_»ad_äom_p
(
poš‹r
è
	`³rıu_äom_İ
("mov", *poš‹r)

	)

67 
	#³rıu_wr™e_to_p
(
poš‹r
, 
v®
) \

68 
	`³rıu_to_İ
("mov", *
poš‹r
, 
v®
)

	)

70 
	#³rıu_»ad_äom_p
(
poš‹r
) ({ \

71 
	`ty³of
(*
poš‹r
è
__tmp_v¬__
; \

72 
	`´“m±_di§bË
(); \

73 
__tmp_v¬__
 = (*
	`SHIFT_PERCPU_PTR
(
poš‹r
, 
my_ıu_off£t
)); \

74 
	`´“m±_’abË
(); \

75 
__tmp_v¬__
; \

76 })

	)

77 
	#³rıu_wr™e_to_p
(
poš‹r
, 
v®
) ({ \

78 
	`´“m±_di§bË
(); \

79 (*
	`SHIFT_PERCPU_PTR
(
poš‹r
, 
my_ıu_off£t
)èğ
v®
; \

80 
	`´“m±_’abË
(); \

81 })

	)

83 #ià
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,34)

84 
	#³rıu_p
(
Çme
è(&(
³r_ıu__
 ##‚ame))

	)

86 
	#³rıu_p
(
Çme
è(&Çme)

	)

91 #ifdeà
CONFIG_COMPAT


92 
	~<asm/Ÿ32_uni¡d.h
>

99 
	#__NR_Ÿ32_şo£
 6

	)

100 
	#__NR_Ÿ32_ex™_group
 252

	)

101 
	#__NR_Ÿ32_¹_sigaùiÚ
 174

	)

105 
	#cs
(
r
èÔ)->
cs


	)

106 
	#ds
(
r
èÔ)->
ds


	)

107 
	#es
(
r
èÔ)->
es


	)

108 
	#ss
(
r
èÔ)->
ss


	)

109 #ià
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,25)

110 
	#
(
r
èÔ)->
r


	)

111 
	#di
(
r
èÔ)->
rdi


	)

112 
	#si
(
r
èÔ)->
rsi


	)

113 
	#¥
(
r
èÔ)->
r¥


	)

114 
	#bp
(
r
èÔ)->
rbp


	)

115 
	#ax
(
r
èÔ)->
¿x


	)

116 
	#bx
(
r
èÔ)->
rbx


	)

117 
	#cx
(
r
èÔ)->
rcx


	)

118 
	#dx
(
r
èÔ)->
rdx


	)

119 
	#Üig_ax
(
r
èÔ)->
Üig_¿x


	)

120 
	#æags
(
r
èÔ)->
eæags


	)

121 
	#¥0
(
t
èÑ)->
r¥0


	)

123 
	#
(
r
èÔ)->



	)

124 
	#di
(
r
èÔ)->
di


	)

125 
	#si
(
r
èÔ)->
si


	)

126 
	#¥
(
r
èÔ)->
¥


	)

127 
	#bp
(
r
èÔ)->
bp


	)

128 
	#ax
(
r
èÔ)->
ax


	)

129 
	#bx
(
r
èÔ)->
bx


	)

130 
	#cx
(
r
èÔ)->
cx


	)

131 
	#dx
(
r
èÔ)->
dx


	)

132 
	#Üig_ax
(
r
èÔ)->
Üig_ax


	)

133 
	#æags
(
r
èÔ)->
æags


	)

134 
	#¥0
(
t
èÑ)->
¥0


	)

138 #ià
defšed
(
__i386__
)

139 #ià
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,25)

140 
	#bx
(
r
èÔ)->
ebx


	)

141 
	#cx
(
r
èÔ)->
ecx


	)

142 
	#dx
(
r
èÔ)->
edx


	)

143 
	#si
(
r
èÔ)->
esi


	)

144 
	#di
(
r
èÔ)->
edi


	)

145 
	#bp
(
r
èÔ)->
ebp


	)

146 
	#ax
(
r
èÔ)->
—x


	)

147 
	#ds
(
r
èÔ)->
xds


	)

148 
	#es
(
r
èÔ)->
xes


	)

149 
	#Üig_ax
(
r
èÔ)->
Üig_—x


	)

150 
	#
(
r
èÔ)->
e


	)

151 
	#cs
(
r
èÔ)->
xcs


	)

152 
	#æags
(
r
èÔ)->
eæags


	)

153 
	#¥
(
r
èÔ)->
e¥


	)

154 
	#ss
(
r
èÔ)->
xss


	)

155 
	#¥0
(
t
èÑ)->
e¥0


	)

157 
	#bx
(
r
èÔ)->
bx


	)

158 
	#cx
(
r
èÔ)->
cx


	)

159 
	#dx
(
r
èÔ)->
dx


	)

160 
	#si
(
r
èÔ)->
si


	)

161 
	#di
(
r
èÔ)->
di


	)

162 
	#bp
(
r
èÔ)->
bp


	)

163 
	#ax
(
r
èÔ)->
ax


	)

164 
	#ds
(
r
èÔ)->
ds


	)

165 
	#es
(
r
èÔ)->
es


	)

166 
	#Üig_ax
(
r
èÔ)->
Üig_ax


	)

167 
	#
(
r
èÔ)->



	)

168 
	#cs
(
r
èÔ)->
cs


	)

169 
	#æags
(
r
èÔ)->
æags


	)

170 
	#¥
(
r
èÔ)->
¥


	)

171 
	#ss
(
r
èÔ)->
ss


	)

172 
	#¥0
(
t
èÑ)->
¥0


	)

186 #ifdeà
__x86_64__


187 #ià
LINUX_VERSION_CODE
 =ğ
KERNEL_VERSION
(2, 6, 18)

188 
	#NEED_SYSCALL_MAPPING_HACK
(è((
	`__·
(
loc
è>> 
PAGE_SHIFT
è>ğ
’d_pâ
)

	)

190 
	#NEED_SYSCALL_MAPPING_HACK
(è0

	)

202 
	#TRAMP_DEBUG
(
x
...è()0

	)

224 **
	gsysÿÎ_bË
 = 0;

226 #ifdeà
CONFIG_COMPAT


230 **
	gŸ32_sysÿÎ_bË
 = 0;

237 
asmlškage
 (*
§ved_sys_şo£
)();

238 
asmlškage
 (*
§ved_sys_ex™_group
)();

239 
asmlškage
 (*
§ved_sys_¹_sigaùiÚ
)(, cÚ¡ 
sigaùiÚ
 *,

240 
sigaùiÚ
 *, 
size_t
);

241 #ifdeà
CONFIG_COMPAT


242 
asmlškage
 (*
§ved_sys_¹_sigaùiÚ32
)(,

243 cÚ¡ 
sigaùiÚ32
 *,

244 
sigaùiÚ32
 *,

249 
©omic_t
 
eçb_sysÿÎ_u£d
;

254 #ià
	`defšed
(
CONFIG_X86_XEN
)

256 **
	$fšd_sysÿÎ_bË
()

259  
NULL
;

260 
	}
}

261 #–ià
defšed
(
__i386__
)

267 **
	$fšd_sysÿÎ_bË
()

269 *
idtba£
;

270 *
p
, *
’d
, 
idt
[6];

271 **
»suÉ
 = 
NULL
;

273 
	`__asm__
("sidˆ%0" : "=m"(
idt
));

274 
idtba£
 = (*)(
idt
[2] | (idt[3] << 8) | (idt[4] << 16)

275 | (
idt
[5] << 24));

276 
	`TRAMP_DEBUG
("idˆba£=%p,ƒÁry 0x80=%08lx,%08lx", 
idtba£
,

277 
idtba£
[0x80*2], idtbase[0x80*2+1]);

278 
p
 = (*)((
idtba£
[0x80*2] & 0xffff)

279 | (
idtba£
[0x80*2+1] & 0xffff0000));

280 
	`TRAMP_DEBUG
("šˆ0x80ƒÁry…ošˆ© %p", 
p
);

281 
’d
 = 
p
 + 1024 - 7;

282 
p
 < 
’d
) {

283 ià((
p
[0] == 0xff) && (p[1] == 0x14) && (p[2] == 0x85)) {

284 
»suÉ
 = *(***)(
p
 + 3);

285 
	`TRAMP_DEBUG
("sysÿÎabË‡ˆ%p", 
»suÉ
);

286  
»suÉ
;

288 
p
++;

291 
	`TRAMP_DEBUG
("didn't find syscallable‡ddress");

292  
»suÉ
;

293 
	}
}

295 #–ià
defšed
(
__x86_64__
)

301 **
	$fšd_sysÿÎ_bË
()

303 
»suÉ
 = 0;

304 *
p
, *
³nd
;

306 
	`rdm¤l
(
MSR_LSTAR
, 
»suÉ
);

307 
	`TRAMP_DEBUG
("m¤_l¡¬=%lx", 
»suÉ
);

308 
p
 = (*)
»suÉ
;

309 
³nd
 = 
p
 + 1024 - 7;

310 
p
 < 
³nd
) {

311 ià((
p
[0] == 0xff) && (p[1] == 0x14) && (p[2] == 0xc5)) {

312 
»suÉ
 &= ~ 0xffffffffUL;

313 
»suÉ
 |ğ(
p
[3] | (p[4] << 8) | (p[5] << 16) | (p[6] << 24));

314 
	`TRAMP_DEBUG
("sysÿÎabË‡ˆ%lx", 
»suÉ
);

315  (**)
»suÉ
;

317 
p
++;

319 
	`TRAMP_DEBUG
("didn't find syscallable‡ddress");

320  
NULL
;

321 
	}
}

323 #ifdeà
CONFIG_COMPAT


329 **
	$fšd_Ÿ32_sysÿÎ_bË
()

331 
»suÉ
 = 0;

332 *
p
, *
³nd
;

333 *
idtba£
;

334 
idt
[10];

336 
	`__asm__
("sidˆ%0" : "=m"(
idt
));

337 
idtba£
 = *(**)(&
idt
[2]);

338 
	`TRAMP_DEBUG
("idˆba£=%p,ƒÁry 0x80=%08x,%08x,%08x", 
idtba£
,

339 
idtba£
[0x80*4], idtbase[0x80*4+1], idtbase[0x80*4+2]);

340 
»suÉ
 = (
idtba£
[0x80*4] & 0xffff) | (idtbase[0x80*4+1] & 0xffff0000)

341 | (()
idtba£
[0x80*4+2] << 32);

342 
p
 = (*)
»suÉ
;

343 
	`TRAMP_DEBUG
("šˆ0x80ƒÁry…ošˆ© %p", 
p
);

344 
³nd
 = 
p
 + 1024 - 7;

345 
p
 < 
³nd
) {

346 ià((
p
[0] == 0xff) && (p[1] == 0x14) && (p[2] == 0xc5)) {

347 
»suÉ
 &= ~ 0xffffffffUL;

348 
»suÉ
 |ğ(
p
[3] | (p[4] << 8) | (p[5] << 16) | (p[6] << 24));

349 
	`TRAMP_DEBUG
("Ÿ32_sysÿÎabË‡ˆ%lx", 
»suÉ
);

350  (**)
»suÉ
;

352 
p
++;

354 
	`TRAMP_DEBUG
("didn't find ia32_syscallable‡ddress");

355  
NULL
;

356 
	}
}

359 #–ià
defšed
(
__Ÿ64__
)

363 
asmlškage
 
eçb_lšux_ŒampŞše_şo£
(
__©Œibu‹__
((
unu£d
)) unused)

365 
TRAMP_DEBUG
 ("ia64ƒfab_linux_trampoline_close() called");

369 **
	$fšd_sysÿÎ_bË
()

371  
NULL
;

372 
	}
}

381 
asmlškage
 
	$eçb_lšux_sys_şo£
(
fd
)

383 
rc
;

385 ifĞ
§ved_sys_şo£
 =ğ
NULL
 ) {

386 
	`ci_log
("Unexpected close()„equest before full init");

387  -
EFAULT
;

390 
	`TRAMP_DEBUG
 ("şo£ %d vŸ saved_sys_şo£=%p...", 
fd
, 
§ved_sys_şo£
);

391 
rc
 = (
§ved_sys_şo£
è(
fd
);

392 
	`TRAMP_DEBUG
 ("... = %d", 
rc
);

393  
rc
;

394 
	}
}

397 
asmlškage
 
	$eçb_lšux_sys_ex™_group
(
¡©us
)

399 ifĞ
§ved_sys_ex™_group
 =ğ
NULL
 ) {

400 
	`ci_log
("Unexpectedƒxit_group()„equest before full init");

401  -
EFAULT
;

403  
	`§ved_sys_ex™_group
(
¡©us
);

404 
	}
}

406 #ià
CI_CFG_USERSPACE_EPOLL


407 
asmlškage
 
	$eçb_lšux_sys_•Şl_ü—‹1
(
æags
)

409 
asmlškage
 (*
sys_•Şl_ü—‹_â
)();

410 
rc
;

412 ifĞ
sysÿÎ_bË
 =ğ
NULL
 ) {

413 
	`ci_log
("Unexpectedƒpoll_ctl()„equest before full init");

414  -
EFAULT
;

417 #ifdeà
__NR_•Şl_ü—‹1


418 
sys_•Şl_ü—‹_â
 = 
sysÿÎ_bË
[
__NR_•Şl_ü—‹1
];

419 
	`TRAMP_DEBUG
 ("•Şl_ü—‹1(%dèvŸ %p...", 
æags
, 
sys_•Şl_ü—‹
);

420 
rc
 = 
	`sys_•Şl_ü—‹_â
(
æags
);

421 ifĞ
rc
 !ğ-
ENOSYS
 )

422 
out
;

425 
sys_•Şl_ü—‹_â
 = 
sysÿÎ_bË
[
__NR_•Şl_ü—‹
];

426 
	`TRAMP_DEBUG
 ("•Şl_ü—‹ vŸ %p...", 
sys_•Şl_ü—‹
);

427 
rc
 = 
	`sys_•Şl_ü—‹_â
(1);

428 
	`ci_as£¹_equ®
(
æags
 & ~
EPOLL_CLOEXEC
, 0);

429 ifĞ
rc
 >ğ0 && 
æags
 & 
EPOLL_CLOEXEC
 ) {

430 
fes_¡ruù
 *
fes
 = 
cu¼’t
->files;

431 
fdbË
 *
fdt
;

432 
	`¥š_lock
(&
fes
->
fe_lock
);

433 
fdt
 = 
	`fes_fdbË
(
fes
);

434 
	`efx_£t_şo£_Ú_exec
(
rc
, 
fdt
);

435 
	`¥š_uÆock
(&
fes
->
fe_lock
);

438 #ifdeà
__NR_•Şl_ü—‹1


439 
out
:

441 
	`TRAMP_DEBUG
 ("... = %d", 
rc
);

442  
rc
;

443 
	}
}

444 
asmlškage
 
	$eçb_lšux_sys_•Şl_ùl
(
•fd
, 
İ
, 
fd
,

445 
•Şl_ev’t
 *
ev’t
)

447 
asmlškage
 (*
sys_•Şl_ùl_â
)(, , , 
•Şl_ev’t
 *);

448 
rc
;

450 ifĞ
sysÿÎ_bË
 =ğ
NULL
 ) {

451 
	`ci_log
("Unexpectedƒpoll_ctl()„equest before full init");

452  -
EFAULT
;

455 
sys_•Şl_ùl_â
 = 
sysÿÎ_bË
[
__NR_•Şl_ùl
];

456 
	`TRAMP_DEBUG
 ("•Şl_ùl(%d,%d,%d,%pèvŸ %p...", 
•fd
, 
İ
, 
fd
, 
ev’t
,

457 
sys_•Şl_ùl_â
);

458 
rc
 = 
	`sys_•Şl_ùl_â
(
•fd
, 
İ
, 
fd
, 
ev’t
);

459 
	`TRAMP_DEBUG
 ("... = %d", 
rc
);

460  
rc
;

461 
	}
}

462 
asmlškage
 
	$eçb_lšux_sys_•Şl_wa™
(
•fd
, 
•Şl_ev’t
 *
ev’ts
,

463 
maxev’ts
, 
timeout
)

465 
asmlškage
 (*
sys_•Şl_wa™_â
)(, 
•Şl_ev’t
 *, , );

466 
rc
;

468 ifĞ
sysÿÎ_bË
 =ğ
NULL
 ) {

469 
	`ci_log
("Unexpectedƒpoll_wait()„equest before full init");

470  -
EFAULT
;

473 
sys_•Şl_wa™_â
 = 
sysÿÎ_bË
[
__NR_•Şl_wa™
];

474 
	`TRAMP_DEBUG
 ("•Şl_wa™(%d,%p,%d,%dèvŸ %p...", 
•fd
, 
ev’ts
, 
maxev’ts
,

475 
timeout
, 
sys_•Şl_wa™_â
);

476 
rc
 = 
	`sys_•Şl_wa™_â
(
•fd
, 
ev’ts
, 
maxev’ts
, 
timeout
);

477 
	`TRAMP_DEBUG
 ("... = %d", 
rc
);

478  
rc
;

479 
	}
}

483 
asmlškage
 
	$eçb_lšux_sys_£ndmsg
(
fd
, 
msghdr
 
__u£r
* 
msg
,

484 
__u£r
* 
sock‘ÿÎ_¬gs
,

485 
æags
)

487 
rc
;

489 ifĞ
sysÿÎ_bË
 =ğ
NULL
 ) {

490 
	`ci_log
("Unexpected sendmsg()„equest before full init");

491  -
EFAULT
;

495 #ifdeà
__NR_£ndmsg


496 
asmlškage
 (*
sys_£ndmsg_â
)(, 
msghdr
 *, );

498 
sys_£ndmsg_â
 = 
sysÿÎ_bË
[
__NR_£ndmsg
];

499 
	`TRAMP_DEBUG
 ("£ndmsg(%d,%p,%dèvŸ %p...", 
fd
, 
msg
, 
æags
, 
sys_£ndmsg_â
);

500 
rc
 = 
	`sys_£ndmsg_â
(
fd
, 
msg
, 
æags
);

501 #–ià
	`defšed
(
__NR_sock‘ÿÎ
)

502 
asmlškage
 (*
sys_sock‘ÿÎ_â
)(, *);

503 
¬gs
[3];

505 
sys_sock‘ÿÎ_â
 = 
sysÿÎ_bË
[
__NR_sock‘ÿÎ
];

506 
	`TRAMP_DEBUG
 ("£ndmsg(%d,%p,%dèvŸ %p...", 
fd
, 
msg
,

507 
æags
, 
sys_sock‘ÿÎ_â
);

508 
	`mem£t
(
¬gs
, 0, (args));

509 
¬gs
[0] = ()
fd
;

510 
¬gs
[1] = ()
msg
;

511 
¬gs
[2] = ()
æags
;

512 
rc
 = -
EFAULT
;

513 ià(
	`cİy_to_u£r
(
sock‘ÿÎ_¬gs
, 
¬gs
, (args)) == 0)

514 
rc
 = (
sys_sock‘ÿÎ_â
è(
SYS_SENDMSG
, 
sock‘ÿÎ_¬gs
);

520 
	`TRAMP_DEBUG
 ("... = %d", 
rc
);

521  
rc
;

522 
	}
}

524 #ifdeà
CONFIG_COMPAT


525 
asmlškage
 

526 
	$eçb_lšux_sys_£ndmsg32
(
fd
, 
com·t_msghdr
 
__u£r
* 
msg
,

527 
__u£r
* 
sock‘ÿÎ_¬gs
,

528 
æags
)

530 
rc
;

532 ifĞ
sysÿÎ_bË
 =ğ
NULL
 ) {

533 
	`ci_log
("Unexpected sendmsg()„equest before full init");

534  -
EFAULT
;

538 
asmlškage
 (*
sys_sock‘ÿÎ_â
)(, *);

539 
com·t_ulÚg_t
 
¬gs
[3];

541 
sys_sock‘ÿÎ_â
 = 
Ÿ32_sysÿÎ_bË
[102 ];

542 
	`TRAMP_DEBUG
 ("£ndmsg(%d,%p,%dèvŸ %p...", 
fd
, 
msg
,

543 
æags
, 
sys_sock‘ÿÎ_â
);

544 
	`mem£t
(
¬gs
, 0, (args));

545 
¬gs
[0] = ()
fd
;

546 
¬gs
[1] = ()
msg
;

547 
¬gs
[2] = ()
æags
;

548 
rc
 = -
EFAULT
;

549 ià(
	`cİy_to_u£r
(
sock‘ÿÎ_¬gs
, 
¬gs
, (args)) == 0)

550 
rc
 = (
sys_sock‘ÿÎ_â
è(
SYS_SENDMSG
, 
sock‘ÿÎ_¬gs
);

553 
	`TRAMP_DEBUG
 ("... = %d", 
rc
);

554  
rc
;

555 
	}
}

558 
asmlškage
 
	$eçb_lšux_sys_sigaùiÚ
(
signum
,

559 cÚ¡ 
sigaùiÚ
 *
aù
,

560 
sigaùiÚ
 *
ßù
)

562 
rc
;

564 ifĞ
§ved_sys_¹_sigaùiÚ
 =ğ
NULL
 ) {

565 
	`ci_log
("Unexpected„t_sigaction()„equest before full init");

566  -
EFAULT
;

569 
	`TRAMP_DEBUG
 ("sigaùiÚ(%d,%p,%p,%dèvŸ %p...", 
signum
, 
aù
, 
ßù
,

570 (
sig£t_t
), 
§ved_sys_¹_sigaùiÚ
);

571 
rc
 = 
	`§ved_sys_¹_sigaùiÚ
(
signum
, 
aù
, 
ßù
, (
sig£t_t
));

572 
	`TRAMP_DEBUG
 ("... = %d", 
rc
);

573  
rc
;

574 
	}
}

575 #ifdeà
CONFIG_COMPAT


576 
asmlškage
 
	$eçb_lšux_sys_sigaùiÚ32
(
signum
,

577 cÚ¡ 
sigaùiÚ32
 *
aù
,

578 
sigaùiÚ32
 *
ßù
)

580 
rc
;

582 ifĞ
§ved_sys_¹_sigaùiÚ32
 =ğ
NULL
 ) {

583 
	`ci_log
("Unexpected„t_sigaction32()„equest before full init");

584  -
EFAULT
;

587 
	`TRAMP_DEBUG
 ("sigaùiÚ32(%d,%p,%p,%dèvŸ %p...", 
signum
, 
aù
, 
ßù
,

588 (
sig£t_t
), 
§ved_sys_¹_sigaùiÚ
);

589 
rc
 = 
	`§ved_sys_¹_sigaùiÚ32
(
signum
, 
aù
, 
ßù
, (
sig£t_t
));

590 
	`TRAMP_DEBUG
 ("... = %d", 
rc
);

591  
rc
;

592 
	}
}

596 #ià
defšed
(
__x86_64__
è&& !
OLD_RSP_PROVIDED


599 
ci_šlše
 *
	$g‘_Şdr¥_addr
()

601 *
Şdr¥_addr
 = 
NULL
;

602 ià(
Şdr¥_addr
)

603  
Şdr¥_addr
;

621 
»suÉ
;

622 #iâdeà
NDEBUG


623 *
±r
;

625 *
p
;

626 
k”Ãl_¡ack_p
 = ()
	`³rıu_p
(
k”Ãl_¡ack
);

627 *
p_’d
;

629 
	`rdm¤l
(
MSR_LSTAR
, 
»suÉ
);

630 
p
 = (*)
»suÉ
;

631 #iâdeà
NDEBUG


632 
±r
 = 
p
;

633 
	#OOPS
(
msg
) { \

634 
i
; \

635 
	`ci_log
(
msg
); \

636 
i
 = 0; i < 10; i++) { \

637 
	`ci_log
("sy¡em_ÿÎ + %d*4: %02x %02x %02x %02x", 
i
, \

638 
±r
[
i
 * 4],…tr[i * 4 + 1],…tr[i * 4 + 2],…tr[i * 4 + 3]); \

640 
	`ci_as£¹
(0); \

641 }

	)

643 
	#OOPS
(
msg
è{ 
	`ci_log
(msg);  
NULL
;}

	)

645 ià(
p
[0] != 0x0f ||…[1] != 0x01 ||…[2] != 0xf8) {

646 
	`OOPS
("Unexpected code‡the beginning of system_call(), "

649 
p
 += 3;

650 
p_’d
 = 
p
 + 32;

651 
p
[0] != 0x65 ||…[1] != 0x48 ||…[2] != 0x89 ||

652 
p
[3] != 0x24 ||…[4] != 0x25) {

653 
p
++;

654 ià(
p
 >ğ
p_’d
) {

655 
	`OOPS
("Unexpected code in system_call(), can'trampoline.\n"

659 
p
 += 5;

660 
»suÉ
 = 
p
[0] + (p[1] << 8);

661 
p
 +=2;

662 *
p
 == 0)

663 
p
++;

664 ià(
p
[0] != 0x65 ||…[1] != 0x48 ||…[2] != 0x8b ||

665 
p
[3] != 0x24 ||…[4] != 0x25 ||

666 
p
[5] !ğ(
k”Ãl_¡ack_p
 & 0xff) ||…[6] != (kernel_stack_p >> 8)) {

667 
	`OOPS
("Unexpected code in system_call(), can'trampoline.\n"

670 
	`TRAMP_DEBUG
("&³r_ıu__Şd_r¥=%08lx", 
»suÉ
);

672 #undeà
OOPS


674 
Şdr¥_addr
 = (*)
»suÉ
;

676  
Şdr¥_addr
;

677 
	}
}

688 
ci_šlše
 

689 
	$avoid_sy¤‘
()

691 
	`£t_th»ad_æag
 (
TIF_NEED_RESCHED
);

692 
	}
}

705 
	$£tup_ŒampŞše
 (
±_»gs
 *
»gs
, 
İcode
, 
d©a
) {

706 
mm_hash
 *
p
;

707 
ci_ušŒ_t
 
ŒampŞše_’Œy
 = 0;

708 
ci_ušŒ_t
 
ŒampŞše_exşude
 = 0;

709 
rc
;

711 
	`»ad_lock
 (&
oo_mm_tbl_lock
);

712 
p
 = 
	`oo_mm_tbl_lookup
(
cu¼’t
->
mm
);

713 ià(
p
) {

714 
ŒampŞše_’Œy
 = (
ci_ušŒ_t
è
	`CI_USER_PTR_GET
 (
p
->trampoline_entry);

715 
ŒampŞše_exşude
 = (
ci_ušŒ_t
è
	`CI_USER_PTR_GET
 (
p
->trampoline_exclude);

717 
	`»ad_uÆock
 (&
oo_mm_tbl_lock
);

719 ià(
ŒampŞše_’Œy
) {

720 *
u£r_¥
 =0;

725 ià(!
	`acûss_ok
 (
VERIFY_READ
, 
ŒampŞše_’Œy
, 1)) {

730 
	`ci_log
 ("Pid %d (mm=%p) has badrampolineƒntry: 0x%08lX",

731 
cu¼’t
->
tgid
, cu¼’t->
mm
, ()
ŒampŞše_’Œy
);

732  -
EBADF
;

740 #ià
	`defšed
(
__x86__
)

741 
	`ci_as£¹
 ( *
u£r_¥
 == 4);

743 ià(
	`cs
(
»gs
è!ğ
__USER_CS
) {

744 
	`ci_log
 ("Warning:rampoline-handler called‚ot from kernel code!");

745 #iâdeà
NDEBUG


746 
	`ci_log
 ("This is‡ debug-build driver, so I'm goingo fail here!");

747 
	`ci_as£¹
 (0);

749  -
EINVAL
;

755 
	`TRAMP_DEBUG
("setup_trampoline:");

756 
	`TRAMP_DEBUG
(" bx %08lx", 
	`bx
(
»gs
));

757 
	`TRAMP_DEBUG
(" cx %08lx", 
	`cx
(
»gs
));

758 
	`TRAMP_DEBUG
(" dx %08lx", 
	`dx
(
»gs
));

759 
	`TRAMP_DEBUG
(" s˜%08lx", 
	`si
(
»gs
));

760 
	`TRAMP_DEBUG
(" d˜%08lx", 
	`di
(
»gs
));

761 
	`TRAMP_DEBUG
(" b°%08lx", 
	`bp
(
»gs
));

762 
	`TRAMP_DEBUG
("‡x %08lx", 
	`ax
(
»gs
));

763 
	`TRAMP_DEBUG
(" d %08x", 
	`ds
(
»gs
));

764 
	`TRAMP_DEBUG
("ƒ %08x", 
	`es
(
»gs
));

765 
	`TRAMP_DEBUG
(" orig_ax %08lx", 
	`Üig_ax
(
»gs
));

766 
	`TRAMP_DEBUG
(" i°%08lx", 
	`
(
»gs
));

767 
	`TRAMP_DEBUG
(" c %08x", 
	`cs
(
»gs
));

768 
	`TRAMP_DEBUG
(" fÏg %08lx", 
	`æags
(
»gs
));

769 
	`TRAMP_DEBUG
(" s°%08lx", 
	`¥
(
»gs
));

770 
	`TRAMP_DEBUG
(" s %08x", 
	`ss
(
»gs
));

772 ià(
	`
(
»gs
è=ğ
ŒampŞše_exşude
) {

773 
	`TRAMP_DEBUG
("Ignoring call fromƒxcluded‡ddress 0x%08lx",

774 ()
ŒampŞše_exşude
);

775  -
EBUSY
;

789 ià(!
	`acûss_ok
 (
VERIFY_WRITE
, 
	`¥
(
»g
) - 20, 20)) {

790 
	`ci_log
 ("Bogus user-mode stack; cannotrampoline!");

791  -
EFAULT
;

793 
u£r_¥
 = (*)
	`¥
(
»g
);

794 
u£r_¥
--;

795 ià(
	`cİy_to_u£r
 (
u£r_¥
, &
	`
(
»gs
), 4è!ğ0è -
EFAULT
;

796 
u£r_¥
--;

797 ià(
	`cİy_to_u£r
 (
u£r_¥
, &
	`cx
(
»gs
), 4è!ğ0è -
EFAULT
;

798 
u£r_¥
--;

799 ià(
	`cİy_to_u£r
 (
u£r_¥
, &
	`dx
(
»gs
), 4è!ğ0è -
EFAULT
;

800 
u£r_¥
--;

801 ià(
	`cİy_to_u£r
 (
u£r_¥
, &
d©a
, 4è!ğ0è -
EFAULT
;

802 
u£r_¥
--;

803 ià(
	`cİy_to_u£r
 (
u£r_¥
, &
İcode
, 4è!ğ0è -
EFAULT
;

806 
	`¥
(
»gs
èğ(
ci_ušŒ_t
è
u£r_¥
;

809 
	`
(
»gs
èğ
ŒampŞše_’Œy
;

811 
	`avoid_sy¤‘
();

812 
	`TRAMP_DEBUG
("£ˆŒam°’Œy 0x%08lx", ()
ŒampŞše_’Œy
);

815 #–ià
	`defšed
(
__i386__
)

817 
	`ci_as£¹
 ( *
u£r_¥
 == 4);

819 ià(
	`cs
(
»gs
è!ğ
__USER_CS
) {

821 
	`ci_log
 ("Warning:rampoline-handler called‚ot from kernel code!");

822 #iâdeà
NDEBUG


823 
	`ci_log
 ("This is‡ debug-build driver, so I'm goingo fail here!");

824 
	`ci_as£¹
 (0);

826  -
EINVAL
;

834 
	`TRAMP_DEBUG
("setup_trampoline:");

835 
	`TRAMP_DEBUG
(" bx %08lx", 
	`bx
(
»gs
));

836 
	`TRAMP_DEBUG
(" cx %08lx", 
	`cx
(
»gs
));

837 
	`TRAMP_DEBUG
(" dx %08lx", 
	`dx
(
»gs
));

838 
	`TRAMP_DEBUG
(" s˜%08lx", 
	`si
(
»gs
));

839 
	`TRAMP_DEBUG
(" d˜%08lx", 
	`di
(
»gs
));

840 
	`TRAMP_DEBUG
(" b°%08lx", 
	`bp
(
»gs
));

841 
	`TRAMP_DEBUG
("‡x %08lx", 
	`ax
(
»gs
));

842 
	`TRAMP_DEBUG
(" d %08lx", ()
	`ds
(
»gs
));

843 
	`TRAMP_DEBUG
("ƒ %08lx", ()
	`es
(
»gs
));

844 
	`TRAMP_DEBUG
(" orig_ax %08lx", 
	`Üig_ax
(
»gs
));

845 
	`TRAMP_DEBUG
(" i°%08lx", 
	`
(
»gs
));

846 
	`TRAMP_DEBUG
(" c %08lx", ()
	`cs
(
»gs
));

847 
	`TRAMP_DEBUG
(" fÏg %08lx", 
	`æags
(
»gs
));

848 
	`TRAMP_DEBUG
(" s°%08lx", 
	`¥
(
»gs
));

849 
	`TRAMP_DEBUG
(" s %08lx", ()
	`ss
(
»gs
));

851 ià(
	`
(
»gs
è=ğ
ŒampŞše_exşude
) {

852 
	`TRAMP_DEBUG
("Ignoring call fromƒxcluded‡ddress 0x%08lx",

853 ()
ŒampŞše_exşude
);

854  -
EBUSY
;

868 ià(!
	`acûss_ok
 (
VERIFY_WRITE
, 
	`¥
(
»gs
) - 20, 20)) {

869 
	`ci_log
 ("Bogus user-mode stack; cannotrampoline!");

870  -
EFAULT
;

872 
u£r_¥
 = (*)
	`¥
(
»gs
);

873 
u£r_¥
--;

874 ià(
	`cİy_to_u£r
 (
u£r_¥
, &
	`
(
»gs
), 4è!ğ0è -
EFAULT
;

875 
u£r_¥
--;

876 ià(
	`cİy_to_u£r
 (
u£r_¥
, &
	`cx
(
»gs
), 4è!ğ0è -
EFAULT
;

877 
u£r_¥
--;

878 ià(
	`cİy_to_u£r
 (
u£r_¥
, &
	`dx
(
»gs
), 4è!ğ0è -
EFAULT
;

879 
u£r_¥
--;

880 ià(
	`cİy_to_u£r
 (
u£r_¥
, &
d©a
, 4è!ğ0è -
EFAULT
;

881 
u£r_¥
--;

882 ià(
	`cİy_to_u£r
 (
u£r_¥
, &
İcode
, 4è!ğ0è -
EFAULT
;

885 
	`¥
(
»gs
èğ(
ci_ušŒ_t
è
u£r_¥
;

888 
	`
(
»gs
èğ
ŒampŞše_’Œy
;

890 
	`avoid_sy¤‘
();

891 
	`TRAMP_DEBUG
("£ˆŒam°’Œy 0x%08lx", ()
ŒampŞše_’Œy
);

893 #–ià
	`defšed
(
__x86_64__
)

904 
	`TRAMP_DEBUG
("setup_trampoline:");

906 
	`TRAMP_DEBUG
("„15 %016lx XX",
»gs
->
r15
);

907 
	`TRAMP_DEBUG
("„14 %016lx XX",
»gs
->
r14
);

908 
	`TRAMP_DEBUG
("„13 %016lx XX",
»gs
->
r13
);

909 
	`TRAMP_DEBUG
("„12 %016lx XX",
»gs
->
r12
);

910 
	`TRAMP_DEBUG
(" b°%016lx XX", 
	`bp
(
»gs
));

911 
	`TRAMP_DEBUG
(" bx %016lx XX", 
	`bx
(
»gs
));

913 
	`TRAMP_DEBUG
("„11 %016lx",
»gs
->
r11
);

914 
	`TRAMP_DEBUG
("„10 %016lx",
»gs
->
r10
);

915 
	`TRAMP_DEBUG
("„9 %016lx",
»gs
->
r9
);

916 
	`TRAMP_DEBUG
("„8 %016lx",
»gs
->
r8
);

917 
	`TRAMP_DEBUG
("‡x %016lx", 
	`ax
(
»gs
));

918 
	`TRAMP_DEBUG
(" cx %016lx", 
	`cx
(
»gs
));

919 
	`TRAMP_DEBUG
(" dx %016lx", 
	`dx
(
»gs
));

920 
	`TRAMP_DEBUG
(" s˜%016lx", 
	`si
(
»gs
));

921 
	`TRAMP_DEBUG
(" d˜%016lx", 
	`di
(
»gs
));

922 
	`TRAMP_DEBUG
(" orig_ax %016lx", 
	`Üig_ax
(
»gs
));

923 
	`TRAMP_DEBUG
(" i°%016lx", 
	`
(
»gs
));

925 
	`TRAMP_DEBUG
(" c  %016lx XX",
»gs
->
cs
);

926 
	`TRAMP_DEBUG
(" fÏg %016lx XX", 
	`æags
(
»gs
));

927 
	`TRAMP_DEBUG
("„¥ %016lx XX", 
	`¥
(
»gs
));

928 
	`TRAMP_DEBUG
(" s  %016lx XX",
»gs
->
ss
);

930 ià(
	`
(
»gs
è=ğ
ŒampŞše_exşude
) {

931 
	`TRAMP_DEBUG
("Ignoring call fromƒxcluded‡ddress");

932  -
EBUSY
;

949 *
Üig_u£r_¥
;

950 #ià
OLD_RSP_PROVIDED


951 
Üig_u£r_¥
 = (*)
	`»ad_pda
(
Şdr¥
);

953 
Üig_u£r_¥
 = (*)
	`³rıu_»ad_äom_p
(
	`g‘_Şdr¥_addr
());

956 
u£r_¥
 = 
Üig_u£r_¥
;

957 
	`TRAMP_DEBUG
("»ad u£r_¥=%p", 
u£r_¥
);

960 ià(!
	`acûss_ok
 (
VERIFY_WRITE
, 
u£r_¥
 - 24, 24)) {

961 
	`ci_log
 ("Invalid user-space stack-pointer; cannotrampoline!");

962  -
EFAULT
;

965 
	`ci_as£¹
 ( *
u£r_¥
 == 8);

967 
u£r_¥
--;

969 ià(
	`cİy_to_u£r
 (
u£r_¥
, &
	`
(
»gs
), 8è!ğ0è -
EFAULT
;

970 
u£r_¥
--;

972 ià(
	`cİy_to_u£r
 (
u£r_¥
, &
	`di
(
»gs
), 8è!ğ0è -
EFAULT
;

973 
u£r_¥
--;

975 ià(
	`cİy_to_u£r
 (
u£r_¥
, &
	`si
(
»gs
), 8è!ğ0è -
EFAULT
;

978 #ià
OLD_RSP_PROVIDED


979 
	`wr™e_pda
(
Şdr¥
, ()
u£r_¥
);

981 
	`³rıu_wr™e_to_p
(
	`g‘_Şdr¥_addr
(), ()
u£r_¥
);

983 
	`TRAMP_DEBUG
("wrÙu£r_¥=%p", 
u£r_¥
);

991 ià(
	`¥
(
»gs
è=ğ()
Üig_u£r_¥
) {

992 
	`¥
(
»gs
èğ()
u£r_¥
;

993 
	`TRAMP_DEBUG
("wrÙ¥=%°a w–l", 
u£r_¥
);

1003 
	`di
(
»gs
èğ
İcode
;

1004 
	`si
(
»gs
èğ
d©a
;

1007 
	`
(
»gs
èğ
ŒampŞše_’Œy
;

1009 
	`TRAMP_DEBUG
("£ˆŒam°’Œy %016lx", (è
ŒampŞše_’Œy
);

1012 #–ià
	`defšed
(
__Ÿ64__
)

1014 ià(
ŒampŞše_’Œy
)

1016 
u£r_¥
 = 0;

1017 
	`TRAMP_DEBUG
("£ˆŒam°’Œy %016lx", 
ŒampŞše_’Œy
);

1024 
rc
 = 0;

1028 
	`OO_DEBUG_VERB
(
	`ci_log
("Error --‡ttemptorampoline for unknown…rocess"));

1029 
rc
 = -
ENOENT
;

1032  
rc
;

1033 
	}
}

1042 
asmlškage
 

1043 
	$eçb_lšux_ŒampŞše_hªdËr_şo£
 (
fd
, 
±_»gs
 *
»gs
, *
»t
) {

1045 
fe
 *
f
;

1046 
rc
;

1048 
	`eçb_sysÿÎ_’‹r
();

1050 
f
 = 
	`fg‘
 (
fd
);

1051 ià(
f
) {

1052 ià(
	`FILE_IS_ENDPOINT
(
f
)) {

1059 ià(
	`£tup_ŒampŞše
 (
»gs
, 
CI_TRAMP_OPCODE_CLOSE
, 
fd
) == 0) {

1061 
	`åut
 (
f
);

1062 
	`eçb_sysÿÎ_ex™
();

1067 
	`åut
 (
f
);

1071 
rc
 = (
§ved_sys_şo£
è(
fd
);

1072 
	`eçb_sysÿÎ_ex™
();

1073  
rc
;

1074 
	}
}

1077 #ifdeà
CONFIG_COMPAT


1087 
	$£tup_ŒampŞše32
 (
±_»gs
 *
»gs
, 
İcode
, 
d©a
) {

1089 
mm_hash
 *
p
;

1090 
ci_ušŒ_t
 
ŒampŞše_’Œy
 = 0;

1091 
ci_ušŒ_t
 
ŒampŞše_exşude
 = 0;

1092 
rc
;

1094 
	`»ad_lock
 (&
oo_mm_tbl_lock
);

1095 
p
 = 
	`oo_mm_tbl_lookup
(
cu¼’t
->
mm
);

1096 ià(
p
) {

1097 
ŒampŞše_’Œy
 = (
ci_ušŒ_t
è
	`CI_USER_PTR_GET
 (
p
->trampoline_entry);

1098 
ŒampŞše_exşude
 = (
ci_ušŒ_t
è
	`CI_USER_PTR_GET
 (
p
->trampoline_exclude);

1100 
	`»ad_uÆock
 (&
oo_mm_tbl_lock
);

1102 ià(
ŒampŞše_’Œy
) {

1103 *
u£r32_¥
;

1108 ià(!
	`acûss_ok
 (
VERIFY_READ
, 
ŒampŞše_’Œy
, 1)) {

1113 
	`ci_log
 ("Warning:…id %d has badrampolineƒntry: 0x%08lx",

1114 
cu¼’t
->
tgid
, ()
ŒampŞše_’Œy
);

1115  -
EBADF
;

1123 
	`ci_as£¹
 ( *
u£r32_¥
 == 4);

1125 ià(
	`cs
(
»gs
è!ğ
__USER32_CS
) {

1131 
	`ci_log
 ("Warning: 32-bitrampoline-handler called unexpectedly (%016lx)",

1132 
	`cs
(
»gs
));

1133 #iâdeà
NDEBUG


1134 
	`ci_log
 ("This is‡ debug-build driver, so I'm goingo fail here!");

1135 
	`ci_as£¹
 (0);

1137  -
EINVAL
;

1140 
	`TRAMP_DEBUG
("setup_trampoline32:");

1141 
	`TRAMP_DEBUG
("„15 %016lx XX",
»gs
->
r15
);

1142 
	`TRAMP_DEBUG
("„14 %016lx XX",
»gs
->
r14
);

1143 
	`TRAMP_DEBUG
("„13 %016lx XX",
»gs
->
r13
);

1144 
	`TRAMP_DEBUG
("„12 %016lx XX",
»gs
->
r12
);

1145 
	`TRAMP_DEBUG
(" b°%016lx XX", 
	`bp
(
»gs
));

1146 
	`TRAMP_DEBUG
(" bx %016lx XX", 
	`bx
(
»gs
));

1147 
	`TRAMP_DEBUG
("„11 %016lx",
»gs
->
r11
);

1148 
	`TRAMP_DEBUG
("„10 %016lx",
»gs
->
r10
);

1149 
	`TRAMP_DEBUG
("„9 %016lx",
»gs
->
r9
);

1150 
	`TRAMP_DEBUG
("„8 %016lx",
»gs
->
r8
);

1151 
	`TRAMP_DEBUG
("‡x %016lx", 
	`ax
(
»gs
));

1152 
	`TRAMP_DEBUG
(" cx %016lx", 
	`cx
(
»gs
));

1153 
	`TRAMP_DEBUG
(" dx %016lx", 
	`dx
(
»gs
));

1154 
	`TRAMP_DEBUG
(" s˜%016lx", 
	`si
(
»gs
));

1155 
	`TRAMP_DEBUG
(" d˜%016lx", 
	`di
(
»gs
));

1156 
	`TRAMP_DEBUG
(" orig_ax %016lx", 
	`Üig_ax
(
»gs
));

1157 
	`TRAMP_DEBUG
(" i°%016lx", 
	`
(
»gs
));

1159 
	`TRAMP_DEBUG
(" c  %016lx",
»gs
->
cs
);

1160 
	`TRAMP_DEBUG
(" fÏg %016lx", 
	`æags
(
»gs
));

1161 
	`TRAMP_DEBUG
(" s°%016lx", 
	`¥
(
»gs
));

1162 
	`TRAMP_DEBUG
(" s  %016lx",
»gs
->
ss
);

1164 ià(
	`
(
»gs
è=ğ
ŒampŞše_exşude
) {

1165 
	`TRAMP_DEBUG
("Ignoring call fromƒxcluded‡ddress");

1166  -
EBUSY
;

1179 ià(!
	`acûss_ok
 (
VERIFY_WRITE
, 
	`¥
(
»gs
) - 20, 20)) {

1180 
	`ci_log
 ("Bogus 32-bit user-mode stack; cannotrampoline!");

1181  -
EFAULT
;

1183 
u£r32_¥
 = (*)
	`¥
(
»gs
);

1184 
u£r32_¥
--;

1185 ià(
	`cİy_to_u£r
 (
u£r32_¥
, &
	`
(
»gs
), 4è!ğ0è -
EFAULT
;

1186 
u£r32_¥
--;

1187 ià(
	`cİy_to_u£r
 (
u£r32_¥
, &
	`cx
(
»gs
), 4è!ğ0è -
EFAULT
;

1188 
u£r32_¥
--;

1189 ià(
	`cİy_to_u£r
 (
u£r32_¥
, &
	`dx
(
»gs
), 4è!ğ0è -
EFAULT
;

1190 
u£r32_¥
--;

1191 ià(
	`cİy_to_u£r
 (
u£r32_¥
, &
d©a
, 4è!ğ0è -
EFAULT
;

1192 
u£r32_¥
--;

1193 ià(
	`cİy_to_u£r
 (
u£r32_¥
, &
İcode
, 4è!ğ0è -
EFAULT
;

1196 
	`¥
(
»gs
èğ(
ci_ušŒ_t
è
u£r32_¥
;

1199 
	`
(
»gs
èğ
ŒampŞše_’Œy
;

1201 
	`TRAMP_DEBUG
("£ˆŒam°’Œy 0x%08lx", ()
ŒampŞše_’Œy
);

1202 
	`avoid_sy¤‘
();

1203 
rc
 = 0;

1207 
	`OO_DEBUG_VERB
(
	`ci_log
("Error --‡ttemptorampoline for unknown…rocess"));

1208 
rc
 = -
ENOENT
;

1211  
rc
;

1212 
	}
}

1215 
asmlškage
 

1216 
	$eçb_lšux_ŒampŞše_hªdËr_şo£32
(
fd
, 
±_»gs
 *
»gs
, *
»t
) {

1218 
fe
 *
f
;

1219 
rc
;

1221 
	`eçb_sysÿÎ_’‹r
();

1223 
f
 = 
	`fg‘
 (
fd
);

1224 ià(
f
) {

1225 ià(
	`FILE_IS_ENDPOINT
(
f
)) {

1232 ià(
	`£tup_ŒampŞše32
 (
»gs
, 
CI_TRAMP_OPCODE_CLOSE
, 
fd
) == 0) {

1233 
	`åut
 (
f
);

1234 
	`eçb_sysÿÎ_ex™
();

1239 
	`åut
 (
f
);

1243 
rc
 = (
§ved_sys_şo£
è(
fd
);

1244 
	`eçb_sysÿÎ_ex™
();

1245  
rc
;

1246 
	}
}

1250 #ifdeà
OO_DO_HUGE_PAGES


1251 
	~<lšux/uni¡d.h
>

1252 
asmlškage
 
	$eçb_lšux_sys_shmg‘
(
key_t
 
key
, 
size_t
 
size
, 
shmæg
)

1254 
asmlškage
 (*
sys_shmg‘_â
)(
key_t
, 
size_t
, );

1255 
rc
;

1257 
	`ci_as£¹
(
sysÿÎ_bË
);

1259 
sys_shmg‘_â
 = 
sysÿÎ_bË
[
__NR_shmg‘
];

1260 
	`TRAMP_DEBUG
 ("shmg‘(%d,%d,%dèvŸ %p...", 
key
, 
size
, 
shmæg
,

1261 
sys_shmg‘_â
);

1262 
rc
 = 
	`sys_shmg‘_â
(
key
, 
size
, 
shmæg
);

1263 
	`TRAMP_DEBUG
 ("... = %d", 
rc
);

1264  
rc
;

1265 
	}
}

1266 
asmlškage
 
	$eçb_lšux_sys_shm©
(
shmid
, 
__u£r
 *
addr
, 
shmæg
)

1268 
asmlškage
 (*
sys_shm©_â
)(, 
__u£r
 *, );

1269 
rc
;

1271 
	`ci_as£¹
(
sysÿÎ_bË
);

1273 
sys_shm©_â
 = 
sysÿÎ_bË
[
__NR_shm©
];

1274 
	`TRAMP_DEBUG
 ("shm©(%d,%p,%dèvŸ %p...", 
shmid
, 
addr
, 
shmæg
,

1275 
sys_shm©_â
);

1276 
rc
 = 
	`sys_shm©_â
(
shmid
, 
addr
, 
shmæg
);

1277 
	`TRAMP_DEBUG
 ("... = %p", 
rc
);

1278  
rc
;

1279 
	}
}

1280 
asmlškage
 
	$eçb_lšux_sys_shmdt
(
__u£r
 *
addr
)

1282 
asmlškage
 (*
sys_shmdt_â
)(
__u£r
 *);

1283 
rc
;

1285 
	`ci_as£¹
(
sysÿÎ_bË
);

1287 
sys_shmdt_â
 = 
sysÿÎ_bË
[
__NR_shmdt
];

1288 
	`TRAMP_DEBUG
 ("shmdt(%pèvŸ %p...", 
addr
, 
sys_shmdt_â
);

1289 
rc
 = 
	`sys_shmdt_â
(
addr
);

1290 
	`TRAMP_DEBUG
 ("... = %d", 
rc
);

1291  
rc
;

1292 
	}
}

1293 
asmlškage
 
	$eçb_lšux_sys_shmùl
(
shmid
, 
cmd
, 
shmid_ds
 
__u£r
 *
buf
)

1295 
asmlškage
 (*
sys_shmùl_â
)(, , 
shmid_ds
 
__u£r
 *);

1296 
rc
;

1298 
	`ci_as£¹
(
sysÿÎ_bË
);

1300 
sys_shmùl_â
 = 
sysÿÎ_bË
[
__NR_shmùl
];

1301 
	`TRAMP_DEBUG
 ("shmdt(%pèvŸ %p...", 
shmid
, 
cmd
, 
buf
, 
sys_shmùl_â
);

1302 
rc
 = 
	`sys_shmùl_â
(
shmid
, 
cmd
, 
buf
);

1303 
	`TRAMP_DEBUG
 ("... = %d", 
rc
);

1304  
rc
;

1305 
	}
}

1314 
	$·tch_sysÿÎ_bË
 (**
bË
, 
’Œy
, *
func
,

1315 * 
´ev_func
)

1317 #ià
LINUX_VERSION_CODE
 >ğ
	`KERNEL_VERSION
(2,6,13)

1318 *
m­³d
;

1319 **
loc
 = 
bË
 + 
’Œy
;

1320 
ci_ušŒ_t
 
offs
 = ((ci_ušŒ_t)
loc
è& (
PAGE_SIZE
-1);

1321 
·ge
 *
pg
;

1323 #ifdeà
__x86_64__


1324 ifĞ
	`NEED_SYSCALL_MAPPING_HACK
() ) {

1325 
pâ
 = ((è
loc
 - 
__START_KERNEL_m­
è>> 
PAGE_SHIFT
;

1326 
pâ
 += 0x200;

1327 
	`TRAMP_DEBUG
 ("%s:…â i %u", 
__FUNCTION__
, 
pâ
);

1328 
pg
 = 
	`pâ_to_·ge
(
pâ
);

1329 
	`TRAMP_DEBUG
 ("%s:…g fÜ…â %u i %p", 
__FUNCTION__
, 
pâ
, 
pg
);

1333 
pg
 = 
	`vœt_to_·ge
 (
loc
);

1335 
	`TRAMP_DEBUG
 ("ÿÎšg vm­ (%p, 1, VM_MAP, PAGE_KERNEL)", 
pg
);

1336 
m­³d
 = 
	`vm­
 (&
pg
, 1, 
VM_MAP
, 
PAGE_KERNEL
);

1337 
	`TRAMP_DEBUG
 ("%s: m­³dØ%p", 
__FUNCTION__
, 
m­³d
);

1338 ià(
m­³d
 =ğ
NULL
) {

1339 
	`ci_log
 ("ERROR: could‚ot map syscallable --here will be‚orampolining");

1343 
loc
 = (**è((
ci_ušŒ_t
è
m­³d
 + 
offs
);

1344 ifĞ*
loc
 =ğ
´ev_func
 ) {

1345 
	`TRAMP_DEBUG
 ("%s: wr™šgØ%p", 
__FUNCTION__
, 
loc
);

1346 *
loc
 = 
func
;

1349 
	`ci_log
("ERROR: Did‚ot…atch syscallable (*loc=%p…rev_func=%p)",

1350 *
loc
, 
´ev_func
);

1352 
	`TRAMP_DEBUG
 ("%s: unm­pšg", 
__FUNCTION__
);

1353 
	`vunm­
 (
m­³d
);

1354 
	`TRAMP_DEBUG
 ("%s:‡Î dÚe", 
__FUNCTION__
);

1360 
bË
 [
’Œy
] = 
func
;

1362 
	}
}

1368 
	$eçb_lšux_ŒampŞše_ùÜ
(
no_sù
)

1370 
sysÿÎ_bË
 = 
	`fšd_sysÿÎ_bË
();

1372 
	`©omic_£t
(&
eçb_sysÿÎ_u£d
, 0);

1373 ià(
sysÿÎ_bË
) {

1378 
	`TRAMP_DEBUG
("syscall_table=%p: close=%pƒxit_group=%p,„t_sigaction=%p",

1379 
sysÿÎ_bË
, sysÿÎ_bË[
__NR_şo£
],

1380 
sysÿÎ_bË
[
__NR_ex™_group
],

1381 
sysÿÎ_bË
[
__NR_¹_sigaùiÚ
]);

1383 #ifdeà
OO_CAN_HANDLE_TERMINATION


1384 
	`eçb_lšux_‹rmš©iÚ_ùÜ
();

1387 
§ved_sys_şo£
 = 
sysÿÎ_bË
 [
__NR_şo£
];

1388 
	`ci_as£¹
(
§ved_sys_şo£
 =ğ(*)
sys_şo£
);

1389 
§ved_sys_ex™_group
 = 
sysÿÎ_bË
 [
__NR_ex™_group
];

1390 
§ved_sys_¹_sigaùiÚ
 = 
sysÿÎ_bË
 [
__NR_¹_sigaùiÚ
];

1392 
	`ci_mb
();

1393 ià(
no_sù
) {

1394 
	`TRAMP_DEBUG
("syscalls NOT hooked -‚o_sct„equested");

1396 
	`·tch_sysÿÎ_bË
 (
sysÿÎ_bË
, 
__NR_şo£
,

1397 
eçb_lšux_ŒampŞše_şo£
, 
§ved_sys_şo£
);

1398 ifĞ
§ã_sigÇls_ªd_ex™
 ) {

1399 #ifdeà
OO_CAN_HANDLE_TERMINATION


1400 
	`·tch_sysÿÎ_bË
 (
sysÿÎ_bË
, 
__NR_ex™_group
,

1401 
eçb_lšux_ŒampŞše_ex™_group
,

1402 
§ved_sys_ex™_group
);

1404 
	`·tch_sysÿÎ_bË
 (
sysÿÎ_bË
, 
__NR_¹_sigaùiÚ
,

1405 
eçb_lšux_ŒampŞše_sigaùiÚ
,

1406 
§ved_sys_¹_sigaùiÚ
);

1408 
	`TRAMP_DEBUG
("syscalls hooked: close=%pƒxit_group=%p,„t_sigaction=%p",

1409 
sysÿÎ_bË
[
__NR_şo£
], sysÿÎ_bË[
__NR_ex™_group
],

1410 
sysÿÎ_bË
[
__NR_¹_sigaùiÚ
]);

1414 
	`TRAMP_DEBUG
("warning: syscallable‚ot found - can't„ead sys_close");

1418 #ifdeà
CONFIG_COMPAT


1420 
Ÿ32_sysÿÎ_bË
 = 
	`fšd_Ÿ32_sysÿÎ_bË
();

1422 ià(
Ÿ32_sysÿÎ_bË
 && !
no_sù
) {

1428 
	`TRAMP_DEBUG
("ia32_syscall_table=%p: close=%p,ƒxit_group=%p, "

1429 "¹_sigaùiÚ=%p", 
Ÿ32_sysÿÎ_bË
,

1430 
Ÿ32_sysÿÎ_bË
[
__NR_Ÿ32_şo£
],

1431 
Ÿ32_sysÿÎ_bË
[
__NR_Ÿ32_ex™_group
],

1432 
Ÿ32_sysÿÎ_bË
[
__NR_Ÿ32_¹_sigaùiÚ
]);

1433 
§ved_sys_¹_sigaùiÚ32
 = 
Ÿ32_sysÿÎ_bË
[
__NR_Ÿ32_¹_sigaùiÚ
];

1434 
	`ci_mb
();

1436 ià(
Ÿ32_sysÿÎ_bË
[
__NR_Ÿ32_şo£
] =ğ
§ved_sys_şo£
) {

1437 
	`·tch_sysÿÎ_bË
 (
Ÿ32_sysÿÎ_bË
, 
__NR_Ÿ32_şo£
,

1438 
eçb_lšux_ŒampŞše_şo£32
, 
§ved_sys_şo£
);

1440 
	`TRAMP_DEBUG
("ex³ùed ia32 sys_şo£=%p, buˆgÙ %p", 
§ved_sys_şo£
,

1441 
Ÿ32_sysÿÎ_bË
[
__NR_Ÿ32_şo£
]);

1442 
	`ci_log
("ia32 close syscall NOT hooked");

1444 ifĞ
§ã_sigÇls_ªd_ex™
 &&

1445 
Ÿ32_sysÿÎ_bË
[
__NR_Ÿ32_ex™_group
] =ğ
§ved_sys_ex™_group
) {

1446 
	`ci_as£¹_equ®
(
Ÿ32_sysÿÎ_bË
[
__NR_Ÿ32_ex™_group
],

1447 
§ved_sys_ex™_group
);

1448 #ifdeà
OO_CAN_HANDLE_TERMINATION


1449 
	`·tch_sysÿÎ_bË
 (
Ÿ32_sysÿÎ_bË
, 
__NR_Ÿ32_ex™_group
,

1450 
eçb_lšux_ŒampŞše_ex™_group
,

1451 
§ved_sys_ex™_group
);

1453 
	`·tch_sysÿÎ_bË
 (
Ÿ32_sysÿÎ_bË
, 
__NR_Ÿ32_¹_sigaùiÚ
,

1454 
eçb_lšux_ŒampŞše_sigaùiÚ32
,

1455 
§ved_sys_¹_sigaùiÚ32
);

1457 
	`TRAMP_DEBUG
("expected ia32 sys_exit_group=%p, but got %p",

1458 
§ved_sys_ex™_group
,

1459 
Ÿ32_sysÿÎ_bË
[
__NR_Ÿ32_ex™_group
]);

1460 
	`ci_log
("ia32ƒxit_group syscall NOT hooked");

1462 
	`TRAMP_DEBUG
("ia32 syscalls hooked: close=%p,ƒxit_group=%p, "

1464 
Ÿ32_sysÿÎ_bË
[
__NR_Ÿ32_şo£
],

1465 
Ÿ32_sysÿÎ_bË
[
__NR_Ÿ32_ex™_group
],

1466 
Ÿ32_sysÿÎ_bË
[
__NR_Ÿ32_¹_sigaùiÚ
]);

1469 
	`TRAMP_DEBUG
("warning: ia32 syscallable‚ot found");

1474 
	}
}

1477 #ià
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,12)

1478 
	#synchrÚize_sched
 
synchrÚize_k”Ãl


	)

1481 
	$eçb_lšux_ŒampŞše_dtÜ
 (
no_sù
) {

1482 ià(
sysÿÎ_bË
 !ğ
NULL
 && !
no_sù
) {

1483 
wa™šg
 = 0;

1486 
	`·tch_sysÿÎ_bË
 (
sysÿÎ_bË
, 
__NR_şo£
, 
§ved_sys_şo£
,

1487 
eçb_lšux_ŒampŞše_şo£
);

1488 ifĞ
§ã_sigÇls_ªd_ex™
 ) {

1489 #ifdeà
OO_CAN_HANDLE_TERMINATION


1490 
	`·tch_sysÿÎ_bË
 (
sysÿÎ_bË
, 
__NR_ex™_group
, 
§ved_sys_ex™_group
,

1491 
eçb_lšux_ŒampŞše_ex™_group
);

1493 
	`·tch_sysÿÎ_bË
 (
sysÿÎ_bË
, 
__NR_¹_sigaùiÚ
,

1494 
§ved_sys_¹_sigaùiÚ
,

1495 
eçb_lšux_ŒampŞše_sigaùiÚ
);

1497 
	`TRAMP_DEBUG
("syscalls„estored: close=%p,ƒxit_group=%p,„t_sigaction=%p",

1498 
sysÿÎ_bË
[
__NR_şo£
], sysÿÎ_bË[
__NR_ex™_group
],

1499 
sysÿÎ_bË
[
__NR_¹_sigaùiÚ
]);

1503 
	`synchrÚize_sched
();

1504 #ifdeà
CONFIG_PREEMPT


1506 
	`scheduË_timeout
(
	`m£cs_to_jiff›s
(50));

1508  
	`©omic_»ad
(&
eçb_sysÿÎ_u£d
) ) {

1509 ifĞ!
wa™šg
 ) {

1510 
	`ci_log
("%s: Waiting for intercepted syscallso finish...",

1511 
__FUNCTION__
);

1512 
wa™šg
 = 1;

1514 
	`scheduË_timeout
(
	`m£cs_to_jiff›s
(50));

1516 ifĞ
wa™šg
 )

1517 
	`ci_log
("%s: AÎ sysÿÎ havfšished", 
__FUNCTION__
);

1519 
	`synchrÚize_sched
();

1520 #ifdeà
CONFIG_PREEMPT


1522 
	`scheduË_timeout
(
	`m£cs_to_jiff›s
(50));

1526 #ifdeà
CONFIG_COMPAT


1527 ià(
Ÿ32_sysÿÎ_bË
 !ğ
NULL
 && !
no_sù
) {

1529 
	`·tch_sysÿÎ_bË
 (
Ÿ32_sysÿÎ_bË
, 
__NR_Ÿ32_şo£
,

1530 
§ved_sys_şo£
, 
eçb_lšux_ŒampŞše_şo£32
);

1531 ifĞ
§ã_sigÇls_ªd_ex™
 ) {

1532 #ifdeà
OO_CAN_HANDLE_TERMINATION


1533 
	`·tch_sysÿÎ_bË
 (
Ÿ32_sysÿÎ_bË
, 
__NR_Ÿ32_ex™_group
,

1534 
§ved_sys_ex™_group
,

1535 
eçb_lšux_ŒampŞše_ex™_group
);

1537 
	`·tch_sysÿÎ_bË
 (
Ÿ32_sysÿÎ_bË
, 
__NR_Ÿ32_¹_sigaùiÚ
,

1538 
§ved_sys_¹_sigaùiÚ32
,

1539 
eçb_lšux_ŒampŞše_sigaùiÚ32
);

1541 
	`TRAMP_DEBUG
("ia32 syscalls„estored: close=%p,ƒxit_group=%p, "

1543 
Ÿ32_sysÿÎ_bË
[
__NR_Ÿ32_şo£
],

1544 
Ÿ32_sysÿÎ_bË
[
__NR_Ÿ32_ex™_group
],

1545 
Ÿ32_sysÿÎ_bË
[
__NR_Ÿ32_¹_sigaùiÚ
]);

1550 
	}
}

1553 
	$eçb_lšux_ŒampŞše_debug
 (
ci_ušŒ_t
 *
·¿m
)

1555 
İ
 = *
·¿m
;

1557 
	`TRAMP_DEBUG
("T¿mpŞšdebug op=%lx", 
İ
);

1558 ()
İ
;

1560 *
·¿m
 = ()
	`fšd_sysÿÎ_bË
();

1563 
	}
}

1566 #iâdeà
NDEBUG


1575 
	$eçb_lšux_ŒampŞše_ul_ç
()

1577 #ià
	`defšed
(
__x86__
è|| defšed(
__i386__
è|| defšed(
__x86_64__
)

1578 
±_»gs
 *
»gs
 = ((±_»g *)(
	`¥0
(&
cu¼’t
->
th»ad
))) - 1;

1580 
±_»gs
 *
»gs
 = 0;

1582 
mm_hash
 *
p
;

1583 
ci_ušŒ_t
 
ŒampŞše_ul_ç
 = 0;

1585 
	`ci_as£¹
(
»gs
);

1587 ià(
cu¼’t
->
mm
) {

1588 
	`»ad_lock
 (&
oo_mm_tbl_lock
);

1589 
p
 = 
	`oo_mm_tbl_lookup
(
cu¼’t
->
mm
);

1590 
	`»ad_uÆock
 (&
oo_mm_tbl_lock
);

1591 ià(
p
) {

1592 
ŒampŞše_ul_ç
 = (
ci_ušŒ_t
è
	`CI_USER_PTR_GET
 (
p
->trampoline_ul_fail);

1595 
	`ci_log
("%s:‚Ø’Œy fÜ…id %u", 
__FUNCTION__
, 
cu¼’t
->
tgid
);

1600 
	`ci_log
("%s:…id %u i dyšg -‚Ømm", 
__FUNCTION__
, 
cu¼’t
->
tgid
);

1604 
	`ci_log
("%s: sysÿÎ backŒaû (pid %d)", 
__FUNCTION__
, 
cu¼’t
->
tgid
);

1605 
	`ci_backŒaû
();

1606 
	`ci_log
("%s:…rovoking user-level fail on syscallƒxit for…id %d",

1607 
__FUNCTION__
, 
cu¼’t
->
tgid
);

1609 #ià
	`defšed
(
__x86__
è|| defšed(
__i386__
è|| defšed(
__x86_64__
)

1610 
	`
(
»gs
èğ
ŒampŞše_ul_ç
;

1612 
	`ci_log
("(not„eally, don't know how onhis…latform)");

1616 
	}
}

	@../linux_resource/kernel_compat.h

39 #iâdeà
DRIVER_LINUX_RESOURCE_KERNEL_COMPAT_H


40 
	#DRIVER_LINUX_RESOURCE_KERNEL_COMPAT_H


	)

42 
	~<lšux/v”siÚ.h
>

43 
	~<lšux/moduË·¿m.h
>

44 
	~<lšux/sched.h
>

45 #ià
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(2,6,16)

46 
	~<lšux/io.h
>

48 
	~<asm/io.h
>

50 #ifdeà
CONFIG_SFC_RESOURCE_VF_IOMMU


51 
	~<lšux/iommu.h
>

53 
	~<driv”/lšux_affš™y/k”Ãl_com·t.h
>

54 #ifdeà
EFRM_HAVE_NSPROXY


55 
	~<lšux/n¥roxy.h
>

64 #ià(
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,11)) && \

65 !
	$defšed
(
RHEL_RELEASE_CODE
)

67 
šlše
 
ç¡ÿÎ


68 
	$eäm_wa™_fÜ_com¶‘iÚ_timeout
(
com¶‘iÚ
 *
x
, 
timeout
)

70 
	`might_¦“p
();

72 
	`¥š_lock_œq
(&
x
->
wa™
.
lock
);

73 ià(!
x
->
dÚe
) {

74 
	`DECLARE_WAITQUEUE
(
wa™
, 
cu¼’t
);

76 
wa™
.
æags
 |ğ
WQ_FLAG_EXCLUSIVE
;

77 
	`__add_wa™_queue_
(&
x
->
wa™
, &wait);

79 
	`__£t_cu¼’t_¡©e
(
TASK_UNINTERRUPTIBLE
);

80 
	`¥š_uÆock_œq
(&
x
->
wa™
.
lock
);

81 
timeout
 = 
	`scheduË_timeout
(timeout);

82 
	`¥š_lock_œq
(&
x
->
wa™
.
lock
);

83 ià(!
timeout
) {

84 
	`__»move_wa™_queue
(&
x
->
wa™
, &wait);

85 
out
;

87 } !
x
->
dÚe
);

88 
	`__»move_wa™_queue
(&
x
->
wa™
, &wait);

90 
x
->
dÚe
--;

91 
out
:

92 
	`¥š_uÆock_œq
(&
x
->
wa™
.
lock
);

93  
timeout
;

94 
	}
}

96 #ifdeà
wa™_fÜ_com¶‘iÚ_timeout


97 #undeà
wa™_fÜ_com¶‘iÚ_timeout


99 
	#wa™_fÜ_com¶‘iÚ_timeout
 
eäm_wa™_fÜ_com¶‘iÚ_timeout


	)

105 #ià
LINUX_VERSION_CODE
 <ğ
KERNEL_VERSION
(2,6,9)

107 #iâdeà
__iomem


108 
	#__iomem


	)

111 
šlše
 
	$eäm_iounm­
(vŞ©
__iomem
 *
addr
)

113 
	`iounm­
((
__iomem
 *)
addr
);

114 
	}
}

115 
	#iounm­
(
¬g
è
	`eäm_iounm­
×rg)

	)

120 #ifdeà
CONFIG_SFC_RESOURCE_VF_IOMMU


122 #ifdeà
EFRM_HAVE_IOMMU_MAP_OLD


123 #ià
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(3,0,0) && \

124 
	gLINUX_VERSION_CODE
 < 
KERNEL_VERSION
(3,1,0è&& 
	$defšed
(
HPAGE_SIZE
)

128 
šlše
 
	$iommu_m­_my
(
iommu_domaš
 *
domaš
,

129 
iova
,

130 
phys_addr_t
 
·ddr
, 
size_t
 
size
, 
´Ù
)

132 ià(
size
 <ğ
HPAGE_SIZE
 / 2 )

133  
	`iommu_m­
(
domaš
, 
iova
, 
·ddr
, 
	`g‘_Üd”
(
size
), 
´Ù
);

135 
rc
 = 
	`iommu_m­
(
domaš
, 
iova
, 
·ddr
,

136 
HPAGE_SHIFT
 - 
PAGE_SHIFT
 - 1, 
´Ù
);

137 ià(
rc
 < 0)

138  
rc
;

139 
rc
 = 
	`iommu_m­
(
domaš
, 
iova
 + 
HPAGE_SIZE
 / 2,

140 
·ddr
 + 
HPAGE_SIZE
 / 2,

141 
HPAGE_SHIFT
 - 
PAGE_SHIFT
 - 1, 
´Ù
);

142 ià(
rc
 < 0)

143 
	`iommu_unm­
(
domaš
, 
iova
, 
HPAGE_SHIFT
 - 1);

144  
rc
;

146 
	}
}

147 
šlše
 
	$iommu_unm­_my
(
iommu_domaš
 *
domaš
,

148 
iova
, 
size_t
 
size
)

150 
rc
;

151 ià(
size
 <ğ
HPAGE_SIZE
 / 2 ) {

152 
rc
 = 
	`iommu_unm­
(
domaš
, 
iova
, 
	`g‘_Üd”
(
size
));

153 ià(
rc
 < 0)

154  
rc
;

155  
size
;

157 
rc
 = 
	`iommu_unm­
(
domaš
, 
iova
, 
HPAGE_SHIFT
 - 
PAGE_SHIFT
 - 1);

158 ià(
rc
 < 0)

159  
rc
;

160 
rc
 = 
	`iommu_unm­
(
domaš
, 
iova
 + (1 << (
HPAGE_SHIFT
 - 1)),

161 
HPAGE_SHIFT
 - 
PAGE_SHIFT
 - 1);

162 ià(
rc
 < 0)

163  
rc
;

164  
size
;

166 
	}
}

167 
	#iommu_m­
 
iommu_m­_my


	)

168 
	#iommu_unm­
 
iommu_unm­_my


	)

173 
šlše
 
	$iommu_m­_my
(
iommu_domaš
 *
domaš
,

174 
iova
,

175 
phys_addr_t
 
·ddr
, 
size_t
 
size
, 
´Ù
)

177  
	`iommu_m­
(
domaš
, 
iova
, 
·ddr
, 
	`g‘_Üd”
(
size
), 
´Ù
);

178 
	}
}

179 
šlše
 
	$iommu_unm­_my
(
iommu_domaš
 *
domaš
,

180 
iova
, 
size_t
 
size
)

182 
rc
 = 
	`iommu_unm­
(
domaš
, 
iova
, 
	`g‘_Üd”
(
size
));

183 ià(
rc
 == 0)

184  
size
;

185  
rc
;

186 
	}
}

187 
	#iommu_m­
 
iommu_m­_my


	)

188 
	#iommu_unm­
 
iommu_unm­_my


	)

191 #–ià!
defšed
(
EFRM_HAVE_IOMMU_MAP
)

192 
šlše
 
	$iommu_m­
(
iommu_domaš
 *
domaš
,

193 
iova
, 
phys_addr_t
 
·ddr
,

194 
size
, 
´Ù
) {

195  
	`iommu_m­_¿nge
(
domaš
, 
iova
, 
·ddr
, 
size
, 
´Ù
);

196 
	}
}

198 
šlše
 
	$iommu_unm­
(
iommu_domaš
 *
domaš
,

199 
iova
, 
size
) {

200 
	`iommu_unm­_¿nge
(
domaš
, 
iova
, 
size
);

201  
size
;

202 
	}
}

208 #iâdeà
IOMMU_CACHE


209 
	#IOMMU_CACHE
 0

	)

211 #ià
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(3,2,0)

212 
	#iommu_´e£Á
(
b
è
	`iommu_found
()

	)

213 
	#iommu_domaš_®loc
(
b
è
	`iommu_domaš_®loc
()

	)

219 #iâdeà
IN_KERNEL_COMPAT_C


220 #iâdeà
__GFP_COMP


221 
	#__GFP_COMP
 0

	)

223 #iâdeà
__GFP_ZERO


224 
	#__GFP_ZERO
 0

	)

229 #ià(
LINUX_VERSION_CODE
 < 
KERNEL_VERSION
(2,6,8))

230 
šlše
 
	$eäm_pci_di§bË_msi
(
pci_dev
 *
dev
è{
	}
}

231 #undeà
pci_di§bË_msi


232 
	#pci_di§bË_msi
 
eäm_pci_di§bË_msi


	)

245 #ifdeà
VM_RESERVED


246 
	#EFRM_VM_IO_FLAGS
 (
VM_IO
 | 
VM_RESERVED
 | 
VM_DONTEXPAND
)

	)

248 
	#EFRM_VM_IO_FLAGS
 (
VM_IO
 | 
VM_DONTDUMP
 | 
VM_DONTEXPAND
)

	)

252 #ià(
LINUX_VERSION_CODE
 >ğ
KERNEL_VERSION
(3,9,0))

253 
	#f_vfsmÁ
 
f_·th
.
mÁ


	)

256 #ifdeà
EFRM_OLD_DEV_BY_IDX


257 
	#__dev_g‘_by_šdex
(
Ãt_ns
, 
ifšdex
è
	`__dev_g‘_by_šdex
(ifšdex)

	)

260 #iâdeà
EFRM_HAVE_NETDEV_NOTIFIER_INFO


261 
	#Ãtdev_nÙif›r_šfo_to_dev
(
šfo
è(šfo)

	)

	@/usr/include/asm/msr.h

1 #iâdeà
_ASM_X86_MSR_H


2 
	#_ASM_X86_MSR_H


	)

4 #iâdeà
__ASSEMBLY__


6 
	~<lšux/ty³s.h
>

7 
	~<lšux/ioùl.h
>

9 
	#X86_IOC_RDMSR_REGS
 
	`_IOWR
('c', 0xA0, 
__u32
[8])

	)

10 
	#X86_IOC_WRMSR_REGS
 
	`_IOWR
('c', 0xA1, 
__u32
[8])

	)

	@/usr/include/asm/unistd.h

1 #iâdeà
_ASM_X86_UNISTD_H


2 
	#_ASM_X86_UNISTD_H


	)

5 
	#__X32_SYSCALL_BIT
 0x40000000

	)

7 #ifdeà
__i386__


8 
	~<asm/uni¡d_32.h
>

9 #–ià
defšed
(
__ILP32__
)

10 
	~<asm/uni¡d_x32.h
>

12 
	~<asm/uni¡d_64.h
>

	@/usr/include/linux/eventpoll.h

14 #iâdeà
_LINUX_EVENTPOLL_H


15 
	#_LINUX_EVENTPOLL_H


	)

18 
	~<lšux/fú.h
>

19 
	~<lšux/ty³s.h
>

22 
	#EPOLL_CLOEXEC
 
O_CLOEXEC


	)

25 
	#EPOLL_CTL_ADD
 1

	)

26 
	#EPOLL_CTL_DEL
 2

	)

27 
	#EPOLL_CTL_MOD
 3

	)

30 
	#EPOLLEXCLUSIVE
 (1 << 28)

	)

42 
	#EPOLLWAKEUP
 (1 << 29)

	)

45 
	#EPOLLONESHOT
 (1 << 30)

	)

48 
	#EPOLLET
 (1 << 31)

	)

56 #ifdeà
__x86_64__


57 
	#EPOLL_PACKED
 
	`__©Œibu‹__
((
·cked
))

	)

59 
	#EPOLL_PACKED


	)

62 
	s•Şl_ev’t
 {

63 
__u32
 
	mev’ts
;

64 
__u64
 
	md©a
;

65 } 
	gEPOLL_PACKED
;

67 #ifdeà
CONFIG_PM_SLEEP


68 
__šlše__
 
	$•_ke_ÿ»_of_•Şlwakeup
(
•Şl_ev’t
 *
•ev
)

70 ià((
•ev
->
ev’ts
 & 
EPOLLWAKEUP
è&& !
	`ÿ·bË
(
CAP_BLOCK_SUSPEND
))

71 
•ev
->
ev’ts
 &ğ~
EPOLLWAKEUP
;

72 
	}
}

74 
__šlše__
 
	$•_ke_ÿ»_of_•Şlwakeup
(
•Şl_ev’t
 *
•ev
)

76 
•ev
->
ev’ts
 &ğ~
EPOLLWAKEUP
;

77 
	}
}

	@/usr/include/linux/fs.h

1 #iâdeà
_LINUX_FS_H


2 
	#_LINUX_FS_H


	)

12 
	~<lšux/lim™s.h
>

13 
	~<lšux/ioùl.h
>

14 
	~<lšux/ty³s.h
>

27 #undeà
NR_OPEN


28 
	#INR_OPEN_CUR
 1024

	)

29 
	#INR_OPEN_MAX
 4096

	)

31 
	#BLOCK_SIZE_BITS
 10

	)

32 
	#BLOCK_SIZE
 (1<<
BLOCK_SIZE_BITS
)

	)

34 
	#SEEK_SET
 0

	)

35 
	#SEEK_CUR
 1

	)

36 
	#SEEK_END
 2

	)

37 
	#SEEK_DATA
 3

	)

38 
	#SEEK_HOLE
 4

	)

39 
	#SEEK_MAX
 
SEEK_HOLE


	)

41 
	#RENAME_NOREPLACE
 (1 << 0è

	)

42 
	#RENAME_EXCHANGE
 (1 << 1è

	)

43 
	#RENAME_WHITEOUT
 (1 << 2è

	)

45 
	sfe_şÚe_¿nge
 {

46 
__s64
 
	m¤c_fd
;

47 
__u64
 
	m¤c_off£t
;

48 
__u64
 
	m¤c_Ëngth
;

49 
__u64
 
	mde¡_off£t
;

52 
	sf¡rim_¿nge
 {

53 
__u64
 
	m¡¬t
;

54 
__u64
 
	mËn
;

55 
__u64
 
	mmšËn
;

59 
	#FILE_DEDUPE_RANGE_SAME
 0

	)

60 
	#FILE_DEDUPE_RANGE_DIFFERS
 1

	)

63 
	sfe_dedu³_¿nge_šfo
 {

64 
__s64
 
	mde¡_fd
;

65 
__u64
 
	mde¡_off£t
;

66 
__u64
 
	mby‹s_dedu³d
;

73 
__s32
 
	m¡©us
;

74 
__u32
 
	m»£rved
;

78 
	sfe_dedu³_¿nge
 {

79 
__u64
 
	m¤c_off£t
;

80 
__u64
 
	m¤c_Ëngth
;

81 
__u16
 
	mde¡_couÁ
;

82 
__u16
 
	m»£rved1
;

83 
__u32
 
	m»£rved2
;

84 
fe_dedu³_¿nge_šfo
 
	mšfo
[0];

88 
	sfes_¡©_¡ruù
 {

89 
	mÄ_fes
;

90 
	mÄ_ä“_fes
;

91 
	mmax_fes
;

94 
	sšodes_¡©_t
 {

95 
	mÄ_šodes
;

96 
	mÄ_unu£d
;

97 
	mdummy
[5];

101 
	#NR_FILE
 8192

	)

107 
	#MS_RDONLY
 1

	)

108 
	#MS_NOSUID
 2

	)

109 
	#MS_NODEV
 4

	)

110 
	#MS_NOEXEC
 8

	)

111 
	#MS_SYNCHRONOUS
 16

	)

112 
	#MS_REMOUNT
 32

	)

113 
	#MS_MANDLOCK
 64

	)

114 
	#MS_DIRSYNC
 128

	)

115 
	#MS_NOATIME
 1024

	)

116 
	#MS_NODIRATIME
 2048

	)

117 
	#MS_BIND
 4096

	)

118 
	#MS_MOVE
 8192

	)

119 
	#MS_REC
 16384

	)

120 
	#MS_VERBOSE
 32768

	)

122 
	#MS_SILENT
 32768

	)

123 
	#MS_POSIXACL
 (1<<16è

	)

124 
	#MS_UNBINDABLE
 (1<<17è

	)

125 
	#MS_PRIVATE
 (1<<18è

	)

126 
	#MS_SLAVE
 (1<<19è

	)

127 
	#MS_SHARED
 (1<<20è

	)

128 
	#MS_RELATIME
 (1<<21è

	)

129 
	#MS_KERNMOUNT
 (1<<22è

	)

130 
	#MS_I_VERSION
 (1<<23è

	)

131 
	#MS_STRICTATIME
 (1<<24è

	)

132 
	#MS_LAZYTIME
 (1<<25è

	)

135 
	#MS_SUBMOUNT
 (1<<26)

	)

136 
	#MS_NOREMOTELOCK
 (1<<27)

	)

137 
	#MS_NOSEC
 (1<<28)

	)

138 
	#MS_BORN
 (1<<29)

	)

139 
	#MS_ACTIVE
 (1<<30)

	)

140 
	#MS_NOUSER
 (1<<31)

	)

145 
	#MS_RMT_MASK
 (
MS_RDONLY
|
MS_SYNCHRONOUS
|
MS_MANDLOCK
|
MS_I_VERSION
|\

146 
MS_LAZYTIME
)

	)

151 
	#MS_MGC_VAL
 0xC0ED0000

	)

152 
	#MS_MGC_MSK
 0xffff0000

	)

157 
	sfsx©Œ
 {

158 
__u32
 
	mfsx_xæags
;

159 
__u32
 
	mfsx_extsize
;

160 
__u32
 
	mfsx_Ãx‹Ás
;

161 
__u32
 
	mfsx_´ojid
;

162 
__u32
 
	mfsx_cowextsize
;

163 
	mfsx_·d
[8];

169 
	#FS_XFLAG_REALTIME
 0x00000001

	)

170 
	#FS_XFLAG_PREALLOC
 0x00000002

	)

171 
	#FS_XFLAG_IMMUTABLE
 0x00000008

	)

172 
	#FS_XFLAG_APPEND
 0x00000010

	)

173 
	#FS_XFLAG_SYNC
 0x00000020

	)

174 
	#FS_XFLAG_NOATIME
 0x00000040

	)

175 
	#FS_XFLAG_NODUMP
 0x00000080

	)

176 
	#FS_XFLAG_RTINHERIT
 0x00000100

	)

177 
	#FS_XFLAG_PROJINHERIT
 0x00000200

	)

178 
	#FS_XFLAG_NOSYMLINKS
 0x00000400

	)

179 
	#FS_XFLAG_EXTSIZE
 0x00000800

	)

180 
	#FS_XFLAG_EXTSZINHERIT
 0x00001000

	)

181 
	#FS_XFLAG_NODEFRAG
 0x00002000

	)

182 
	#FS_XFLAG_FILESTREAM
 0x00004000

	)

183 
	#FS_XFLAG_DAX
 0x00008000

	)

184 
	#FS_XFLAG_COWEXTSIZE
 0x00010000

	)

185 
	#FS_XFLAG_HASATTR
 0x80000000

	)

190 
	#BLKROSET
 
	`_IO
(0x12,93è

	)

191 
	#BLKROGET
 
	`_IO
(0x12,94è

	)

192 
	#BLKRRPART
 
	`_IO
(0x12,95è

	)

193 
	#BLKGETSIZE
 
	`_IO
(0x12,96è

	)

194 
	#BLKFLSBUF
 
	`_IO
(0x12,97è

	)

195 
	#BLKRASET
 
	`_IO
(0x12,98è

	)

196 
	#BLKRAGET
 
	`_IO
(0x12,99è

	)

197 
	#BLKFRASET
 
	`_IO
(0x12,100)

	)

198 
	#BLKFRAGET
 
	`_IO
(0x12,101)

	)

199 
	#BLKSECTSET
 
	`_IO
(0x12,102)

	)

200 
	#BLKSECTGET
 
	`_IO
(0x12,103)

	)

201 
	#BLKSSZGET
 
	`_IO
(0x12,104)

	)

203 
	#BLKPG
 
	`_IO
(0x12,105)

	)

207 
	#BLKELVGET
 
	`_IOR
(0x12,106,
size_t
)

	)

208 
	#BLKELVSET
 
	`_IOW
(0x12,107,
size_t
)

	)

213 
	#BLKBSZGET
 
	`_IOR
(0x12,112,
size_t
)

	)

214 
	#BLKBSZSET
 
	`_IOW
(0x12,113,
size_t
)

	)

215 
	#BLKGETSIZE64
 
	`_IOR
(0x12,114,
size_t
è

	)

216 
	#BLKTRACESETUP
 
	`_IOWR
(0x12,115,
blk_u£r_Œaû_£tup
)

	)

217 
	#BLKTRACESTART
 
	`_IO
(0x12,116)

	)

218 
	#BLKTRACESTOP
 
	`_IO
(0x12,117)

	)

219 
	#BLKTRACETEARDOWN
 
	`_IO
(0x12,118)

	)

220 
	#BLKDISCARD
 
	`_IO
(0x12,119)

	)

221 
	#BLKIOMIN
 
	`_IO
(0x12,120)

	)

222 
	#BLKIOOPT
 
	`_IO
(0x12,121)

	)

223 
	#BLKALIGNOFF
 
	`_IO
(0x12,122)

	)

224 
	#BLKPBSZGET
 
	`_IO
(0x12,123)

	)

225 
	#BLKDISCARDZEROES
 
	`_IO
(0x12,124)

	)

226 
	#BLKSECDISCARD
 
	`_IO
(0x12,125)

	)

227 
	#BLKROTATIONAL
 
	`_IO
(0x12,126)

	)

228 
	#BLKZEROOUT
 
	`_IO
(0x12,127)

	)

234 
	#BMAP_IOCTL
 1

	)

235 
	#FIBMAP
 
	`_IO
(0x00,1è

	)

236 
	#FIGETBSZ
 
	`_IO
(0x00,2è

	)

237 
	#FIFREEZE
 
	`_IOWR
('X', 119, è

	)

238 
	#FITHAW
 
	`_IOWR
('X', 120, è

	)

239 
	#FITRIM
 
	`_IOWR
('X', 121, 
f¡rim_¿nge
è

	)

240 
	#FICLONE
 
	`_IOW
(0x94, 9, )

	)

241 
	#FICLONERANGE
 
	`_IOW
(0x94, 13, 
fe_şÚe_¿nge
)

	)

242 
	#FIDEDUPERANGE
 
	`_IOWR
(0x94, 54, 
fe_dedu³_¿nge
)

	)

244 
	#FS_IOC_GETFLAGS
 
	`_IOR
('f', 1, )

	)

245 
	#FS_IOC_SETFLAGS
 
	`_IOW
('f', 2, )

	)

246 
	#FS_IOC_GETVERSION
 
	`_IOR
('v', 1, )

	)

247 
	#FS_IOC_SETVERSION
 
	`_IOW
('v', 2, )

	)

248 
	#FS_IOC_FIEMAP
 
	`_IOWR
('f', 11, 
f›m­
)

	)

249 
	#FS_IOC32_GETFLAGS
 
	`_IOR
('f', 1, )

	)

250 
	#FS_IOC32_SETFLAGS
 
	`_IOW
('f', 2, )

	)

251 
	#FS_IOC32_GETVERSION
 
	`_IOR
('v', 1, )

	)

252 
	#FS_IOC32_SETVERSION
 
	`_IOW
('v', 2, )

	)

253 
	#FS_IOC_FSGETXATTR
 
	`_IOR
 ('X', 31, 
fsx©Œ
)

	)

254 
	#FS_IOC_FSSETXATTR
 
	`_IOW
 ('X', 32, 
fsx©Œ
)

	)

260 
	#FS_KEY_DESCRIPTOR_SIZE
 8

	)

262 
	#FS_POLICY_FLAGS_PAD_4
 0x00

	)

263 
	#FS_POLICY_FLAGS_PAD_8
 0x01

	)

264 
	#FS_POLICY_FLAGS_PAD_16
 0x02

	)

265 
	#FS_POLICY_FLAGS_PAD_32
 0x03

	)

266 
	#FS_POLICY_FLAGS_PAD_MASK
 0x03

	)

267 
	#FS_POLICY_FLAGS_VALID
 0x03

	)

270 
	#FS_ENCRYPTION_MODE_INVALID
 0

	)

271 
	#FS_ENCRYPTION_MODE_AES_256_XTS
 1

	)

272 
	#FS_ENCRYPTION_MODE_AES_256_GCM
 2

	)

273 
	#FS_ENCRYPTION_MODE_AES_256_CBC
 3

	)

274 
	#FS_ENCRYPTION_MODE_AES_256_CTS
 4

	)

276 
	sfsüy±_pŞicy
 {

277 
__u8
 
	mv”siÚ
;

278 
__u8
 
	mcÚ‹Ás_’üy±iÚ_mode
;

279 
__u8
 
	mf’ames_’üy±iÚ_mode
;

280 
__u8
 
	mæags
;

281 
__u8
 
	mma¡”_key_desütÜ
[
FS_KEY_DESCRIPTOR_SIZE
];

282 } 
__©Œibu‹__
((
·cked
));

284 
	#FS_IOC_SET_ENCRYPTION_POLICY
 
	`_IOR
('f', 19, 
fsüy±_pŞicy
)

	)

285 
	#FS_IOC_GET_ENCRYPTION_PWSALT
 
	`_IOW
('f', 20, 
__u8
[16])

	)

286 
	#FS_IOC_GET_ENCRYPTION_POLICY
 
	`_IOW
('f', 21, 
fsüy±_pŞicy
)

	)

308 
	#FS_SECRM_FL
 0x00000001

	)

309 
	#FS_UNRM_FL
 0x00000002

	)

310 
	#FS_COMPR_FL
 0x00000004

	)

311 
	#FS_SYNC_FL
 0x00000008

	)

312 
	#FS_IMMUTABLE_FL
 0x00000010

	)

313 
	#FS_APPEND_FL
 0x00000020

	)

314 
	#FS_NODUMP_FL
 0x00000040

	)

315 
	#FS_NOATIME_FL
 0x00000080

	)

317 
	#FS_DIRTY_FL
 0x00000100

	)

318 
	#FS_COMPRBLK_FL
 0x00000200

	)

319 
	#FS_NOCOMP_FL
 0x00000400

	)

321 
	#FS_ENCRYPT_FL
 0x00000800

	)

322 
	#FS_BTREE_FL
 0x00001000

	)

323 
	#FS_INDEX_FL
 0x00001000

	)

324 
	#FS_IMAGIC_FL
 0x00002000

	)

325 
	#FS_JOURNAL_DATA_FL
 0x00004000

	)

326 
	#FS_NOTAIL_FL
 0x00008000

	)

327 
	#FS_DIRSYNC_FL
 0x00010000

	)

328 
	#FS_TOPDIR_FL
 0x00020000

	)

329 
	#FS_HUGE_FILE_FL
 0x00040000

	)

330 
	#FS_EXTENT_FL
 0x00080000

	)

331 
	#FS_EA_INODE_FL
 0x00200000

	)

332 
	#FS_EOFBLOCKS_FL
 0x00400000

	)

333 
	#FS_NOCOW_FL
 0x00800000

	)

334 
	#FS_INLINE_DATA_FL
 0x10000000

	)

335 
	#FS_PROJINHERIT_FL
 0x20000000

	)

336 
	#FS_RESERVED_FL
 0x80000000

	)

338 
	#FS_FL_USER_VISIBLE
 0x0003DFFF

	)

339 
	#FS_FL_USER_MODIFIABLE
 0x000380FF

	)

342 
	#SYNC_FILE_RANGE_WAIT_BEFORE
 1

	)

343 
	#SYNC_FILE_RANGE_WRITE
 2

	)

344 
	#SYNC_FILE_RANGE_WAIT_AFTER
 4

	)

347 
	#RWF_HIPRI
 0x00000001

	)

348 
	#RWF_DSYNC
 0x00000002

	)

349 
	#RWF_SYNC
 0x00000004

	)

	@/usr/include/linux/if_addr.h

1 #iâdeà
__LINUX_IF_ADDR_H


2 
	#__LINUX_IF_ADDR_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãšk.h
>

7 
	siçddrmsg
 {

8 
__u8
 
	miç_çmy
;

9 
__u8
 
	miç_´efixËn
;

10 
__u8
 
	miç_æags
;

11 
__u8
 
	miç_scİe
;

12 
__u32
 
	miç_šdex
;

26 
	mIFA_UNSPEC
,

27 
	mIFA_ADDRESS
,

28 
	mIFA_LOCAL
,

29 
	mIFA_LABEL
,

30 
	mIFA_BROADCAST
,

31 
	mIFA_ANYCAST
,

32 
	mIFA_CACHEINFO
,

33 
	mIFA_MULTICAST
,

34 
	mIFA_FLAGS
,

35 
	m__IFA_MAX
,

38 
	#IFA_MAX
 (
__IFA_MAX
 - 1)

	)

41 
	#IFA_F_SECONDARY
 0x01

	)

42 
	#IFA_F_TEMPORARY
 
IFA_F_SECONDARY


	)

44 
	#IFA_F_NODAD
 0x02

	)

45 
	#IFA_F_OPTIMISTIC
 0x04

	)

46 
	#IFA_F_DADFAILED
 0x08

	)

47 
	#IFA_F_HOMEADDRESS
 0x10

	)

48 
	#IFA_F_DEPRECATED
 0x20

	)

49 
	#IFA_F_TENTATIVE
 0x40

	)

50 
	#IFA_F_PERMANENT
 0x80

	)

51 
	#IFA_F_MANAGETEMPADDR
 0x100

	)

52 
	#IFA_F_NOPREFIXROUTE
 0x200

	)

53 
	#IFA_F_MCAUTOJOIN
 0x400

	)

54 
	#IFA_F_STABLE_PRIVACY
 0x800

	)

56 
	siç_ÿchešfo
 {

57 
__u32
 
	miç_´eã»d
;

58 
__u32
 
	miç_v®id
;

59 
__u32
 
	mc¡amp
;

60 
__u32
 
	mt¡amp
;

64 
	#IFA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
içddrmsg
))))

	)

65 
	#IFA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
içddrmsg
))

	)

	@/usr/include/linux/if_arp.h

23 #iâdeà
_LINUX_IF_ARP_H


24 
	#_LINUX_IF_ARP_H


	)

26 
	~<lšux/Ãtdeviû.h
>

29 
	#ARPHRD_NETROM
 0

	)

30 
	#ARPHRD_ETHER
 1

	)

31 
	#ARPHRD_EETHER
 2

	)

32 
	#ARPHRD_AX25
 3

	)

33 
	#ARPHRD_PRONET
 4

	)

34 
	#ARPHRD_CHAOS
 5

	)

35 
	#ARPHRD_IEEE802
 6

	)

36 
	#ARPHRD_ARCNET
 7

	)

37 
	#ARPHRD_APPLETLK
 8

	)

38 
	#ARPHRD_DLCI
 15

	)

39 
	#ARPHRD_ATM
 19

	)

40 
	#ARPHRD_METRICOM
 23

	)

41 
	#ARPHRD_IEEE1394
 24

	)

42 
	#ARPHRD_EUI64
 27

	)

43 
	#ARPHRD_INFINIBAND
 32

	)

46 
	#ARPHRD_SLIP
 256

	)

47 
	#ARPHRD_CSLIP
 257

	)

48 
	#ARPHRD_SLIP6
 258

	)

49 
	#ARPHRD_CSLIP6
 259

	)

50 
	#ARPHRD_RSRVD
 260

	)

51 
	#ARPHRD_ADAPT
 264

	)

52 
	#ARPHRD_ROSE
 270

	)

53 
	#ARPHRD_X25
 271

	)

54 
	#ARPHRD_HWX25
 272

	)

55 
	#ARPHRD_CAN
 280

	)

56 
	#ARPHRD_PPP
 512

	)

57 
	#ARPHRD_CISCO
 513

	)

58 
	#ARPHRD_HDLC
 
ARPHRD_CISCO


	)

59 
	#ARPHRD_LAPB
 516

	)

60 
	#ARPHRD_DDCMP
 517

	)

61 
	#ARPHRD_RAWHDLC
 518

	)

63 
	#ARPHRD_TUNNEL
 768

	)

64 
	#ARPHRD_TUNNEL6
 769

	)

65 
	#ARPHRD_FRAD
 770

	)

66 
	#ARPHRD_SKIP
 771

	)

67 
	#ARPHRD_LOOPBACK
 772

	)

68 
	#ARPHRD_LOCALTLK
 773

	)

69 
	#ARPHRD_FDDI
 774

	)

70 
	#ARPHRD_BIF
 775

	)

71 
	#ARPHRD_SIT
 776

	)

72 
	#ARPHRD_IPDDP
 777

	)

73 
	#ARPHRD_IPGRE
 778

	)

74 
	#ARPHRD_PIMREG
 779

	)

75 
	#ARPHRD_HIPPI
 780

	)

76 
	#ARPHRD_ASH
 781

	)

77 
	#ARPHRD_ECONET
 782

	)

78 
	#ARPHRD_IRDA
 783

	)

80 
	#ARPHRD_FCPP
 784

	)

81 
	#ARPHRD_FCAL
 785

	)

82 
	#ARPHRD_FCPL
 786

	)

83 
	#ARPHRD_FCFABRIC
 787

	)

85 
	#ARPHRD_IEEE802_TR
 800

	)

86 
	#ARPHRD_IEEE80211
 801

	)

87 
	#ARPHRD_IEEE80211_PRISM
 802

	)

88 
	#ARPHRD_IEEE80211_RADIOTAP
 803

	)

89 
	#ARPHRD_IEEE802154
 804

	)

90 
	#ARPHRD_IEEE802154_MONITOR
 805

	)

92 
	#ARPHRD_PHONET
 820

	)

93 
	#ARPHRD_PHONET_PIPE
 821

	)

94 
	#ARPHRD_CAIF
 822

	)

95 
	#ARPHRD_IP6GRE
 823

	)

96 
	#ARPHRD_NETLINK
 824

	)

97 
	#ARPHRD_6LOWPAN
 825

	)

99 
	#ARPHRD_VOID
 0xFFFF

	)

100 
	#ARPHRD_NONE
 0xFFFE

	)

103 
	#ARPOP_REQUEST
 1

	)

104 
	#ARPOP_REPLY
 2

	)

105 
	#ARPOP_RREQUEST
 3

	)

106 
	#ARPOP_RREPLY
 4

	)

107 
	#ARPOP_InREQUEST
 8

	)

108 
	#ARPOP_InREPLY
 9

	)

109 
	#ARPOP_NAK
 10

	)

113 
	s¬´eq
 {

114 
sockaddr
 
	m¬p_·
;

115 
sockaddr
 
	m¬p_ha
;

116 
	m¬p_æags
;

117 
sockaddr
 
	m¬p_Ãtmask
;

118 
	m¬p_dev
[16];

121 
	s¬´eq_Şd
 {

122 
sockaddr
 
	m¬p_·
;

123 
sockaddr
 
	m¬p_ha
;

124 
	m¬p_æags
;

125 
sockaddr
 
	m¬p_Ãtmask
;

129 
	#ATF_COM
 0x02

	)

130 
	#ATF_PERM
 0x04

	)

131 
	#ATF_PUBL
 0x08

	)

132 
	#ATF_USETRAILERS
 0x10

	)

133 
	#ATF_NETMASK
 0x20

	)

135 
	#ATF_DONTPUB
 0x40

	)

141 
	s¬phdr
 {

142 
__be16
 
	m¬_hrd
;

143 
__be16
 
	m¬_´o
;

144 
	m¬_hÊ
;

145 
	m¬_¶n
;

146 
__be16
 
	m¬_İ
;

152 
	m¬_sha
[
ETH_ALEN
];

153 
	m¬_s
[4];

154 
	m¬_tha
[
ETH_ALEN
];

155 
	m¬_t
[4];

	@/usr/include/linux/kernel.h

1 #iâdeà
_LINUX_KERNEL_H


2 
	#_LINUX_KERNEL_H


	)

4 
	~<lšux/sysšfo.h
>

9 
	#__ALIGN_KERNEL
(
x
, 
a
è
	`__ALIGN_KERNEL_MASK
(x, (
	`ty³of
(x))×è- 1)

	)

10 
	#__ALIGN_KERNEL_MASK
(
x
, 
mask
è(((xè+ (mask)è& ~(mask))

	)

12 
	#__KERNEL_DIV_ROUND_UP
(
n
, 
d
è((Òè+ (dè- 1è/ (d))

	)

	@/usr/include/linux/netdevice.h

25 #iâdeà
_LINUX_NETDEVICE_H


26 
	#_LINUX_NETDEVICE_H


	)

28 
	~<lšux/if.h
>

29 
	~<lšux/if_‘h”.h
>

30 
	~<lšux/if_·ck‘.h
>

31 
	~<lšux/if_lšk.h
>

34 
	#MAX_ADDR_LEN
 32

	)

37 
	#INIT_NETDEV_GROUP
 0

	)

41 
	#NET_NAME_UNKNOWN
 0

	)

42 
	#NET_NAME_ENUM
 1

	)

43 
	#NET_NAME_PREDICTABLE
 2

	)

44 
	#NET_NAME_USER
 3

	)

45 
	#NET_NAME_RENAMED
 4

	)

49 
	mIF_PORT_UNKNOWN
 = 0,

50 
	mIF_PORT_10BASE2
,

51 
	mIF_PORT_10BASET
,

52 
	mIF_PORT_AUI
,

53 
	mIF_PORT_100BASET
,

54 
	mIF_PORT_100BASETX
,

55 
	mIF_PORT_100BASEFX


59 
	#NET_ADDR_PERM
 0

	)

60 
	#NET_ADDR_RANDOM
 1

	)

61 
	#NET_ADDR_STOLEN
 2

	)

62 
	#NET_ADDR_SET
 3

	)

	@/usr/include/linux/netfilter.h

1 #iâdeà
__LINUX_NETFILTER_H


2 
	#__LINUX_NETFILTER_H


	)

4 
	~<lšux/ty³s.h
>

6 
	~<lšux/sysùl.h
>

7 
	~<lšux/š.h
>

8 
	~<lšux/š6.h
>

11 
	#NF_DROP
 0

	)

12 
	#NF_ACCEPT
 1

	)

13 
	#NF_STOLEN
 2

	)

14 
	#NF_QUEUE
 3

	)

15 
	#NF_REPEAT
 4

	)

16 
	#NF_STOP
 5

	)

17 
	#NF_MAX_VERDICT
 
NF_STOP


	)

22 
	#NF_VERDICT_MASK
 0x000000ff

	)

25 
	#NF_VERDICT_FLAG_QUEUE_BYPASS
 0x00008000

	)

28 
	#NF_VERDICT_QMASK
 0xffff0000

	)

29 
	#NF_VERDICT_QBITS
 16

	)

31 
	#NF_QUEUE_NR
(
x
è((((xè<< 16è& 
NF_VERDICT_QMASK
è| 
NF_QUEUE
)

	)

33 
	#NF_DROP_ERR
(
x
è(((-xè<< 16è| 
NF_DROP
)

	)

38 
	#NFC_UNKNOWN
 0x4000

	)

39 
	#NFC_ALTERED
 0x8000

	)

42 
	#NF_VERDICT_BITS
 16

	)

44 
	enf_š‘_hooks
 {

45 
	mNF_INET_PRE_ROUTING
,

46 
	mNF_INET_LOCAL_IN
,

47 
	mNF_INET_FORWARD
,

48 
	mNF_INET_LOCAL_OUT
,

49 
	mNF_INET_POST_ROUTING
,

50 
	mNF_INET_NUMHOOKS


53 
	enf_dev_hooks
 {

54 
	mNF_NETDEV_INGRESS
,

55 
	mNF_NETDEV_NUMHOOKS


59 
	mNFPROTO_UNSPEC
 = 0,

60 
	mNFPROTO_INET
 = 1,

61 
	mNFPROTO_IPV4
 = 2,

62 
	mNFPROTO_ARP
 = 3,

63 
	mNFPROTO_NETDEV
 = 5,

64 
	mNFPROTO_BRIDGE
 = 7,

65 
	mNFPROTO_IPV6
 = 10,

66 
	mNFPROTO_DECNET
 = 12,

67 
	mNFPROTO_NUMPROTO
,

70 
	unf_š‘_addr
 {

71 
__u32
 
	m®l
[4];

72 
__be32
 
	m
;

73 
__be32
 
	m6
[4];

74 
š_addr
 
	mš
;

75 
š6_addr
 
	mš6
;

	@/usr/include/linux/netfilter_arp.h

1 #iâdeà
__LINUX_ARP_NETFILTER_H


2 
	#__LINUX_ARP_NETFILTER_H


	)

8 
	~<lšux/Ãtf‹r.h
>

11 
	#NF_ARP
 0

	)

14 
	#NF_ARP_IN
 0

	)

15 
	#NF_ARP_OUT
 1

	)

16 
	#NF_ARP_FORWARD
 2

	)

17 
	#NF_ARP_NUMHOOKS
 3

	)

	@/usr/include/linux/netfilter_ipv4.h

4 #iâdeà
__LINUX_IP_NETFILTER_H


5 
	#__LINUX_IP_NETFILTER_H


	)

8 
	~<lšux/Ãtf‹r.h
>

12 
	~<lim™s.h
>

16 
	#NFC_IP_SRC
 0x0001

	)

18 
	#NFC_IP_DST
 0x0002

	)

20 
	#NFC_IP_IF_IN
 0x0004

	)

22 
	#NFC_IP_IF_OUT
 0x0008

	)

24 
	#NFC_IP_TOS
 0x0010

	)

26 
	#NFC_IP_PROTO
 0x0020

	)

28 
	#NFC_IP_OPTIONS
 0x0040

	)

30 
	#NFC_IP_FRAG
 0x0080

	)

34 
	#NFC_IP_TCPFLAGS
 0x0100

	)

36 
	#NFC_IP_SRC_PT
 0x0200

	)

38 
	#NFC_IP_DST_PT
 0x0400

	)

40 
	#NFC_IP_PROTO_UNKNOWN
 0x2000

	)

44 
	#NF_IP_PRE_ROUTING
 0

	)

46 
	#NF_IP_LOCAL_IN
 1

	)

48 
	#NF_IP_FORWARD
 2

	)

50 
	#NF_IP_LOCAL_OUT
 3

	)

52 
	#NF_IP_POST_ROUTING
 4

	)

53 
	#NF_IP_NUMHOOKS
 5

	)

55 
	enf__hook_´iÜ™›s
 {

56 
	mNF_IP_PRI_FIRST
 = 
INT_MIN
,

57 
	mNF_IP_PRI_CONNTRACK_DEFRAG
 = -400,

58 
	mNF_IP_PRI_RAW
 = -300,

59 
	mNF_IP_PRI_SELINUX_FIRST
 = -225,

60 
	mNF_IP_PRI_CONNTRACK
 = -200,

61 
	mNF_IP_PRI_MANGLE
 = -150,

62 
	mNF_IP_PRI_NAT_DST
 = -100,

63 
	mNF_IP_PRI_FILTER
 = 0,

64 
	mNF_IP_PRI_SECURITY
 = 50,

65 
	mNF_IP_PRI_NAT_SRC
 = 100,

66 
	mNF_IP_PRI_SELINUX_LAST
 = 225,

67 
	mNF_IP_PRI_CONNTRACK_HELPER
 = 300,

68 
	mNF_IP_PRI_CONNTRACK_CONFIRM
 = 
INT_MAX
,

69 
	mNF_IP_PRI_LAST
 = 
INT_MAX
,

76 
	#SO_ORIGINAL_DST
 80

	)

	@/usr/include/linux/netlink.h

1 #iâdeà
__LINUX_NETLINK_H


2 
	#__LINUX_NETLINK_H


	)

4 
	~<lšux/k”Ãl.h
>

5 
	~<lšux/sock‘.h
>

6 
	~<lšux/ty³s.h
>

8 
	#NETLINK_ROUTE
 0

	)

9 
	#NETLINK_UNUSED
 1

	)

10 
	#NETLINK_USERSOCK
 2

	)

11 
	#NETLINK_FIREWALL
 3

	)

12 
	#NETLINK_SOCK_DIAG
 4

	)

13 
	#NETLINK_NFLOG
 5

	)

14 
	#NETLINK_XFRM
 6

	)

15 
	#NETLINK_SELINUX
 7

	)

16 
	#NETLINK_ISCSI
 8

	)

17 
	#NETLINK_AUDIT
 9

	)

18 
	#NETLINK_FIB_LOOKUP
 10

	)

19 
	#NETLINK_CONNECTOR
 11

	)

20 
	#NETLINK_NETFILTER
 12

	)

21 
	#NETLINK_IP6_FW
 13

	)

22 
	#NETLINK_DNRTMSG
 14

	)

23 
	#NETLINK_KOBJECT_UEVENT
 15

	)

24 
	#NETLINK_GENERIC
 16

	)

26 
	#NETLINK_SCSITRANSPORT
 18

	)

27 
	#NETLINK_ECRYPTFS
 19

	)

28 
	#NETLINK_RDMA
 20

	)

29 
	#NETLINK_CRYPTO
 21

	)

31 
	#NETLINK_INET_DIAG
 
NETLINK_SOCK_DIAG


	)

33 
	#MAX_LINKS
 32

	)

35 
	ssockaddr_Æ
 {

36 
__k”Ãl_§_çmy_t
 
	mÆ_çmy
;

37 
	mÆ_·d
;

38 
__u32
 
	mÆ_pid
;

39 
__u32
 
	mÆ_groups
;

42 
	sÆmsghdr
 {

43 
__u32
 
	mÆmsg_Ën
;

44 
__u16
 
	mÆmsg_ty³
;

45 
__u16
 
	mÆmsg_æags
;

46 
__u32
 
	mÆmsg_£q
;

47 
__u32
 
	mÆmsg_pid
;

52 
	#NLM_F_REQUEST
 1

	)

53 
	#NLM_F_MULTI
 2

	)

54 
	#NLM_F_ACK
 4

	)

55 
	#NLM_F_ECHO
 8

	)

56 
	#NLM_F_DUMP_INTR
 16

	)

57 
	#NLM_F_DUMP_FILTERED
 32

	)

60 
	#NLM_F_ROOT
 0x100

	)

61 
	#NLM_F_MATCH
 0x200

	)

62 
	#NLM_F_ATOMIC
 0x400

	)

63 
	#NLM_F_DUMP
 (
NLM_F_ROOT
|
NLM_F_MATCH
)

	)

66 
	#NLM_F_REPLACE
 0x100

	)

67 
	#NLM_F_EXCL
 0x200

	)

68 
	#NLM_F_CREATE
 0x400

	)

69 
	#NLM_F_APPEND
 0x800

	)

80 
	#NLMSG_ALIGNTO
 4U

	)

81 
	#NLMSG_ALIGN
(
Ën
èĞ(Ö’)+
NLMSG_ALIGNTO
-1è& ~(NLMSG_ALIGNTO-1è)

	)

82 
	#NLMSG_HDRLEN
 ((è
	`NLMSG_ALIGN
((
Æmsghdr
)))

	)

83 
	#NLMSG_LENGTH
(
Ën
è(Ö’è+ 
NLMSG_HDRLEN
)

	)

84 
	#NLMSG_SPACE
(
Ën
è
	`NLMSG_ALIGN
(
	`NLMSG_LENGTH
Ö’))

	)

85 
	#NLMSG_DATA
(
Æh
è((*)(((*êlhè+ 
	`NLMSG_LENGTH
(0)))

	)

86 
	#NLMSG_NEXT
(
Æh
,
Ën
è(Ö’è-ğ
	`NLMSG_ALIGN
(Òlh)->
Æmsg_Ën
), \

87 (
Æmsghdr
*)(((*)(
Æh
)è+ 
	`NLMSG_ALIGN
(Òlh)->
Æmsg_Ën
)))

	)

88 
	#NLMSG_OK
(
Æh
,
Ën
è(Ö’è>ğ()(
Æmsghdr
) && \

89 (
Æh
)->
Æmsg_Ën
 >ğ(
Æmsghdr
) && \

90 (
Æh
)->
Æmsg_Ën
 <ğ(
Ën
))

	)

91 
	#NLMSG_PAYLOAD
(
Æh
,
Ën
è(Òlh)->
Æmsg_Ën
 - 
	`NLMSG_SPACE
(Ö’)))

	)

93 
	#NLMSG_NOOP
 0x1

	)

94 
	#NLMSG_ERROR
 0x2

	)

95 
	#NLMSG_DONE
 0x3

	)

96 
	#NLMSG_OVERRUN
 0x4

	)

98 
	#NLMSG_MIN_TYPE
 0x10

	)

100 
	sÆmsg”r
 {

101 
	m”rÜ
;

102 
Æmsghdr
 
	mmsg
;

105 
	#NETLINK_ADD_MEMBERSHIP
 1

	)

106 
	#NETLINK_DROP_MEMBERSHIP
 2

	)

107 
	#NETLINK_PKTINFO
 3

	)

108 
	#NETLINK_BROADCAST_ERROR
 4

	)

109 
	#NETLINK_NO_ENOBUFS
 5

	)

110 
	#NETLINK_RX_RING
 6

	)

111 
	#NETLINK_TX_RING
 7

	)

112 
	#NETLINK_LISTEN_ALL_NSID
 8

	)

113 
	#NETLINK_LIST_MEMBERSHIPS
 9

	)

114 
	#NETLINK_CAP_ACK
 10

	)

116 
	sÆ_pktšfo
 {

117 
__u32
 
	mgroup
;

120 
	sÆ_mm­_»q
 {

121 
	mnm_block_size
;

122 
	mnm_block_Ä
;

123 
	mnm_äame_size
;

124 
	mnm_äame_Ä
;

127 
	sÆ_mm­_hdr
 {

128 
	mnm_¡©us
;

129 
	mnm_Ën
;

130 
__u32
 
	mnm_group
;

132 
__u32
 
	mnm_pid
;

133 
__u32
 
	mnm_uid
;

134 
__u32
 
	mnm_gid
;

137 
	eÆ_mm­_¡©us
 {

138 
	mNL_MMAP_STATUS_UNUSED
,

139 
	mNL_MMAP_STATUS_RESERVED
,

140 
	mNL_MMAP_STATUS_VALID
,

141 
	mNL_MMAP_STATUS_COPY
,

142 
	mNL_MMAP_STATUS_SKIP
,

145 
	#NL_MMAP_MSG_ALIGNMENT
 
NLMSG_ALIGNTO


	)

146 
	#NL_MMAP_MSG_ALIGN
(
sz
è
	`__ALIGN_KERNEL
(sz, 
NL_MMAP_MSG_ALIGNMENT
)

	)

147 
	#NL_MMAP_HDRLEN
 
	`NL_MMAP_MSG_ALIGN
((
Æ_mm­_hdr
))

	)

149 
	#NET_MAJOR
 36

	)

152 
	mNETLINK_UNCONNECTED
 = 0,

153 
	mNETLINK_CONNECTED
,

165 
	sÆ©Œ
 {

166 
__u16
 
	mÆa_Ën
;

167 
__u16
 
	mÆa_ty³
;

180 
	#NLA_F_NESTED
 (1 << 15)

	)

181 
	#NLA_F_NET_BYTEORDER
 (1 << 14)

	)

182 
	#NLA_TYPE_MASK
 ~(
NLA_F_NESTED
 | 
NLA_F_NET_BYTEORDER
)

	)

184 
	#NLA_ALIGNTO
 4

	)

185 
	#NLA_ALIGN
(
Ën
è((Ö’è+ 
NLA_ALIGNTO
 - 1è& ~(NLA_ALIGNTO - 1))

	)

186 
	#NLA_HDRLEN
 ((è
	`NLA_ALIGN
((
Æ©Œ
)))

	)

	@/usr/include/linux/rtnetlink.h

1 #iâdeà
__LINUX_RTNETLINK_H


2 
	#__LINUX_RTNETLINK_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãšk.h
>

6 
	~<lšux/if_lšk.h
>

7 
	~<lšux/if_addr.h
>

8 
	~<lšux/Ãighbour.h
>

13 
	#RTNL_FAMILY_IPMR
 128

	)

14 
	#RTNL_FAMILY_IP6MR
 129

	)

15 
	#RTNL_FAMILY_MAX
 129

	)

24 
	mRTM_BASE
 = 16,

25 
	#RTM_BASE
 
RTM_BASE


	)

27 
	mRTM_NEWLINK
 = 16,

28 
	#RTM_NEWLINK
 
RTM_NEWLINK


	)

29 
	mRTM_DELLINK
,

30 
	#RTM_DELLINK
 
RTM_DELLINK


	)

31 
	mRTM_GETLINK
,

32 
	#RTM_GETLINK
 
RTM_GETLINK


	)

33 
	mRTM_SETLINK
,

34 
	#RTM_SETLINK
 
RTM_SETLINK


	)

36 
	mRTM_NEWADDR
 = 20,

37 
	#RTM_NEWADDR
 
RTM_NEWADDR


	)

38 
	mRTM_DELADDR
,

39 
	#RTM_DELADDR
 
RTM_DELADDR


	)

40 
	mRTM_GETADDR
,

41 
	#RTM_GETADDR
 
RTM_GETADDR


	)

43 
	mRTM_NEWROUTE
 = 24,

44 
	#RTM_NEWROUTE
 
RTM_NEWROUTE


	)

45 
	mRTM_DELROUTE
,

46 
	#RTM_DELROUTE
 
RTM_DELROUTE


	)

47 
	mRTM_GETROUTE
,

48 
	#RTM_GETROUTE
 
RTM_GETROUTE


	)

50 
	mRTM_NEWNEIGH
 = 28,

51 
	#RTM_NEWNEIGH
 
RTM_NEWNEIGH


	)

52 
	mRTM_DELNEIGH
,

53 
	#RTM_DELNEIGH
 
RTM_DELNEIGH


	)

54 
	mRTM_GETNEIGH
,

55 
	#RTM_GETNEIGH
 
RTM_GETNEIGH


	)

57 
	mRTM_NEWRULE
 = 32,

58 
	#RTM_NEWRULE
 
RTM_NEWRULE


	)

59 
	mRTM_DELRULE
,

60 
	#RTM_DELRULE
 
RTM_DELRULE


	)

61 
	mRTM_GETRULE
,

62 
	#RTM_GETRULE
 
RTM_GETRULE


	)

64 
	mRTM_NEWQDISC
 = 36,

65 
	#RTM_NEWQDISC
 
RTM_NEWQDISC


	)

66 
	mRTM_DELQDISC
,

67 
	#RTM_DELQDISC
 
RTM_DELQDISC


	)

68 
	mRTM_GETQDISC
,

69 
	#RTM_GETQDISC
 
RTM_GETQDISC


	)

71 
	mRTM_NEWTCLASS
 = 40,

72 
	#RTM_NEWTCLASS
 
RTM_NEWTCLASS


	)

73 
	mRTM_DELTCLASS
,

74 
	#RTM_DELTCLASS
 
RTM_DELTCLASS


	)

75 
	mRTM_GETTCLASS
,

76 
	#RTM_GETTCLASS
 
RTM_GETTCLASS


	)

78 
	mRTM_NEWTFILTER
 = 44,

79 
	#RTM_NEWTFILTER
 
RTM_NEWTFILTER


	)

80 
	mRTM_DELTFILTER
,

81 
	#RTM_DELTFILTER
 
RTM_DELTFILTER


	)

82 
	mRTM_GETTFILTER
,

83 
	#RTM_GETTFILTER
 
RTM_GETTFILTER


	)

85 
	mRTM_NEWACTION
 = 48,

86 
	#RTM_NEWACTION
 
RTM_NEWACTION


	)

87 
	mRTM_DELACTION
,

88 
	#RTM_DELACTION
 
RTM_DELACTION


	)

89 
	mRTM_GETACTION
,

90 
	#RTM_GETACTION
 
RTM_GETACTION


	)

92 
	mRTM_NEWPREFIX
 = 52,

93 
	#RTM_NEWPREFIX
 
RTM_NEWPREFIX


	)

95 
	mRTM_GETMULTICAST
 = 58,

96 
	#RTM_GETMULTICAST
 
RTM_GETMULTICAST


	)

98 
	mRTM_GETANYCAST
 = 62,

99 
	#RTM_GETANYCAST
 
RTM_GETANYCAST


	)

101 
	mRTM_NEWNEIGHTBL
 = 64,

102 
	#RTM_NEWNEIGHTBL
 
RTM_NEWNEIGHTBL


	)

103 
	mRTM_GETNEIGHTBL
 = 66,

104 
	#RTM_GETNEIGHTBL
 
RTM_GETNEIGHTBL


	)

105 
	mRTM_SETNEIGHTBL
,

106 
	#RTM_SETNEIGHTBL
 
RTM_SETNEIGHTBL


	)

108 
	mRTM_NEWNDUSEROPT
 = 68,

109 
	#RTM_NEWNDUSEROPT
 
RTM_NEWNDUSEROPT


	)

111 
	mRTM_NEWADDRLABEL
 = 72,

112 
	#RTM_NEWADDRLABEL
 
RTM_NEWADDRLABEL


	)

113 
	mRTM_DELADDRLABEL
,

114 
	#RTM_DELADDRLABEL
 
RTM_DELADDRLABEL


	)

115 
	mRTM_GETADDRLABEL
,

116 
	#RTM_GETADDRLABEL
 
RTM_GETADDRLABEL


	)

118 
	mRTM_GETDCB
 = 78,

119 
	#RTM_GETDCB
 
RTM_GETDCB


	)

120 
	mRTM_SETDCB
,

121 
	#RTM_SETDCB
 
RTM_SETDCB


	)

123 
	mRTM_NEWNETCONF
 = 80,

124 
	#RTM_NEWNETCONF
 
RTM_NEWNETCONF


	)

125 
	mRTM_GETNETCONF
 = 82,

126 
	#RTM_GETNETCONF
 
RTM_GETNETCONF


	)

128 
	mRTM_NEWMDB
 = 84,

129 
	#RTM_NEWMDB
 
RTM_NEWMDB


	)

130 
	mRTM_DELMDB
 = 85,

131 
	#RTM_DELMDB
 
RTM_DELMDB


	)

132 
	mRTM_GETMDB
 = 86,

133 
	#RTM_GETMDB
 
RTM_GETMDB


	)

135 
	mRTM_NEWNSID
 = 88,

136 
	#RTM_NEWNSID
 
RTM_NEWNSID


	)

137 
	mRTM_DELNSID
 = 89,

138 
	#RTM_DELNSID
 
RTM_DELNSID


	)

139 
	mRTM_GETNSID
 = 90,

140 
	#RTM_GETNSID
 
RTM_GETNSID


	)

142 
	mRTM_NEWSTATS
 = 92,

143 
	#RTM_NEWSTATS
 
RTM_NEWSTATS


	)

144 
	mRTM_GETSTATS
 = 94,

145 
	#RTM_GETSTATS
 
RTM_GETSTATS


	)

147 
	m__RTM_MAX
,

148 
	#RTM_MAX
 (((
__RTM_MAX
 + 3è& ~3è- 1)

	)

151 
	#RTM_NR_MSGTYPES
 (
RTM_MAX
 + 1 - 
RTM_BASE
)

	)

152 
	#RTM_NR_FAMILIES
 (
RTM_NR_MSGTYPES
 >> 2)

	)

153 
	#RTM_FAM
(
cmd
è(((cmdè- 
RTM_BASE
è>> 2)

	)

161 
	s¹©Œ
 {

162 
	m¹a_Ën
;

163 
	m¹a_ty³
;

168 
	#RTA_ALIGNTO
 4U

	)

169 
	#RTA_ALIGN
(
Ën
èĞ(Ö’)+
RTA_ALIGNTO
-1è& ~(RTA_ALIGNTO-1è)

	)

170 
	#RTA_OK
(
¹a
,
Ën
è(Ö’è>ğ()(
¹©Œ
) && \

171 (
¹a
)->
¹a_Ën
 >ğ(
¹©Œ
) && \

172 (
¹a
)->
¹a_Ën
 <ğ(
Ën
))

	)

173 
	#RTA_NEXT
(
¹a
,
©ŒËn
è(×‰¾’è-ğ
	`RTA_ALIGN
(Ô)->
¹a_Ën
), \

174 (
¹©Œ
*)(((*)(
¹a
)è+ 
	`RTA_ALIGN
(Ô)->
¹a_Ën
)))

	)

175 
	#RTA_LENGTH
(
Ën
è(
	`RTA_ALIGN
((
¹©Œ
)è+ (Ën))

	)

176 
	#RTA_SPACE
(
Ën
è
	`RTA_ALIGN
(
	`RTA_LENGTH
Ö’))

	)

177 
	#RTA_DATA
(
¹a
è((*)(((*)Ô)è+ 
	`RTA_LENGTH
(0)))

	)

178 
	#RTA_PAYLOAD
(
¹a
è(()(Ô)->
¹a_Ën
è- 
	`RTA_LENGTH
(0))

	)

187 
	s¹msg
 {

188 
	m¹m_çmy
;

189 
	m¹m_d¡_Ën
;

190 
	m¹m_¤c_Ën
;

191 
	m¹m_tos
;

193 
	m¹m_bË
;

194 
	m¹m_´ÙocŞ
;

195 
	m¹m_scİe
;

196 
	m¹m_ty³
;

198 
	m¹m_æags
;

204 
	mRTN_UNSPEC
,

205 
	mRTN_UNICAST
,

206 
	mRTN_LOCAL
,

207 
	mRTN_BROADCAST
,

209 
	mRTN_ANYCAST
,

211 
	mRTN_MULTICAST
,

212 
	mRTN_BLACKHOLE
,

213 
	mRTN_UNREACHABLE
,

214 
	mRTN_PROHIBIT
,

215 
	mRTN_THROW
,

216 
	mRTN_NAT
,

217 
	mRTN_XRESOLVE
,

218 
	m__RTN_MAX


221 
	#RTN_MAX
 (
__RTN_MAX
 - 1)

	)

226 
	#RTPROT_UNSPEC
 0

	)

227 
	#RTPROT_REDIRECT
 1

	)

229 
	#RTPROT_KERNEL
 2

	)

230 
	#RTPROT_BOOT
 3

	)

231 
	#RTPROT_STATIC
 4

	)

240 
	#RTPROT_GATED
 8

	)

241 
	#RTPROT_RA
 9

	)

242 
	#RTPROT_MRT
 10

	)

243 
	#RTPROT_ZEBRA
 11

	)

244 
	#RTPROT_BIRD
 12

	)

245 
	#RTPROT_DNROUTED
 13

	)

246 
	#RTPROT_XORP
 14

	)

247 
	#RTPROT_NTK
 15

	)

248 
	#RTPROT_DHCP
 16

	)

249 
	#RTPROT_MROUTED
 17

	)

250 
	#RTPROT_BABEL
 42

	)

263 
	e¹_scİe_t
 {

264 
	mRT_SCOPE_UNIVERSE
=0,

266 
	mRT_SCOPE_SITE
=200,

267 
	mRT_SCOPE_LINK
=253,

268 
	mRT_SCOPE_HOST
=254,

269 
	mRT_SCOPE_NOWHERE
=255

274 
	#RTM_F_NOTIFY
 0x100

	)

275 
	#RTM_F_CLONED
 0x200

	)

276 
	#RTM_F_EQUALIZE
 0x400

	)

277 
	#RTM_F_PREFIX
 0x800

	)

278 
	#RTM_F_LOOKUP_TABLE
 0x1000

	)

282 
	e¹_şass_t
 {

283 
	mRT_TABLE_UNSPEC
=0,

285 
	mRT_TABLE_COMPAT
=252,

286 
	mRT_TABLE_DEFAULT
=253,

287 
	mRT_TABLE_MAIN
=254,

288 
	mRT_TABLE_LOCAL
=255,

289 
	mRT_TABLE_MAX
=0xFFFFFFFF

295 
	e¹©Œ_ty³_t
 {

296 
	mRTA_UNSPEC
,

297 
	mRTA_DST
,

298 
	mRTA_SRC
,

299 
	mRTA_IIF
,

300 
	mRTA_OIF
,

301 
	mRTA_GATEWAY
,

302 
	mRTA_PRIORITY
,

303 
	mRTA_PREFSRC
,

304 
	mRTA_METRICS
,

305 
	mRTA_MULTIPATH
,

306 
	mRTA_PROTOINFO
,

307 
	mRTA_FLOW
,

308 
	mRTA_CACHEINFO
,

309 
	mRTA_SESSION
,

310 
	mRTA_MP_ALGO
,

311 
	mRTA_TABLE
,

312 
	mRTA_MARK
,

313 
	mRTA_MFC_STATS
,

314 
	mRTA_VIA
,

315 
	mRTA_NEWDST
,

316 
	mRTA_PREF
,

317 
	mRTA_ENCAP_TYPE
,

318 
	mRTA_ENCAP
,

319 
	mRTA_EXPIRES
,

320 
	mRTA_PAD
,

321 
	mRTA_UID
,

322 
	m__RTA_MAX


325 
	#RTA_MAX
 (
__RTA_MAX
 - 1)

	)

327 
	#RTM_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
¹msg
))))

	)

328 
	#RTM_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
¹msg
))

	)

339 
	s¹Ãxthİ
 {

340 
	m¹nh_Ën
;

341 
	m¹nh_æags
;

342 
	m¹nh_hİs
;

343 
	m¹nh_ifšdex
;

348 
	#RTNH_F_DEAD
 1

	)

349 
	#RTNH_F_PERVASIVE
 2

	)

350 
	#RTNH_F_ONLINK
 4

	)

351 
	#RTNH_F_OFFLOAD
 8

	)

352 
	#RTNH_F_LINKDOWN
 16

	)

354 
	#RTNH_COMPARE_MASK
 (
RTNH_F_DEAD
 | 
RTNH_F_LINKDOWN
 | 
RTNH_F_OFFLOAD
)

	)

358 
	#RTNH_ALIGNTO
 4

	)

359 
	#RTNH_ALIGN
(
Ën
èĞ(Ö’)+
RTNH_ALIGNTO
-1è& ~(RTNH_ALIGNTO-1è)

	)

360 
	#RTNH_OK
(
¹nh
,
Ën
è(ÔŠh)->
¹nh_Ën
 >ğ(
¹Ãxthİ
) && \

361 (()(
¹nh
)->
¹nh_Ën
è<ğ(
Ën
))

	)

362 
	#RTNH_NEXT
(
¹nh
è((
¹Ãxthİ
*)(((*)ÔŠh)è+ 
	`RTNH_ALIGN
(ÔŠh)->
¹nh_Ën
)))

	)

363 
	#RTNH_LENGTH
(
Ën
è(
	`RTNH_ALIGN
((
¹Ãxthİ
)è+ (Ën))

	)

364 
	#RTNH_SPACE
(
Ën
è
	`RTNH_ALIGN
(
	`RTNH_LENGTH
Ö’))

	)

365 
	#RTNH_DATA
(
¹nh
è((
¹©Œ
*)(((*)ÔŠh)è+ 
	`RTNH_LENGTH
(0)))

	)

368 
	s¹vŸ
 {

369 
__k”Ãl_§_çmy_t
 
	m¹vŸ_çmy
;

370 
__u8
 
	m¹vŸ_addr
[0];

375 
	s¹a_ÿchešfo
 {

376 
__u32
 
	m¹a_şÁ»f
;

377 
__u32
 
	m¹a_Ï¡u£
;

378 
__s32
 
	m¹a_expœes
;

379 
__u32
 
	m¹a_”rÜ
;

380 
__u32
 
	m¹a_u£d
;

382 
	#RTNETLINK_HAVE_PEERINFO
 1

	)

383 
__u32
 
	m¹a_id
;

384 
__u32
 
	m¹a_ts
;

385 
__u32
 
	m¹a_t§ge
;

391 
	mRTAX_UNSPEC
,

392 
	#RTAX_UNSPEC
 
RTAX_UNSPEC


	)

393 
	mRTAX_LOCK
,

394 
	#RTAX_LOCK
 
RTAX_LOCK


	)

395 
	mRTAX_MTU
,

396 
	#RTAX_MTU
 
RTAX_MTU


	)

397 
	mRTAX_WINDOW
,

398 
	#RTAX_WINDOW
 
RTAX_WINDOW


	)

399 
	mRTAX_RTT
,

400 
	#RTAX_RTT
 
RTAX_RTT


	)

401 
	mRTAX_RTTVAR
,

402 
	#RTAX_RTTVAR
 
RTAX_RTTVAR


	)

403 
	mRTAX_SSTHRESH
,

404 
	#RTAX_SSTHRESH
 
RTAX_SSTHRESH


	)

405 
	mRTAX_CWND
,

406 
	#RTAX_CWND
 
RTAX_CWND


	)

407 
	mRTAX_ADVMSS
,

408 
	#RTAX_ADVMSS
 
RTAX_ADVMSS


	)

409 
	mRTAX_REORDERING
,

410 
	#RTAX_REORDERING
 
RTAX_REORDERING


	)

411 
	mRTAX_HOPLIMIT
,

412 
	#RTAX_HOPLIMIT
 
RTAX_HOPLIMIT


	)

413 
	mRTAX_INITCWND
,

414 
	#RTAX_INITCWND
 
RTAX_INITCWND


	)

415 
	mRTAX_FEATURES
,

416 
	#RTAX_FEATURES
 
RTAX_FEATURES


	)

417 
	mRTAX_RTO_MIN
,

418 
	#RTAX_RTO_MIN
 
RTAX_RTO_MIN


	)

419 
	mRTAX_INITRWND
,

420 
	#RTAX_INITRWND
 
RTAX_INITRWND


	)

421 
	mRTAX_QUICKACK
,

422 
	#RTAX_QUICKACK
 
RTAX_QUICKACK


	)

423 
	mRTAX_CC_ALGO
,

424 
	#RTAX_CC_ALGO
 
RTAX_CC_ALGO


	)

425 
	m__RTAX_MAX


428 
	#RTAX_MAX
 (
__RTAX_MAX
 - 1)

	)

430 
	#RTAX_FEATURE_ECN
 (1 << 0)

	)

431 
	#RTAX_FEATURE_SACK
 (1 << 1)

	)

432 
	#RTAX_FEATURE_TIMESTAMP
 (1 << 2)

	)

433 
	#RTAX_FEATURE_ALLFRAG
 (1 << 3)

	)

435 
	#RTAX_FEATURE_MASK
 (
RTAX_FEATURE_ECN
 | 
RTAX_FEATURE_SACK
 | \

436 
RTAX_FEATURE_TIMESTAMP
 | 
RTAX_FEATURE_ALLFRAG
)

	)

438 
	s¹a_£ssiÚ
 {

439 
__u8
 
	m´Ùo
;

440 
__u8
 
	m·d1
;

441 
__u16
 
	m·d2
;

445 
__u16
 
	m¥Üt
;

446 
__u16
 
	mdpÜt
;

447 } 
	mpÜts
;

450 
__u8
 
	mty³
;

451 
__u8
 
	mcode
;

452 
__u16
 
	mid’t
;

453 } 
	micm±
;

455 
__u32
 
	m¥i
;

456 } 
	mu
;

459 
	s¹a_mfc_¡©s
 {

460 
__u64
 
	mmfcs_·ck‘s
;

461 
__u64
 
	mmfcs_by‹s
;

462 
__u64
 
	mmfcs_wrÚg_if
;

469 
	s¹g’msg
 {

470 
	m¹g’_çmy
;

482 
	sifšfomsg
 {

483 
	mifi_çmy
;

484 
	m__ifi_·d
;

485 
	mifi_ty³
;

486 
	mifi_šdex
;

487 
	mifi_æags
;

488 
	mifi_chªge
;

495 
	s´efixmsg
 {

496 
	m´efix_çmy
;

497 
	m´efix_·d1
;

498 
	m´efix_·d2
;

499 
	m´efix_ifšdex
;

500 
	m´efix_ty³
;

501 
	m´efix_Ën
;

502 
	m´efix_æags
;

503 
	m´efix_·d3
;

508 
	mPREFIX_UNSPEC
,

509 
	mPREFIX_ADDRESS
,

510 
	mPREFIX_CACHEINFO
,

511 
	m__PREFIX_MAX


514 
	#PREFIX_MAX
 (
__PREFIX_MAX
 - 1)

	)

516 
	s´efix_ÿchešfo
 {

517 
__u32
 
	m´eã¼ed_time
;

518 
__u32
 
	mv®id_time
;

526 
	stcmsg
 {

527 
	mtcm_çmy
;

528 
	mtcm__·d1
;

529 
	mtcm__·d2
;

530 
	mtcm_ifšdex
;

531 
__u32
 
	mtcm_hªdË
;

532 
__u32
 
	mtcm_·»Á
;

533 
__u32
 
	mtcm_šfo
;

537 
	mTCA_UNSPEC
,

538 
	mTCA_KIND
,

539 
	mTCA_OPTIONS
,

540 
	mTCA_STATS
,

541 
	mTCA_XSTATS
,

542 
	mTCA_RATE
,

543 
	mTCA_FCNT
,

544 
	mTCA_STATS2
,

545 
	mTCA_STAB
,

546 
	mTCA_PAD
,

547 
	m__TCA_MAX


550 
	#TCA_MAX
 (
__TCA_MAX
 - 1)

	)

552 
	#TCA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
tcmsg
))))

	)

553 
	#TCA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
tcmsg
))

	)

559 
	sndu£rİtmsg
 {

560 
	mndu£rİt_çmy
;

561 
	mndu£rİt_·d1
;

562 
	mndu£rİt_İts_Ën
;

563 
	mndu£rİt_ifšdex
;

564 
__u8
 
	mndu£rİt_icmp_ty³
;

565 
__u8
 
	mndu£rİt_icmp_code
;

566 
	mndu£rİt_·d2
;

567 
	mndu£rİt_·d3
;

572 
	mNDUSEROPT_UNSPEC
,

573 
	mNDUSEROPT_SRCADDR
,

574 
	m__NDUSEROPT_MAX


577 
	#NDUSEROPT_MAX
 (
__NDUSEROPT_MAX
 - 1)

	)

580 
	#RTMGRP_LINK
 1

	)

581 
	#RTMGRP_NOTIFY
 2

	)

582 
	#RTMGRP_NEIGH
 4

	)

583 
	#RTMGRP_TC
 8

	)

585 
	#RTMGRP_IPV4_IFADDR
 0x10

	)

586 
	#RTMGRP_IPV4_MROUTE
 0x20

	)

587 
	#RTMGRP_IPV4_ROUTE
 0x40

	)

588 
	#RTMGRP_IPV4_RULE
 0x80

	)

590 
	#RTMGRP_IPV6_IFADDR
 0x100

	)

591 
	#RTMGRP_IPV6_MROUTE
 0x200

	)

592 
	#RTMGRP_IPV6_ROUTE
 0x400

	)

593 
	#RTMGRP_IPV6_IFINFO
 0x800

	)

595 
	#RTMGRP_DECÃt_IFADDR
 0x1000

	)

596 
	#RTMGRP_DECÃt_ROUTE
 0x4000

	)

598 
	#RTMGRP_IPV6_PREFIX
 0x20000

	)

601 
	e¹Ãšk_groups
 {

602 
	mRTNLGRP_NONE
,

603 
	#RTNLGRP_NONE
 
RTNLGRP_NONE


	)

604 
	mRTNLGRP_LINK
,

605 
	#RTNLGRP_LINK
 
RTNLGRP_LINK


	)

606 
	mRTNLGRP_NOTIFY
,

607 
	#RTNLGRP_NOTIFY
 
RTNLGRP_NOTIFY


	)

608 
	mRTNLGRP_NEIGH
,

609 
	#RTNLGRP_NEIGH
 
RTNLGRP_NEIGH


	)

610 
	mRTNLGRP_TC
,

611 
	#RTNLGRP_TC
 
RTNLGRP_TC


	)

612 
	mRTNLGRP_IPV4_IFADDR
,

613 
	#RTNLGRP_IPV4_IFADDR
 
RTNLGRP_IPV4_IFADDR


	)

614 
	mRTNLGRP_IPV4_MROUTE
,

615 
	#RTNLGRP_IPV4_MROUTE
 
RTNLGRP_IPV4_MROUTE


	)

616 
	mRTNLGRP_IPV4_ROUTE
,

617 
	#RTNLGRP_IPV4_ROUTE
 
RTNLGRP_IPV4_ROUTE


	)

618 
	mRTNLGRP_IPV4_RULE
,

619 
	#RTNLGRP_IPV4_RULE
 
RTNLGRP_IPV4_RULE


	)

620 
	mRTNLGRP_IPV6_IFADDR
,

621 
	#RTNLGRP_IPV6_IFADDR
 
RTNLGRP_IPV6_IFADDR


	)

622 
	mRTNLGRP_IPV6_MROUTE
,

623 
	#RTNLGRP_IPV6_MROUTE
 
RTNLGRP_IPV6_MROUTE


	)

624 
	mRTNLGRP_IPV6_ROUTE
,

625 
	#RTNLGRP_IPV6_ROUTE
 
RTNLGRP_IPV6_ROUTE


	)

626 
	mRTNLGRP_IPV6_IFINFO
,

627 
	#RTNLGRP_IPV6_IFINFO
 
RTNLGRP_IPV6_IFINFO


	)

628 
	mRTNLGRP_DECÃt_IFADDR
,

629 
	#RTNLGRP_DECÃt_IFADDR
 
RTNLGRP_DECÃt_IFADDR


	)

630 
	mRTNLGRP_NOP2
,

631 
	mRTNLGRP_DECÃt_ROUTE
,

632 
	#RTNLGRP_DECÃt_ROUTE
 
RTNLGRP_DECÃt_ROUTE


	)

633 
	mRTNLGRP_DECÃt_RULE
,

634 
	#RTNLGRP_DECÃt_RULE
 
RTNLGRP_DECÃt_RULE


	)

635 
	mRTNLGRP_NOP4
,

636 
	mRTNLGRP_IPV6_PREFIX
,

637 
	#RTNLGRP_IPV6_PREFIX
 
RTNLGRP_IPV6_PREFIX


	)

638 
	mRTNLGRP_IPV6_RULE
,

639 
	#RTNLGRP_IPV6_RULE
 
RTNLGRP_IPV6_RULE


	)

640 
	mRTNLGRP_ND_USEROPT
,

641 
	#RTNLGRP_ND_USEROPT
 
RTNLGRP_ND_USEROPT


	)

642 
	mRTNLGRP_PHONET_IFADDR
,

643 
	#RTNLGRP_PHONET_IFADDR
 
RTNLGRP_PHONET_IFADDR


	)

644 
	mRTNLGRP_PHONET_ROUTE
,

645 
	#RTNLGRP_PHONET_ROUTE
 
RTNLGRP_PHONET_ROUTE


	)

646 
	mRTNLGRP_DCB
,

647 
	#RTNLGRP_DCB
 
RTNLGRP_DCB


	)

648 
	mRTNLGRP_IPV4_NETCONF
,

649 
	#RTNLGRP_IPV4_NETCONF
 
RTNLGRP_IPV4_NETCONF


	)

650 
	mRTNLGRP_IPV6_NETCONF
,

651 
	#RTNLGRP_IPV6_NETCONF
 
RTNLGRP_IPV6_NETCONF


	)

652 
	mRTNLGRP_MDB
,

653 
	#RTNLGRP_MDB
 
RTNLGRP_MDB


	)

654 
	mRTNLGRP_MPLS_ROUTE
,

655 
	#RTNLGRP_MPLS_ROUTE
 
RTNLGRP_MPLS_ROUTE


	)

656 
	mRTNLGRP_NSID
,

657 
	#RTNLGRP_NSID
 
RTNLGRP_NSID


	)

658 
	m__RTNLGRP_MAX


660 
	#RTNLGRP_MAX
 (
__RTNLGRP_MAX
 - 1)

	)

663 
	stÿmsg
 {

664 
	mtÿ_çmy
;

665 
	mtÿ__·d1
;

666 
	mtÿ__·d2
;

668 
	#TA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
tÿmsg
))))

	)

669 
	#TA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
tÿmsg
))

	)

670 
	#TCA_ACT_TAB
 1

	)

671 
	#TCAA_MAX
 1

	)

674 
	#RTEXT_FILTER_VF
 (1 << 0)

	)

675 
	#RTEXT_FILTER_BRVLAN
 (1 << 1)

	)

676 
	#RTEXT_FILTER_BRVLAN_COMPRESSED
 (1 << 2)

	)

677 
	#RTEXT_FILTER_SKIP_STATS
 (1 << 3)

	)

	@/usr/include/linux/times.h

1 #iâdeà
_LINUX_TIMES_H


2 
	#_LINUX_TIMES_H


	)

4 
	~<lšux/ty³s.h
>

6 
	stms
 {

7 
__k”Ãl_şock_t
 
	mtms_utime
;

8 
__k”Ãl_şock_t
 
	mtms_¡ime
;

9 
__k”Ãl_şock_t
 
	mtms_cutime
;

10 
__k”Ãl_şock_t
 
	mtms_c¡ime
;

	@/usr/include/linux/unistd.h

1 #iâdeà
_LINUX_UNISTD_H_


2 
	#_LINUX_UNISTD_H_


	)

7 
	~<asm/uni¡d.h
>

	@/usr/include/linux/version.h

1 
	#LINUX_VERSION_CODE
 264721

	)

2 
	#KERNEL_VERSION
(
a
,
b
,
c
è((×è<< 16è+ ((bè<< 8è+ (c))

	)

	@/usr/include/asm/unistd_32.h

1 #iâdeà
_ASM_X86_UNISTD_32_H


2 
	#_ASM_X86_UNISTD_32_H
 1

	)

4 
	#__NR_»¡¬t_sysÿÎ
 0

	)

5 
	#__NR_ex™
 1

	)

6 
	#__NR_fÜk
 2

	)

7 
	#__NR_»ad
 3

	)

8 
	#__NR_wr™e
 4

	)

9 
	#__NR_İ’
 5

	)

10 
	#__NR_şo£
 6

	)

11 
	#__NR_wa™pid
 7

	)

12 
	#__NR_ü—t
 8

	)

13 
	#__NR_lšk
 9

	)

14 
	#__NR_uÆšk
 10

	)

15 
	#__NR_execve
 11

	)

16 
	#__NR_chdœ
 12

	)

17 
	#__NR_time
 13

	)

18 
	#__NR_mknod
 14

	)

19 
	#__NR_chmod
 15

	)

20 
	#__NR_lchown
 16

	)

21 
	#__NR_b»ak
 17

	)

22 
	#__NR_Şd¡©
 18

	)

23 
	#__NR_l£ek
 19

	)

24 
	#__NR_g‘pid
 20

	)

25 
	#__NR_mouÁ
 21

	)

26 
	#__NR_umouÁ
 22

	)

27 
	#__NR_£tuid
 23

	)

28 
	#__NR_g‘uid
 24

	)

29 
	#__NR_¡ime
 25

	)

30 
	#__NR_±¿û
 26

	)

31 
	#__NR_®¬m
 27

	)

32 
	#__NR_Şdf¡©
 28

	)

33 
	#__NR_·u£
 29

	)

34 
	#__NR_utime
 30

	)

35 
	#__NR_¡ty
 31

	)

36 
	#__NR_g‰y
 32

	)

37 
	#__NR_acûss
 33

	)

38 
	#__NR_niû
 34

	)

39 
	#__NR_áime
 35

	)

40 
	#__NR_sync
 36

	)

41 
	#__NR_kl
 37

	)

42 
	#__NR_»Çme
 38

	)

43 
	#__NR_mkdœ
 39

	)

44 
	#__NR_rmdœ
 40

	)

45 
	#__NR_dup
 41

	)

46 
	#__NR_pe
 42

	)

47 
	#__NR_times
 43

	)

48 
	#__NR_´of
 44

	)

49 
	#__NR_brk
 45

	)

50 
	#__NR_£tgid
 46

	)

51 
	#__NR_g‘gid
 47

	)

52 
	#__NR_sigÇl
 48

	)

53 
	#__NR_g‘euid
 49

	)

54 
	#__NR_g‘egid
 50

	)

55 
	#__NR_acù
 51

	)

56 
	#__NR_umouÁ2
 52

	)

57 
	#__NR_lock
 53

	)

58 
	#__NR_ioùl
 54

	)

59 
	#__NR_fú
 55

	)

60 
	#__NR_mpx
 56

	)

61 
	#__NR_£gid
 57

	)

62 
	#__NR_ulim™
 58

	)

63 
	#__NR_ŞdŞduÇme
 59

	)

64 
	#__NR_umask
 60

	)

65 
	#__NR_chroÙ
 61

	)

66 
	#__NR_u¡©
 62

	)

67 
	#__NR_dup2
 63

	)

68 
	#__NR_g‘µid
 64

	)

69 
	#__NR_g‘pg½
 65

	)

70 
	#__NR_£tsid
 66

	)

71 
	#__NR_sigaùiÚ
 67

	)

72 
	#__NR_sg‘mask
 68

	)

73 
	#__NR_s£tmask
 69

	)

74 
	#__NR_£Œeuid
 70

	)

75 
	#__NR_£Œegid
 71

	)

76 
	#__NR_sigsu¥’d
 72

	)

77 
	#__NR_sig³ndšg
 73

	)

78 
	#__NR_£tho¡Çme
 74

	)

79 
	#__NR_£Œlim™
 75

	)

80 
	#__NR_g‘¾im™
 76

	)

81 
	#__NR_g‘ru§ge
 77

	)

82 
	#__NR_g‘timeofday
 78

	)

83 
	#__NR_£‰imeofday
 79

	)

84 
	#__NR_g‘groups
 80

	)

85 
	#__NR_£tgroups
 81

	)

86 
	#__NR_£Ëù
 82

	)

87 
	#__NR_symlšk
 83

	)

88 
	#__NR_Şdl¡©
 84

	)

89 
	#__NR_»adlšk
 85

	)

90 
	#__NR_u£lib
 86

	)

91 
	#__NR_sw­Ú
 87

	)

92 
	#__NR_»boÙ
 88

	)

93 
	#__NR_»addœ
 89

	)

94 
	#__NR_mm­
 90

	)

95 
	#__NR_munm­
 91

	)

96 
	#__NR_Œunÿ‹
 92

	)

97 
	#__NR_árunÿ‹
 93

	)

98 
	#__NR_fchmod
 94

	)

99 
	#__NR_fchown
 95

	)

100 
	#__NR_g‘´iÜ™y
 96

	)

101 
	#__NR_£riÜ™y
 97

	)

102 
	#__NR_´of
 98

	)

103 
	#__NR_¡©fs
 99

	)

104 
	#__NR_f¡©fs
 100

	)

105 
	#__NR_iİ”m
 101

	)

106 
	#__NR_sock‘ÿÎ
 102

	)

107 
	#__NR_sy¦og
 103

	)

108 
	#__NR_£t™im”
 104

	)

109 
	#__NR_g‘™im”
 105

	)

110 
	#__NR_¡©
 106

	)

111 
	#__NR_l¡©
 107

	)

112 
	#__NR_f¡©
 108

	)

113 
	#__NR_ŞduÇme
 109

	)

114 
	#__NR_iİl
 110

	)

115 
	#__NR_vhªgup
 111

	)

116 
	#__NR_idË
 112

	)

117 
	#__NR_vm86Şd
 113

	)

118 
	#__NR_wa™4
 114

	)

119 
	#__NR_sw­off
 115

	)

120 
	#__NR_sysšfo
 116

	)

121 
	#__NR_c
 117

	)

122 
	#__NR_fsync
 118

	)

123 
	#__NR_sig»tuº
 119

	)

124 
	#__NR_şÚe
 120

	)

125 
	#__NR_£tdomašÇme
 121

	)

126 
	#__NR_uÇme
 122

	)

127 
	#__NR_modify_ldt
 123

	)

128 
	#__NR_adjtimex
 124

	)

129 
	#__NR_m´Ùeù
 125

	)

130 
	#__NR_sig´ocmask
 126

	)

131 
	#__NR_ü—‹_moduË
 127

	)

132 
	#__NR_š™_moduË
 128

	)

133 
	#__NR_d–‘e_moduË
 129

	)

134 
	#__NR_g‘_k”Ãl_syms
 130

	)

135 
	#__NR_quÙaùl
 131

	)

136 
	#__NR_g‘pgid
 132

	)

137 
	#__NR_fchdœ
 133

	)

138 
	#__NR_bdæush
 134

	)

139 
	#__NR_sysfs
 135

	)

140 
	#__NR_³rsÚ®™y
 136

	)

141 
	#__NR_afs_sysÿÎ
 137

	)

142 
	#__NR_£tfsuid
 138

	)

143 
	#__NR_£tfsgid
 139

	)

144 
	#__NR__Î£ek
 140

	)

145 
	#__NR_g‘d’ts
 141

	)

146 
	#__NR__Ãw£Ëù
 142

	)

147 
	#__NR_æock
 143

	)

148 
	#__NR_msync
 144

	)

149 
	#__NR_»adv
 145

	)

150 
	#__NR_wr™ev
 146

	)

151 
	#__NR_g‘sid
 147

	)

152 
	#__NR_fd©async
 148

	)

153 
	#__NR__sysùl
 149

	)

154 
	#__NR_mlock
 150

	)

155 
	#__NR_muÆock
 151

	)

156 
	#__NR_mlock®l
 152

	)

157 
	#__NR_muÆock®l
 153

	)

158 
	#__NR_sched_£¬am
 154

	)

159 
	#__NR_sched_g‘·¿m
 155

	)

160 
	#__NR_sched_£tscheduËr
 156

	)

161 
	#__NR_sched_g‘scheduËr
 157

	)

162 
	#__NR_sched_y›ld
 158

	)

163 
	#__NR_sched_g‘_´iÜ™y_max
 159

	)

164 
	#__NR_sched_g‘_´iÜ™y_mš
 160

	)

165 
	#__NR_sched_¼_g‘_š‹rv®
 161

	)

166 
	#__NR_Çno¦“p
 162

	)

167 
	#__NR_m»m­
 163

	)

168 
	#__NR_£Œesuid
 164

	)

169 
	#__NR_g‘»suid
 165

	)

170 
	#__NR_vm86
 166

	)

171 
	#__NR_qu”y_moduË
 167

	)

172 
	#__NR_pŞl
 168

	)

173 
	#__NR_nfs£rvùl
 169

	)

174 
	#__NR_£Œesgid
 170

	)

175 
	#__NR_g‘»sgid
 171

	)

176 
	#__NR_´ùl
 172

	)

177 
	#__NR_¹_sig»tuº
 173

	)

178 
	#__NR_¹_sigaùiÚ
 174

	)

179 
	#__NR_¹_sig´ocmask
 175

	)

180 
	#__NR_¹_sig³ndšg
 176

	)

181 
	#__NR_¹_sigtimedwa™
 177

	)

182 
	#__NR_¹_sigqueuešfo
 178

	)

183 
	#__NR_¹_sigsu¥’d
 179

	)

184 
	#__NR_´—d64
 180

	)

185 
	#__NR_pwr™e64
 181

	)

186 
	#__NR_chown
 182

	)

187 
	#__NR_g‘cwd
 183

	)

188 
	#__NR_ÿpg‘
 184

	)

189 
	#__NR_ÿp£t
 185

	)

190 
	#__NR_sig®t¡ack
 186

	)

191 
	#__NR_£ndfe
 187

	)

192 
	#__NR_g‘pmsg
 188

	)

193 
	#__NR_pumsg
 189

	)

194 
	#__NR_vfÜk
 190

	)

195 
	#__NR_ug‘¾im™
 191

	)

196 
	#__NR_mm­2
 192

	)

197 
	#__NR_Œunÿ‹64
 193

	)

198 
	#__NR_árunÿ‹64
 194

	)

199 
	#__NR_¡©64
 195

	)

200 
	#__NR_l¡©64
 196

	)

201 
	#__NR_f¡©64
 197

	)

202 
	#__NR_lchown32
 198

	)

203 
	#__NR_g‘uid32
 199

	)

204 
	#__NR_g‘gid32
 200

	)

205 
	#__NR_g‘euid32
 201

	)

206 
	#__NR_g‘egid32
 202

	)

207 
	#__NR_£Œeuid32
 203

	)

208 
	#__NR_£Œegid32
 204

	)

209 
	#__NR_g‘groups32
 205

	)

210 
	#__NR_£tgroups32
 206

	)

211 
	#__NR_fchown32
 207

	)

212 
	#__NR_£Œesuid32
 208

	)

213 
	#__NR_g‘»suid32
 209

	)

214 
	#__NR_£Œesgid32
 210

	)

215 
	#__NR_g‘»sgid32
 211

	)

216 
	#__NR_chown32
 212

	)

217 
	#__NR_£tuid32
 213

	)

218 
	#__NR_£tgid32
 214

	)

219 
	#__NR_£tfsuid32
 215

	)

220 
	#__NR_£tfsgid32
 216

	)

221 
	#__NR_pivÙ_roÙ
 217

	)

222 
	#__NR_mšcÜe
 218

	)

223 
	#__NR_madvi£
 219

	)

224 
	#__NR_g‘d’ts64
 220

	)

225 
	#__NR_fú64
 221

	)

226 
	#__NR_g‘tid
 224

	)

227 
	#__NR_»adah—d
 225

	)

228 
	#__NR_£tx©Œ
 226

	)

229 
	#__NR_l£tx©Œ
 227

	)

230 
	#__NR_f£tx©Œ
 228

	)

231 
	#__NR_g‘x©Œ
 229

	)

232 
	#__NR_lg‘x©Œ
 230

	)

233 
	#__NR_fg‘x©Œ
 231

	)

234 
	#__NR_li¡x©Œ
 232

	)

235 
	#__NR_Îi¡x©Œ
 233

	)

236 
	#__NR_æi¡x©Œ
 234

	)

237 
	#__NR_»movex©Œ
 235

	)

238 
	#__NR_Ìemovex©Œ
 236

	)

239 
	#__NR_äemovex©Œ
 237

	)

240 
	#__NR_tkl
 238

	)

241 
	#__NR_£ndfe64
 239

	)

242 
	#__NR_fu‹x
 240

	)

243 
	#__NR_sched_£ffš™y
 241

	)

244 
	#__NR_sched_g‘affš™y
 242

	)

245 
	#__NR_£t_th»ad_¬—
 243

	)

246 
	#__NR_g‘_th»ad_¬—
 244

	)

247 
	#__NR_io_£tup
 245

	)

248 
	#__NR_io_de¡roy
 246

	)

249 
	#__NR_io_g‘ev’ts
 247

	)

250 
	#__NR_io_subm™
 248

	)

251 
	#__NR_io_ÿnûl
 249

	)

252 
	#__NR_çdvi£64
 250

	)

253 
	#__NR_ex™_group
 252

	)

254 
	#__NR_lookup_dcook›
 253

	)

255 
	#__NR_•Şl_ü—‹
 254

	)

256 
	#__NR_•Şl_ùl
 255

	)

257 
	#__NR_•Şl_wa™
 256

	)

258 
	#__NR_»m­_fe_·ges
 257

	)

259 
	#__NR_£t_tid_add»ss
 258

	)

260 
	#__NR_tim”_ü—‹
 259

	)

261 
	#__NR_tim”_£‰ime
 260

	)

262 
	#__NR_tim”_g‘time
 261

	)

263 
	#__NR_tim”_g‘ov”run
 262

	)

264 
	#__NR_tim”_d–‘e
 263

	)

265 
	#__NR_şock_£‰ime
 264

	)

266 
	#__NR_şock_g‘time
 265

	)

267 
	#__NR_şock_g‘»s
 266

	)

268 
	#__NR_şock_Çno¦“p
 267

	)

269 
	#__NR_¡©fs64
 268

	)

270 
	#__NR_f¡©fs64
 269

	)

271 
	#__NR_tgkl
 270

	)

272 
	#__NR_utimes
 271

	)

273 
	#__NR_çdvi£64_64
 272

	)

274 
	#__NR_v£rv”
 273

	)

275 
	#__NR_mbšd
 274

	)

276 
	#__NR_g‘_mempŞicy
 275

	)

277 
	#__NR_£t_mempŞicy
 276

	)

278 
	#__NR_mq_İ’
 277

	)

279 
	#__NR_mq_uÆšk
 278

	)

280 
	#__NR_mq_timed£nd
 279

	)

281 
	#__NR_mq_timed»ûive
 280

	)

282 
	#__NR_mq_nÙify
 281

	)

283 
	#__NR_mq_g‘£‰r
 282

	)

284 
	#__NR_kexec_lßd
 283

	)

285 
	#__NR_wa™id
 284

	)

286 
	#__NR_add_key
 286

	)

287 
	#__NR_»que¡_key
 287

	)

288 
	#__NR_keyùl
 288

	)

289 
	#__NR_iİrio_£t
 289

	)

290 
	#__NR_iİrio_g‘
 290

	)

291 
	#__NR_šÙify_š™
 291

	)

292 
	#__NR_šÙify_add_w©ch
 292

	)

293 
	#__NR_šÙify_rm_w©ch
 293

	)

294 
	#__NR_mig¿‹_·ges
 294

	)

295 
	#__NR_İ’©
 295

	)

296 
	#__NR_mkdœ©
 296

	)

297 
	#__NR_mknod©
 297

	)

298 
	#__NR_fchowÇt
 298

	)

299 
	#__NR_futime§t
 299

	)

300 
	#__NR_f¡©©64
 300

	)

301 
	#__NR_uÆšk©
 301

	)

302 
	#__NR_»Çm—t
 302

	)

303 
	#__NR_lšk©
 303

	)

304 
	#__NR_symlšk©
 304

	)

305 
	#__NR_»adlšk©
 305

	)

306 
	#__NR_fchmod©
 306

	)

307 
	#__NR_çcûs§t
 307

	)

308 
	#__NR_p£Ëù6
 308

	)

309 
	#__NR_µŞl
 309

	)

310 
	#__NR_unsh¬e
 310

	)

311 
	#__NR_£t_robu¡_li¡
 311

	)

312 
	#__NR_g‘_robu¡_li¡
 312

	)

313 
	#__NR_¥liû
 313

	)

314 
	#__NR_sync_fe_¿nge
 314

	)

315 
	#__NR_‹e
 315

	)

316 
	#__NR_vm¥liû
 316

	)

317 
	#__NR_move_·ges
 317

	)

318 
	#__NR_g‘ıu
 318

	)

319 
	#__NR_•Şl_pwa™
 319

	)

320 
	#__NR_utim’§t
 320

	)

321 
	#__NR_sigÇlfd
 321

	)

322 
	#__NR_tim”fd_ü—‹
 322

	)

323 
	#__NR_ev’tfd
 323

	)

324 
	#__NR_çÎoÿ‹
 324

	)

325 
	#__NR_tim”fd_£‰ime
 325

	)

326 
	#__NR_tim”fd_g‘time
 326

	)

327 
	#__NR_sigÇlfd4
 327

	)

328 
	#__NR_ev’tfd2
 328

	)

329 
	#__NR_•Şl_ü—‹1
 329

	)

330 
	#__NR_dup3
 330

	)

331 
	#__NR_pe2
 331

	)

332 
	#__NR_šÙify_š™1
 332

	)

333 
	#__NR_´—dv
 333

	)

334 
	#__NR_pwr™ev
 334

	)

335 
	#__NR_¹_tgsigqueuešfo
 335

	)

336 
	#__NR_³rf_ev’t_İ’
 336

	)

337 
	#__NR_»cvmmsg
 337

	)

338 
	#__NR_çnÙify_š™
 338

	)

339 
	#__NR_çnÙify_m¬k
 339

	)

340 
	#__NR_´lim™64
 340

	)

341 
	#__NR_Çme_to_hªdË_©
 341

	)

342 
	#__NR_İ’_by_hªdË_©
 342

	)

343 
	#__NR_şock_adjtime
 343

	)

344 
	#__NR_syncfs
 344

	)

345 
	#__NR_£ndmmsg
 345

	)

346 
	#__NR_£Šs
 346

	)

347 
	#__NR_´oûss_vm_»adv
 347

	)

348 
	#__NR_´oûss_vm_wr™ev
 348

	)

349 
	#__NR_kcmp
 349

	)

350 
	#__NR_fš™_moduË
 350

	)

351 
	#__NR_sched_£‰r
 351

	)

352 
	#__NR_sched_g‘©Œ
 352

	)

353 
	#__NR_»Çm—t2
 353

	)

354 
	#__NR_£ccomp
 354

	)

355 
	#__NR_g‘¿ndom
 355

	)

356 
	#__NR_memfd_ü—‹
 356

	)

357 
	#__NR_bpf
 357

	)

358 
	#__NR_execv—t
 358

	)

359 
	#__NR_sock‘
 359

	)

360 
	#__NR_sock‘·œ
 360

	)

361 
	#__NR_bšd
 361

	)

362 
	#__NR_cÚÃù
 362

	)

363 
	#__NR_li¡’
 363

	)

364 
	#__NR_acû±4
 364

	)

365 
	#__NR_g‘sockİt
 365

	)

366 
	#__NR_£tsockİt
 366

	)

367 
	#__NR_g‘sockÇme
 367

	)

368 
	#__NR_g‘³”Çme
 368

	)

369 
	#__NR_£ndto
 369

	)

370 
	#__NR_£ndmsg
 370

	)

371 
	#__NR_»cväom
 371

	)

372 
	#__NR_»cvmsg
 372

	)

373 
	#__NR_shutdown
 373

	)

374 
	#__NR_u£rçuÉfd
 374

	)

375 
	#__NR_memb¬r›r
 375

	)

376 
	#__NR_mlock2
 376

	)

377 
	#__NR_cİy_fe_¿nge
 377

	)

378 
	#__NR_´—dv2
 378

	)

379 
	#__NR_pwr™ev2
 379

	)

380 
	#__NR_pkey_m´Ùeù
 380

	)

381 
	#__NR_pkey_®loc
 381

	)

382 
	#__NR_pkey_ä“
 382

	)

	@/usr/include/asm/unistd_64.h

1 #iâdeà
_ASM_X86_UNISTD_64_H


2 
	#_ASM_X86_UNISTD_64_H
 1

	)

4 
	#__NR_»ad
 0

	)

5 
	#__NR_wr™e
 1

	)

6 
	#__NR_İ’
 2

	)

7 
	#__NR_şo£
 3

	)

8 
	#__NR_¡©
 4

	)

9 
	#__NR_f¡©
 5

	)

10 
	#__NR_l¡©
 6

	)

11 
	#__NR_pŞl
 7

	)

12 
	#__NR_l£ek
 8

	)

13 
	#__NR_mm­
 9

	)

14 
	#__NR_m´Ùeù
 10

	)

15 
	#__NR_munm­
 11

	)

16 
	#__NR_brk
 12

	)

17 
	#__NR_¹_sigaùiÚ
 13

	)

18 
	#__NR_¹_sig´ocmask
 14

	)

19 
	#__NR_¹_sig»tuº
 15

	)

20 
	#__NR_ioùl
 16

	)

21 
	#__NR_´—d64
 17

	)

22 
	#__NR_pwr™e64
 18

	)

23 
	#__NR_»adv
 19

	)

24 
	#__NR_wr™ev
 20

	)

25 
	#__NR_acûss
 21

	)

26 
	#__NR_pe
 22

	)

27 
	#__NR_£Ëù
 23

	)

28 
	#__NR_sched_y›ld
 24

	)

29 
	#__NR_m»m­
 25

	)

30 
	#__NR_msync
 26

	)

31 
	#__NR_mšcÜe
 27

	)

32 
	#__NR_madvi£
 28

	)

33 
	#__NR_shmg‘
 29

	)

34 
	#__NR_shm©
 30

	)

35 
	#__NR_shmùl
 31

	)

36 
	#__NR_dup
 32

	)

37 
	#__NR_dup2
 33

	)

38 
	#__NR_·u£
 34

	)

39 
	#__NR_Çno¦“p
 35

	)

40 
	#__NR_g‘™im”
 36

	)

41 
	#__NR_®¬m
 37

	)

42 
	#__NR_£t™im”
 38

	)

43 
	#__NR_g‘pid
 39

	)

44 
	#__NR_£ndfe
 40

	)

45 
	#__NR_sock‘
 41

	)

46 
	#__NR_cÚÃù
 42

	)

47 
	#__NR_acû±
 43

	)

48 
	#__NR_£ndto
 44

	)

49 
	#__NR_»cväom
 45

	)

50 
	#__NR_£ndmsg
 46

	)

51 
	#__NR_»cvmsg
 47

	)

52 
	#__NR_shutdown
 48

	)

53 
	#__NR_bšd
 49

	)

54 
	#__NR_li¡’
 50

	)

55 
	#__NR_g‘sockÇme
 51

	)

56 
	#__NR_g‘³”Çme
 52

	)

57 
	#__NR_sock‘·œ
 53

	)

58 
	#__NR_£tsockİt
 54

	)

59 
	#__NR_g‘sockİt
 55

	)

60 
	#__NR_şÚe
 56

	)

61 
	#__NR_fÜk
 57

	)

62 
	#__NR_vfÜk
 58

	)

63 
	#__NR_execve
 59

	)

64 
	#__NR_ex™
 60

	)

65 
	#__NR_wa™4
 61

	)

66 
	#__NR_kl
 62

	)

67 
	#__NR_uÇme
 63

	)

68 
	#__NR_£mg‘
 64

	)

69 
	#__NR_£mİ
 65

	)

70 
	#__NR_£mùl
 66

	)

71 
	#__NR_shmdt
 67

	)

72 
	#__NR_msgg‘
 68

	)

73 
	#__NR_msg¢d
 69

	)

74 
	#__NR_msgrcv
 70

	)

75 
	#__NR_msgùl
 71

	)

76 
	#__NR_fú
 72

	)

77 
	#__NR_æock
 73

	)

78 
	#__NR_fsync
 74

	)

79 
	#__NR_fd©async
 75

	)

80 
	#__NR_Œunÿ‹
 76

	)

81 
	#__NR_árunÿ‹
 77

	)

82 
	#__NR_g‘d’ts
 78

	)

83 
	#__NR_g‘cwd
 79

	)

84 
	#__NR_chdœ
 80

	)

85 
	#__NR_fchdœ
 81

	)

86 
	#__NR_»Çme
 82

	)

87 
	#__NR_mkdœ
 83

	)

88 
	#__NR_rmdœ
 84

	)

89 
	#__NR_ü—t
 85

	)

90 
	#__NR_lšk
 86

	)

91 
	#__NR_uÆšk
 87

	)

92 
	#__NR_symlšk
 88

	)

93 
	#__NR_»adlšk
 89

	)

94 
	#__NR_chmod
 90

	)

95 
	#__NR_fchmod
 91

	)

96 
	#__NR_chown
 92

	)

97 
	#__NR_fchown
 93

	)

98 
	#__NR_lchown
 94

	)

99 
	#__NR_umask
 95

	)

100 
	#__NR_g‘timeofday
 96

	)

101 
	#__NR_g‘¾im™
 97

	)

102 
	#__NR_g‘ru§ge
 98

	)

103 
	#__NR_sysšfo
 99

	)

104 
	#__NR_times
 100

	)

105 
	#__NR_±¿û
 101

	)

106 
	#__NR_g‘uid
 102

	)

107 
	#__NR_sy¦og
 103

	)

108 
	#__NR_g‘gid
 104

	)

109 
	#__NR_£tuid
 105

	)

110 
	#__NR_£tgid
 106

	)

111 
	#__NR_g‘euid
 107

	)

112 
	#__NR_g‘egid
 108

	)

113 
	#__NR_£gid
 109

	)

114 
	#__NR_g‘µid
 110

	)

115 
	#__NR_g‘pg½
 111

	)

116 
	#__NR_£tsid
 112

	)

117 
	#__NR_£Œeuid
 113

	)

118 
	#__NR_£Œegid
 114

	)

119 
	#__NR_g‘groups
 115

	)

120 
	#__NR_£tgroups
 116

	)

121 
	#__NR_£Œesuid
 117

	)

122 
	#__NR_g‘»suid
 118

	)

123 
	#__NR_£Œesgid
 119

	)

124 
	#__NR_g‘»sgid
 120

	)

125 
	#__NR_g‘pgid
 121

	)

126 
	#__NR_£tfsuid
 122

	)

127 
	#__NR_£tfsgid
 123

	)

128 
	#__NR_g‘sid
 124

	)

129 
	#__NR_ÿpg‘
 125

	)

130 
	#__NR_ÿp£t
 126

	)

131 
	#__NR_¹_sig³ndšg
 127

	)

132 
	#__NR_¹_sigtimedwa™
 128

	)

133 
	#__NR_¹_sigqueuešfo
 129

	)

134 
	#__NR_¹_sigsu¥’d
 130

	)

135 
	#__NR_sig®t¡ack
 131

	)

136 
	#__NR_utime
 132

	)

137 
	#__NR_mknod
 133

	)

138 
	#__NR_u£lib
 134

	)

139 
	#__NR_³rsÚ®™y
 135

	)

140 
	#__NR_u¡©
 136

	)

141 
	#__NR_¡©fs
 137

	)

142 
	#__NR_f¡©fs
 138

	)

143 
	#__NR_sysfs
 139

	)

144 
	#__NR_g‘´iÜ™y
 140

	)

145 
	#__NR_£riÜ™y
 141

	)

146 
	#__NR_sched_£¬am
 142

	)

147 
	#__NR_sched_g‘·¿m
 143

	)

148 
	#__NR_sched_£tscheduËr
 144

	)

149 
	#__NR_sched_g‘scheduËr
 145

	)

150 
	#__NR_sched_g‘_´iÜ™y_max
 146

	)

151 
	#__NR_sched_g‘_´iÜ™y_mš
 147

	)

152 
	#__NR_sched_¼_g‘_š‹rv®
 148

	)

153 
	#__NR_mlock
 149

	)

154 
	#__NR_muÆock
 150

	)

155 
	#__NR_mlock®l
 151

	)

156 
	#__NR_muÆock®l
 152

	)

157 
	#__NR_vhªgup
 153

	)

158 
	#__NR_modify_ldt
 154

	)

159 
	#__NR_pivÙ_roÙ
 155

	)

160 
	#__NR__sysùl
 156

	)

161 
	#__NR_´ùl
 157

	)

162 
	#__NR_¬ch_´ùl
 158

	)

163 
	#__NR_adjtimex
 159

	)

164 
	#__NR_£Œlim™
 160

	)

165 
	#__NR_chroÙ
 161

	)

166 
	#__NR_sync
 162

	)

167 
	#__NR_acù
 163

	)

168 
	#__NR_£‰imeofday
 164

	)

169 
	#__NR_mouÁ
 165

	)

170 
	#__NR_umouÁ2
 166

	)

171 
	#__NR_sw­Ú
 167

	)

172 
	#__NR_sw­off
 168

	)

173 
	#__NR_»boÙ
 169

	)

174 
	#__NR_£tho¡Çme
 170

	)

175 
	#__NR_£tdomašÇme
 171

	)

176 
	#__NR_iİl
 172

	)

177 
	#__NR_iİ”m
 173

	)

178 
	#__NR_ü—‹_moduË
 174

	)

179 
	#__NR_š™_moduË
 175

	)

180 
	#__NR_d–‘e_moduË
 176

	)

181 
	#__NR_g‘_k”Ãl_syms
 177

	)

182 
	#__NR_qu”y_moduË
 178

	)

183 
	#__NR_quÙaùl
 179

	)

184 
	#__NR_nfs£rvùl
 180

	)

185 
	#__NR_g‘pmsg
 181

	)

186 
	#__NR_pumsg
 182

	)

187 
	#__NR_afs_sysÿÎ
 183

	)

188 
	#__NR_tuxÿÎ
 184

	)

189 
	#__NR_£cur™y
 185

	)

190 
	#__NR_g‘tid
 186

	)

191 
	#__NR_»adah—d
 187

	)

192 
	#__NR_£tx©Œ
 188

	)

193 
	#__NR_l£tx©Œ
 189

	)

194 
	#__NR_f£tx©Œ
 190

	)

195 
	#__NR_g‘x©Œ
 191

	)

196 
	#__NR_lg‘x©Œ
 192

	)

197 
	#__NR_fg‘x©Œ
 193

	)

198 
	#__NR_li¡x©Œ
 194

	)

199 
	#__NR_Îi¡x©Œ
 195

	)

200 
	#__NR_æi¡x©Œ
 196

	)

201 
	#__NR_»movex©Œ
 197

	)

202 
	#__NR_Ìemovex©Œ
 198

	)

203 
	#__NR_äemovex©Œ
 199

	)

204 
	#__NR_tkl
 200

	)

205 
	#__NR_time
 201

	)

206 
	#__NR_fu‹x
 202

	)

207 
	#__NR_sched_£ffš™y
 203

	)

208 
	#__NR_sched_g‘affš™y
 204

	)

209 
	#__NR_£t_th»ad_¬—
 205

	)

210 
	#__NR_io_£tup
 206

	)

211 
	#__NR_io_de¡roy
 207

	)

212 
	#__NR_io_g‘ev’ts
 208

	)

213 
	#__NR_io_subm™
 209

	)

214 
	#__NR_io_ÿnûl
 210

	)

215 
	#__NR_g‘_th»ad_¬—
 211

	)

216 
	#__NR_lookup_dcook›
 212

	)

217 
	#__NR_•Şl_ü—‹
 213

	)

218 
	#__NR_•Şl_ùl_Şd
 214

	)

219 
	#__NR_•Şl_wa™_Şd
 215

	)

220 
	#__NR_»m­_fe_·ges
 216

	)

221 
	#__NR_g‘d’ts64
 217

	)

222 
	#__NR_£t_tid_add»ss
 218

	)

223 
	#__NR_»¡¬t_sysÿÎ
 219

	)

224 
	#__NR_£mtimedİ
 220

	)

225 
	#__NR_çdvi£64
 221

	)

226 
	#__NR_tim”_ü—‹
 222

	)

227 
	#__NR_tim”_£‰ime
 223

	)

228 
	#__NR_tim”_g‘time
 224

	)

229 
	#__NR_tim”_g‘ov”run
 225

	)

230 
	#__NR_tim”_d–‘e
 226

	)

231 
	#__NR_şock_£‰ime
 227

	)

232 
	#__NR_şock_g‘time
 228

	)

233 
	#__NR_şock_g‘»s
 229

	)

234 
	#__NR_şock_Çno¦“p
 230

	)

235 
	#__NR_ex™_group
 231

	)

236 
	#__NR_•Şl_wa™
 232

	)

237 
	#__NR_•Şl_ùl
 233

	)

238 
	#__NR_tgkl
 234

	)

239 
	#__NR_utimes
 235

	)

240 
	#__NR_v£rv”
 236

	)

241 
	#__NR_mbšd
 237

	)

242 
	#__NR_£t_mempŞicy
 238

	)

243 
	#__NR_g‘_mempŞicy
 239

	)

244 
	#__NR_mq_İ’
 240

	)

245 
	#__NR_mq_uÆšk
 241

	)

246 
	#__NR_mq_timed£nd
 242

	)

247 
	#__NR_mq_timed»ûive
 243

	)

248 
	#__NR_mq_nÙify
 244

	)

249 
	#__NR_mq_g‘£‰r
 245

	)

250 
	#__NR_kexec_lßd
 246

	)

251 
	#__NR_wa™id
 247

	)

252 
	#__NR_add_key
 248

	)

253 
	#__NR_»que¡_key
 249

	)

254 
	#__NR_keyùl
 250

	)

255 
	#__NR_iİrio_£t
 251

	)

256 
	#__NR_iİrio_g‘
 252

	)

257 
	#__NR_šÙify_š™
 253

	)

258 
	#__NR_šÙify_add_w©ch
 254

	)

259 
	#__NR_šÙify_rm_w©ch
 255

	)

260 
	#__NR_mig¿‹_·ges
 256

	)

261 
	#__NR_İ’©
 257

	)

262 
	#__NR_mkdœ©
 258

	)

263 
	#__NR_mknod©
 259

	)

264 
	#__NR_fchowÇt
 260

	)

265 
	#__NR_futime§t
 261

	)

266 
	#__NR_Ãwf¡©©
 262

	)

267 
	#__NR_uÆšk©
 263

	)

268 
	#__NR_»Çm—t
 264

	)

269 
	#__NR_lšk©
 265

	)

270 
	#__NR_symlšk©
 266

	)

271 
	#__NR_»adlšk©
 267

	)

272 
	#__NR_fchmod©
 268

	)

273 
	#__NR_çcûs§t
 269

	)

274 
	#__NR_p£Ëù6
 270

	)

275 
	#__NR_µŞl
 271

	)

276 
	#__NR_unsh¬e
 272

	)

277 
	#__NR_£t_robu¡_li¡
 273

	)

278 
	#__NR_g‘_robu¡_li¡
 274

	)

279 
	#__NR_¥liû
 275

	)

280 
	#__NR_‹e
 276

	)

281 
	#__NR_sync_fe_¿nge
 277

	)

282 
	#__NR_vm¥liû
 278

	)

283 
	#__NR_move_·ges
 279

	)

284 
	#__NR_utim’§t
 280

	)

285 
	#__NR_•Şl_pwa™
 281

	)

286 
	#__NR_sigÇlfd
 282

	)

287 
	#__NR_tim”fd_ü—‹
 283

	)

288 
	#__NR_ev’tfd
 284

	)

289 
	#__NR_çÎoÿ‹
 285

	)

290 
	#__NR_tim”fd_£‰ime
 286

	)

291 
	#__NR_tim”fd_g‘time
 287

	)

292 
	#__NR_acû±4
 288

	)

293 
	#__NR_sigÇlfd4
 289

	)

294 
	#__NR_ev’tfd2
 290

	)

295 
	#__NR_•Şl_ü—‹1
 291

	)

296 
	#__NR_dup3
 292

	)

297 
	#__NR_pe2
 293

	)

298 
	#__NR_šÙify_š™1
 294

	)

299 
	#__NR_´—dv
 295

	)

300 
	#__NR_pwr™ev
 296

	)

301 
	#__NR_¹_tgsigqueuešfo
 297

	)

302 
	#__NR_³rf_ev’t_İ’
 298

	)

303 
	#__NR_»cvmmsg
 299

	)

304 
	#__NR_çnÙify_š™
 300

	)

305 
	#__NR_çnÙify_m¬k
 301

	)

306 
	#__NR_´lim™64
 302

	)

307 
	#__NR_Çme_to_hªdË_©
 303

	)

308 
	#__NR_İ’_by_hªdË_©
 304

	)

309 
	#__NR_şock_adjtime
 305

	)

310 
	#__NR_syncfs
 306

	)

311 
	#__NR_£ndmmsg
 307

	)

312 
	#__NR_£Šs
 308

	)

313 
	#__NR_g‘ıu
 309

	)

314 
	#__NR_´oûss_vm_»adv
 310

	)

315 
	#__NR_´oûss_vm_wr™ev
 311

	)

316 
	#__NR_kcmp
 312

	)

317 
	#__NR_fš™_moduË
 313

	)

318 
	#__NR_sched_£‰r
 314

	)

319 
	#__NR_sched_g‘©Œ
 315

	)

320 
	#__NR_»Çm—t2
 316

	)

321 
	#__NR_£ccomp
 317

	)

322 
	#__NR_g‘¿ndom
 318

	)

323 
	#__NR_memfd_ü—‹
 319

	)

324 
	#__NR_kexec_fe_lßd
 320

	)

325 
	#__NR_bpf
 321

	)

326 
	#__NR_execv—t
 322

	)

327 
	#__NR_u£rçuÉfd
 323

	)

328 
	#__NR_memb¬r›r
 324

	)

329 
	#__NR_mlock2
 325

	)

330 
	#__NR_cİy_fe_¿nge
 326

	)

331 
	#__NR_´—dv2
 327

	)

332 
	#__NR_pwr™ev2
 328

	)

333 
	#__NR_pkey_m´Ùeù
 329

	)

334 
	#__NR_pkey_®loc
 330

	)

335 
	#__NR_pkey_ä“
 331

	)

	@/usr/include/asm/unistd_x32.h

1 #iâdeà
_ASM_X86_UNISTD_X32_H


2 
	#_ASM_X86_UNISTD_X32_H
 1

	)

4 
	#__NR_»ad
 (
__X32_SYSCALL_BIT
 + 0)

	)

5 
	#__NR_wr™e
 (
__X32_SYSCALL_BIT
 + 1)

	)

6 
	#__NR_İ’
 (
__X32_SYSCALL_BIT
 + 2)

	)

7 
	#__NR_şo£
 (
__X32_SYSCALL_BIT
 + 3)

	)

8 
	#__NR_¡©
 (
__X32_SYSCALL_BIT
 + 4)

	)

9 
	#__NR_f¡©
 (
__X32_SYSCALL_BIT
 + 5)

	)

10 
	#__NR_l¡©
 (
__X32_SYSCALL_BIT
 + 6)

	)

11 
	#__NR_pŞl
 (
__X32_SYSCALL_BIT
 + 7)

	)

12 
	#__NR_l£ek
 (
__X32_SYSCALL_BIT
 + 8)

	)

13 
	#__NR_mm­
 (
__X32_SYSCALL_BIT
 + 9)

	)

14 
	#__NR_m´Ùeù
 (
__X32_SYSCALL_BIT
 + 10)

	)

15 
	#__NR_munm­
 (
__X32_SYSCALL_BIT
 + 11)

	)

16 
	#__NR_brk
 (
__X32_SYSCALL_BIT
 + 12)

	)

17 
	#__NR_¹_sig´ocmask
 (
__X32_SYSCALL_BIT
 + 14)

	)

18 
	#__NR_´—d64
 (
__X32_SYSCALL_BIT
 + 17)

	)

19 
	#__NR_pwr™e64
 (
__X32_SYSCALL_BIT
 + 18)

	)

20 
	#__NR_acûss
 (
__X32_SYSCALL_BIT
 + 21)

	)

21 
	#__NR_pe
 (
__X32_SYSCALL_BIT
 + 22)

	)

22 
	#__NR_£Ëù
 (
__X32_SYSCALL_BIT
 + 23)

	)

23 
	#__NR_sched_y›ld
 (
__X32_SYSCALL_BIT
 + 24)

	)

24 
	#__NR_m»m­
 (
__X32_SYSCALL_BIT
 + 25)

	)

25 
	#__NR_msync
 (
__X32_SYSCALL_BIT
 + 26)

	)

26 
	#__NR_mšcÜe
 (
__X32_SYSCALL_BIT
 + 27)

	)

27 
	#__NR_madvi£
 (
__X32_SYSCALL_BIT
 + 28)

	)

28 
	#__NR_shmg‘
 (
__X32_SYSCALL_BIT
 + 29)

	)

29 
	#__NR_shm©
 (
__X32_SYSCALL_BIT
 + 30)

	)

30 
	#__NR_shmùl
 (
__X32_SYSCALL_BIT
 + 31)

	)

31 
	#__NR_dup
 (
__X32_SYSCALL_BIT
 + 32)

	)

32 
	#__NR_dup2
 (
__X32_SYSCALL_BIT
 + 33)

	)

33 
	#__NR_·u£
 (
__X32_SYSCALL_BIT
 + 34)

	)

34 
	#__NR_Çno¦“p
 (
__X32_SYSCALL_BIT
 + 35)

	)

35 
	#__NR_g‘™im”
 (
__X32_SYSCALL_BIT
 + 36)

	)

36 
	#__NR_®¬m
 (
__X32_SYSCALL_BIT
 + 37)

	)

37 
	#__NR_£t™im”
 (
__X32_SYSCALL_BIT
 + 38)

	)

38 
	#__NR_g‘pid
 (
__X32_SYSCALL_BIT
 + 39)

	)

39 
	#__NR_£ndfe
 (
__X32_SYSCALL_BIT
 + 40)

	)

40 
	#__NR_sock‘
 (
__X32_SYSCALL_BIT
 + 41)

	)

41 
	#__NR_cÚÃù
 (
__X32_SYSCALL_BIT
 + 42)

	)

42 
	#__NR_acû±
 (
__X32_SYSCALL_BIT
 + 43)

	)

43 
	#__NR_£ndto
 (
__X32_SYSCALL_BIT
 + 44)

	)

44 
	#__NR_shutdown
 (
__X32_SYSCALL_BIT
 + 48)

	)

45 
	#__NR_bšd
 (
__X32_SYSCALL_BIT
 + 49)

	)

46 
	#__NR_li¡’
 (
__X32_SYSCALL_BIT
 + 50)

	)

47 
	#__NR_g‘sockÇme
 (
__X32_SYSCALL_BIT
 + 51)

	)

48 
	#__NR_g‘³”Çme
 (
__X32_SYSCALL_BIT
 + 52)

	)

49 
	#__NR_sock‘·œ
 (
__X32_SYSCALL_BIT
 + 53)

	)

50 
	#__NR_şÚe
 (
__X32_SYSCALL_BIT
 + 56)

	)

51 
	#__NR_fÜk
 (
__X32_SYSCALL_BIT
 + 57)

	)

52 
	#__NR_vfÜk
 (
__X32_SYSCALL_BIT
 + 58)

	)

53 
	#__NR_ex™
 (
__X32_SYSCALL_BIT
 + 60)

	)

54 
	#__NR_wa™4
 (
__X32_SYSCALL_BIT
 + 61)

	)

55 
	#__NR_kl
 (
__X32_SYSCALL_BIT
 + 62)

	)

56 
	#__NR_uÇme
 (
__X32_SYSCALL_BIT
 + 63)

	)

57 
	#__NR_£mg‘
 (
__X32_SYSCALL_BIT
 + 64)

	)

58 
	#__NR_£mİ
 (
__X32_SYSCALL_BIT
 + 65)

	)

59 
	#__NR_£mùl
 (
__X32_SYSCALL_BIT
 + 66)

	)

60 
	#__NR_shmdt
 (
__X32_SYSCALL_BIT
 + 67)

	)

61 
	#__NR_msgg‘
 (
__X32_SYSCALL_BIT
 + 68)

	)

62 
	#__NR_msg¢d
 (
__X32_SYSCALL_BIT
 + 69)

	)

63 
	#__NR_msgrcv
 (
__X32_SYSCALL_BIT
 + 70)

	)

64 
	#__NR_msgùl
 (
__X32_SYSCALL_BIT
 + 71)

	)

65 
	#__NR_fú
 (
__X32_SYSCALL_BIT
 + 72)

	)

66 
	#__NR_æock
 (
__X32_SYSCALL_BIT
 + 73)

	)

67 
	#__NR_fsync
 (
__X32_SYSCALL_BIT
 + 74)

	)

68 
	#__NR_fd©async
 (
__X32_SYSCALL_BIT
 + 75)

	)

69 
	#__NR_Œunÿ‹
 (
__X32_SYSCALL_BIT
 + 76)

	)

70 
	#__NR_árunÿ‹
 (
__X32_SYSCALL_BIT
 + 77)

	)

71 
	#__NR_g‘d’ts
 (
__X32_SYSCALL_BIT
 + 78)

	)

72 
	#__NR_g‘cwd
 (
__X32_SYSCALL_BIT
 + 79)

	)

73 
	#__NR_chdœ
 (
__X32_SYSCALL_BIT
 + 80)

	)

74 
	#__NR_fchdœ
 (
__X32_SYSCALL_BIT
 + 81)

	)

75 
	#__NR_»Çme
 (
__X32_SYSCALL_BIT
 + 82)

	)

76 
	#__NR_mkdœ
 (
__X32_SYSCALL_BIT
 + 83)

	)

77 
	#__NR_rmdœ
 (
__X32_SYSCALL_BIT
 + 84)

	)

78 
	#__NR_ü—t
 (
__X32_SYSCALL_BIT
 + 85)

	)

79 
	#__NR_lšk
 (
__X32_SYSCALL_BIT
 + 86)

	)

80 
	#__NR_uÆšk
 (
__X32_SYSCALL_BIT
 + 87)

	)

81 
	#__NR_symlšk
 (
__X32_SYSCALL_BIT
 + 88)

	)

82 
	#__NR_»adlšk
 (
__X32_SYSCALL_BIT
 + 89)

	)

83 
	#__NR_chmod
 (
__X32_SYSCALL_BIT
 + 90)

	)

84 
	#__NR_fchmod
 (
__X32_SYSCALL_BIT
 + 91)

	)

85 
	#__NR_chown
 (
__X32_SYSCALL_BIT
 + 92)

	)

86 
	#__NR_fchown
 (
__X32_SYSCALL_BIT
 + 93)

	)

87 
	#__NR_lchown
 (
__X32_SYSCALL_BIT
 + 94)

	)

88 
	#__NR_umask
 (
__X32_SYSCALL_BIT
 + 95)

	)

89 
	#__NR_g‘timeofday
 (
__X32_SYSCALL_BIT
 + 96)

	)

90 
	#__NR_g‘¾im™
 (
__X32_SYSCALL_BIT
 + 97)

	)

91 
	#__NR_g‘ru§ge
 (
__X32_SYSCALL_BIT
 + 98)

	)

92 
	#__NR_sysšfo
 (
__X32_SYSCALL_BIT
 + 99)

	)

93 
	#__NR_times
 (
__X32_SYSCALL_BIT
 + 100)

	)

94 
	#__NR_g‘uid
 (
__X32_SYSCALL_BIT
 + 102)

	)

95 
	#__NR_sy¦og
 (
__X32_SYSCALL_BIT
 + 103)

	)

96 
	#__NR_g‘gid
 (
__X32_SYSCALL_BIT
 + 104)

	)

97 
	#__NR_£tuid
 (
__X32_SYSCALL_BIT
 + 105)

	)

98 
	#__NR_£tgid
 (
__X32_SYSCALL_BIT
 + 106)

	)

99 
	#__NR_g‘euid
 (
__X32_SYSCALL_BIT
 + 107)

	)

100 
	#__NR_g‘egid
 (
__X32_SYSCALL_BIT
 + 108)

	)

101 
	#__NR_£gid
 (
__X32_SYSCALL_BIT
 + 109)

	)

102 
	#__NR_g‘µid
 (
__X32_SYSCALL_BIT
 + 110)

	)

103 
	#__NR_g‘pg½
 (
__X32_SYSCALL_BIT
 + 111)

	)

104 
	#__NR_£tsid
 (
__X32_SYSCALL_BIT
 + 112)

	)

105 
	#__NR_£Œeuid
 (
__X32_SYSCALL_BIT
 + 113)

	)

106 
	#__NR_£Œegid
 (
__X32_SYSCALL_BIT
 + 114)

	)

107 
	#__NR_g‘groups
 (
__X32_SYSCALL_BIT
 + 115)

	)

108 
	#__NR_£tgroups
 (
__X32_SYSCALL_BIT
 + 116)

	)

109 
	#__NR_£Œesuid
 (
__X32_SYSCALL_BIT
 + 117)

	)

110 
	#__NR_g‘»suid
 (
__X32_SYSCALL_BIT
 + 118)

	)

111 
	#__NR_£Œesgid
 (
__X32_SYSCALL_BIT
 + 119)

	)

112 
	#__NR_g‘»sgid
 (
__X32_SYSCALL_BIT
 + 120)

	)

113 
	#__NR_g‘pgid
 (
__X32_SYSCALL_BIT
 + 121)

	)

114 
	#__NR_£tfsuid
 (
__X32_SYSCALL_BIT
 + 122)

	)

115 
	#__NR_£tfsgid
 (
__X32_SYSCALL_BIT
 + 123)

	)

116 
	#__NR_g‘sid
 (
__X32_SYSCALL_BIT
 + 124)

	)

117 
	#__NR_ÿpg‘
 (
__X32_SYSCALL_BIT
 + 125)

	)

118 
	#__NR_ÿp£t
 (
__X32_SYSCALL_BIT
 + 126)

	)

119 
	#__NR_¹_sigsu¥’d
 (
__X32_SYSCALL_BIT
 + 130)

	)

120 
	#__NR_utime
 (
__X32_SYSCALL_BIT
 + 132)

	)

121 
	#__NR_mknod
 (
__X32_SYSCALL_BIT
 + 133)

	)

122 
	#__NR_³rsÚ®™y
 (
__X32_SYSCALL_BIT
 + 135)

	)

123 
	#__NR_u¡©
 (
__X32_SYSCALL_BIT
 + 136)

	)

124 
	#__NR_¡©fs
 (
__X32_SYSCALL_BIT
 + 137)

	)

125 
	#__NR_f¡©fs
 (
__X32_SYSCALL_BIT
 + 138)

	)

126 
	#__NR_sysfs
 (
__X32_SYSCALL_BIT
 + 139)

	)

127 
	#__NR_g‘´iÜ™y
 (
__X32_SYSCALL_BIT
 + 140)

	)

128 
	#__NR_£riÜ™y
 (
__X32_SYSCALL_BIT
 + 141)

	)

129 
	#__NR_sched_£¬am
 (
__X32_SYSCALL_BIT
 + 142)

	)

130 
	#__NR_sched_g‘·¿m
 (
__X32_SYSCALL_BIT
 + 143)

	)

131 
	#__NR_sched_£tscheduËr
 (
__X32_SYSCALL_BIT
 + 144)

	)

132 
	#__NR_sched_g‘scheduËr
 (
__X32_SYSCALL_BIT
 + 145)

	)

133 
	#__NR_sched_g‘_´iÜ™y_max
 (
__X32_SYSCALL_BIT
 + 146)

	)

134 
	#__NR_sched_g‘_´iÜ™y_mš
 (
__X32_SYSCALL_BIT
 + 147)

	)

135 
	#__NR_sched_¼_g‘_š‹rv®
 (
__X32_SYSCALL_BIT
 + 148)

	)

136 
	#__NR_mlock
 (
__X32_SYSCALL_BIT
 + 149)

	)

137 
	#__NR_muÆock
 (
__X32_SYSCALL_BIT
 + 150)

	)

138 
	#__NR_mlock®l
 (
__X32_SYSCALL_BIT
 + 151)

	)

139 
	#__NR_muÆock®l
 (
__X32_SYSCALL_BIT
 + 152)

	)

140 
	#__NR_vhªgup
 (
__X32_SYSCALL_BIT
 + 153)

	)

141 
	#__NR_modify_ldt
 (
__X32_SYSCALL_BIT
 + 154)

	)

142 
	#__NR_pivÙ_roÙ
 (
__X32_SYSCALL_BIT
 + 155)

	)

143 
	#__NR_´ùl
 (
__X32_SYSCALL_BIT
 + 157)

	)

144 
	#__NR_¬ch_´ùl
 (
__X32_SYSCALL_BIT
 + 158)

	)

145 
	#__NR_adjtimex
 (
__X32_SYSCALL_BIT
 + 159)

	)

146 
	#__NR_£Œlim™
 (
__X32_SYSCALL_BIT
 + 160)

	)

147 
	#__NR_chroÙ
 (
__X32_SYSCALL_BIT
 + 161)

	)

148 
	#__NR_sync
 (
__X32_SYSCALL_BIT
 + 162)

	)

149 
	#__NR_acù
 (
__X32_SYSCALL_BIT
 + 163)

	)

150 
	#__NR_£‰imeofday
 (
__X32_SYSCALL_BIT
 + 164)

	)

151 
	#__NR_mouÁ
 (
__X32_SYSCALL_BIT
 + 165)

	)

152 
	#__NR_umouÁ2
 (
__X32_SYSCALL_BIT
 + 166)

	)

153 
	#__NR_sw­Ú
 (
__X32_SYSCALL_BIT
 + 167)

	)

154 
	#__NR_sw­off
 (
__X32_SYSCALL_BIT
 + 168)

	)

155 
	#__NR_»boÙ
 (
__X32_SYSCALL_BIT
 + 169)

	)

156 
	#__NR_£tho¡Çme
 (
__X32_SYSCALL_BIT
 + 170)

	)

157 
	#__NR_£tdomašÇme
 (
__X32_SYSCALL_BIT
 + 171)

	)

158 
	#__NR_iİl
 (
__X32_SYSCALL_BIT
 + 172)

	)

159 
	#__NR_iİ”m
 (
__X32_SYSCALL_BIT
 + 173)

	)

160 
	#__NR_š™_moduË
 (
__X32_SYSCALL_BIT
 + 175)

	)

161 
	#__NR_d–‘e_moduË
 (
__X32_SYSCALL_BIT
 + 176)

	)

162 
	#__NR_quÙaùl
 (
__X32_SYSCALL_BIT
 + 179)

	)

163 
	#__NR_g‘pmsg
 (
__X32_SYSCALL_BIT
 + 181)

	)

164 
	#__NR_pumsg
 (
__X32_SYSCALL_BIT
 + 182)

	)

165 
	#__NR_afs_sysÿÎ
 (
__X32_SYSCALL_BIT
 + 183)

	)

166 
	#__NR_tuxÿÎ
 (
__X32_SYSCALL_BIT
 + 184)

	)

167 
	#__NR_£cur™y
 (
__X32_SYSCALL_BIT
 + 185)

	)

168 
	#__NR_g‘tid
 (
__X32_SYSCALL_BIT
 + 186)

	)

169 
	#__NR_»adah—d
 (
__X32_SYSCALL_BIT
 + 187)

	)

170 
	#__NR_£tx©Œ
 (
__X32_SYSCALL_BIT
 + 188)

	)

171 
	#__NR_l£tx©Œ
 (
__X32_SYSCALL_BIT
 + 189)

	)

172 
	#__NR_f£tx©Œ
 (
__X32_SYSCALL_BIT
 + 190)

	)

173 
	#__NR_g‘x©Œ
 (
__X32_SYSCALL_BIT
 + 191)

	)

174 
	#__NR_lg‘x©Œ
 (
__X32_SYSCALL_BIT
 + 192)

	)

175 
	#__NR_fg‘x©Œ
 (
__X32_SYSCALL_BIT
 + 193)

	)

176 
	#__NR_li¡x©Œ
 (
__X32_SYSCALL_BIT
 + 194)

	)

177 
	#__NR_Îi¡x©Œ
 (
__X32_SYSCALL_BIT
 + 195)

	)

178 
	#__NR_æi¡x©Œ
 (
__X32_SYSCALL_BIT
 + 196)

	)

179 
	#__NR_»movex©Œ
 (
__X32_SYSCALL_BIT
 + 197)

	)

180 
	#__NR_Ìemovex©Œ
 (
__X32_SYSCALL_BIT
 + 198)

	)

181 
	#__NR_äemovex©Œ
 (
__X32_SYSCALL_BIT
 + 199)

	)

182 
	#__NR_tkl
 (
__X32_SYSCALL_BIT
 + 200)

	)

183 
	#__NR_time
 (
__X32_SYSCALL_BIT
 + 201)

	)

184 
	#__NR_fu‹x
 (
__X32_SYSCALL_BIT
 + 202)

	)

185 
	#__NR_sched_£ffš™y
 (
__X32_SYSCALL_BIT
 + 203)

	)

186 
	#__NR_sched_g‘affš™y
 (
__X32_SYSCALL_BIT
 + 204)

	)

187 
	#__NR_io_de¡roy
 (
__X32_SYSCALL_BIT
 + 207)

	)

188 
	#__NR_io_g‘ev’ts
 (
__X32_SYSCALL_BIT
 + 208)

	)

189 
	#__NR_io_ÿnûl
 (
__X32_SYSCALL_BIT
 + 210)

	)

190 
	#__NR_lookup_dcook›
 (
__X32_SYSCALL_BIT
 + 212)

	)

191 
	#__NR_•Şl_ü—‹
 (
__X32_SYSCALL_BIT
 + 213)

	)

192 
	#__NR_»m­_fe_·ges
 (
__X32_SYSCALL_BIT
 + 216)

	)

193 
	#__NR_g‘d’ts64
 (
__X32_SYSCALL_BIT
 + 217)

	)

194 
	#__NR_£t_tid_add»ss
 (
__X32_SYSCALL_BIT
 + 218)

	)

195 
	#__NR_»¡¬t_sysÿÎ
 (
__X32_SYSCALL_BIT
 + 219)

	)

196 
	#__NR_£mtimedİ
 (
__X32_SYSCALL_BIT
 + 220)

	)

197 
	#__NR_çdvi£64
 (
__X32_SYSCALL_BIT
 + 221)

	)

198 
	#__NR_tim”_£‰ime
 (
__X32_SYSCALL_BIT
 + 223)

	)

199 
	#__NR_tim”_g‘time
 (
__X32_SYSCALL_BIT
 + 224)

	)

200 
	#__NR_tim”_g‘ov”run
 (
__X32_SYSCALL_BIT
 + 225)

	)

201 
	#__NR_tim”_d–‘e
 (
__X32_SYSCALL_BIT
 + 226)

	)

202 
	#__NR_şock_£‰ime
 (
__X32_SYSCALL_BIT
 + 227)

	)

203 
	#__NR_şock_g‘time
 (
__X32_SYSCALL_BIT
 + 228)

	)

204 
	#__NR_şock_g‘»s
 (
__X32_SYSCALL_BIT
 + 229)

	)

205 
	#__NR_şock_Çno¦“p
 (
__X32_SYSCALL_BIT
 + 230)

	)

206 
	#__NR_ex™_group
 (
__X32_SYSCALL_BIT
 + 231)

	)

207 
	#__NR_•Şl_wa™
 (
__X32_SYSCALL_BIT
 + 232)

	)

208 
	#__NR_•Şl_ùl
 (
__X32_SYSCALL_BIT
 + 233)

	)

209 
	#__NR_tgkl
 (
__X32_SYSCALL_BIT
 + 234)

	)

210 
	#__NR_utimes
 (
__X32_SYSCALL_BIT
 + 235)

	)

211 
	#__NR_mbšd
 (
__X32_SYSCALL_BIT
 + 237)

	)

212 
	#__NR_£t_mempŞicy
 (
__X32_SYSCALL_BIT
 + 238)

	)

213 
	#__NR_g‘_mempŞicy
 (
__X32_SYSCALL_BIT
 + 239)

	)

214 
	#__NR_mq_İ’
 (
__X32_SYSCALL_BIT
 + 240)

	)

215 
	#__NR_mq_uÆšk
 (
__X32_SYSCALL_BIT
 + 241)

	)

216 
	#__NR_mq_timed£nd
 (
__X32_SYSCALL_BIT
 + 242)

	)

217 
	#__NR_mq_timed»ûive
 (
__X32_SYSCALL_BIT
 + 243)

	)

218 
	#__NR_mq_g‘£‰r
 (
__X32_SYSCALL_BIT
 + 245)

	)

219 
	#__NR_add_key
 (
__X32_SYSCALL_BIT
 + 248)

	)

220 
	#__NR_»que¡_key
 (
__X32_SYSCALL_BIT
 + 249)

	)

221 
	#__NR_keyùl
 (
__X32_SYSCALL_BIT
 + 250)

	)

222 
	#__NR_iİrio_£t
 (
__X32_SYSCALL_BIT
 + 251)

	)

223 
	#__NR_iİrio_g‘
 (
__X32_SYSCALL_BIT
 + 252)

	)

224 
	#__NR_šÙify_š™
 (
__X32_SYSCALL_BIT
 + 253)

	)

225 
	#__NR_šÙify_add_w©ch
 (
__X32_SYSCALL_BIT
 + 254)

	)

226 
	#__NR_šÙify_rm_w©ch
 (
__X32_SYSCALL_BIT
 + 255)

	)

227 
	#__NR_mig¿‹_·ges
 (
__X32_SYSCALL_BIT
 + 256)

	)

228 
	#__NR_İ’©
 (
__X32_SYSCALL_BIT
 + 257)

	)

229 
	#__NR_mkdœ©
 (
__X32_SYSCALL_BIT
 + 258)

	)

230 
	#__NR_mknod©
 (
__X32_SYSCALL_BIT
 + 259)

	)

231 
	#__NR_fchowÇt
 (
__X32_SYSCALL_BIT
 + 260)

	)

232 
	#__NR_futime§t
 (
__X32_SYSCALL_BIT
 + 261)

	)

233 
	#__NR_Ãwf¡©©
 (
__X32_SYSCALL_BIT
 + 262)

	)

234 
	#__NR_uÆšk©
 (
__X32_SYSCALL_BIT
 + 263)

	)

235 
	#__NR_»Çm—t
 (
__X32_SYSCALL_BIT
 + 264)

	)

236 
	#__NR_lšk©
 (
__X32_SYSCALL_BIT
 + 265)

	)

237 
	#__NR_symlšk©
 (
__X32_SYSCALL_BIT
 + 266)

	)

238 
	#__NR_»adlšk©
 (
__X32_SYSCALL_BIT
 + 267)

	)

239 
	#__NR_fchmod©
 (
__X32_SYSCALL_BIT
 + 268)

	)

240 
	#__NR_çcûs§t
 (
__X32_SYSCALL_BIT
 + 269)

	)

241 
	#__NR_p£Ëù6
 (
__X32_SYSCALL_BIT
 + 270)

	)

242 
	#__NR_µŞl
 (
__X32_SYSCALL_BIT
 + 271)

	)

243 
	#__NR_unsh¬e
 (
__X32_SYSCALL_BIT
 + 272)

	)

244 
	#__NR_¥liû
 (
__X32_SYSCALL_BIT
 + 275)

	)

245 
	#__NR_‹e
 (
__X32_SYSCALL_BIT
 + 276)

	)

246 
	#__NR_sync_fe_¿nge
 (
__X32_SYSCALL_BIT
 + 277)

	)

247 
	#__NR_utim’§t
 (
__X32_SYSCALL_BIT
 + 280)

	)

248 
	#__NR_•Şl_pwa™
 (
__X32_SYSCALL_BIT
 + 281)

	)

249 
	#__NR_sigÇlfd
 (
__X32_SYSCALL_BIT
 + 282)

	)

250 
	#__NR_tim”fd_ü—‹
 (
__X32_SYSCALL_BIT
 + 283)

	)

251 
	#__NR_ev’tfd
 (
__X32_SYSCALL_BIT
 + 284)

	)

252 
	#__NR_çÎoÿ‹
 (
__X32_SYSCALL_BIT
 + 285)

	)

253 
	#__NR_tim”fd_£‰ime
 (
__X32_SYSCALL_BIT
 + 286)

	)

254 
	#__NR_tim”fd_g‘time
 (
__X32_SYSCALL_BIT
 + 287)

	)

255 
	#__NR_acû±4
 (
__X32_SYSCALL_BIT
 + 288)

	)

256 
	#__NR_sigÇlfd4
 (
__X32_SYSCALL_BIT
 + 289)

	)

257 
	#__NR_ev’tfd2
 (
__X32_SYSCALL_BIT
 + 290)

	)

258 
	#__NR_•Şl_ü—‹1
 (
__X32_SYSCALL_BIT
 + 291)

	)

259 
	#__NR_dup3
 (
__X32_SYSCALL_BIT
 + 292)

	)

260 
	#__NR_pe2
 (
__X32_SYSCALL_BIT
 + 293)

	)

261 
	#__NR_šÙify_š™1
 (
__X32_SYSCALL_BIT
 + 294)

	)

262 
	#__NR_³rf_ev’t_İ’
 (
__X32_SYSCALL_BIT
 + 298)

	)

263 
	#__NR_çnÙify_š™
 (
__X32_SYSCALL_BIT
 + 300)

	)

264 
	#__NR_çnÙify_m¬k
 (
__X32_SYSCALL_BIT
 + 301)

	)

265 
	#__NR_´lim™64
 (
__X32_SYSCALL_BIT
 + 302)

	)

266 
	#__NR_Çme_to_hªdË_©
 (
__X32_SYSCALL_BIT
 + 303)

	)

267 
	#__NR_İ’_by_hªdË_©
 (
__X32_SYSCALL_BIT
 + 304)

	)

268 
	#__NR_şock_adjtime
 (
__X32_SYSCALL_BIT
 + 305)

	)

269 
	#__NR_syncfs
 (
__X32_SYSCALL_BIT
 + 306)

	)

270 
	#__NR_£Šs
 (
__X32_SYSCALL_BIT
 + 308)

	)

271 
	#__NR_g‘ıu
 (
__X32_SYSCALL_BIT
 + 309)

	)

272 
	#__NR_kcmp
 (
__X32_SYSCALL_BIT
 + 312)

	)

273 
	#__NR_fš™_moduË
 (
__X32_SYSCALL_BIT
 + 313)

	)

274 
	#__NR_sched_£‰r
 (
__X32_SYSCALL_BIT
 + 314)

	)

275 
	#__NR_sched_g‘©Œ
 (
__X32_SYSCALL_BIT
 + 315)

	)

276 
	#__NR_»Çm—t2
 (
__X32_SYSCALL_BIT
 + 316)

	)

277 
	#__NR_£ccomp
 (
__X32_SYSCALL_BIT
 + 317)

	)

278 
	#__NR_g‘¿ndom
 (
__X32_SYSCALL_BIT
 + 318)

	)

279 
	#__NR_memfd_ü—‹
 (
__X32_SYSCALL_BIT
 + 319)

	)

280 
	#__NR_kexec_fe_lßd
 (
__X32_SYSCALL_BIT
 + 320)

	)

281 
	#__NR_bpf
 (
__X32_SYSCALL_BIT
 + 321)

	)

282 
	#__NR_u£rçuÉfd
 (
__X32_SYSCALL_BIT
 + 323)

	)

283 
	#__NR_memb¬r›r
 (
__X32_SYSCALL_BIT
 + 324)

	)

284 
	#__NR_mlock2
 (
__X32_SYSCALL_BIT
 + 325)

	)

285 
	#__NR_cİy_fe_¿nge
 (
__X32_SYSCALL_BIT
 + 326)

	)

286 
	#__NR_pkey_m´Ùeù
 (
__X32_SYSCALL_BIT
 + 329)

	)

287 
	#__NR_pkey_®loc
 (
__X32_SYSCALL_BIT
 + 330)

	)

288 
	#__NR_pkey_ä“
 (
__X32_SYSCALL_BIT
 + 331)

	)

289 
	#__NR_¹_sigaùiÚ
 (
__X32_SYSCALL_BIT
 + 512)

	)

290 
	#__NR_¹_sig»tuº
 (
__X32_SYSCALL_BIT
 + 513)

	)

291 
	#__NR_ioùl
 (
__X32_SYSCALL_BIT
 + 514)

	)

292 
	#__NR_»adv
 (
__X32_SYSCALL_BIT
 + 515)

	)

293 
	#__NR_wr™ev
 (
__X32_SYSCALL_BIT
 + 516)

	)

294 
	#__NR_»cväom
 (
__X32_SYSCALL_BIT
 + 517)

	)

295 
	#__NR_£ndmsg
 (
__X32_SYSCALL_BIT
 + 518)

	)

296 
	#__NR_»cvmsg
 (
__X32_SYSCALL_BIT
 + 519)

	)

297 
	#__NR_execve
 (
__X32_SYSCALL_BIT
 + 520)

	)

298 
	#__NR_±¿û
 (
__X32_SYSCALL_BIT
 + 521)

	)

299 
	#__NR_¹_sig³ndšg
 (
__X32_SYSCALL_BIT
 + 522)

	)

300 
	#__NR_¹_sigtimedwa™
 (
__X32_SYSCALL_BIT
 + 523)

	)

301 
	#__NR_¹_sigqueuešfo
 (
__X32_SYSCALL_BIT
 + 524)

	)

302 
	#__NR_sig®t¡ack
 (
__X32_SYSCALL_BIT
 + 525)

	)

303 
	#__NR_tim”_ü—‹
 (
__X32_SYSCALL_BIT
 + 526)

	)

304 
	#__NR_mq_nÙify
 (
__X32_SYSCALL_BIT
 + 527)

	)

305 
	#__NR_kexec_lßd
 (
__X32_SYSCALL_BIT
 + 528)

	)

306 
	#__NR_wa™id
 (
__X32_SYSCALL_BIT
 + 529)

	)

307 
	#__NR_£t_robu¡_li¡
 (
__X32_SYSCALL_BIT
 + 530)

	)

308 
	#__NR_g‘_robu¡_li¡
 (
__X32_SYSCALL_BIT
 + 531)

	)

309 
	#__NR_vm¥liû
 (
__X32_SYSCALL_BIT
 + 532)

	)

310 
	#__NR_move_·ges
 (
__X32_SYSCALL_BIT
 + 533)

	)

311 
	#__NR_´—dv
 (
__X32_SYSCALL_BIT
 + 534)

	)

312 
	#__NR_pwr™ev
 (
__X32_SYSCALL_BIT
 + 535)

	)

313 
	#__NR_¹_tgsigqueuešfo
 (
__X32_SYSCALL_BIT
 + 536)

	)

314 
	#__NR_»cvmmsg
 (
__X32_SYSCALL_BIT
 + 537)

	)

315 
	#__NR_£ndmmsg
 (
__X32_SYSCALL_BIT
 + 538)

	)

316 
	#__NR_´oûss_vm_»adv
 (
__X32_SYSCALL_BIT
 + 539)

	)

317 
	#__NR_´oûss_vm_wr™ev
 (
__X32_SYSCALL_BIT
 + 540)

	)

318 
	#__NR_£tsockİt
 (
__X32_SYSCALL_BIT
 + 541)

	)

319 
	#__NR_g‘sockİt
 (
__X32_SYSCALL_BIT
 + 542)

	)

320 
	#__NR_io_£tup
 (
__X32_SYSCALL_BIT
 + 543)

	)

321 
	#__NR_io_subm™
 (
__X32_SYSCALL_BIT
 + 544)

	)

322 
	#__NR_execv—t
 (
__X32_SYSCALL_BIT
 + 545)

	)

323 
	#__NR_´—dv2
 (
__X32_SYSCALL_BIT
 + 546)

	)

324 
	#__NR_pwr™ev2
 (
__X32_SYSCALL_BIT
 + 547)

	)

	@/usr/include/limits.h

22 #iâdeà
_LIBC_LIMITS_H_


23 
	#_LIBC_LIMITS_H_
 1

	)

25 
	~<ã©u»s.h
>

31 
	#MB_LEN_MAX
 16

	)

36 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

41 #iâdeà
_LIMITS_H


42 
	#_LIMITS_H
 1

	)

44 
	~<b™s/wÜdsize.h
>

53 
	#CHAR_BIT
 8

	)

56 
	#SCHAR_MIN
 (-128)

	)

57 
	#SCHAR_MAX
 127

	)

60 
	#UCHAR_MAX
 255

	)

63 #ifdeà
__CHAR_UNSIGNED__


64 
	#CHAR_MIN
 0

	)

65 
	#CHAR_MAX
 
UCHAR_MAX


	)

67 
	#CHAR_MIN
 
SCHAR_MIN


	)

68 
	#CHAR_MAX
 
SCHAR_MAX


	)

72 
	#SHRT_MIN
 (-32768)

	)

73 
	#SHRT_MAX
 32767

	)

76 
	#USHRT_MAX
 65535

	)

79 
	#INT_MIN
 (-
INT_MAX
 - 1)

	)

80 
	#INT_MAX
 2147483647

	)

83 
	#UINT_MAX
 4294967295U

	)

86 #ià
__WORDSIZE
 == 64

87 
	#LONG_MAX
 9223372036854775807L

	)

89 
	#LONG_MAX
 2147483647L

	)

91 
	#LONG_MIN
 (-
LONG_MAX
 - 1L)

	)

94 #ià
__WORDSIZE
 == 64

95 
	#ULONG_MAX
 18446744073709551615UL

	)

97 
	#ULONG_MAX
 4294967295UL

	)

100 #ifdeà
__USE_ISOC99


103 
	#LLONG_MAX
 9223372036854775807LL

	)

104 
	#LLONG_MIN
 (-
LLONG_MAX
 - 1LL)

	)

107 
	#ULLONG_MAX
 18446744073709551615ULL

	)

121 #ià
defšed
 
__GNUC__
 && !defšed 
_GCC_LIMITS_H_


123 #šşude_Ãxˆ<
lim™s
.
h
>

129 #ià
defšed
 
__USE_ISOC99
 && defšed 
__GNUC__


130 #iâdeà
LLONG_MIN


131 
	#LLONG_MIN
 (-
LLONG_MAX
-1)

	)

133 #iâdeà
LLONG_MAX


134 
	#LLONG_MAX
 
__LONG_LONG_MAX__


	)

136 #iâdeà
ULLONG_MAX


137 
	#ULLONG_MAX
 (
LLONG_MAX
 * 2ULL + 1)

	)

141 #ifdef 
__USE_POSIX


143 
	~<b™s/posix1_lim.h
>

146 #ifdef 
__USE_POSIX2


147 
	~<b™s/posix2_lim.h
>

150 #ifdef 
__USE_XOPEN


151 
	~<b™s/xİ’_lim.h
>

	@/usr/include/linux/fcntl.h

1 #iâdeà
_LINUX_FCNTL_H


2 
	#_LINUX_FCNTL_H


	)

4 
	~<asm/fú.h
>

6 
	#F_SETLEASE
 (
F_LINUX_SPECIFIC_BASE
 + 0)

	)

7 
	#F_GETLEASE
 (
F_LINUX_SPECIFIC_BASE
 + 1)

	)

13 
	#F_CANCELLK
 (
F_LINUX_SPECIFIC_BASE
 + 5)

	)

16 
	#F_DUPFD_CLOEXEC
 (
F_LINUX_SPECIFIC_BASE
 + 6)

	)

22 
	#F_NOTIFY
 (
F_LINUX_SPECIFIC_BASE
+2)

	)

27 
	#F_SETPIPE_SZ
 (
F_LINUX_SPECIFIC_BASE
 + 7)

	)

28 
	#F_GETPIPE_SZ
 (
F_LINUX_SPECIFIC_BASE
 + 8)

	)

33 
	#F_ADD_SEALS
 (
F_LINUX_SPECIFIC_BASE
 + 9)

	)

34 
	#F_GET_SEALS
 (
F_LINUX_SPECIFIC_BASE
 + 10)

	)

39 
	#F_SEAL_SEAL
 0x0001

	)

40 
	#F_SEAL_SHRINK
 0x0002

	)

41 
	#F_SEAL_GROW
 0x0004

	)

42 
	#F_SEAL_WRITE
 0x0008

	)

48 
	#DN_ACCESS
 0x00000001

	)

49 
	#DN_MODIFY
 0x00000002

	)

50 
	#DN_CREATE
 0x00000004

	)

51 
	#DN_DELETE
 0x00000008

	)

52 
	#DN_RENAME
 0x00000010

	)

53 
	#DN_ATTRIB
 0x00000020

	)

54 
	#DN_MULTISHOT
 0x80000000

	)

56 
	#AT_FDCWD
 -100

	)

59 
	#AT_SYMLINK_NOFOLLOW
 0x100

	)

60 
	#AT_REMOVEDIR
 0x200

	)

62 
	#AT_SYMLINK_FOLLOW
 0x400

	)

63 
	#AT_NO_AUTOMOUNT
 0x800

	)

64 
	#AT_EMPTY_PATH
 0x1000

	)

	@/usr/include/linux/if.h

19 #iâdeà
_LINUX_IF_H


20 
	#_LINUX_IF_H


	)

22 
	~<lšux/libc-com·t.h
>

23 
	~<lšux/ty³s.h
>

24 
	~<lšux/sock‘.h
>

27 #ià
__UAPI_DEF_IF_IFNAMSIZ


28 
	#IFNAMSIZ
 16

	)

30 
	#IFALIASZ
 256

	)

31 
	~<lšux/hdlc/ioùl.h
>

34 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 != 0 || \

35 
	g__UAPI_DEF_IF_NET_DEVICE_FLAGS
 != 0

76 
	eÃt_deviû_æags
 {

78 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS


79 
IFF_UP
 = 1<<0,

80 
	mIFF_BROADCAST
 = 1<<1,

81 
	mIFF_DEBUG
 = 1<<2,

82 
	mIFF_LOOPBACK
 = 1<<3,

83 
	mIFF_POINTOPOINT
 = 1<<4,

84 
	mIFF_NOTRAILERS
 = 1<<5,

85 
	mIFF_RUNNING
 = 1<<6,

86 
	mIFF_NOARP
 = 1<<7,

87 
	mIFF_PROMISC
 = 1<<8,

88 
	mIFF_ALLMULTI
 = 1<<9,

89 
	mIFF_MASTER
 = 1<<10,

90 
	mIFF_SLAVE
 = 1<<11,

91 
	mIFF_MULTICAST
 = 1<<12,

92 
	mIFF_PORTSEL
 = 1<<13,

93 
	mIFF_AUTOMEDIA
 = 1<<14,

94 
	mIFF_DYNAMIC
 = 1<<15,

96 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


97 
	mIFF_LOWER_UP
 = 1<<16,

98 
	mIFF_DORMANT
 = 1<<17,

99 
	mIFF_ECHO
 = 1<<18,

105 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS


106 
	#IFF_UP
 
IFF_UP


	)

107 
	#IFF_BROADCAST
 
IFF_BROADCAST


	)

108 
	#IFF_DEBUG
 
IFF_DEBUG


	)

109 
	#IFF_LOOPBACK
 
IFF_LOOPBACK


	)

110 
	#IFF_POINTOPOINT
 
IFF_POINTOPOINT


	)

111 
	#IFF_NOTRAILERS
 
IFF_NOTRAILERS


	)

112 
	#IFF_RUNNING
 
IFF_RUNNING


	)

113 
	#IFF_NOARP
 
IFF_NOARP


	)

114 
	#IFF_PROMISC
 
IFF_PROMISC


	)

115 
	#IFF_ALLMULTI
 
IFF_ALLMULTI


	)

116 
	#IFF_MASTER
 
IFF_MASTER


	)

117 
	#IFF_SLAVE
 
IFF_SLAVE


	)

118 
	#IFF_MULTICAST
 
IFF_MULTICAST


	)

119 
	#IFF_PORTSEL
 
IFF_PORTSEL


	)

120 
	#IFF_AUTOMEDIA
 
IFF_AUTOMEDIA


	)

121 
	#IFF_DYNAMIC
 
IFF_DYNAMIC


	)

124 #ià
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


125 
	#IFF_LOWER_UP
 
IFF_LOWER_UP


	)

126 
	#IFF_DORMANT
 
IFF_DORMANT


	)

127 
	#IFF_ECHO
 
IFF_ECHO


	)

130 
	#IFF_VOLATILE
 (
IFF_LOOPBACK
|
IFF_POINTOPOINT
|
IFF_BROADCAST
|
IFF_ECHO
|\

131 
IFF_MASTER
|
IFF_SLAVE
|
IFF_RUNNING
|
IFF_LOWER_UP
|
IFF_DORMANT
)

	)

133 
	#IF_GET_IFACE
 0x0001

	)

134 
	#IF_GET_PROTO
 0x0002

	)

137 
	#IF_IFACE_V35
 0x1000

	)

138 
	#IF_IFACE_V24
 0x1001

	)

139 
	#IF_IFACE_X21
 0x1002

	)

140 
	#IF_IFACE_T1
 0x1003

	)

141 
	#IF_IFACE_E1
 0x1004

	)

142 
	#IF_IFACE_SYNC_SERIAL
 0x1005

	)

143 
	#IF_IFACE_X21D
 0x1006

	)

146 
	#IF_PROTO_HDLC
 0x2000

	)

147 
	#IF_PROTO_PPP
 0x2001

	)

148 
	#IF_PROTO_CISCO
 0x2002

	)

149 
	#IF_PROTO_FR
 0x2003

	)

150 
	#IF_PROTO_FR_ADD_PVC
 0x2004

	)

151 
	#IF_PROTO_FR_DEL_PVC
 0x2005

	)

152 
	#IF_PROTO_X25
 0x2006

	)

153 
	#IF_PROTO_HDLC_ETH
 0x2007

	)

154 
	#IF_PROTO_FR_ADD_ETH_PVC
 0x2008

	)

155 
	#IF_PROTO_FR_DEL_ETH_PVC
 0x2009

	)

156 
	#IF_PROTO_FR_PVC
 0x200A

	)

157 
	#IF_PROTO_FR_ETH_PVC
 0x200B

	)

158 
	#IF_PROTO_RAW
 0x200C

	)

162 
	mIF_OPER_UNKNOWN
,

163 
	mIF_OPER_NOTPRESENT
,

164 
	mIF_OPER_DOWN
,

165 
	mIF_OPER_LOWERLAYERDOWN
,

166 
	mIF_OPER_TESTING
,

167 
	mIF_OPER_DORMANT
,

168 
	mIF_OPER_UP
,

173 
	mIF_LINK_MODE_DEFAULT
,

174 
	mIF_LINK_MODE_DORMANT
,

188 #ià
__UAPI_DEF_IF_IFMAP


189 
	sifm­
 {

190 
	mmem_¡¬t
;

191 
	mmem_’d
;

192 
	mba£_addr
;

193 
	mœq
;

194 
	mdma
;

195 
	mpÜt
;

200 
	sif_£‰šgs
 {

201 
	mty³
;

202 
	msize
;

205 
¿w_hdlc_´Ùo
 *
	m¿w_hdlc
;

206 
cisco_´Ùo
 *
	mcisco
;

207 
ä_´Ùo
 *
	mä
;

208 
ä_´Ùo_pvc
 *
	mä_pvc
;

209 
ä_´Ùo_pvc_šfo
 *
	mä_pvc_šfo
;

212 
sync_£rŸl_£‰šgs
 *
	msync
;

213 
‹1_£‰šgs
 *
	m‹1
;

214 } 
	mifs_ifsu
;

225 #ià
__UAPI_DEF_IF_IFREQ


226 
	siäeq
 {

227 
	#IFHWADDRLEN
 6

	)

230 
	miän_Çme
[
IFNAMSIZ
];

231 } 
	miä_iän
;

234 
sockaddr
 
	miäu_addr
;

235 
sockaddr
 
	miäu_d¡addr
;

236 
sockaddr
 
	miäu_brßdaddr
;

237 
sockaddr
 
	miäu_Ãtmask
;

238 
sockaddr
 
	miäu_hwaddr
;

239 
	miäu_æags
;

240 
	miäu_iv®ue
;

241 
	miäu_mtu
;

242 
ifm­
 
	miäu_m­
;

243 
	miäu_¦ave
[
IFNAMSIZ
];

244 
	miäu_ÃwÇme
[
IFNAMSIZ
];

245 * 
	miäu_d©a
;

246 
if_£‰šgs
 
	miäu_£‰šgs
;

247 } 
	miä_iäu
;

251 
	#iä_Çme
 
iä_iän
.
iän_Çme


	)

252 
	#iä_hwaddr
 
iä_iäu
.
iäu_hwaddr


	)

253 
	#iä_addr
 
iä_iäu
.
iäu_addr


	)

254 
	#iä_d¡addr
 
iä_iäu
.
iäu_d¡addr


	)

255 
	#iä_brßdaddr
 
iä_iäu
.
iäu_brßdaddr


	)

256 
	#iä_Ãtmask
 
iä_iäu
.
iäu_Ãtmask


	)

257 
	#iä_æags
 
iä_iäu
.
iäu_æags


	)

258 
	#iä_m‘ric
 
iä_iäu
.
iäu_iv®ue


	)

259 
	#iä_mtu
 
iä_iäu
.
iäu_mtu


	)

260 
	#iä_m­
 
iä_iäu
.
iäu_m­


	)

261 
	#iä_¦ave
 
iä_iäu
.
iäu_¦ave


	)

262 
	#iä_d©a
 
iä_iäu
.
iäu_d©a


	)

263 
	#iä_ifšdex
 
iä_iäu
.
iäu_iv®ue


	)

264 
	#iä_bªdwidth
 
iä_iäu
.
iäu_iv®ue


	)

265 
	#iä_qËn
 
iä_iäu
.
iäu_iv®ue


	)

266 
	#iä_ÃwÇme
 
iä_iäu
.
iäu_ÃwÇme


	)

267 
	#iä_£‰šgs
 
iä_iäu
.
iäu_£‰šgs


	)

277 #ià
__UAPI_DEF_IF_IFCONF


278 
	sifcÚf
 {

279 
	mifc_Ën
;

281 *
	mifcu_buf
;

282 
iäeq
 *
	mifcu_»q
;

283 } 
	mifc_ifcu
;

287 
	#ifc_buf
 
ifc_ifcu
.
ifcu_buf


	)

288 
	#ifc_»q
 
ifc_ifcu
.
ifcu_»q


	)

	@/usr/include/linux/if_ether.h

21 #iâdeà
_LINUX_IF_ETHER_H


22 
	#_LINUX_IF_ETHER_H


	)

24 
	~<lšux/ty³s.h
>

31 
	#ETH_ALEN
 6

	)

32 
	#ETH_HLEN
 14

	)

33 
	#ETH_ZLEN
 60

	)

34 
	#ETH_DATA_LEN
 1500

	)

35 
	#ETH_FRAME_LEN
 1514

	)

36 
	#ETH_FCS_LEN
 4

	)

38 
	#ETH_MIN_MTU
 68

	)

39 
	#ETH_MAX_MTU
 0xFFFFU

	)

45 
	#ETH_P_LOOP
 0x0060

	)

46 
	#ETH_P_PUP
 0x0200

	)

47 
	#ETH_P_PUPAT
 0x0201

	)

48 
	#ETH_P_TSN
 0x22F0

	)

49 
	#ETH_P_IP
 0x0800

	)

50 
	#ETH_P_X25
 0x0805

	)

51 
	#ETH_P_ARP
 0x0806

	)

52 
	#ETH_P_BPQ
 0x08FF

	)

53 
	#ETH_P_IEEEPUP
 0x0a00

	)

54 
	#ETH_P_IEEEPUPAT
 0x0a01

	)

55 
	#ETH_P_BATMAN
 0x4305

	)

56 
	#ETH_P_DEC
 0x6000

	)

57 
	#ETH_P_DNA_DL
 0x6001

	)

58 
	#ETH_P_DNA_RC
 0x6002

	)

59 
	#ETH_P_DNA_RT
 0x6003

	)

60 
	#ETH_P_LAT
 0x6004

	)

61 
	#ETH_P_DIAG
 0x6005

	)

62 
	#ETH_P_CUST
 0x6006

	)

63 
	#ETH_P_SCA
 0x6007

	)

64 
	#ETH_P_TEB
 0x6558

	)

65 
	#ETH_P_RARP
 0x8035

	)

66 
	#ETH_P_ATALK
 0x809B

	)

67 
	#ETH_P_AARP
 0x80F3

	)

68 
	#ETH_P_8021Q
 0x8100

	)

69 
	#ETH_P_IPX
 0x8137

	)

70 
	#ETH_P_IPV6
 0x86DD

	)

71 
	#ETH_P_PAUSE
 0x8808

	)

72 
	#ETH_P_SLOW
 0x8809

	)

73 
	#ETH_P_WCCP
 0x883E

	)

75 
	#ETH_P_MPLS_UC
 0x8847

	)

76 
	#ETH_P_MPLS_MC
 0x8848

	)

77 
	#ETH_P_ATMMPOA
 0x884ø

	)

78 
	#ETH_P_PPP_DISC
 0x8863

	)

79 
	#ETH_P_PPP_SES
 0x8864

	)

80 
	#ETH_P_LINK_CTL
 0x886ø

	)

81 
	#ETH_P_ATMFATE
 0x8884

	)

84 
	#ETH_P_PAE
 0x888E

	)

85 
	#ETH_P_AOE
 0x88A2

	)

86 
	#ETH_P_8021AD
 0x88A8

	)

87 
	#ETH_P_802_EX1
 0x88B5

	)

88 
	#ETH_P_TIPC
 0x88CA

	)

89 
	#ETH_P_MACSEC
 0x88E5

	)

90 
	#ETH_P_8021AH
 0x88E7

	)

91 
	#ETH_P_MVRP
 0x88F5

	)

92 
	#ETH_P_1588
 0x88F7

	)

93 
	#ETH_P_NCSI
 0x88F8

	)

94 
	#ETH_P_PRP
 0x88FB

	)

95 
	#ETH_P_FCOE
 0x8906

	)

96 
	#ETH_P_TDLS
 0x890D

	)

97 
	#ETH_P_FIP
 0x8914

	)

98 
	#ETH_P_80221
 0x8917

	)

99 
	#ETH_P_HSR
 0x892F

	)

100 
	#ETH_P_LOOPBACK
 0x9000

	)

101 
	#ETH_P_QINQ1
 0x9100

	)

102 
	#ETH_P_QINQ2
 0x9200

	)

103 
	#ETH_P_QINQ3
 0x9300

	)

104 
	#ETH_P_EDSA
 0xDADA

	)

105 
	#ETH_P_AF_IUCV
 0xFBFB

	)

107 
	#ETH_P_802_3_MIN
 0x0600

	)

114 
	#ETH_P_802_3
 0x0001

	)

115 
	#ETH_P_AX25
 0x0002

	)

116 
	#ETH_P_ALL
 0x0003

	)

117 
	#ETH_P_802_2
 0x0004

	)

118 
	#ETH_P_SNAP
 0x0005

	)

119 
	#ETH_P_DDCMP
 0x0006

	)

120 
	#ETH_P_WAN_PPP
 0x0007

	)

121 
	#ETH_P_PPP_MP
 0x0008

	)

122 
	#ETH_P_LOCALTALK
 0x0009

	)

123 
	#ETH_P_CAN
 0x000C

	)

124 
	#ETH_P_CANFD
 0x000D

	)

125 
	#ETH_P_PPPTALK
 0x0010

	)

126 
	#ETH_P_TR_802_2
 0x0011

	)

127 
	#ETH_P_MOBITEX
 0x0015

	)

128 
	#ETH_P_CONTROL
 0x0016

	)

129 
	#ETH_P_IRDA
 0x0017

	)

130 
	#ETH_P_ECONET
 0x0018

	)

131 
	#ETH_P_HDLC
 0x0019

	)

132 
	#ETH_P_ARCNET
 0x001A

	)

133 
	#ETH_P_DSA
 0x001B

	)

134 
	#ETH_P_TRAILER
 0x001C

	)

135 
	#ETH_P_PHONET
 0x00F5

	)

136 
	#ETH_P_IEEE802154
 0x00F6

	)

137 
	#ETH_P_CAIF
 0x00F7

	)

138 
	#ETH_P_XDSA
 0x00F8

	)

144 
	s‘hhdr
 {

145 
	mh_de¡
[
ETH_ALEN
];

146 
	mh_sourû
[
ETH_ALEN
];

147 
__be16
 
	mh_´Ùo
;

148 } 
__©Œibu‹__
((
·cked
));

	@/usr/include/linux/if_link.h

1 #iâdeà
_LINUX_IF_LINK_H


2 
	#_LINUX_IF_LINK_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãšk.h
>

8 
	s¹Æ_lšk_¡©s
 {

9 
__u32
 
	mrx_·ck‘s
;

10 
__u32
 
	mtx_·ck‘s
;

11 
__u32
 
	mrx_by‹s
;

12 
__u32
 
	mtx_by‹s
;

13 
__u32
 
	mrx_”rÜs
;

14 
__u32
 
	mtx_”rÜs
;

15 
__u32
 
	mrx_drİ³d
;

16 
__u32
 
	mtx_drİ³d
;

17 
__u32
 
	mmuÉiÿ¡
;

18 
__u32
 
	mcŞlisiÚs
;

21 
__u32
 
	mrx_Ëngth_”rÜs
;

22 
__u32
 
	mrx_ov”_”rÜs
;

23 
__u32
 
	mrx_üc_”rÜs
;

24 
__u32
 
	mrx_äame_”rÜs
;

25 
__u32
 
	mrx_fifo_”rÜs
;

26 
__u32
 
	mrx_mis£d_”rÜs
;

29 
__u32
 
	mtx_abÜ‹d_”rÜs
;

30 
__u32
 
	mtx_ÿ¼›r_”rÜs
;

31 
__u32
 
	mtx_fifo_”rÜs
;

32 
__u32
 
	mtx_h—¹b—t_”rÜs
;

33 
__u32
 
	mtx_wšdow_”rÜs
;

36 
__u32
 
	mrx_com´es£d
;

37 
__u32
 
	mtx_com´es£d
;

39 
__u32
 
	mrx_nohªdËr
;

43 
	s¹Æ_lšk_¡©s64
 {

44 
__u64
 
	mrx_·ck‘s
;

45 
__u64
 
	mtx_·ck‘s
;

46 
__u64
 
	mrx_by‹s
;

47 
__u64
 
	mtx_by‹s
;

48 
__u64
 
	mrx_”rÜs
;

49 
__u64
 
	mtx_”rÜs
;

50 
__u64
 
	mrx_drİ³d
;

51 
__u64
 
	mtx_drİ³d
;

52 
__u64
 
	mmuÉiÿ¡
;

53 
__u64
 
	mcŞlisiÚs
;

56 
__u64
 
	mrx_Ëngth_”rÜs
;

57 
__u64
 
	mrx_ov”_”rÜs
;

58 
__u64
 
	mrx_üc_”rÜs
;

59 
__u64
 
	mrx_äame_”rÜs
;

60 
__u64
 
	mrx_fifo_”rÜs
;

61 
__u64
 
	mrx_mis£d_”rÜs
;

64 
__u64
 
	mtx_abÜ‹d_”rÜs
;

65 
__u64
 
	mtx_ÿ¼›r_”rÜs
;

66 
__u64
 
	mtx_fifo_”rÜs
;

67 
__u64
 
	mtx_h—¹b—t_”rÜs
;

68 
__u64
 
	mtx_wšdow_”rÜs
;

71 
__u64
 
	mrx_com´es£d
;

72 
__u64
 
	mtx_com´es£d
;

74 
__u64
 
	mrx_nohªdËr
;

78 
	s¹Æ_lšk_ifm­
 {

79 
__u64
 
	mmem_¡¬t
;

80 
__u64
 
	mmem_’d
;

81 
__u64
 
	mba£_addr
;

82 
__u16
 
	mœq
;

83 
__u8
 
	mdma
;

84 
__u8
 
	mpÜt
;

106 
	mIFLA_UNSPEC
,

107 
	mIFLA_ADDRESS
,

108 
	mIFLA_BROADCAST
,

109 
	mIFLA_IFNAME
,

110 
	mIFLA_MTU
,

111 
	mIFLA_LINK
,

112 
	mIFLA_QDISC
,

113 
	mIFLA_STATS
,

114 
	mIFLA_COST
,

115 
	#IFLA_COST
 
IFLA_COST


	)

116 
	mIFLA_PRIORITY
,

117 
	#IFLA_PRIORITY
 
IFLA_PRIORITY


	)

118 
	mIFLA_MASTER
,

119 
	#IFLA_MASTER
 
IFLA_MASTER


	)

120 
	mIFLA_WIRELESS
,

121 
	#IFLA_WIRELESS
 
IFLA_WIRELESS


	)

122 
	mIFLA_PROTINFO
,

123 
	#IFLA_PROTINFO
 
IFLA_PROTINFO


	)

124 
	mIFLA_TXQLEN
,

125 
	#IFLA_TXQLEN
 
IFLA_TXQLEN


	)

126 
	mIFLA_MAP
,

127 
	#IFLA_MAP
 
IFLA_MAP


	)

128 
	mIFLA_WEIGHT
,

129 
	#IFLA_WEIGHT
 
IFLA_WEIGHT


	)

130 
	mIFLA_OPERSTATE
,

131 
	mIFLA_LINKMODE
,

132 
	mIFLA_LINKINFO
,

133 
	#IFLA_LINKINFO
 
IFLA_LINKINFO


	)

134 
	mIFLA_NET_NS_PID
,

135 
	mIFLA_IFALIAS
,

136 
	mIFLA_NUM_VF
,

137 
	mIFLA_VFINFO_LIST
,

138 
	mIFLA_STATS64
,

139 
	mIFLA_VF_PORTS
,

140 
	mIFLA_PORT_SELF
,

141 
	mIFLA_AF_SPEC
,

142 
	mIFLA_GROUP
,

143 
	mIFLA_NET_NS_FD
,

144 
	mIFLA_EXT_MASK
,

145 
	mIFLA_PROMISCUITY
,

146 
	#IFLA_PROMISCUITY
 
IFLA_PROMISCUITY


	)

147 
	mIFLA_NUM_TX_QUEUES
,

148 
	mIFLA_NUM_RX_QUEUES
,

149 
	mIFLA_CARRIER
,

150 
	mIFLA_PHYS_PORT_ID
,

151 
	mIFLA_CARRIER_CHANGES
,

152 
	mIFLA_PHYS_SWITCH_ID
,

153 
	mIFLA_LINK_NETNSID
,

154 
	mIFLA_PHYS_PORT_NAME
,

155 
	mIFLA_PROTO_DOWN
,

156 
	mIFLA_GSO_MAX_SEGS
,

157 
	mIFLA_GSO_MAX_SIZE
,

158 
	mIFLA_PAD
,

159 
	mIFLA_XDP
,

160 
	m__IFLA_MAX


164 
	#IFLA_MAX
 (
__IFLA_MAX
 - 1)

	)

167 
	#IFLA_RTA
(
r
è((
¹©Œ
*)(((*)Ô)è+ 
	`NLMSG_ALIGN
((
ifšfomsg
))))

	)

168 
	#IFLA_PAYLOAD
(
n
è
	`NLMSG_PAYLOAD
Ò,(
ifšfomsg
))

	)

171 
	mIFLA_INET_UNSPEC
,

172 
	mIFLA_INET_CONF
,

173 
	m__IFLA_INET_MAX
,

176 
	#IFLA_INET_MAX
 (
__IFLA_INET_MAX
 - 1)

	)

209 
	mIFLA_INET6_UNSPEC
,

210 
	mIFLA_INET6_FLAGS
,

211 
	mIFLA_INET6_CONF
,

212 
	mIFLA_INET6_STATS
,

213 
	mIFLA_INET6_MCAST
,

214 
	mIFLA_INET6_CACHEINFO
,

215 
	mIFLA_INET6_ICMP6STATS
,

216 
	mIFLA_INET6_TOKEN
,

217 
	mIFLA_INET6_ADDR_GEN_MODE
,

218 
	m__IFLA_INET6_MAX


221 
	#IFLA_INET6_MAX
 (
__IFLA_INET6_MAX
 - 1)

	)

223 
	eš6_addr_g’_mode
 {

224 
	mIN6_ADDR_GEN_MODE_EUI64
,

225 
	mIN6_ADDR_GEN_MODE_NONE
,

226 
	mIN6_ADDR_GEN_MODE_STABLE_PRIVACY
,

227 
	mIN6_ADDR_GEN_MODE_RANDOM
,

233 
	mIFLA_BR_UNSPEC
,

234 
	mIFLA_BR_FORWARD_DELAY
,

235 
	mIFLA_BR_HELLO_TIME
,

236 
	mIFLA_BR_MAX_AGE
,

237 
	mIFLA_BR_AGEING_TIME
,

238 
	mIFLA_BR_STP_STATE
,

239 
	mIFLA_BR_PRIORITY
,

240 
	mIFLA_BR_VLAN_FILTERING
,

241 
	mIFLA_BR_VLAN_PROTOCOL
,

242 
	mIFLA_BR_GROUP_FWD_MASK
,

243 
	mIFLA_BR_ROOT_ID
,

244 
	mIFLA_BR_BRIDGE_ID
,

245 
	mIFLA_BR_ROOT_PORT
,

246 
	mIFLA_BR_ROOT_PATH_COST
,

247 
	mIFLA_BR_TOPOLOGY_CHANGE
,

248 
	mIFLA_BR_TOPOLOGY_CHANGE_DETECTED
,

249 
	mIFLA_BR_HELLO_TIMER
,

250 
	mIFLA_BR_TCN_TIMER
,

251 
	mIFLA_BR_TOPOLOGY_CHANGE_TIMER
,

252 
	mIFLA_BR_GC_TIMER
,

253 
	mIFLA_BR_GROUP_ADDR
,

254 
	mIFLA_BR_FDB_FLUSH
,

255 
	mIFLA_BR_MCAST_ROUTER
,

256 
	mIFLA_BR_MCAST_SNOOPING
,

257 
	mIFLA_BR_MCAST_QUERY_USE_IFADDR
,

258 
	mIFLA_BR_MCAST_QUERIER
,

259 
	mIFLA_BR_MCAST_HASH_ELASTICITY
,

260 
	mIFLA_BR_MCAST_HASH_MAX
,

261 
	mIFLA_BR_MCAST_LAST_MEMBER_CNT
,

262 
	mIFLA_BR_MCAST_STARTUP_QUERY_CNT
,

263 
	mIFLA_BR_MCAST_LAST_MEMBER_INTVL
,

264 
	mIFLA_BR_MCAST_MEMBERSHIP_INTVL
,

265 
	mIFLA_BR_MCAST_QUERIER_INTVL
,

266 
	mIFLA_BR_MCAST_QUERY_INTVL
,

267 
	mIFLA_BR_MCAST_QUERY_RESPONSE_INTVL
,

268 
	mIFLA_BR_MCAST_STARTUP_QUERY_INTVL
,

269 
	mIFLA_BR_NF_CALL_IPTABLES
,

270 
	mIFLA_BR_NF_CALL_IP6TABLES
,

271 
	mIFLA_BR_NF_CALL_ARPTABLES
,

272 
	mIFLA_BR_VLAN_DEFAULT_PVID
,

273 
	mIFLA_BR_PAD
,

274 
	mIFLA_BR_VLAN_STATS_ENABLED
,

275 
	mIFLA_BR_MCAST_STATS_ENABLED
,

276 
	mIFLA_BR_MCAST_IGMP_VERSION
,

277 
	mIFLA_BR_MCAST_MLD_VERSION
,

278 
	m__IFLA_BR_MAX
,

281 
	#IFLA_BR_MAX
 (
__IFLA_BR_MAX
 - 1)

	)

283 
	siæa_bridge_id
 {

284 
__u8
 
	m´io
[2];

285 
__u8
 
	maddr
[6];

289 
	mBRIDGE_MODE_UNSPEC
,

290 
	mBRIDGE_MODE_HAIRPIN
,

294 
	mIFLA_BRPORT_UNSPEC
,

295 
	mIFLA_BRPORT_STATE
,

296 
	mIFLA_BRPORT_PRIORITY
,

297 
	mIFLA_BRPORT_COST
,

298 
	mIFLA_BRPORT_MODE
,

299 
	mIFLA_BRPORT_GUARD
,

300 
	mIFLA_BRPORT_PROTECT
,

301 
	mIFLA_BRPORT_FAST_LEAVE
,

302 
	mIFLA_BRPORT_LEARNING
,

303 
	mIFLA_BRPORT_UNICAST_FLOOD
,

304 
	mIFLA_BRPORT_PROXYARP
,

305 
	mIFLA_BRPORT_LEARNING_SYNC
,

306 
	mIFLA_BRPORT_PROXYARP_WIFI
,

307 
	mIFLA_BRPORT_ROOT_ID
,

308 
	mIFLA_BRPORT_BRIDGE_ID
,

309 
	mIFLA_BRPORT_DESIGNATED_PORT
,

310 
	mIFLA_BRPORT_DESIGNATED_COST
,

311 
	mIFLA_BRPORT_ID
,

312 
	mIFLA_BRPORT_NO
,

313 
	mIFLA_BRPORT_TOPOLOGY_CHANGE_ACK
,

314 
	mIFLA_BRPORT_CONFIG_PENDING
,

315 
	mIFLA_BRPORT_MESSAGE_AGE_TIMER
,

316 
	mIFLA_BRPORT_FORWARD_DELAY_TIMER
,

317 
	mIFLA_BRPORT_HOLD_TIMER
,

318 
	mIFLA_BRPORT_FLUSH
,

319 
	mIFLA_BRPORT_MULTICAST_ROUTER
,

320 
	mIFLA_BRPORT_PAD
,

321 
	mIFLA_BRPORT_MCAST_FLOOD
,

322 
	m__IFLA_BRPORT_MAX


324 
	#IFLA_BRPORT_MAX
 (
__IFLA_BRPORT_MAX
 - 1)

	)

326 
	siæa_ÿchešfo
 {

327 
__u32
 
	mmax_»asm_Ën
;

328 
__u32
 
	mt¡amp
;

329 
__u32
 
	m»achabË_time
;

330 
__u32
 
	m»Œªs_time
;

334 
	mIFLA_INFO_UNSPEC
,

335 
	mIFLA_INFO_KIND
,

336 
	mIFLA_INFO_DATA
,

337 
	mIFLA_INFO_XSTATS
,

338 
	mIFLA_INFO_SLAVE_KIND
,

339 
	mIFLA_INFO_SLAVE_DATA
,

340 
	m__IFLA_INFO_MAX
,

343 
	#IFLA_INFO_MAX
 (
__IFLA_INFO_MAX
 - 1)

	)

348 
	mIFLA_VLAN_UNSPEC
,

349 
	mIFLA_VLAN_ID
,

350 
	mIFLA_VLAN_FLAGS
,

351 
	mIFLA_VLAN_EGRESS_QOS
,

352 
	mIFLA_VLAN_INGRESS_QOS
,

353 
	mIFLA_VLAN_PROTOCOL
,

354 
	m__IFLA_VLAN_MAX
,

357 
	#IFLA_VLAN_MAX
 (
__IFLA_VLAN_MAX
 - 1)

	)

359 
	siæa_vÏn_æags
 {

360 
__u32
 
	mæags
;

361 
__u32
 
	mmask
;

365 
	mIFLA_VLAN_QOS_UNSPEC
,

366 
	mIFLA_VLAN_QOS_MAPPING
,

367 
	m__IFLA_VLAN_QOS_MAX


370 
	#IFLA_VLAN_QOS_MAX
 (
__IFLA_VLAN_QOS_MAX
 - 1)

	)

372 
	siæa_vÏn_qos_m­pšg
 {

373 
__u32
 
	mäom
;

374 
__u32
 
	mto
;

379 
	mIFLA_MACVLAN_UNSPEC
,

380 
	mIFLA_MACVLAN_MODE
,

381 
	mIFLA_MACVLAN_FLAGS
,

382 
	mIFLA_MACVLAN_MACADDR_MODE
,

383 
	mIFLA_MACVLAN_MACADDR
,

384 
	mIFLA_MACVLAN_MACADDR_DATA
,

385 
	mIFLA_MACVLAN_MACADDR_COUNT
,

386 
	m__IFLA_MACVLAN_MAX
,

389 
	#IFLA_MACVLAN_MAX
 (
__IFLA_MACVLAN_MAX
 - 1)

	)

391 
	emacvÏn_mode
 {

392 
	mMACVLAN_MODE_PRIVATE
 = 1,

393 
	mMACVLAN_MODE_VEPA
 = 2,

394 
	mMACVLAN_MODE_BRIDGE
 = 4,

395 
	mMACVLAN_MODE_PASSTHRU
 = 8,

396 
	mMACVLAN_MODE_SOURCE
 = 16,

399 
	emacvÏn_maÿddr_mode
 {

400 
	mMACVLAN_MACADDR_ADD
,

401 
	mMACVLAN_MACADDR_DEL
,

402 
	mMACVLAN_MACADDR_FLUSH
,

403 
	mMACVLAN_MACADDR_SET
,

406 
	#MACVLAN_FLAG_NOPROMISC
 1

	)

410 
	mIFLA_VRF_UNSPEC
,

411 
	mIFLA_VRF_TABLE
,

412 
	m__IFLA_VRF_MAX


415 
	#IFLA_VRF_MAX
 (
__IFLA_VRF_MAX
 - 1)

	)

418 
	mIFLA_VRF_PORT_UNSPEC
,

419 
	mIFLA_VRF_PORT_TABLE
,

420 
	m__IFLA_VRF_PORT_MAX


423 
	#IFLA_VRF_PORT_MAX
 (
__IFLA_VRF_PORT_MAX
 - 1)

	)

427 
	mIFLA_MACSEC_UNSPEC
,

428 
	mIFLA_MACSEC_SCI
,

429 
	mIFLA_MACSEC_PORT
,

430 
	mIFLA_MACSEC_ICV_LEN
,

431 
	mIFLA_MACSEC_CIPHER_SUITE
,

432 
	mIFLA_MACSEC_WINDOW
,

433 
	mIFLA_MACSEC_ENCODING_SA
,

434 
	mIFLA_MACSEC_ENCRYPT
,

435 
	mIFLA_MACSEC_PROTECT
,

436 
	mIFLA_MACSEC_INC_SCI
,

437 
	mIFLA_MACSEC_ES
,

438 
	mIFLA_MACSEC_SCB
,

439 
	mIFLA_MACSEC_REPLAY_PROTECT
,

440 
	mIFLA_MACSEC_VALIDATION
,

441 
	mIFLA_MACSEC_PAD
,

442 
	m__IFLA_MACSEC_MAX
,

445 
	#IFLA_MACSEC_MAX
 (
__IFLA_MACSEC_MAX
 - 1)

	)

447 
	emac£c_v®id©iÚ_ty³
 {

448 
	mMACSEC_VALIDATE_DISABLED
 = 0,

449 
	mMACSEC_VALIDATE_CHECK
 = 1,

450 
	mMACSEC_VALIDATE_STRICT
 = 2,

451 
	m__MACSEC_VALIDATE_END
,

452 
	mMACSEC_VALIDATE_MAX
 = 
__MACSEC_VALIDATE_END
 - 1,

457 
	mIFLA_IPVLAN_UNSPEC
,

458 
	mIFLA_IPVLAN_MODE
,

459 
	m__IFLA_IPVLAN_MAX


462 
	#IFLA_IPVLAN_MAX
 (
__IFLA_IPVLAN_MAX
 - 1)

	)

464 
	evÏn_mode
 {

465 
	mIPVLAN_MODE_L2
 = 0,

466 
	mIPVLAN_MODE_L3
,

467 
	mIPVLAN_MODE_L3S
,

468 
	mIPVLAN_MODE_MAX


473 
	mIFLA_VXLAN_UNSPEC
,

474 
	mIFLA_VXLAN_ID
,

475 
	mIFLA_VXLAN_GROUP
,

476 
	mIFLA_VXLAN_LINK
,

477 
	mIFLA_VXLAN_LOCAL
,

478 
	mIFLA_VXLAN_TTL
,

479 
	mIFLA_VXLAN_TOS
,

480 
	mIFLA_VXLAN_LEARNING
,

481 
	mIFLA_VXLAN_AGEING
,

482 
	mIFLA_VXLAN_LIMIT
,

483 
	mIFLA_VXLAN_PORT_RANGE
,

484 
	mIFLA_VXLAN_PROXY
,

485 
	mIFLA_VXLAN_RSC
,

486 
	mIFLA_VXLAN_L2MISS
,

487 
	mIFLA_VXLAN_L3MISS
,

488 
	mIFLA_VXLAN_PORT
,

489 
	mIFLA_VXLAN_GROUP6
,

490 
	mIFLA_VXLAN_LOCAL6
,

491 
	mIFLA_VXLAN_UDP_CSUM
,

492 
	mIFLA_VXLAN_UDP_ZERO_CSUM6_TX
,

493 
	mIFLA_VXLAN_UDP_ZERO_CSUM6_RX
,

494 
	mIFLA_VXLAN_REMCSUM_TX
,

495 
	mIFLA_VXLAN_REMCSUM_RX
,

496 
	mIFLA_VXLAN_GBP
,

497 
	mIFLA_VXLAN_REMCSUM_NOPARTIAL
,

498 
	mIFLA_VXLAN_COLLECT_METADATA
,

499 
	mIFLA_VXLAN_LABEL
,

500 
	mIFLA_VXLAN_GPE
,

501 
	m__IFLA_VXLAN_MAX


503 
	#IFLA_VXLAN_MAX
 (
__IFLA_VXLAN_MAX
 - 1)

	)

505 
	siæa_vxÏn_pÜt_¿nge
 {

506 
__be16
 
	mlow
;

507 
__be16
 
	mhigh
;

512 
	mIFLA_GENEVE_UNSPEC
,

513 
	mIFLA_GENEVE_ID
,

514 
	mIFLA_GENEVE_REMOTE
,

515 
	mIFLA_GENEVE_TTL
,

516 
	mIFLA_GENEVE_TOS
,

517 
	mIFLA_GENEVE_PORT
,

518 
	mIFLA_GENEVE_COLLECT_METADATA
,

519 
	mIFLA_GENEVE_REMOTE6
,

520 
	mIFLA_GENEVE_UDP_CSUM
,

521 
	mIFLA_GENEVE_UDP_ZERO_CSUM6_TX
,

522 
	mIFLA_GENEVE_UDP_ZERO_CSUM6_RX
,

523 
	mIFLA_GENEVE_LABEL
,

524 
	m__IFLA_GENEVE_MAX


526 
	#IFLA_GENEVE_MAX
 (
__IFLA_GENEVE_MAX
 - 1)

	)

530 
	mIFLA_PPP_UNSPEC
,

531 
	mIFLA_PPP_DEV_FD
,

532 
	m__IFLA_PPP_MAX


534 
	#IFLA_PPP_MAX
 (
__IFLA_PPP_MAX
 - 1)

	)

538 
	mIFLA_GTP_UNSPEC
,

539 
	mIFLA_GTP_FD0
,

540 
	mIFLA_GTP_FD1
,

541 
	mIFLA_GTP_PDP_HASHSIZE
,

542 
	m__IFLA_GTP_MAX
,

544 
	#IFLA_GTP_MAX
 (
__IFLA_GTP_MAX
 - 1)

	)

549 
	mIFLA_BOND_UNSPEC
,

550 
	mIFLA_BOND_MODE
,

551 
	mIFLA_BOND_ACTIVE_SLAVE
,

552 
	mIFLA_BOND_MIIMON
,

553 
	mIFLA_BOND_UPDELAY
,

554 
	mIFLA_BOND_DOWNDELAY
,

555 
	mIFLA_BOND_USE_CARRIER
,

556 
	mIFLA_BOND_ARP_INTERVAL
,

557 
	mIFLA_BOND_ARP_IP_TARGET
,

558 
	mIFLA_BOND_ARP_VALIDATE
,

559 
	mIFLA_BOND_ARP_ALL_TARGETS
,

560 
	mIFLA_BOND_PRIMARY
,

561 
	mIFLA_BOND_PRIMARY_RESELECT
,

562 
	mIFLA_BOND_FAIL_OVER_MAC
,

563 
	mIFLA_BOND_XMIT_HASH_POLICY
,

564 
	mIFLA_BOND_RESEND_IGMP
,

565 
	mIFLA_BOND_NUM_PEER_NOTIF
,

566 
	mIFLA_BOND_ALL_SLAVES_ACTIVE
,

567 
	mIFLA_BOND_MIN_LINKS
,

568 
	mIFLA_BOND_LP_INTERVAL
,

569 
	mIFLA_BOND_PACKETS_PER_SLAVE
,

570 
	mIFLA_BOND_AD_LACP_RATE
,

571 
	mIFLA_BOND_AD_SELECT
,

572 
	mIFLA_BOND_AD_INFO
,

573 
	mIFLA_BOND_AD_ACTOR_SYS_PRIO
,

574 
	mIFLA_BOND_AD_USER_PORT_KEY
,

575 
	mIFLA_BOND_AD_ACTOR_SYSTEM
,

576 
	mIFLA_BOND_TLB_DYNAMIC_LB
,

577 
	m__IFLA_BOND_MAX
,

580 
	#IFLA_BOND_MAX
 (
__IFLA_BOND_MAX
 - 1)

	)

583 
	mIFLA_BOND_AD_INFO_UNSPEC
,

584 
	mIFLA_BOND_AD_INFO_AGGREGATOR
,

585 
	mIFLA_BOND_AD_INFO_NUM_PORTS
,

586 
	mIFLA_BOND_AD_INFO_ACTOR_KEY
,

587 
	mIFLA_BOND_AD_INFO_PARTNER_KEY
,

588 
	mIFLA_BOND_AD_INFO_PARTNER_MAC
,

589 
	m__IFLA_BOND_AD_INFO_MAX
,

592 
	#IFLA_BOND_AD_INFO_MAX
 (
__IFLA_BOND_AD_INFO_MAX
 - 1)

	)

595 
	mIFLA_BOND_SLAVE_UNSPEC
,

596 
	mIFLA_BOND_SLAVE_STATE
,

597 
	mIFLA_BOND_SLAVE_MII_STATUS
,

598 
	mIFLA_BOND_SLAVE_LINK_FAILURE_COUNT
,

599 
	mIFLA_BOND_SLAVE_PERM_HWADDR
,

600 
	mIFLA_BOND_SLAVE_QUEUE_ID
,

601 
	mIFLA_BOND_SLAVE_AD_AGGREGATOR_ID
,

602 
	mIFLA_BOND_SLAVE_AD_ACTOR_OPER_PORT_STATE
,

603 
	mIFLA_BOND_SLAVE_AD_PARTNER_OPER_PORT_STATE
,

604 
	m__IFLA_BOND_SLAVE_MAX
,

607 
	#IFLA_BOND_SLAVE_MAX
 (
__IFLA_BOND_SLAVE_MAX
 - 1)

	)

612 
	mIFLA_VF_INFO_UNSPEC
,

613 
	mIFLA_VF_INFO
,

614 
	m__IFLA_VF_INFO_MAX
,

617 
	#IFLA_VF_INFO_MAX
 (
__IFLA_VF_INFO_MAX
 - 1)

	)

620 
	mIFLA_VF_UNSPEC
,

621 
	mIFLA_VF_MAC
,

622 
	mIFLA_VF_VLAN
,

623 
	mIFLA_VF_TX_RATE
,

624 
	mIFLA_VF_SPOOFCHK
,

625 
	mIFLA_VF_LINK_STATE
,

626 
	mIFLA_VF_RATE
,

627 
	mIFLA_VF_RSS_QUERY_EN
,

630 
	mIFLA_VF_STATS
,

631 
	mIFLA_VF_TRUST
,

632 
	mIFLA_VF_IB_NODE_GUID
,

633 
	mIFLA_VF_IB_PORT_GUID
,

634 
	mIFLA_VF_VLAN_LIST
,

635 
	m__IFLA_VF_MAX
,

638 
	#IFLA_VF_MAX
 (
__IFLA_VF_MAX
 - 1)

	)

640 
	siæa_vf_mac
 {

641 
__u32
 
	mvf
;

642 
__u8
 
	mmac
[32];

645 
	siæa_vf_vÏn
 {

646 
__u32
 
	mvf
;

647 
__u32
 
	mvÏn
;

648 
__u32
 
	mqos
;

652 
	mIFLA_VF_VLAN_INFO_UNSPEC
,

653 
	mIFLA_VF_VLAN_INFO
,

654 
	m__IFLA_VF_VLAN_INFO_MAX
,

657 
	#IFLA_VF_VLAN_INFO_MAX
 (
__IFLA_VF_VLAN_INFO_MAX
 - 1)

	)

658 
	#MAX_VLAN_LIST_LEN
 1

	)

660 
	siæa_vf_vÏn_šfo
 {

661 
__u32
 
	mvf
;

662 
__u32
 
	mvÏn
;

663 
__u32
 
	mqos
;

664 
__be16
 
	mvÏn_´Ùo
;

667 
	siæa_vf_tx_¿‹
 {

668 
__u32
 
	mvf
;

669 
__u32
 
	m¿‹
;

672 
	siæa_vf_¿‹
 {

673 
__u32
 
	mvf
;

674 
__u32
 
	mmš_tx_¿‹
;

675 
__u32
 
	mmax_tx_¿‹
;

678 
	siæa_vf_¥oofchk
 {

679 
__u32
 
	mvf
;

680 
__u32
 
	m£‰šg
;

683 
	siæa_vf_guid
 {

684 
__u32
 
	mvf
;

685 
__u64
 
	mguid
;

689 
	mIFLA_VF_LINK_STATE_AUTO
,

690 
	mIFLA_VF_LINK_STATE_ENABLE
,

691 
	mIFLA_VF_LINK_STATE_DISABLE
,

692 
	m__IFLA_VF_LINK_STATE_MAX
,

695 
	siæa_vf_lšk_¡©e
 {

696 
__u32
 
	mvf
;

697 
__u32
 
	mlšk_¡©e
;

700 
	siæa_vf_rss_qu”y_’
 {

701 
__u32
 
	mvf
;

702 
__u32
 
	m£‰šg
;

706 
	mIFLA_VF_STATS_RX_PACKETS
,

707 
	mIFLA_VF_STATS_TX_PACKETS
,

708 
	mIFLA_VF_STATS_RX_BYTES
,

709 
	mIFLA_VF_STATS_TX_BYTES
,

710 
	mIFLA_VF_STATS_BROADCAST
,

711 
	mIFLA_VF_STATS_MULTICAST
,

712 
	mIFLA_VF_STATS_PAD
,

713 
	m__IFLA_VF_STATS_MAX
,

716 
	#IFLA_VF_STATS_MAX
 (
__IFLA_VF_STATS_MAX
 - 1)

	)

718 
	siæa_vf_Œu¡
 {

719 
__u32
 
	mvf
;

720 
__u32
 
	m£‰šg
;

739 
	mIFLA_VF_PORT_UNSPEC
,

740 
	mIFLA_VF_PORT
,

741 
	m__IFLA_VF_PORT_MAX
,

744 
	#IFLA_VF_PORT_MAX
 (
__IFLA_VF_PORT_MAX
 - 1)

	)

747 
	mIFLA_PORT_UNSPEC
,

748 
	mIFLA_PORT_VF
,

749 
	mIFLA_PORT_PROFILE
,

750 
	mIFLA_PORT_VSI_TYPE
,

751 
	mIFLA_PORT_INSTANCE_UUID
,

752 
	mIFLA_PORT_HOST_UUID
,

753 
	mIFLA_PORT_REQUEST
,

754 
	mIFLA_PORT_RESPONSE
,

755 
	m__IFLA_PORT_MAX
,

758 
	#IFLA_PORT_MAX
 (
__IFLA_PORT_MAX
 - 1)

	)

760 
	#PORT_PROFILE_MAX
 40

	)

761 
	#PORT_UUID_MAX
 16

	)

762 
	#PORT_SELF_VF
 -1

	)

765 
	mPORT_REQUEST_PREASSOCIATE
 = 0,

766 
	mPORT_REQUEST_PREASSOCIATE_RR
,

767 
	mPORT_REQUEST_ASSOCIATE
,

768 
	mPORT_REQUEST_DISASSOCIATE
,

772 
	mPORT_VDP_RESPONSE_SUCCESS
 = 0,

773 
	mPORT_VDP_RESPONSE_INVALID_FORMAT
,

774 
	mPORT_VDP_RESPONSE_INSUFFICIENT_RESOURCES
,

775 
	mPORT_VDP_RESPONSE_UNUSED_VTID
,

776 
	mPORT_VDP_RESPONSE_VTID_VIOLATION
,

777 
	mPORT_VDP_RESPONSE_VTID_VERSION_VIOALTION
,

778 
	mPORT_VDP_RESPONSE_OUT_OF_SYNC
,

780 
	mPORT_PROFILE_RESPONSE_SUCCESS
 = 0x100,

781 
	mPORT_PROFILE_RESPONSE_INPROGRESS
,

782 
	mPORT_PROFILE_RESPONSE_INVALID
,

783 
	mPORT_PROFILE_RESPONSE_BADSTATE
,

784 
	mPORT_PROFILE_RESPONSE_INSUFFICIENT_RESOURCES
,

785 
	mPORT_PROFILE_RESPONSE_ERROR
,

788 
	siæa_pÜt_vsi
 {

789 
__u8
 
	mvsi_mgr_id
;

790 
__u8
 
	mvsi_ty³_id
[3];

791 
__u8
 
	mvsi_ty³_v”siÚ
;

792 
__u8
 
	m·d
[3];

799 
	mIFLA_IPOIB_UNSPEC
,

800 
	mIFLA_IPOIB_PKEY
,

801 
	mIFLA_IPOIB_MODE
,

802 
	mIFLA_IPOIB_UMCAST
,

803 
	m__IFLA_IPOIB_MAX


807 
	mIPOIB_MODE_DATAGRAM
 = 0,

808 
	mIPOIB_MODE_CONNECTED
 = 1,

811 
	#IFLA_IPOIB_MAX
 (
__IFLA_IPOIB_MAX
 - 1)

	)

817 
	mIFLA_HSR_UNSPEC
,

818 
	mIFLA_HSR_SLAVE1
,

819 
	mIFLA_HSR_SLAVE2
,

820 
	mIFLA_HSR_MULTICAST_SPEC
,

821 
	mIFLA_HSR_SUPERVISION_ADDR
,

822 
	mIFLA_HSR_SEQ_NR
,

823 
	mIFLA_HSR_VERSION
,

824 
	m__IFLA_HSR_MAX
,

827 
	#IFLA_HSR_MAX
 (
__IFLA_HSR_MAX
 - 1)

	)

831 
	sif_¡©s_msg
 {

832 
__u8
 
	mçmy
;

833 
__u8
 
	m·d1
;

834 
__u16
 
	m·d2
;

835 
__u32
 
	mifšdex
;

836 
__u32
 
	mf‹r_mask
;

843 
	mIFLA_STATS_UNSPEC
,

844 
	mIFLA_STATS_LINK_64
,

845 
	mIFLA_STATS_LINK_XSTATS
,

846 
	mIFLA_STATS_LINK_XSTATS_SLAVE
,

847 
	mIFLA_STATS_LINK_OFFLOAD_XSTATS
,

848 
	m__IFLA_STATS_MAX
,

851 
	#IFLA_STATS_MAX
 (
__IFLA_STATS_MAX
 - 1)

	)

853 
	#IFLA_STATS_FILTER_BIT
(
ATTR
è(1 << (ATTR - 1))

	)

861 
	mLINK_XSTATS_TYPE_UNSPEC
,

862 
	mLINK_XSTATS_TYPE_BRIDGE
,

863 
	m__LINK_XSTATS_TYPE_MAX


865 
	#LINK_XSTATS_TYPE_MAX
 (
__LINK_XSTATS_TYPE_MAX
 - 1)

	)

869 
	mIFLA_OFFLOAD_XSTATS_UNSPEC
,

870 
	mIFLA_OFFLOAD_XSTATS_CPU_HIT
,

871 
	m__IFLA_OFFLOAD_XSTATS_MAX


873 
	#IFLA_OFFLOAD_XSTATS_MAX
 (
__IFLA_OFFLOAD_XSTATS_MAX
 - 1)

	)

877 
	#XDP_FLAGS_UPDATE_IF_NOEXIST
 (1U << 0)

	)

878 
	#XDP_FLAGS_MASK
 (
XDP_FLAGS_UPDATE_IF_NOEXIST
)

	)

881 
	mIFLA_XDP_UNSPEC
,

882 
	mIFLA_XDP_FD
,

883 
	mIFLA_XDP_ATTACHED
,

884 
	mIFLA_XDP_FLAGS
,

885 
	m__IFLA_XDP_MAX
,

888 
	#IFLA_XDP_MAX
 (
__IFLA_XDP_MAX
 - 1)

	)

	@/usr/include/linux/if_packet.h

1 #iâdeà
__LINUX_IF_PACKET_H


2 
	#__LINUX_IF_PACKET_H


	)

4 
	~<lšux/ty³s.h
>

6 
	ssockaddr_pkt
 {

7 
	m¥kt_çmy
;

8 
	m¥kt_deviû
[14];

9 
__be16
 
	m¥kt_´ÙocŞ
;

12 
	ssockaddr_Î
 {

13 
	m¦l_çmy
;

14 
__be16
 
	m¦l_´ÙocŞ
;

15 
	m¦l_ifšdex
;

16 
	m¦l_h©y³
;

17 
	m¦l_pk‰y³
;

18 
	m¦l_h®’
;

19 
	m¦l_addr
[8];

24 
	#PACKET_HOST
 0

	)

25 
	#PACKET_BROADCAST
 1

	)

26 
	#PACKET_MULTICAST
 2

	)

27 
	#PACKET_OTHERHOST
 3

	)

28 
	#PACKET_OUTGOING
 4

	)

29 
	#PACKET_LOOPBACK
 5

	)

30 
	#PACKET_USER
 6

	)

31 
	#PACKET_KERNEL
 7

	)

33 
	#PACKET_FASTROUTE
 6

	)

37 
	#PACKET_ADD_MEMBERSHIP
 1

	)

38 
	#PACKET_DROP_MEMBERSHIP
 2

	)

39 
	#PACKET_RECV_OUTPUT
 3

	)

41 
	#PACKET_RX_RING
 5

	)

42 
	#PACKET_STATISTICS
 6

	)

43 
	#PACKET_COPY_THRESH
 7

	)

44 
	#PACKET_AUXDATA
 8

	)

45 
	#PACKET_ORIGDEV
 9

	)

46 
	#PACKET_VERSION
 10

	)

47 
	#PACKET_HDRLEN
 11

	)

48 
	#PACKET_RESERVE
 12

	)

49 
	#PACKET_TX_RING
 13

	)

50 
	#PACKET_LOSS
 14

	)

51 
	#PACKET_VNET_HDR
 15

	)

52 
	#PACKET_TX_TIMESTAMP
 16

	)

53 
	#PACKET_TIMESTAMP
 17

	)

54 
	#PACKET_FANOUT
 18

	)

55 
	#PACKET_TX_HAS_OFF
 19

	)

56 
	#PACKET_QDISC_BYPASS
 20

	)

57 
	#PACKET_ROLLOVER_STATS
 21

	)

58 
	#PACKET_FANOUT_DATA
 22

	)

60 
	#PACKET_FANOUT_HASH
 0

	)

61 
	#PACKET_FANOUT_LB
 1

	)

62 
	#PACKET_FANOUT_CPU
 2

	)

63 
	#PACKET_FANOUT_ROLLOVER
 3

	)

64 
	#PACKET_FANOUT_RND
 4

	)

65 
	#PACKET_FANOUT_QM
 5

	)

66 
	#PACKET_FANOUT_CBPF
 6

	)

67 
	#PACKET_FANOUT_EBPF
 7

	)

68 
	#PACKET_FANOUT_FLAG_ROLLOVER
 0x1000

	)

69 
	#PACKET_FANOUT_FLAG_DEFRAG
 0x8000

	)

71 
	sack‘_¡©s
 {

72 
	m_·ck‘s
;

73 
	m_drİs
;

76 
	sack‘_¡©s_v3
 {

77 
	m_·ck‘s
;

78 
	m_drİs
;

79 
	m_ä“ze_q_út
;

82 
	sack‘_rŞlov”_¡©s
 {

83 
__®igÃd_u64
 
	m_®l
;

84 
__®igÃd_u64
 
	m_huge
;

85 
__®igÃd_u64
 
	m_çed
;

88 
	uack‘_¡©s_u
 {

89 
ack‘_¡©s
 
	m¡©s1
;

90 
ack‘_¡©s_v3
 
	m¡©s3
;

93 
	sack‘_auxd©a
 {

94 
__u32
 
	m_¡©us
;

95 
__u32
 
	m_Ën
;

96 
__u32
 
	m_¢­Ën
;

97 
__u16
 
	m_mac
;

98 
__u16
 
	m_Ãt
;

99 
__u16
 
	m_vÏn_tci
;

100 
__u16
 
	m_vÏn_id
;

104 
	#TP_STATUS_KERNEL
 0

	)

105 
	#TP_STATUS_USER
 (1 << 0)

	)

106 
	#TP_STATUS_COPY
 (1 << 1)

	)

107 
	#TP_STATUS_LOSING
 (1 << 2)

	)

108 
	#TP_STATUS_CSUMNOTREADY
 (1 << 3)

	)

109 
	#TP_STATUS_VLAN_VALID
 (1 << 4è

	)

110 
	#TP_STATUS_BLK_TMO
 (1 << 5)

	)

111 
	#TP_STATUS_VLAN_TPID_VALID
 (1 << 6è

	)

112 
	#TP_STATUS_CSUM_VALID
 (1 << 7)

	)

115 
	#TP_STATUS_AVAILABLE
 0

	)

116 
	#TP_STATUS_SEND_REQUEST
 (1 << 0)

	)

117 
	#TP_STATUS_SENDING
 (1 << 1)

	)

118 
	#TP_STATUS_WRONG_FORMAT
 (1 << 2)

	)

121 
	#TP_STATUS_TS_SOFTWARE
 (1 << 29)

	)

122 
	#TP_STATUS_TS_SYS_HARDWARE
 (1 << 30è

	)

123 
	#TP_STATUS_TS_RAW_HARDWARE
 (1 << 31)

	)

126 
	#TP_FT_REQ_FILL_RXHASH
 0x1

	)

128 
	sack‘_hdr
 {

129 
	m_¡©us
;

130 
	m_Ën
;

131 
	m_¢­Ën
;

132 
	m_mac
;

133 
	m_Ãt
;

134 
	m_£c
;

135 
	m_u£c
;

138 
	#TPACKET_ALIGNMENT
 16

	)

139 
	#TPACKET_ALIGN
(
x
è(((x)+
TPACKET_ALIGNMENT
-1)&~(TPACKET_ALIGNMENT-1))

	)

140 
	#TPACKET_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘_hdr
)è+ (
sockaddr_Î
))

	)

142 
	sack‘2_hdr
 {

143 
__u32
 
	m_¡©us
;

144 
__u32
 
	m_Ën
;

145 
__u32
 
	m_¢­Ën
;

146 
__u16
 
	m_mac
;

147 
__u16
 
	m_Ãt
;

148 
__u32
 
	m_£c
;

149 
__u32
 
	m_n£c
;

150 
__u16
 
	m_vÏn_tci
;

151 
__u16
 
	m_vÏn_id
;

152 
__u8
 
	m_·ddšg
[4];

155 
	sack‘_hdr_v¬ŸÁ1
 {

156 
__u32
 
	m_rxhash
;

157 
__u32
 
	m_vÏn_tci
;

158 
__u16
 
	m_vÏn_id
;

159 
__u16
 
	m_·ddšg
;

162 
	sack‘3_hdr
 {

163 
__u32
 
	m_Ãxt_off£t
;

164 
__u32
 
	m_£c
;

165 
__u32
 
	m_n£c
;

166 
__u32
 
	m_¢­Ën
;

167 
__u32
 
	m_Ën
;

168 
__u32
 
	m_¡©us
;

169 
__u16
 
	m_mac
;

170 
__u16
 
	m_Ãt
;

173 
ack‘_hdr_v¬ŸÁ1
 
	mhv1
;

175 
__u8
 
	m_·ddšg
[8];

178 
	sack‘_bd_ts
 {

179 
	mts_£c
;

181 
	mts_u£c
;

182 
	mts_n£c
;

186 
	sack‘_hdr_v1
 {

187 
__u32
 
	mblock_¡©us
;

188 
__u32
 
	mnum_pkts
;

189 
__u32
 
	moff£t_to_fœ¡_pkt
;

194 
__u32
 
	mblk_Ën
;

205 
__®igÃd_u64
 
	m£q_num
;

232 
ack‘_bd_ts
 
	mts_fœ¡_pkt
, 
	mts_Ï¡_pkt
;

235 
	uack‘_bd_h—d”_u
 {

236 
ack‘_hdr_v1
 
	mbh1
;

239 
	sack‘_block_desc
 {

240 
__u32
 
	mv”siÚ
;

241 
__u32
 
	moff£t_to_´iv
;

242 
ack‘_bd_h—d”_u
 
	mhdr
;

245 
	#TPACKET2_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘2_hdr
)è+ (
sockaddr_Î
))

	)

246 
	#TPACKET3_HDRLEN
 (
	`TPACKET_ALIGN
((
ack‘3_hdr
)è+ (
sockaddr_Î
))

	)

248 
	eack‘_v”siÚs
 {

249 
	mTPACKET_V1
,

250 
	mTPACKET_V2
,

251 
	mTPACKET_V3


267 
	sack‘_»q
 {

268 
	m_block_size
;

269 
	m_block_Ä
;

270 
	m_äame_size
;

271 
	m_äame_Ä
;

274 
	sack‘_»q3
 {

275 
	m_block_size
;

276 
	m_block_Ä
;

277 
	m_äame_size
;

278 
	m_äame_Ä
;

279 
	m_»tœe_blk_tov
;

280 
	m_sizeof_´iv
;

281 
	m_ã©u»_»q_wÜd
;

284 
	uack‘_»q_u
 {

285 
ack‘_»q
 
	m»q
;

286 
ack‘_»q3
 
	m»q3
;

289 
	s·ck‘_m»q
 {

290 
	mmr_ifšdex
;

291 
	mmr_ty³
;

292 
	mmr_®’
;

293 
	mmr_add»ss
[8];

296 
	#PACKET_MR_MULTICAST
 0

	)

297 
	#PACKET_MR_PROMISC
 1

	)

298 
	#PACKET_MR_ALLMULTI
 2

	)

299 
	#PACKET_MR_UNICAST
 3

	)

	@/usr/include/linux/in.h

18 #iâdeà
_LINUX_IN_H


19 
	#_LINUX_IN_H


	)

21 
	~<lšux/ty³s.h
>

22 
	~<lšux/libc-com·t.h
>

23 
	~<lšux/sock‘.h
>

25 #ià
__UAPI_DEF_IN_IPPROTO


28 
	mIPPROTO_IP
 = 0,

29 
	#IPPROTO_IP
 
IPPROTO_IP


	)

30 
	mIPPROTO_ICMP
 = 1,

31 
	#IPPROTO_ICMP
 
IPPROTO_ICMP


	)

32 
	mIPPROTO_IGMP
 = 2,

33 
	#IPPROTO_IGMP
 
IPPROTO_IGMP


	)

34 
	mIPPROTO_IPIP
 = 4,

35 
	#IPPROTO_IPIP
 
IPPROTO_IPIP


	)

36 
	mIPPROTO_TCP
 = 6,

37 
	#IPPROTO_TCP
 
IPPROTO_TCP


	)

38 
	mIPPROTO_EGP
 = 8,

39 
	#IPPROTO_EGP
 
IPPROTO_EGP


	)

40 
	mIPPROTO_PUP
 = 12,

41 
	#IPPROTO_PUP
 
IPPROTO_PUP


	)

42 
	mIPPROTO_UDP
 = 17,

43 
	#IPPROTO_UDP
 
IPPROTO_UDP


	)

44 
	mIPPROTO_IDP
 = 22,

45 
	#IPPROTO_IDP
 
IPPROTO_IDP


	)

46 
	mIPPROTO_TP
 = 29,

47 
	#IPPROTO_TP
 
IPPROTO_TP


	)

48 
	mIPPROTO_DCCP
 = 33,

49 
	#IPPROTO_DCCP
 
IPPROTO_DCCP


	)

50 
	mIPPROTO_IPV6
 = 41,

51 
	#IPPROTO_IPV6
 
IPPROTO_IPV6


	)

52 
	mIPPROTO_RSVP
 = 46,

53 
	#IPPROTO_RSVP
 
IPPROTO_RSVP


	)

54 
	mIPPROTO_GRE
 = 47,

55 
	#IPPROTO_GRE
 
IPPROTO_GRE


	)

56 
	mIPPROTO_ESP
 = 50,

57 
	#IPPROTO_ESP
 
IPPROTO_ESP


	)

58 
	mIPPROTO_AH
 = 51,

59 
	#IPPROTO_AH
 
IPPROTO_AH


	)

60 
	mIPPROTO_MTP
 = 92,

61 
	#IPPROTO_MTP
 
IPPROTO_MTP


	)

62 
	mIPPROTO_BEETPH
 = 94,

63 
	#IPPROTO_BEETPH
 
IPPROTO_BEETPH


	)

64 
	mIPPROTO_ENCAP
 = 98,

65 
	#IPPROTO_ENCAP
 
IPPROTO_ENCAP


	)

66 
	mIPPROTO_PIM
 = 103,

67 
	#IPPROTO_PIM
 
IPPROTO_PIM


	)

68 
	mIPPROTO_COMP
 = 108,

69 
	#IPPROTO_COMP
 
IPPROTO_COMP


	)

70 
	mIPPROTO_SCTP
 = 132,

71 
	#IPPROTO_SCTP
 
IPPROTO_SCTP


	)

72 
	mIPPROTO_UDPLITE
 = 136,

73 
	#IPPROTO_UDPLITE
 
IPPROTO_UDPLITE


	)

74 
	mIPPROTO_MPLS
 = 137,

75 
	#IPPROTO_MPLS
 
IPPROTO_MPLS


	)

76 
	mIPPROTO_RAW
 = 255,

77 
	#IPPROTO_RAW
 
IPPROTO_RAW


	)

78 
	mIPPROTO_MAX


82 #ià
__UAPI_DEF_IN_ADDR


84 
	sš_addr
 {

85 
__be32
 
	ms_addr
;

89 
	#IP_TOS
 1

	)

90 
	#IP_TTL
 2

	)

91 
	#IP_HDRINCL
 3

	)

92 
	#IP_OPTIONS
 4

	)

93 
	#IP_ROUTER_ALERT
 5

	)

94 
	#IP_RECVOPTS
 6

	)

95 
	#IP_RETOPTS
 7

	)

96 
	#IP_PKTINFO
 8

	)

97 
	#IP_PKTOPTIONS
 9

	)

98 
	#IP_MTU_DISCOVER
 10

	)

99 
	#IP_RECVERR
 11

	)

100 
	#IP_RECVTTL
 12

	)

101 
	#IP_RECVTOS
 13

	)

102 
	#IP_MTU
 14

	)

103 
	#IP_FREEBIND
 15

	)

104 
	#IP_IPSEC_POLICY
 16

	)

105 
	#IP_XFRM_POLICY
 17

	)

106 
	#IP_PASSSEC
 18

	)

107 
	#IP_TRANSPARENT
 19

	)

110 
	#IP_RECVRETOPTS
 
IP_RETOPTS


	)

113 
	#IP_ORIGDSTADDR
 20

	)

114 
	#IP_RECVORIGDSTADDR
 
IP_ORIGDSTADDR


	)

116 
	#IP_MINTTL
 21

	)

117 
	#IP_NODEFRAG
 22

	)

118 
	#IP_CHECKSUM
 23

	)

119 
	#IP_BIND_ADDRESS_NO_PORT
 24

	)

120 
	#IP_RECVFRAGSIZE
 25

	)

123 
	#IP_PMTUDISC_DONT
 0

	)

124 
	#IP_PMTUDISC_WANT
 1

	)

125 
	#IP_PMTUDISC_DO
 2

	)

126 
	#IP_PMTUDISC_PROBE
 3

	)

131 
	#IP_PMTUDISC_INTERFACE
 4

	)

135 
	#IP_PMTUDISC_OMIT
 5

	)

137 
	#IP_MULTICAST_IF
 32

	)

138 
	#IP_MULTICAST_TTL
 33

	)

139 
	#IP_MULTICAST_LOOP
 34

	)

140 
	#IP_ADD_MEMBERSHIP
 35

	)

141 
	#IP_DROP_MEMBERSHIP
 36

	)

142 
	#IP_UNBLOCK_SOURCE
 37

	)

143 
	#IP_BLOCK_SOURCE
 38

	)

144 
	#IP_ADD_SOURCE_MEMBERSHIP
 39

	)

145 
	#IP_DROP_SOURCE_MEMBERSHIP
 40

	)

146 
	#IP_MSFILTER
 41

	)

147 
	#MCAST_JOIN_GROUP
 42

	)

148 
	#MCAST_BLOCK_SOURCE
 43

	)

149 
	#MCAST_UNBLOCK_SOURCE
 44

	)

150 
	#MCAST_LEAVE_GROUP
 45

	)

151 
	#MCAST_JOIN_SOURCE_GROUP
 46

	)

152 
	#MCAST_LEAVE_SOURCE_GROUP
 47

	)

153 
	#MCAST_MSFILTER
 48

	)

154 
	#IP_MULTICAST_ALL
 49

	)

155 
	#IP_UNICAST_IF
 50

	)

157 
	#MCAST_EXCLUDE
 0

	)

158 
	#MCAST_INCLUDE
 1

	)

161 
	#IP_DEFAULT_MULTICAST_TTL
 1

	)

162 
	#IP_DEFAULT_MULTICAST_LOOP
 1

	)

166 #ià
__UAPI_DEF_IP_MREQ


167 
	s_m»q
 {

168 
š_addr
 
	mimr_muÉŸddr
;

169 
š_addr
 
	mimr_š‹rçû
;

172 
	s_m»qn
 {

173 
š_addr
 
	mimr_muÉŸddr
;

174 
š_addr
 
	mimr_add»ss
;

175 
	mimr_ifšdex
;

178 
	s_m»q_sourû
 {

179 
__be32
 
	mimr_muÉŸddr
;

180 
__be32
 
	mimr_š‹rçû
;

181 
__be32
 
	mimr_sourûaddr
;

184 
	s_msf‹r
 {

185 
__be32
 
	mimsf_muÉŸddr
;

186 
__be32
 
	mimsf_š‹rçû
;

187 
__u32
 
	mimsf_fmode
;

188 
__u32
 
	mimsf_num¤c
;

189 
__be32
 
	mimsf_¦i¡
[1];

192 
	#IP_MSFILTER_SIZE
(
num¤c
) \

193 ((
_msf‹r
è- (
__u32
) \

194 + (
num¤c
è* (
__u32
))

	)

196 
	sgroup_»q
 {

197 
__u32
 
	mgr_š‹rçû
;

198 
__k”Ãl_sockaddr_¡Üage
 
	mgr_group
;

201 
	sgroup_sourû_»q
 {

202 
__u32
 
	mg¤_š‹rçû
;

203 
__k”Ãl_sockaddr_¡Üage
 
	mg¤_group
;

204 
__k”Ãl_sockaddr_¡Üage
 
	mg¤_sourû
;

207 
	sgroup_f‹r
 {

208 
__u32
 
	mgf_š‹rçû
;

209 
__k”Ãl_sockaddr_¡Üage
 
	mgf_group
;

210 
__u32
 
	mgf_fmode
;

211 
__u32
 
	mgf_num¤c
;

212 
__k”Ãl_sockaddr_¡Üage
 
	mgf_¦i¡
[1];

215 
	#GROUP_FILTER_SIZE
(
num¤c
) \

216 ((
group_f‹r
è- (
__k”Ãl_sockaddr_¡Üage
) \

217 + (
num¤c
è* (
__k”Ãl_sockaddr_¡Üage
))

	)

220 #ià
__UAPI_DEF_IN_PKTINFO


221 
	sš_pktšfo
 {

222 
	mi_ifšdex
;

223 
š_addr
 
	mi_¥ec_d¡
;

224 
š_addr
 
	mi_addr
;

229 #ià 
__UAPI_DEF_SOCKADDR_IN


230 
	#__SOCK_SIZE__
 16

	)

231 
	ssockaddr_š
 {

232 
__k”Ãl_§_çmy_t
 
	msš_çmy
;

233 
__be16
 
	msš_pÜt
;

234 
š_addr
 
	msš_addr
;

237 
	m__·d
[
__SOCK_SIZE__
 - () -

238 (è- (
š_addr
)];

240 
	#sš_z”o
 
__·d


	)

243 #ià
__UAPI_DEF_IN_CLASS


249 
	#IN_CLASSA
(
a
è((((è×)è& 0x80000000è=ğ0)

	)

250 
	#IN_CLASSA_NET
 0xff000000

	)

251 
	#IN_CLASSA_NSHIFT
 24

	)

252 
	#IN_CLASSA_HOST
 (0xfffffffà& ~
IN_CLASSA_NET
)

	)

253 
	#IN_CLASSA_MAX
 128

	)

255 
	#IN_CLASSB
(
a
è((((è×)è& 0xc0000000è=ğ0x80000000)

	)

256 
	#IN_CLASSB_NET
 0xffff0000

	)

257 
	#IN_CLASSB_NSHIFT
 16

	)

258 
	#IN_CLASSB_HOST
 (0xfffffffà& ~
IN_CLASSB_NET
)

	)

259 
	#IN_CLASSB_MAX
 65536

	)

261 
	#IN_CLASSC
(
a
è((((è×)è& 0xe0000000è=ğ0xc0000000)

	)

262 
	#IN_CLASSC_NET
 0xffffff00

	)

263 
	#IN_CLASSC_NSHIFT
 8

	)

264 
	#IN_CLASSC_HOST
 (0xfffffffà& ~
IN_CLASSC_NET
)

	)

266 
	#IN_CLASSD
(
a
è((((è×)è& 0xf0000000è=ğ0xe0000000)

	)

267 
	#IN_MULTICAST
(
a
è
	`IN_CLASSD
×)

	)

268 
	#IN_MULTICAST_NET
 0xF0000000

	)

270 
	#IN_EXPERIMENTAL
(
a
è((((è×)è& 0xf0000000è=ğ0xf0000000)

	)

271 
	#IN_BADCLASS
(
a
è
	`IN_EXPERIMENTAL
(×))

	)

274 
	#INADDR_ANY
 ((è0x00000000)

	)

277 
	#INADDR_BROADCAST
 ((è0xffffffff)

	)

280 
	#INADDR_NONE
 ((è0xffffffff)

	)

283 
	#IN_LOOPBACKNET
 127

	)

286 
	#INADDR_LOOPBACK
 0x7f000001

	)

287 
	#IN_LOOPBACK
(
a
è((((è×)è& 0xff000000è=ğ0x7f000000)

	)

290 
	#INADDR_UNSPEC_GROUP
 0xe0000000U

	)

291 
	#INADDR_ALLHOSTS_GROUP
 0xe0000001U

	)

292 
	#INADDR_ALLRTRS_GROUP
 0xe0000002U

	)

293 
	#INADDR_MAX_LOCAL_GROUP
 0xe00000ffU

	)

297 
	~<asm/by‹Üd”.h
>

	@/usr/include/linux/in6.h

21 #iâdeà
_LINUX_IN6_H


22 
	#_LINUX_IN6_H


	)

24 
	~<lšux/ty³s.h
>

25 
	~<lšux/libc-com·t.h
>

31 #ià
__UAPI_DEF_IN6_ADDR


32 
	sš6_addr
 {

34 
__u8
 
	mu6_addr8
[16];

35 #ià
__UAPI_DEF_IN6_ADDR_ALT


36 
__be16
 
	mu6_addr16
[8];

37 
__be32
 
	mu6_addr32
[4];

39 } 
	mš6_u
;

40 
	#s6_addr
 
š6_u
.
u6_addr8


	)

41 #ià
__UAPI_DEF_IN6_ADDR_ALT


42 
	#s6_addr16
 
š6_u
.
u6_addr16


	)

43 
	#s6_addr32
 
š6_u
.
u6_addr32


	)

48 #ià
__UAPI_DEF_SOCKADDR_IN6


49 
	ssockaddr_š6
 {

50 
	msš6_çmy
;

51 
__be16
 
	msš6_pÜt
;

52 
__be32
 
	msš6_æowšfo
;

53 
š6_addr
 
	msš6_addr
;

54 
__u32
 
	msš6_scİe_id
;

58 #ià
__UAPI_DEF_IPV6_MREQ


59 
	sv6_m»q
 {

61 
š6_addr
 
	mv6mr_muÉŸddr
;

64 
	mv6mr_ifšdex
;

68 
	#v6mr_aÿddr
 
v6mr_muÉŸddr


	)

70 
	sš6_æowÏb–_»q
 {

71 
š6_addr
 
	mær_d¡
;

72 
__be32
 
	mær_Ïb–
;

73 
__u8
 
	mær_aùiÚ
;

74 
__u8
 
	mær_sh¬e
;

75 
__u16
 
	mær_æags
;

76 
__u16
 
	mær_expœes
;

77 
__u16
 
	mær_lšg”
;

78 
__u32
 
	m__ær_·d
;

82 
	#IPV6_FL_A_GET
 0

	)

83 
	#IPV6_FL_A_PUT
 1

	)

84 
	#IPV6_FL_A_RENEW
 2

	)

86 
	#IPV6_FL_F_CREATE
 1

	)

87 
	#IPV6_FL_F_EXCL
 2

	)

88 
	#IPV6_FL_F_REFLECT
 4

	)

89 
	#IPV6_FL_F_REMOTE
 8

	)

91 
	#IPV6_FL_S_NONE
 0

	)

92 
	#IPV6_FL_S_EXCL
 1

	)

93 
	#IPV6_FL_S_PROCESS
 2

	)

94 
	#IPV6_FL_S_USER
 3

	)

95 
	#IPV6_FL_S_ANY
 255

	)

106 
	#IPV6_FLOWINFO_FLOWLABEL
 0x000fffff

	)

107 
	#IPV6_FLOWINFO_PRIORITY
 0x0ff00000

	)

110 
	#IPV6_PRIORITY_UNCHARACTERIZED
 0x0000

	)

111 
	#IPV6_PRIORITY_FILLER
 0x0100

	)

112 
	#IPV6_PRIORITY_UNATTENDED
 0x0200

	)

113 
	#IPV6_PRIORITY_RESERVED1
 0x0300

	)

114 
	#IPV6_PRIORITY_BULK
 0x0400

	)

115 
	#IPV6_PRIORITY_RESERVED2
 0x0500

	)

116 
	#IPV6_PRIORITY_INTERACTIVE
 0x0600

	)

117 
	#IPV6_PRIORITY_CONTROL
 0x0700

	)

118 
	#IPV6_PRIORITY_8
 0x0800

	)

119 
	#IPV6_PRIORITY_9
 0x0900

	)

120 
	#IPV6_PRIORITY_10
 0x0a00

	)

121 
	#IPV6_PRIORITY_11
 0x0b00

	)

122 
	#IPV6_PRIORITY_12
 0x0c00

	)

123 
	#IPV6_PRIORITY_13
 0x0d00

	)

124 
	#IPV6_PRIORITY_14
 0x0e00

	)

125 
	#IPV6_PRIORITY_15
 0x0f00

	)

130 #ià
__UAPI_DEF_IPPROTO_V6


131 
	#IPPROTO_HOPOPTS
 0

	)

132 
	#IPPROTO_ROUTING
 43

	)

133 
	#IPPROTO_FRAGMENT
 44

	)

134 
	#IPPROTO_ICMPV6
 58

	)

135 
	#IPPROTO_NONE
 59

	)

136 
	#IPPROTO_DSTOPTS
 60

	)

137 
	#IPPROTO_MH
 135

	)

143 
	#IPV6_TLV_PAD1
 0

	)

144 
	#IPV6_TLV_PADN
 1

	)

145 
	#IPV6_TLV_ROUTERALERT
 5

	)

146 
	#IPV6_TLV_CALIPSO
 7

	)

147 
	#IPV6_TLV_JUMBO
 194

	)

148 
	#IPV6_TLV_HAO
 201

	)

153 #ià
__UAPI_DEF_IPV6_OPTIONS


154 
	#IPV6_ADDRFORM
 1

	)

155 
	#IPV6_2292PKTINFO
 2

	)

156 
	#IPV6_2292HOPOPTS
 3

	)

157 
	#IPV6_2292DSTOPTS
 4

	)

158 
	#IPV6_2292RTHDR
 5

	)

159 
	#IPV6_2292PKTOPTIONS
 6

	)

160 
	#IPV6_CHECKSUM
 7

	)

161 
	#IPV6_2292HOPLIMIT
 8

	)

162 
	#IPV6_NEXTHOP
 9

	)

163 
	#IPV6_AUTHHDR
 10

	)

164 
	#IPV6_FLOWINFO
 11

	)

166 
	#IPV6_UNICAST_HOPS
 16

	)

167 
	#IPV6_MULTICAST_IF
 17

	)

168 
	#IPV6_MULTICAST_HOPS
 18

	)

169 
	#IPV6_MULTICAST_LOOP
 19

	)

170 
	#IPV6_ADD_MEMBERSHIP
 20

	)

171 
	#IPV6_DROP_MEMBERSHIP
 21

	)

172 
	#IPV6_ROUTER_ALERT
 22

	)

173 
	#IPV6_MTU_DISCOVER
 23

	)

174 
	#IPV6_MTU
 24

	)

175 
	#IPV6_RECVERR
 25

	)

176 
	#IPV6_V6ONLY
 26

	)

177 
	#IPV6_JOIN_ANYCAST
 27

	)

178 
	#IPV6_LEAVE_ANYCAST
 28

	)

181 
	#IPV6_PMTUDISC_DONT
 0

	)

182 
	#IPV6_PMTUDISC_WANT
 1

	)

183 
	#IPV6_PMTUDISC_DO
 2

	)

184 
	#IPV6_PMTUDISC_PROBE
 3

	)

188 
	#IPV6_PMTUDISC_INTERFACE
 4

	)

192 
	#IPV6_PMTUDISC_OMIT
 5

	)

195 
	#IPV6_FLOWLABEL_MGR
 32

	)

196 
	#IPV6_FLOWINFO_SEND
 33

	)

198 
	#IPV6_IPSEC_POLICY
 34

	)

199 
	#IPV6_XFRM_POLICY
 35

	)

200 
	#IPV6_HDRINCL
 36

	)

222 
	#IPV6_RECVPKTINFO
 49

	)

223 
	#IPV6_PKTINFO
 50

	)

224 
	#IPV6_RECVHOPLIMIT
 51

	)

225 
	#IPV6_HOPLIMIT
 52

	)

226 
	#IPV6_RECVHOPOPTS
 53

	)

227 
	#IPV6_HOPOPTS
 54

	)

228 
	#IPV6_RTHDRDSTOPTS
 55

	)

229 
	#IPV6_RECVRTHDR
 56

	)

230 
	#IPV6_RTHDR
 57

	)

231 
	#IPV6_RECVDSTOPTS
 58

	)

232 
	#IPV6_DSTOPTS
 59

	)

233 
	#IPV6_RECVPATHMTU
 60

	)

234 
	#IPV6_PATHMTU
 61

	)

235 
	#IPV6_DONTFRAG
 62

	)

237 
	#IPV6_USE_MIN_MTU
 63

	)

253 
	#IPV6_RECVTCLASS
 66

	)

254 
	#IPV6_TCLASS
 67

	)

267 
	#IPV6_AUTOFLOWLABEL
 70

	)

269 
	#IPV6_ADDR_PREFERENCES
 72

	)

271 
	#IPV6_PREFER_SRC_TMP
 0x0001

	)

272 
	#IPV6_PREFER_SRC_PUBLIC
 0x0002

	)

273 
	#IPV6_PREFER_SRC_PUBTMP_DEFAULT
 0x0100

	)

274 
	#IPV6_PREFER_SRC_COA
 0x0004

	)

275 
	#IPV6_PREFER_SRC_HOME
 0x0400

	)

276 
	#IPV6_PREFER_SRC_CGA
 0x0008

	)

277 
	#IPV6_PREFER_SRC_NONCGA
 0x0800

	)

280 
	#IPV6_MINHOPCOUNT
 73

	)

282 
	#IPV6_ORIGDSTADDR
 74

	)

283 
	#IPV6_RECVORIGDSTADDR
 
IPV6_ORIGDSTADDR


	)

284 
	#IPV6_TRANSPARENT
 75

	)

285 
	#IPV6_UNICAST_IF
 76

	)

286 
	#IPV6_RECVFRAGSIZE
 77

	)

	@/usr/include/linux/ioctl.h

1 #iâdeà
_LINUX_IOCTL_H


2 
	#_LINUX_IOCTL_H


	)

4 
	~<asm/ioùl.h
>

	@/usr/include/linux/limits.h

1 #iâdeà
_LINUX_LIMITS_H


2 
	#_LINUX_LIMITS_H


	)

4 
	#NR_OPEN
 1024

	)

6 
	#NGROUPS_MAX
 65536

	)

7 
	#ARG_MAX
 131072

	)

8 
	#LINK_MAX
 127

	)

9 
	#MAX_CANON
 255

	)

10 
	#MAX_INPUT
 255

	)

11 
	#NAME_MAX
 255

	)

12 
	#PATH_MAX
 4096

	)

13 
	#PIPE_BUF
 4096

	)

14 
	#XATTR_NAME_MAX
 255

	)

15 
	#XATTR_SIZE_MAX
 65536

	)

16 
	#XATTR_LIST_MAX
 65536

	)

18 
	#RTSIG_MAX
 32

	)

	@/usr/include/linux/neighbour.h

1 #iâdeà
__LINUX_NEIGHBOUR_H


2 
	#__LINUX_NEIGHBOUR_H


	)

4 
	~<lšux/ty³s.h
>

5 
	~<lšux/Ãšk.h
>

7 
	sndmsg
 {

8 
__u8
 
	mndm_çmy
;

9 
__u8
 
	mndm_·d1
;

10 
__u16
 
	mndm_·d2
;

11 
__s32
 
	mndm_ifšdex
;

12 
__u16
 
	mndm_¡©e
;

13 
__u8
 
	mndm_æags
;

14 
__u8
 
	mndm_ty³
;

18 
	mNDA_UNSPEC
,

19 
	mNDA_DST
,

20 
	mNDA_LLADDR
,

21 
	mNDA_CACHEINFO
,

22 
	mNDA_PROBES
,

23 
	mNDA_VLAN
,

24 
	mNDA_PORT
,

25 
	mNDA_VNI
,

26 
	mNDA_IFINDEX
,

27 
	mNDA_MASTER
,

28 
	mNDA_LINK_NETNSID
,

29 
	m__NDA_MAX


32 
	#NDA_MAX
 (
__NDA_MAX
 - 1)

	)

38 
	#NTF_USE
 0x01

	)

39 
	#NTF_SELF
 0x02

	)

40 
	#NTF_MASTER
 0x04

	)

41 
	#NTF_PROXY
 0x08

	)

42 
	#NTF_EXT_LEARNED
 0x10

	)

43 
	#NTF_ROUTER
 0x80

	)

49 
	#NUD_INCOMPLETE
 0x01

	)

50 
	#NUD_REACHABLE
 0x02

	)

51 
	#NUD_STALE
 0x04

	)

52 
	#NUD_DELAY
 0x08

	)

53 
	#NUD_PROBE
 0x10

	)

54 
	#NUD_FAILED
 0x20

	)

57 
	#NUD_NOARP
 0x40

	)

58 
	#NUD_PERMANENT
 0x80

	)

59 
	#NUD_NONE
 0x00

	)

66 
	snda_ÿchešfo
 {

67 
__u32
 
	mndm_cÚfœmed
;

68 
__u32
 
	mndm_u£d
;

69 
__u32
 
	mndm_upd©ed
;

70 
__u32
 
	mndm_»fút
;

98 
	sndt_¡©s
 {

99 
__u64
 
	mndts_®locs
;

100 
__u64
 
	mndts_de¡roys
;

101 
__u64
 
	mndts_hash_grows
;

102 
__u64
 
	mndts_»s_çed
;

103 
__u64
 
	mndts_lookups
;

104 
__u64
 
	mndts_h™s
;

105 
__u64
 
	mndts_rcv_´obes_mÿ¡
;

106 
__u64
 
	mndts_rcv_´obes_uÿ¡
;

107 
__u64
 
	mndts_³riodic_gc_runs
;

108 
__u64
 
	mndts_fÜûd_gc_runs
;

109 
__u64
 
	mndts_bË_fuÎs
;

113 
	mNDTPA_UNSPEC
,

114 
	mNDTPA_IFINDEX
,

115 
	mNDTPA_REFCNT
,

116 
	mNDTPA_REACHABLE_TIME
,

117 
	mNDTPA_BASE_REACHABLE_TIME
,

118 
	mNDTPA_RETRANS_TIME
,

119 
	mNDTPA_GC_STALETIME
,

120 
	mNDTPA_DELAY_PROBE_TIME
,

121 
	mNDTPA_QUEUE_LEN
,

122 
	mNDTPA_APP_PROBES
,

123 
	mNDTPA_UCAST_PROBES
,

124 
	mNDTPA_MCAST_PROBES
,

125 
	mNDTPA_ANYCAST_DELAY
,

126 
	mNDTPA_PROXY_DELAY
,

127 
	mNDTPA_PROXY_QLEN
,

128 
	mNDTPA_LOCKTIME
,

129 
	mNDTPA_QUEUE_LENBYTES
,

130 
	mNDTPA_MCAST_REPROBES
,

131 
	mNDTPA_PAD
,

132 
	m__NDTPA_MAX


134 
	#NDTPA_MAX
 (
__NDTPA_MAX
 - 1)

	)

136 
	sndtmsg
 {

137 
__u8
 
	mndtm_çmy
;

138 
__u8
 
	mndtm_·d1
;

139 
__u16
 
	mndtm_·d2
;

142 
	sndt_cÚfig
 {

143 
__u16
 
	mndtc_key_Ën
;

144 
__u16
 
	mndtc_’Œy_size
;

145 
__u32
 
	mndtc_’Œ›s
;

146 
__u32
 
	mndtc_Ï¡_æush
;

147 
__u32
 
	mndtc_Ï¡_¿nd
;

148 
__u32
 
	mndtc_hash_ºd
;

149 
__u32
 
	mndtc_hash_mask
;

150 
__u32
 
	mndtc_hash_chaš_gc
;

151 
__u32
 
	mndtc_´oxy_qËn
;

155 
	mNDTA_UNSPEC
,

156 
	mNDTA_NAME
,

157 
	mNDTA_THRESH1
,

158 
	mNDTA_THRESH2
,

159 
	mNDTA_THRESH3
,

160 
	mNDTA_CONFIG
,

161 
	mNDTA_PARMS
,

162 
	mNDTA_STATS
,

163 
	mNDTA_GC_INTERVAL
,

164 
	mNDTA_PAD
,

165 
	m__NDTA_MAX


167 
	#NDTA_MAX
 (
__NDTA_MAX
 - 1)

	)

	@/usr/include/linux/sched.h

1 #iâdeà
_LINUX_SCHED_H


2 
	#_LINUX_SCHED_H


	)

7 
	#CSIGNAL
 0x000000fà

	)

8 
	#CLONE_VM
 0x00000100

	)

9 
	#CLONE_FS
 0x00000200

	)

10 
	#CLONE_FILES
 0x00000400

	)

11 
	#CLONE_SIGHAND
 0x00000800

	)

12 
	#CLONE_PTRACE
 0x00002000

	)

13 
	#CLONE_VFORK
 0x00004000

	)

14 
	#CLONE_PARENT
 0x00008000

	)

15 
	#CLONE_THREAD
 0x00010000

	)

16 
	#CLONE_NEWNS
 0x00020000

	)

17 
	#CLONE_SYSVSEM
 0x00040000

	)

18 
	#CLONE_SETTLS
 0x00080000

	)

19 
	#CLONE_PARENT_SETTID
 0x00100000

	)

20 
	#CLONE_CHILD_CLEARTID
 0x00200000

	)

21 
	#CLONE_DETACHED
 0x00400000

	)

22 
	#CLONE_UNTRACED
 0x00800000

	)

23 
	#CLONE_CHILD_SETTID
 0x01000000

	)

24 
	#CLONE_NEWCGROUP
 0x02000000

	)

25 
	#CLONE_NEWUTS
 0x04000000

	)

26 
	#CLONE_NEWIPC
 0x08000000

	)

27 
	#CLONE_NEWUSER
 0x10000000

	)

28 
	#CLONE_NEWPID
 0x20000000

	)

29 
	#CLONE_NEWNET
 0x40000000

	)

30 
	#CLONE_IO
 0x80000000

	)

35 
	#SCHED_NORMAL
 0

	)

36 
	#SCHED_FIFO
 1

	)

37 
	#SCHED_RR
 2

	)

38 
	#SCHED_BATCH
 3

	)

40 
	#SCHED_IDLE
 5

	)

41 
	#SCHED_DEADLINE
 6

	)

44 
	#SCHED_RESET_ON_FORK
 0x40000000

	)

49 
	#SCHED_FLAG_RESET_ON_FORK
 0x01

	)

	@/usr/include/linux/socket.h

1 #iâdeà
_LINUX_SOCKET_H


2 
	#_LINUX_SOCKET_H


	)

7 
	#_K_SS_MAXSIZE
 128

	)

8 
	#_K_SS_ALIGNSIZE
 (
	`__®ignof__
 (
sockaddr
 *))

	)

11 
	t__k”Ãl_§_çmy_t
;

13 
	s__k”Ãl_sockaddr_¡Üage
 {

14 
__k”Ãl_§_çmy_t
 
	mss_çmy
;

16 
	m__d©a
[
_K_SS_MAXSIZE
 - ()];

19 } 
__©Œibu‹__
 ((
®igÃd
(
_K_SS_ALIGNSIZE
)));

	@/usr/include/linux/sysctl.h

22 #iâdeà
_LINUX_SYSCTL_H


23 
	#_LINUX_SYSCTL_H


	)

25 
	~<lšux/k”Ãl.h
>

26 
	~<lšux/ty³s.h
>

29 
	#CTL_MAXNAME
 10

	)

34 
	s__sysùl_¬gs
 {

35 *
	mÇme
;

36 
	mÆ’
;

37 *
	mŞdv®
;

38 
size_t
 *
	mŞdËÅ
;

39 *
	mÃwv®
;

40 
size_t
 
	mÃwËn
;

41 
	m__unu£d
[4];

50 
	mCTL_KERN
=1,

51 
	mCTL_VM
=2,

52 
	mCTL_NET
=3,

53 
	mCTL_PROC
=4,

54 
	mCTL_FS
=5,

55 
	mCTL_DEBUG
=6,

56 
	mCTL_DEV
=7,

57 
	mCTL_BUS
=8,

58 
	mCTL_ABI
=9,

59 
	mCTL_CPU
=10,

60 
	mCTL_ARLAN
=254,

61 
	mCTL_S390DBF
=5677,

62 
	mCTL_SUNRPC
=7249,

63 
	mCTL_PM
=9899,

64 
	mCTL_FRV
=9898,

70 
	mCTL_BUS_ISA
=1

76 
	mINOTIFY_MAX_USER_INSTANCES
=1,

77 
	mINOTIFY_MAX_USER_WATCHES
=2,

78 
	mINOTIFY_MAX_QUEUED_EVENTS
=3

84 
	mKERN_OSTYPE
=1,

85 
	mKERN_OSRELEASE
=2,

86 
	mKERN_OSREV
=3,

87 
	mKERN_VERSION
=4,

88 
	mKERN_SECUREMASK
=5,

89 
	mKERN_PROF
=6,

90 
	mKERN_NODENAME
=7,

91 
	mKERN_DOMAINNAME
=8,

93 
	mKERN_PANIC
=15,

94 
	mKERN_REALROOTDEV
=16,

96 
	mKERN_SPARC_REBOOT
=21,

97 
	mKERN_CTLALTDEL
=22,

98 
	mKERN_PRINTK
=23,

99 
	mKERN_NAMETRANS
=24,

100 
	mKERN_PPC_HTABRECLAIM
=25,

101 
	mKERN_PPC_ZEROPAGED
=26,

102 
	mKERN_PPC_POWERSAVE_NAP
=27,

103 
	mKERN_MODPROBE
=28,

104 
	mKERN_SG_BIG_BUFF
=29,

105 
	mKERN_ACCT
=30,

106 
	mKERN_PPC_L2CR
=31,

108 
	mKERN_RTSIGNR
=32,

109 
	mKERN_RTSIGMAX
=33,

111 
	mKERN_SHMMAX
=34,

112 
	mKERN_MSGMAX
=35,

113 
	mKERN_MSGMNB
=36,

114 
	mKERN_MSGPOOL
=37,

115 
	mKERN_SYSRQ
=38,

116 
	mKERN_MAX_THREADS
=39,

117 
	mKERN_RANDOM
=40,

118 
	mKERN_SHMALL
=41,

119 
	mKERN_MSGMNI
=42,

120 
	mKERN_SEM
=43,

121 
	mKERN_SPARC_STOP_A
=44,

122 
	mKERN_SHMMNI
=45,

123 
	mKERN_OVERFLOWUID
=46,

124 
	mKERN_OVERFLOWGID
=47,

125 
	mKERN_SHMPATH
=48,

126 
	mKERN_HOTPLUG
=49,

127 
	mKERN_IEEE_EMULATION_WARNINGS
=50,

128 
	mKERN_S390_USER_DEBUG_LOGGING
=51,

129 
	mKERN_CORE_USES_PID
=52,

130 
	mKERN_TAINTED
=53,

131 
	mKERN_CADPID
=54,

132 
	mKERN_PIDMAX
=55,

133 
	mKERN_CORE_PATTERN
=56,

134 
	mKERN_PANIC_ON_OOPS
=57,

135 
	mKERN_HPPA_PWRSW
=58,

136 
	mKERN_HPPA_UNALIGNED
=59,

137 
	mKERN_PRINTK_RATELIMIT
=60,

138 
	mKERN_PRINTK_RATELIMIT_BURST
=61,

139 
	mKERN_PTY
=62,

140 
	mKERN_NGROUPS_MAX
=63,

141 
	mKERN_SPARC_SCONS_PWROFF
=64,

142 
	mKERN_HZ_TIMER
=65,

143 
	mKERN_UNKNOWN_NMI_PANIC
=66,

144 
	mKERN_BOOTLOADER_TYPE
=67,

145 
	mKERN_RANDOMIZE
=68,

146 
	mKERN_SETUID_DUMPABLE
=69,

147 
	mKERN_SPIN_RETRY
=70,

148 
	mKERN_ACPI_VIDEO_FLAGS
=71,

149 
	mKERN_IA64_UNALIGNED
=72,

150 
	mKERN_COMPAT_LOG
=73,

151 
	mKERN_MAX_LOCK_DEPTH
=74,

152 
	mKERN_NMI_WATCHDOG
=75,

153 
	mKERN_PANIC_ON_NMI
=76,

154 
	mKERN_PANIC_ON_WARN
=77,

162 
	mVM_UNUSED1
=1,

163 
	mVM_UNUSED2
=2,

164 
	mVM_UNUSED3
=3,

165 
	mVM_UNUSED4
=4,

166 
	mVM_OVERCOMMIT_MEMORY
=5,

167 
	mVM_UNUSED5
=6,

168 
	mVM_UNUSED7
=7,

169 
	mVM_UNUSED8
=8,

170 
	mVM_UNUSED9
=9,

171 
	mVM_PAGE_CLUSTER
=10,

172 
	mVM_DIRTY_BACKGROUND
=11,

173 
	mVM_DIRTY_RATIO
=12,

174 
	mVM_DIRTY_WB_CS
=13,

175 
	mVM_DIRTY_EXPIRE_CS
=14,

176 
	mVM_NR_PDFLUSH_THREADS
=15,

177 
	mVM_OVERCOMMIT_RATIO
=16,

178 
	mVM_PAGEBUF
=17,

179 
	mVM_HUGETLB_PAGES
=18,

180 
	mVM_SWAPPINESS
=19,

181 
	mVM_LOWMEM_RESERVE_RATIO
=20,

182 
	mVM_MIN_FREE_KBYTES
=21,

183 
	mVM_MAX_MAP_COUNT
=22,

184 
	mVM_LAPTOP_MODE
=23,

185 
	mVM_BLOCK_DUMP
=24,

186 
	mVM_HUGETLB_GROUP
=25,

187 
	mVM_VFS_CACHE_PRESSURE
=26,

188 
	mVM_LEGACY_VA_LAYOUT
=27,

189 
	mVM_SWAP_TOKEN_TIMEOUT
=28,

190 
	mVM_DROP_PAGECACHE
=29,

191 
	mVM_PERCPU_PAGELIST_FRACTION
=30,

192 
	mVM_ZONE_RECLAIM_MODE
=31,

193 
	mVM_MIN_UNMAPPED
=32,

194 
	mVM_PANIC_ON_OOM
=33,

195 
	mVM_VDSO_ENABLED
=34,

196 
	mVM_MIN_SLAB
=35,

203 
	mNET_CORE
=1,

204 
	mNET_ETHER
=2,

205 
	mNET_802
=3,

206 
	mNET_UNIX
=4,

207 
	mNET_IPV4
=5,

208 
	mNET_IPX
=6,

209 
	mNET_ATALK
=7,

210 
	mNET_NETROM
=8,

211 
	mNET_AX25
=9,

212 
	mNET_BRIDGE
=10,

213 
	mNET_ROSE
=11,

214 
	mNET_IPV6
=12,

215 
	mNET_X25
=13,

216 
	mNET_TR
=14,

217 
	mNET_DECNET
=15,

218 
	mNET_ECONET
=16,

219 
	mNET_SCTP
=17,

220 
	mNET_LLC
=18,

221 
	mNET_NETFILTER
=19,

222 
	mNET_DCCP
=20,

223 
	mNET_IRDA
=412,

229 
	mRANDOM_POOLSIZE
=1,

230 
	mRANDOM_ENTROPY_COUNT
=2,

231 
	mRANDOM_READ_THRESH
=3,

232 
	mRANDOM_WRITE_THRESH
=4,

233 
	mRANDOM_BOOT_ID
=5,

234 
	mRANDOM_UUID
=6

240 
	mPTY_MAX
=1,

241 
	mPTY_NR
=2

247 
	mBUS_ISA_MEM_BASE
=1,

248 
	mBUS_ISA_PORT_BASE
=2,

249 
	mBUS_ISA_PORT_SHIFT
=3

255 
	mNET_CORE_WMEM_MAX
=1,

256 
	mNET_CORE_RMEM_MAX
=2,

257 
	mNET_CORE_WMEM_DEFAULT
=3,

258 
	mNET_CORE_RMEM_DEFAULT
=4,

260 
	mNET_CORE_MAX_BACKLOG
=6,

261 
	mNET_CORE_FASTROUTE
=7,

262 
	mNET_CORE_MSG_COST
=8,

263 
	mNET_CORE_MSG_BURST
=9,

264 
	mNET_CORE_OPTMEM_MAX
=10,

265 
	mNET_CORE_HOT_LIST_LENGTH
=11,

266 
	mNET_CORE_DIVERT_VERSION
=12,

267 
	mNET_CORE_NO_CONG_THRESH
=13,

268 
	mNET_CORE_NO_CONG
=14,

269 
	mNET_CORE_LO_CONG
=15,

270 
	mNET_CORE_MOD_CONG
=16,

271 
	mNET_CORE_DEV_WEIGHT
=17,

272 
	mNET_CORE_SOMAXCONN
=18,

273 
	mNET_CORE_BUDGET
=19,

274 
	mNET_CORE_AEVENT_ETIME
=20,

275 
	mNET_CORE_AEVENT_RSEQTH
=21,

276 
	mNET_CORE_WARNINGS
=22,

287 
	mNET_UNIX_DESTROY_DELAY
=1,

288 
	mNET_UNIX_DELETE_DELAY
=2,

289 
	mNET_UNIX_MAX_DGRAM_QLEN
=3,

295 
	mNET_NF_CONNTRACK_MAX
=1,

296 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_SYN_SENT
=2,

297 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_SYN_RECV
=3,

298 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_ESTABLISHED
=4,

299 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_FIN_WAIT
=5,

300 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_CLOSE_WAIT
=6,

301 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_LAST_ACK
=7,

302 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_TIME_WAIT
=8,

303 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_CLOSE
=9,

304 
	mNET_NF_CONNTRACK_UDP_TIMEOUT
=10,

305 
	mNET_NF_CONNTRACK_UDP_TIMEOUT_STREAM
=11,

306 
	mNET_NF_CONNTRACK_ICMP_TIMEOUT
=12,

307 
	mNET_NF_CONNTRACK_GENERIC_TIMEOUT
=13,

308 
	mNET_NF_CONNTRACK_BUCKETS
=14,

309 
	mNET_NF_CONNTRACK_LOG_INVALID
=15,

310 
	mNET_NF_CONNTRACK_TCP_TIMEOUT_MAX_RETRANS
=16,

311 
	mNET_NF_CONNTRACK_TCP_LOOSE
=17,

312 
	mNET_NF_CONNTRACK_TCP_BE_LIBERAL
=18,

313 
	mNET_NF_CONNTRACK_TCP_MAX_RETRANS
=19,

314 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_CLOSED
=20,

315 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_WAIT
=21,

316 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_ECHOED
=22,

317 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_ESTABLISHED
=23,

318 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_SENT
=24,

319 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_RECD
=25,

320 
	mNET_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_ACK_SENT
=26,

321 
	mNET_NF_CONNTRACK_COUNT
=27,

322 
	mNET_NF_CONNTRACK_ICMPV6_TIMEOUT
=28,

323 
	mNET_NF_CONNTRACK_FRAG6_TIMEOUT
=29,

324 
	mNET_NF_CONNTRACK_FRAG6_LOW_THRESH
=30,

325 
	mNET_NF_CONNTRACK_FRAG6_HIGH_THRESH
=31,

326 
	mNET_NF_CONNTRACK_CHECKSUM
=32,

333 
	mNET_IPV4_FORWARD
=8,

334 
	mNET_IPV4_DYNADDR
=9,

336 
	mNET_IPV4_CONF
=16,

337 
	mNET_IPV4_NEIGH
=17,

338 
	mNET_IPV4_ROUTE
=18,

339 
	mNET_IPV4_FIB_HASH
=19,

340 
	mNET_IPV4_NETFILTER
=20,

342 
	mNET_IPV4_TCP_TIMESTAMPS
=33,

343 
	mNET_IPV4_TCP_WINDOW_SCALING
=34,

344 
	mNET_IPV4_TCP_SACK
=35,

345 
	mNET_IPV4_TCP_RETRANS_COLLAPSE
=36,

346 
	mNET_IPV4_DEFAULT_TTL
=37,

347 
	mNET_IPV4_AUTOCONFIG
=38,

348 
	mNET_IPV4_NO_PMTU_DISC
=39,

349 
	mNET_IPV4_TCP_SYN_RETRIES
=40,

350 
	mNET_IPV4_IPFRAG_HIGH_THRESH
=41,

351 
	mNET_IPV4_IPFRAG_LOW_THRESH
=42,

352 
	mNET_IPV4_IPFRAG_TIME
=43,

353 
	mNET_IPV4_TCP_MAX_KA_PROBES
=44,

354 
	mNET_IPV4_TCP_KEEPALIVE_TIME
=45,

355 
	mNET_IPV4_TCP_KEEPALIVE_PROBES
=46,

356 
	mNET_IPV4_TCP_RETRIES1
=47,

357 
	mNET_IPV4_TCP_RETRIES2
=48,

358 
	mNET_IPV4_TCP_FIN_TIMEOUT
=49,

359 
	mNET_IPV4_IP_MASQ_DEBUG
=50,

360 
	mNET_TCP_SYNCOOKIES
=51,

361 
	mNET_TCP_STDURG
=52,

362 
	mNET_TCP_RFC1337
=53,

363 
	mNET_TCP_SYN_TAILDROP
=54,

364 
	mNET_TCP_MAX_SYN_BACKLOG
=55,

365 
	mNET_IPV4_LOCAL_PORT_RANGE
=56,

366 
	mNET_IPV4_ICMP_ECHO_IGNORE_ALL
=57,

367 
	mNET_IPV4_ICMP_ECHO_IGNORE_BROADCASTS
=58,

368 
	mNET_IPV4_ICMP_SOURCEQUENCH_RATE
=59,

369 
	mNET_IPV4_ICMP_DESTUNREACH_RATE
=60,

370 
	mNET_IPV4_ICMP_TIMEEXCEED_RATE
=61,

371 
	mNET_IPV4_ICMP_PARAMPROB_RATE
=62,

372 
	mNET_IPV4_ICMP_ECHOREPLY_RATE
=63,

373 
	mNET_IPV4_ICMP_IGNORE_BOGUS_ERROR_RESPONSES
=64,

374 
	mNET_IPV4_IGMP_MAX_MEMBERSHIPS
=65,

375 
	mNET_TCP_TW_RECYCLE
=66,

376 
	mNET_IPV4_ALWAYS_DEFRAG
=67,

377 
	mNET_IPV4_TCP_KEEPALIVE_INTVL
=68,

378 
	mNET_IPV4_INET_PEER_THRESHOLD
=69,

379 
	mNET_IPV4_INET_PEER_MINTTL
=70,

380 
	mNET_IPV4_INET_PEER_MAXTTL
=71,

381 
	mNET_IPV4_INET_PEER_GC_MINTIME
=72,

382 
	mNET_IPV4_INET_PEER_GC_MAXTIME
=73,

383 
	mNET_TCP_ORPHAN_RETRIES
=74,

384 
	mNET_TCP_ABORT_ON_OVERFLOW
=75,

385 
	mNET_TCP_SYNACK_RETRIES
=76,

386 
	mNET_TCP_MAX_ORPHANS
=77,

387 
	mNET_TCP_MAX_TW_BUCKETS
=78,

388 
	mNET_TCP_FACK
=79,

389 
	mNET_TCP_REORDERING
=80,

390 
	mNET_TCP_ECN
=81,

391 
	mNET_TCP_DSACK
=82,

392 
	mNET_TCP_MEM
=83,

393 
	mNET_TCP_WMEM
=84,

394 
	mNET_TCP_RMEM
=85,

395 
	mNET_TCP_APP_WIN
=86,

396 
	mNET_TCP_ADV_WIN_SCALE
=87,

397 
	mNET_IPV4_NONLOCAL_BIND
=88,

398 
	mNET_IPV4_ICMP_RATELIMIT
=89,

399 
	mNET_IPV4_ICMP_RATEMASK
=90,

400 
	mNET_TCP_TW_REUSE
=91,

401 
	mNET_TCP_FRTO
=92,

402 
	mNET_TCP_LOW_LATENCY
=93,

403 
	mNET_IPV4_IPFRAG_SECRET_INTERVAL
=94,

404 
	mNET_IPV4_IGMP_MAX_MSF
=96,

405 
	mNET_TCP_NO_METRICS_SAVE
=97,

406 
	mNET_TCP_DEFAULT_WIN_SCALE
=105,

407 
	mNET_TCP_MODERATE_RCVBUF
=106,

408 
	mNET_TCP_TSO_WIN_DIVISOR
=107,

409 
	mNET_TCP_BIC_BETA
=108,

410 
	mNET_IPV4_ICMP_ERRORS_USE_INBOUND_IFADDR
=109,

411 
	mNET_TCP_CONG_CONTROL
=110,

412 
	mNET_TCP_ABC
=111,

413 
	mNET_IPV4_IPFRAG_MAX_DIST
=112,

414 
	mNET_TCP_MTU_PROBING
=113,

415 
	mNET_TCP_BASE_MSS
=114,

416 
	mNET_IPV4_TCP_WORKAROUND_SIGNED_WINDOWS
=115,

417 
	mNET_TCP_DMA_COPYBREAK
=116,

418 
	mNET_TCP_SLOW_START_AFTER_IDLE
=117,

419 
	mNET_CIPSOV4_CACHE_ENABLE
=118,

420 
	mNET_CIPSOV4_CACHE_BUCKET_SIZE
=119,

421 
	mNET_CIPSOV4_RBM_OPTFMT
=120,

422 
	mNET_CIPSOV4_RBM_STRICTVALID
=121,

423 
	mNET_TCP_AVAIL_CONG_CONTROL
=122,

424 
	mNET_TCP_ALLOWED_CONG_CONTROL
=123,

425 
	mNET_TCP_MAX_SSTHRESH
=124,

426 
	mNET_TCP_FRTO_RESPONSE
=125,

430 
	mNET_IPV4_ROUTE_FLUSH
=1,

431 
	mNET_IPV4_ROUTE_MIN_DELAY
=2,

432 
	mNET_IPV4_ROUTE_MAX_DELAY
=3,

433 
	mNET_IPV4_ROUTE_GC_THRESH
=4,

434 
	mNET_IPV4_ROUTE_MAX_SIZE
=5,

435 
	mNET_IPV4_ROUTE_GC_MIN_INTERVAL
=6,

436 
	mNET_IPV4_ROUTE_GC_TIMEOUT
=7,

437 
	mNET_IPV4_ROUTE_GC_INTERVAL
=8,

438 
	mNET_IPV4_ROUTE_REDIRECT_LOAD
=9,

439 
	mNET_IPV4_ROUTE_REDIRECT_NUMBER
=10,

440 
	mNET_IPV4_ROUTE_REDIRECT_SILENCE
=11,

441 
	mNET_IPV4_ROUTE_ERROR_COST
=12,

442 
	mNET_IPV4_ROUTE_ERROR_BURST
=13,

443 
	mNET_IPV4_ROUTE_GC_ELASTICITY
=14,

444 
	mNET_IPV4_ROUTE_MTU_EXPIRES
=15,

445 
	mNET_IPV4_ROUTE_MIN_PMTU
=16,

446 
	mNET_IPV4_ROUTE_MIN_ADVMSS
=17,

447 
	mNET_IPV4_ROUTE_SECRET_INTERVAL
=18,

448 
	mNET_IPV4_ROUTE_GC_MIN_INTERVAL_MS
=19,

453 
	mNET_PROTO_CONF_ALL
=-2,

454 
	mNET_PROTO_CONF_DEFAULT
=-3

461 
	mNET_IPV4_CONF_FORWARDING
=1,

462 
	mNET_IPV4_CONF_MC_FORWARDING
=2,

463 
	mNET_IPV4_CONF_PROXY_ARP
=3,

464 
	mNET_IPV4_CONF_ACCEPT_REDIRECTS
=4,

465 
	mNET_IPV4_CONF_SECURE_REDIRECTS
=5,

466 
	mNET_IPV4_CONF_SEND_REDIRECTS
=6,

467 
	mNET_IPV4_CONF_SHARED_MEDIA
=7,

468 
	mNET_IPV4_CONF_RP_FILTER
=8,

469 
	mNET_IPV4_CONF_ACCEPT_SOURCE_ROUTE
=9,

470 
	mNET_IPV4_CONF_BOOTP_RELAY
=10,

471 
	mNET_IPV4_CONF_LOG_MARTIANS
=11,

472 
	mNET_IPV4_CONF_TAG
=12,

473 
	mNET_IPV4_CONF_ARPFILTER
=13,

474 
	mNET_IPV4_CONF_MEDIUM_ID
=14,

475 
	mNET_IPV4_CONF_NOXFRM
=15,

476 
	mNET_IPV4_CONF_NOPOLICY
=16,

477 
	mNET_IPV4_CONF_FORCE_IGMP_VERSION
=17,

478 
	mNET_IPV4_CONF_ARP_ANNOUNCE
=18,

479 
	mNET_IPV4_CONF_ARP_IGNORE
=19,

480 
	mNET_IPV4_CONF_PROMOTE_SECONDARIES
=20,

481 
	mNET_IPV4_CONF_ARP_ACCEPT
=21,

482 
	mNET_IPV4_CONF_ARP_NOTIFY
=22,

488 
	mNET_IPV4_NF_CONNTRACK_MAX
=1,

489 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_SYN_SENT
=2,

490 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_SYN_RECV
=3,

491 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_ESTABLISHED
=4,

492 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_FIN_WAIT
=5,

493 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_CLOSE_WAIT
=6,

494 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_LAST_ACK
=7,

495 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_TIME_WAIT
=8,

496 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_CLOSE
=9,

497 
	mNET_IPV4_NF_CONNTRACK_UDP_TIMEOUT
=10,

498 
	mNET_IPV4_NF_CONNTRACK_UDP_TIMEOUT_STREAM
=11,

499 
	mNET_IPV4_NF_CONNTRACK_ICMP_TIMEOUT
=12,

500 
	mNET_IPV4_NF_CONNTRACK_GENERIC_TIMEOUT
=13,

501 
	mNET_IPV4_NF_CONNTRACK_BUCKETS
=14,

502 
	mNET_IPV4_NF_CONNTRACK_LOG_INVALID
=15,

503 
	mNET_IPV4_NF_CONNTRACK_TCP_TIMEOUT_MAX_RETRANS
=16,

504 
	mNET_IPV4_NF_CONNTRACK_TCP_LOOSE
=17,

505 
	mNET_IPV4_NF_CONNTRACK_TCP_BE_LIBERAL
=18,

506 
	mNET_IPV4_NF_CONNTRACK_TCP_MAX_RETRANS
=19,

507 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_CLOSED
=20,

508 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_WAIT
=21,

509 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_COOKIE_ECHOED
=22,

510 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_ESTABLISHED
=23,

511 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_SENT
=24,

512 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_RECD
=25,

513 
	mNET_IPV4_NF_CONNTRACK_SCTP_TIMEOUT_SHUTDOWN_ACK_SENT
=26,

514 
	mNET_IPV4_NF_CONNTRACK_COUNT
=27,

515 
	mNET_IPV4_NF_CONNTRACK_CHECKSUM
=28,

520 
	mNET_IPV6_CONF
=16,

521 
	mNET_IPV6_NEIGH
=17,

522 
	mNET_IPV6_ROUTE
=18,

523 
	mNET_IPV6_ICMP
=19,

524 
	mNET_IPV6_BINDV6ONLY
=20,

525 
	mNET_IPV6_IP6FRAG_HIGH_THRESH
=21,

526 
	mNET_IPV6_IP6FRAG_LOW_THRESH
=22,

527 
	mNET_IPV6_IP6FRAG_TIME
=23,

528 
	mNET_IPV6_IP6FRAG_SECRET_INTERVAL
=24,

529 
	mNET_IPV6_MLD_MAX_MSF
=25,

533 
	mNET_IPV6_ROUTE_FLUSH
=1,

534 
	mNET_IPV6_ROUTE_GC_THRESH
=2,

535 
	mNET_IPV6_ROUTE_MAX_SIZE
=3,

536 
	mNET_IPV6_ROUTE_GC_MIN_INTERVAL
=4,

537 
	mNET_IPV6_ROUTE_GC_TIMEOUT
=5,

538 
	mNET_IPV6_ROUTE_GC_INTERVAL
=6,

539 
	mNET_IPV6_ROUTE_GC_ELASTICITY
=7,

540 
	mNET_IPV6_ROUTE_MTU_EXPIRES
=8,

541 
	mNET_IPV6_ROUTE_MIN_ADVMSS
=9,

542 
	mNET_IPV6_ROUTE_GC_MIN_INTERVAL_MS
=10

546 
	mNET_IPV6_FORWARDING
=1,

547 
	mNET_IPV6_HOP_LIMIT
=2,

548 
	mNET_IPV6_MTU
=3,

549 
	mNET_IPV6_ACCEPT_RA
=4,

550 
	mNET_IPV6_ACCEPT_REDIRECTS
=5,

551 
	mNET_IPV6_AUTOCONF
=6,

552 
	mNET_IPV6_DAD_TRANSMITS
=7,

553 
	mNET_IPV6_RTR_SOLICITS
=8,

554 
	mNET_IPV6_RTR_SOLICIT_INTERVAL
=9,

555 
	mNET_IPV6_RTR_SOLICIT_DELAY
=10,

556 
	mNET_IPV6_USE_TEMPADDR
=11,

557 
	mNET_IPV6_TEMP_VALID_LFT
=12,

558 
	mNET_IPV6_TEMP_PREFERED_LFT
=13,

559 
	mNET_IPV6_REGEN_MAX_RETRY
=14,

560 
	mNET_IPV6_MAX_DESYNC_FACTOR
=15,

561 
	mNET_IPV6_MAX_ADDRESSES
=16,

562 
	mNET_IPV6_FORCE_MLD_VERSION
=17,

563 
	mNET_IPV6_ACCEPT_RA_DEFRTR
=18,

564 
	mNET_IPV6_ACCEPT_RA_PINFO
=19,

565 
	mNET_IPV6_ACCEPT_RA_RTR_PREF
=20,

566 
	mNET_IPV6_RTR_PROBE_INTERVAL
=21,

567 
	mNET_IPV6_ACCEPT_RA_RT_INFO_MAX_PLEN
=22,

568 
	mNET_IPV6_PROXY_NDP
=23,

569 
	mNET_IPV6_ACCEPT_SOURCE_ROUTE
=25,

570 
	mNET_IPV6_ACCEPT_RA_FROM_LOCAL
=26,

571 
	m__NET_IPV6_MAX


576 
	mNET_IPV6_ICMP_RATELIMIT
=1

581 
	mNET_NEIGH_MCAST_SOLICIT
=1,

582 
	mNET_NEIGH_UCAST_SOLICIT
=2,

583 
	mNET_NEIGH_APP_SOLICIT
=3,

584 
	mNET_NEIGH_RETRANS_TIME
=4,

585 
	mNET_NEIGH_REACHABLE_TIME
=5,

586 
	mNET_NEIGH_DELAY_PROBE_TIME
=6,

587 
	mNET_NEIGH_GC_STALE_TIME
=7,

588 
	mNET_NEIGH_UNRES_QLEN
=8,

589 
	mNET_NEIGH_PROXY_QLEN
=9,

590 
	mNET_NEIGH_ANYCAST_DELAY
=10,

591 
	mNET_NEIGH_PROXY_DELAY
=11,

592 
	mNET_NEIGH_LOCKTIME
=12,

593 
	mNET_NEIGH_GC_INTERVAL
=13,

594 
	mNET_NEIGH_GC_THRESH1
=14,

595 
	mNET_NEIGH_GC_THRESH2
=15,

596 
	mNET_NEIGH_GC_THRESH3
=16,

597 
	mNET_NEIGH_RETRANS_TIME_MS
=17,

598 
	mNET_NEIGH_REACHABLE_TIME_MS
=18,

603 
	mNET_DCCP_DEFAULT
=1,

608 
	mNET_IPX_PPROP_BROADCASTING
=1,

609 
	mNET_IPX_FORWARDING
=2

614 
	mNET_LLC2
=1,

615 
	mNET_LLC_STATION
=2,

620 
	mNET_LLC2_TIMEOUT
=1,

625 
	mNET_LLC_STATION_ACK_TIMEOUT
=1,

630 
	mNET_LLC2_ACK_TIMEOUT
=1,

631 
	mNET_LLC2_P_TIMEOUT
=2,

632 
	mNET_LLC2_REJ_TIMEOUT
=3,

633 
	mNET_LLC2_BUSY_TIMEOUT
=4,

638 
	mNET_ATALK_AARP_EXPIRY_TIME
=1,

639 
	mNET_ATALK_AARP_TICK_TIME
=2,

640 
	mNET_ATALK_AARP_RETRANSMIT_LIMIT
=3,

641 
	mNET_ATALK_AARP_RESOLVE_TIME
=4

647 
	mNET_NETROM_DEFAULT_PATH_QUALITY
=1,

648 
	mNET_NETROM_OBSOLESCENCE_COUNT_INITIALISER
=2,

649 
	mNET_NETROM_NETWORK_TTL_INITIALISER
=3,

650 
	mNET_NETROM_TRANSPORT_TIMEOUT
=4,

651 
	mNET_NETROM_TRANSPORT_MAXIMUM_TRIES
=5,

652 
	mNET_NETROM_TRANSPORT_ACKNOWLEDGE_DELAY
=6,

653 
	mNET_NETROM_TRANSPORT_BUSY_DELAY
=7,

654 
	mNET_NETROM_TRANSPORT_REQUESTED_WINDOW_SIZE
=8,

655 
	mNET_NETROM_TRANSPORT_NO_ACTIVITY_TIMEOUT
=9,

656 
	mNET_NETROM_ROUTING_CONTROL
=10,

657 
	mNET_NETROM_LINK_FAILS_COUNT
=11,

658 
	mNET_NETROM_RESET
=12

663 
	mNET_AX25_IP_DEFAULT_MODE
=1,

664 
	mNET_AX25_DEFAULT_MODE
=2,

665 
	mNET_AX25_BACKOFF_TYPE
=3,

666 
	mNET_AX25_CONNECT_MODE
=4,

667 
	mNET_AX25_STANDARD_WINDOW
=5,

668 
	mNET_AX25_EXTENDED_WINDOW
=6,

669 
	mNET_AX25_T1_TIMEOUT
=7,

670 
	mNET_AX25_T2_TIMEOUT
=8,

671 
	mNET_AX25_T3_TIMEOUT
=9,

672 
	mNET_AX25_IDLE_TIMEOUT
=10,

673 
	mNET_AX25_N2
=11,

674 
	mNET_AX25_PACLEN
=12,

675 
	mNET_AX25_PROTOCOL
=13,

676 
	mNET_AX25_DAMA_SLAVE_TIMEOUT
=14

681 
	mNET_ROSE_RESTART_REQUEST_TIMEOUT
=1,

682 
	mNET_ROSE_CALL_REQUEST_TIMEOUT
=2,

683 
	mNET_ROSE_RESET_REQUEST_TIMEOUT
=3,

684 
	mNET_ROSE_CLEAR_REQUEST_TIMEOUT
=4,

685 
	mNET_ROSE_ACK_HOLD_BACK_TIMEOUT
=5,

686 
	mNET_ROSE_ROUTING_CONTROL
=6,

687 
	mNET_ROSE_LINK_FAIL_TIMEOUT
=7,

688 
	mNET_ROSE_MAX_VCS
=8,

689 
	mNET_ROSE_WINDOW_SIZE
=9,

690 
	mNET_ROSE_NO_ACTIVITY_TIMEOUT
=10

695 
	mNET_X25_RESTART_REQUEST_TIMEOUT
=1,

696 
	mNET_X25_CALL_REQUEST_TIMEOUT
=2,

697 
	mNET_X25_RESET_REQUEST_TIMEOUT
=3,

698 
	mNET_X25_CLEAR_REQUEST_TIMEOUT
=4,

699 
	mNET_X25_ACK_HOLD_BACK_TIMEOUT
=5,

700 
	mNET_X25_FORWARD
=6

706 
	mNET_TR_RIF_TIMEOUT
=1

711 
	mNET_DECNET_NODE_TYPE
 = 1,

712 
	mNET_DECNET_NODE_ADDRESS
 = 2,

713 
	mNET_DECNET_NODE_NAME
 = 3,

714 
	mNET_DECNET_DEFAULT_DEVICE
 = 4,

715 
	mNET_DECNET_TIME_WAIT
 = 5,

716 
	mNET_DECNET_DN_COUNT
 = 6,

717 
	mNET_DECNET_DI_COUNT
 = 7,

718 
	mNET_DECNET_DR_COUNT
 = 8,

719 
	mNET_DECNET_DST_GC_INTERVAL
 = 9,

720 
	mNET_DECNET_CONF
 = 10,

721 
	mNET_DECNET_NO_FC_MAX_CWND
 = 11,

722 
	mNET_DECNET_MEM
 = 12,

723 
	mNET_DECNET_RMEM
 = 13,

724 
	mNET_DECNET_WMEM
 = 14,

725 
	mNET_DECNET_DEBUG_LEVEL
 = 255

730 
	mNET_DECNET_CONF_LOOPBACK
 = -2,

731 
	mNET_DECNET_CONF_DDCMP
 = -3,

732 
	mNET_DECNET_CONF_PPP
 = -4,

733 
	mNET_DECNET_CONF_X25
 = -5,

734 
	mNET_DECNET_CONF_GRE
 = -6,

735 
	mNET_DECNET_CONF_ETHER
 = -7

742 
	mNET_DECNET_CONF_DEV_PRIORITY
 = 1,

743 
	mNET_DECNET_CONF_DEV_T1
 = 2,

744 
	mNET_DECNET_CONF_DEV_T2
 = 3,

745 
	mNET_DECNET_CONF_DEV_T3
 = 4,

746 
	mNET_DECNET_CONF_DEV_FORWARDING
 = 5,

747 
	mNET_DECNET_CONF_DEV_BLKSIZE
 = 6,

748 
	mNET_DECNET_CONF_DEV_STATE
 = 7

753 
	mNET_SCTP_RTO_INITIAL
 = 1,

754 
	mNET_SCTP_RTO_MIN
 = 2,

755 
	mNET_SCTP_RTO_MAX
 = 3,

756 
	mNET_SCTP_RTO_ALPHA
 = 4,

757 
	mNET_SCTP_RTO_BETA
 = 5,

758 
	mNET_SCTP_VALID_COOKIE_LIFE
 = 6,

759 
	mNET_SCTP_ASSOCIATION_MAX_RETRANS
 = 7,

760 
	mNET_SCTP_PATH_MAX_RETRANS
 = 8,

761 
	mNET_SCTP_MAX_INIT_RETRANSMITS
 = 9,

762 
	mNET_SCTP_HB_INTERVAL
 = 10,

763 
	mNET_SCTP_PRESERVE_ENABLE
 = 11,

764 
	mNET_SCTP_MAX_BURST
 = 12,

765 
	mNET_SCTP_ADDIP_ENABLE
 = 13,

766 
	mNET_SCTP_PRSCTP_ENABLE
 = 14,

767 
	mNET_SCTP_SNDBUF_POLICY
 = 15,

768 
	mNET_SCTP_SACK_TIMEOUT
 = 16,

769 
	mNET_SCTP_RCVBUF_POLICY
 = 17,

774 
	mNET_BRIDGE_NF_CALL_ARPTABLES
 = 1,

775 
	mNET_BRIDGE_NF_CALL_IPTABLES
 = 2,

776 
	mNET_BRIDGE_NF_CALL_IP6TABLES
 = 3,

777 
	mNET_BRIDGE_NF_FILTER_VLAN_TAGGED
 = 4,

778 
	mNET_BRIDGE_NF_FILTER_PPPOE_TAGGED
 = 5,

783 
	mNET_IRDA_DISCOVERY
=1,

784 
	mNET_IRDA_DEVNAME
=2,

785 
	mNET_IRDA_DEBUG
=3,

786 
	mNET_IRDA_FAST_POLL
=4,

787 
	mNET_IRDA_DISCOVERY_SLOTS
=5,

788 
	mNET_IRDA_DISCOVERY_TIMEOUT
=6,

789 
	mNET_IRDA_SLOT_TIMEOUT
=7,

790 
	mNET_IRDA_MAX_BAUD_RATE
=8,

791 
	mNET_IRDA_MIN_TX_TURN_TIME
=9,

792 
	mNET_IRDA_MAX_TX_DATA_SIZE
=10,

793 
	mNET_IRDA_MAX_TX_WINDOW
=11,

794 
	mNET_IRDA_MAX_NOREPLY_TIME
=12,

795 
	mNET_IRDA_WARN_NOREPLY_TIME
=13,

796 
	mNET_IRDA_LAP_KEEPALIVE_TIME
=14,

803 
	mFS_NRINODE
=1,

804 
	mFS_STATINODE
=2,

805 
	mFS_MAXINODE
=3,

806 
	mFS_NRDQUOT
=4,

807 
	mFS_MAXDQUOT
=5,

808 
	mFS_NRFILE
=6,

809 
	mFS_MAXFILE
=7,

810 
	mFS_DENTRY
=8,

811 
	mFS_NRSUPER
=9,

812 
	mFS_MAXSUPER
=10,

813 
	mFS_OVERFLOWUID
=11,

814 
	mFS_OVERFLOWGID
=12,

815 
	mFS_LEASES
=13,

816 
	mFS_DIR_NOTIFY
=14,

817 
	mFS_LEASE_TIME
=15,

818 
	mFS_DQSTATS
=16,

819 
	mFS_XFS
=17,

820 
	mFS_AIO_NR
=18,

821 
	mFS_AIO_MAX_NR
=19,

822 
	mFS_INOTIFY
=20,

823 
	mFS_OCFS2
=988,

828 
	mFS_DQ_LOOKUPS
 = 1,

829 
	mFS_DQ_DROPS
 = 2,

830 
	mFS_DQ_READS
 = 3,

831 
	mFS_DQ_WRITES
 = 4,

832 
	mFS_DQ_CACHE_HITS
 = 5,

833 
	mFS_DQ_ALLOCATED
 = 6,

834 
	mFS_DQ_FREE
 = 7,

835 
	mFS_DQ_SYNCS
 = 8,

836 
	mFS_DQ_WARNINGS
 = 9,

843 
	mDEV_CDROM
=1,

844 
	mDEV_HWMON
=2,

845 
	mDEV_PARPORT
=3,

846 
	mDEV_RAID
=4,

847 
	mDEV_MAC_HID
=5,

848 
	mDEV_SCSI
=6,

849 
	mDEV_IPMI
=7,

854 
	mDEV_CDROM_INFO
=1,

855 
	mDEV_CDROM_AUTOCLOSE
=2,

856 
	mDEV_CDROM_AUTOEJECT
=3,

857 
	mDEV_CDROM_DEBUG
=4,

858 
	mDEV_CDROM_LOCK
=5,

859 
	mDEV_CDROM_CHECK_MEDIA
=6

864 
	mDEV_PARPORT_DEFAULT
=-3

869 
	mDEV_RAID_SPEED_LIMIT_MIN
=1,

870 
	mDEV_RAID_SPEED_LIMIT_MAX
=2

875 
	mDEV_PARPORT_DEFAULT_TIMESLICE
=1,

876 
	mDEV_PARPORT_DEFAULT_SPINTIME
=2

881 
	mDEV_PARPORT_SPINTIME
=1,

882 
	mDEV_PARPORT_BASE_ADDR
=2,

883 
	mDEV_PARPORT_IRQ
=3,

884 
	mDEV_PARPORT_DMA
=4,

885 
	mDEV_PARPORT_MODES
=5,

886 
	mDEV_PARPORT_DEVICES
=6,

887 
	mDEV_PARPORT_AUTOPROBE
=16

892 
	mDEV_PARPORT_DEVICES_ACTIVE
=-3,

897 
	mDEV_PARPORT_DEVICE_TIMESLICE
=1,

902 
	mDEV_MAC_HID_KEYBOARD_SENDS_LINUX_KEYCODES
=1,

903 
	mDEV_MAC_HID_KEYBOARD_LOCK_KEYCODES
=2,

904 
	mDEV_MAC_HID_MOUSE_BUTTON_EMULATION
=3,

905 
	mDEV_MAC_HID_MOUSE_BUTTON2_KEYCODE
=4,

906 
	mDEV_MAC_HID_MOUSE_BUTTON3_KEYCODE
=5,

907 
	mDEV_MAC_HID_ADB_MOUSE_SENDS_KEYCODES
=6

912 
	mDEV_SCSI_LOGGING_LEVEL
=1,

917 
	mDEV_IPMI_POWEROFF_POWERCYCLE
=1,

923 
	mABI_DEFHANDLER_COFF
=1,

924 
	mABI_DEFHANDLER_ELF
=2,

925 
	mABI_DEFHANDLER_LCALL7
=3,

926 
	mABI_DEFHANDLER_LIBCSO
=4,

927 
	mABI_TRACE
=5,

928 
	mABI_FAKE_UTSNAME
=6,

	@/usr/include/linux/sysinfo.h

1 #iâdeà
_LINUX_SYSINFO_H


2 
	#_LINUX_SYSINFO_H


	)

4 
	~<lšux/ty³s.h
>

6 
	#SI_LOAD_SHIFT
 16

	)

7 
	ssysšfo
 {

8 
__k”Ãl_lÚg_t
 
	mu±ime
;

9 
__k”Ãl_ulÚg_t
 
	mlßds
[3];

10 
__k”Ãl_ulÚg_t
 
	mtÙ®¿m
;

11 
__k”Ãl_ulÚg_t
 
	mä“¿m
;

12 
__k”Ãl_ulÚg_t
 
	msh¬ed¿m
;

13 
__k”Ãl_ulÚg_t
 
	mbufã¼am
;

14 
__k”Ãl_ulÚg_t
 
	mtÙ®sw­
;

15 
__k”Ãl_ulÚg_t
 
	mä“sw­
;

16 
__u16
 
	m´ocs
;

17 
__u16
 
	m·d
;

18 
__k”Ãl_ulÚg_t
 
	mtÙ®high
;

19 
__k”Ãl_ulÚg_t
 
	mä“high
;

20 
__u32
 
	mmem_un™
;

21 
	m_f
[20-2*(
__k”Ãl_ulÚg_t
)-(
__u32
)];

	@/usr/include/linux/types.h

1 #iâdeà
_LINUX_TYPES_H


2 
	#_LINUX_TYPES_H


	)

4 
	~<asm/ty³s.h
>

6 #iâdeà
__ASSEMBLY__


8 
	~<lšux/posix_ty³s.h
>

16 #ifdeà
__CHECKER__


17 
	#__b™wi£__
 
	`__©Œibu‹__
((
b™wi£
))

	)

19 
	#__b™wi£__


	)

21 
	#__b™wi£
 
__b™wi£__


	)

23 
__u16
 
	t__b™wi£
 
	t__Ë16
;

24 
__u16
 
	t__b™wi£
 
	t__be16
;

25 
__u32
 
	t__b™wi£
 
	t__Ë32
;

26 
__u32
 
	t__b™wi£
 
	t__be32
;

27 
__u64
 
	t__b™wi£
 
	t__Ë64
;

28 
__u64
 
	t__b™wi£
 
	t__be64
;

30 
__u16
 
	t__b™wi£
 
	t__sum16
;

31 
__u32
 
	t__b™wi£
 
	t__wsum
;

42 
	#__®igÃd_u64
 
__u64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

43 
	#__®igÃd_be64
 
__be64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

44 
	#__®igÃd_Ë64
 
__Ë64
 
	`__©Œibu‹__
((
	`®igÃd
(8)))

	)

	@/usr/include/asm/byteorder.h

1 #iâdeà
_ASM_X86_BYTEORDER_H


2 
	#_ASM_X86_BYTEORDER_H


	)

4 
	~<lšux/by‹Üd”/l™e_’dŸn.h
>

	@/usr/include/asm/fcntl.h

1 
	~<asm-g’”ic/fú.h
>

	@/usr/include/asm/ioctl.h

1 
	~<asm-g’”ic/ioùl.h
>

	@/usr/include/asm/types.h

1 #iâdeà
_ASM_X86_TYPES_H


2 
	#_ASM_X86_TYPES_H


	)

4 
	~<asm-g’”ic/ty³s.h
>

	@/usr/include/bits/posix1_lim.h

24 #iâdef 
_BITS_POSIX1_LIM_H


25 
	#_BITS_POSIX1_LIM_H
 1

	)

31 
	#_POSIX_AIO_LISTIO_MAX
 2

	)

34 
	#_POSIX_AIO_MAX
 1

	)

37 
	#_POSIX_ARG_MAX
 4096

	)

40 #ifdeà
__USE_XOPEN2K


41 
	#_POSIX_CHILD_MAX
 25

	)

43 
	#_POSIX_CHILD_MAX
 6

	)

47 
	#_POSIX_DELAYTIMER_MAX
 32

	)

51 
	#_POSIX_HOST_NAME_MAX
 255

	)

54 
	#_POSIX_LINK_MAX
 8

	)

57 
	#_POSIX_LOGIN_NAME_MAX
 9

	)

60 
	#_POSIX_MAX_CANON
 255

	)

64 
	#_POSIX_MAX_INPUT
 255

	)

67 
	#_POSIX_MQ_OPEN_MAX
 8

	)

70 
	#_POSIX_MQ_PRIO_MAX
 32

	)

73 
	#_POSIX_NAME_MAX
 14

	)

76 #ifdeà
__USE_XOPEN2K


77 
	#_POSIX_NGROUPS_MAX
 8

	)

79 
	#_POSIX_NGROUPS_MAX
 0

	)

83 #ifdeà
__USE_XOPEN2K


84 
	#_POSIX_OPEN_MAX
 20

	)

86 
	#_POSIX_OPEN_MAX
 16

	)

89 #ià!
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_GNU


92 
	#_POSIX_FD_SETSIZE
 
_POSIX_OPEN_MAX


	)

96 
	#_POSIX_PATH_MAX
 256

	)

99 
	#_POSIX_PIPE_BUF
 512

	)

103 
	#_POSIX_RE_DUP_MAX
 255

	)

106 
	#_POSIX_RTSIG_MAX
 8

	)

109 
	#_POSIX_SEM_NSEMS_MAX
 256

	)

112 
	#_POSIX_SEM_VALUE_MAX
 32767

	)

115 
	#_POSIX_SIGQUEUE_MAX
 32

	)

118 
	#_POSIX_SSIZE_MAX
 32767

	)

121 
	#_POSIX_STREAM_MAX
 8

	)

124 
	#_POSIX_SYMLINK_MAX
 255

	)

128 
	#_POSIX_SYMLOOP_MAX
 8

	)

131 
	#_POSIX_TIMER_MAX
 32

	)

134 
	#_POSIX_TTY_NAME_MAX
 9

	)

137 #ifdeà
__USE_XOPEN2K


138 
	#_POSIX_TZNAME_MAX
 6

	)

140 
	#_POSIX_TZNAME_MAX
 3

	)

143 #ià!
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_GNU


145 
	#_POSIX_QLIMIT
 1

	)

149 
	#_POSIX_HIWAT
 
_POSIX_PIPE_BUF


	)

152 
	#_POSIX_UIO_MAXIOV
 16

	)

156 
	#_POSIX_CLOCKRES_MIN
 20000000

	)

160 
	~<b™s/loÿl_lim.h
>

163 #iâdef 
SSIZE_MAX


164 
	#SSIZE_MAX
 
LONG_MAX


	)

171 #iâdef 
NGROUPS_MAX


172 
	#NGROUPS_MAX
 8

	)

	@/usr/include/bits/posix2_lim.h

22 #iâdef 
_BITS_POSIX2_LIM_H


23 
	#_BITS_POSIX2_LIM_H
 1

	)

27 
	#_POSIX2_BC_BASE_MAX
 99

	)

30 
	#_POSIX2_BC_DIM_MAX
 2048

	)

33 
	#_POSIX2_BC_SCALE_MAX
 99

	)

36 
	#_POSIX2_BC_STRING_MAX
 1000

	)

40 
	#_POSIX2_COLL_WEIGHTS_MAX
 2

	)

44 
	#_POSIX2_EXPR_NEST_MAX
 32

	)

47 
	#_POSIX2_LINE_MAX
 2048

	)

51 
	#_POSIX2_RE_DUP_MAX
 255

	)

55 
	#_POSIX2_CHARCLASS_NAME_MAX
 14

	)

62 #iâdef 
BC_BASE_MAX


63 
	#BC_BASE_MAX
 
_POSIX2_BC_BASE_MAX


	)

65 #iâdef 
BC_DIM_MAX


66 
	#BC_DIM_MAX
 
_POSIX2_BC_DIM_MAX


	)

68 #iâdef 
BC_SCALE_MAX


69 
	#BC_SCALE_MAX
 
_POSIX2_BC_SCALE_MAX


	)

71 #iâdef 
BC_STRING_MAX


72 
	#BC_STRING_MAX
 
_POSIX2_BC_STRING_MAX


	)

74 #iâdef 
COLL_WEIGHTS_MAX


75 
	#COLL_WEIGHTS_MAX
 255

	)

77 #iâdef 
EXPR_NEST_MAX


78 
	#EXPR_NEST_MAX
 
_POSIX2_EXPR_NEST_MAX


	)

80 #iâdef 
LINE_MAX


81 
	#LINE_MAX
 
_POSIX2_LINE_MAX


	)

83 #iâdef 
CHARCLASS_NAME_MAX


84 
	#CHARCLASS_NAME_MAX
 2048

	)

88 
	#RE_DUP_MAX
 (0x7fff)

	)

	@/usr/include/bits/wordsize.h

3 #ià
defšed
 
__x86_64__
 && !defšed 
__ILP32__


4 
	#__WORDSIZE
 64

	)

6 
	#__WORDSIZE
 32

	)

9 #ifdeà
__x86_64__


10 
	#__WORDSIZE_TIME64_COMPAT32
 1

	)

12 
	#__SYSCALL_WORDSIZE
 64

	)

	@/usr/include/bits/xopen_lim.h

29 #iâdeà
_XOPEN_LIM_H


30 
	#_XOPEN_LIM_H
 1

	)

32 
	#__Ãed_IOV_MAX


	)

33 
	~<b™s/¡dio_lim.h
>

65 
	#_XOPEN_IOV_MAX
 
_POSIX_UIO_MAXIOV


	)

70 
	#NL_ARGMAX
 
_POSIX_ARG_MAX


	)

73 
	#NL_LANGMAX
 
_POSIX2_LINE_MAX


	)

76 
	#NL_MSGMAX
 
INT_MAX


	)

80 
	#NL_NMAX
 
INT_MAX


	)

83 
	#NL_SETMAX
 
INT_MAX


	)

86 
	#NL_TEXTMAX
 
INT_MAX


	)

89 
	#NZERO
 20

	)

93 #ifdeà
INT_MAX


94 #ià
INT_MAX
 == 32767

95 
	#WORD_BIT
 16

	)

97 #ià
INT_MAX
 == 2147483647

98 
	#WORD_BIT
 32

	)

101 
	#WORD_BIT
 64

	)

104 #–ià
defšed
 
__INT_MAX__


105 #ià
__INT_MAX__
 == 32767

106 
	#WORD_BIT
 16

	)

108 #ià
__INT_MAX__
 == 2147483647

109 
	#WORD_BIT
 32

	)

112 
	#WORD_BIT
 64

	)

116 
	#WORD_BIT
 32

	)

120 #ifdeà
LONG_MAX


121 #ià
LONG_MAX
 == 2147483647

122 
	#LONG_BIT
 32

	)

125 
	#LONG_BIT
 64

	)

127 #–ià
defšed
 
__LONG_MAX__


128 #ià
__LONG_MAX__
 == 2147483647

129 
	#LONG_BIT
 32

	)

132 
	#LONG_BIT
 64

	)

135 
	~<b™s/wÜdsize.h
>

136 #ià
__WORDSIZE
 == 64

137 
	#LONG_BIT
 64

	)

139 
	#LONG_BIT
 32

	)

	@/usr/include/features.h

18 #iâdef 
_FEATURES_H


19 
	#_FEATURES_H
 1

	)

97 #undeà
__USE_ISOC11


98 #undeà
__USE_ISOC99


99 #undeà
__USE_ISOC95


100 #undeà
__USE_ISOCXX11


101 #undeà
__USE_POSIX


102 #undeà
__USE_POSIX2


103 #undeà
__USE_POSIX199309


104 #undeà
__USE_POSIX199506


105 #undeà
__USE_XOPEN


106 #undeà
__USE_XOPEN_EXTENDED


107 #undeà
__USE_UNIX98


108 #undeà
__USE_XOPEN2K


109 #undeà
__USE_XOPEN2KXSI


110 #undeà
__USE_XOPEN2K8


111 #undeà
__USE_XOPEN2K8XSI


112 #undeà
__USE_LARGEFILE


113 #undeà
__USE_LARGEFILE64


114 #undeà
__USE_FILE_OFFSET64


115 #undeà
__USE_MISC


116 #undeà
__USE_ATFILE


117 #undeà
__USE_GNU


118 #undeà
__USE_REENTRANT


119 #undeà
__USE_FORTIFY_LEVEL


120 #undeà
__KERNEL_STRICT_NAMES


124 #iâdeà
_LOOSE_KERNEL_NAMES


125 
	#__KERNEL_STRICT_NAMES


	)

135 #ià
defšed
 
__GNUC__
 && defšed 
__GNUC_MINOR__


136 
	#__GNUC_PREREQ
(
maj
, 
mš
) \

137 ((
__GNUC__
 << 16è+ 
__GNUC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

139 
	#__GNUC_PREREQ
(
maj
, 
mš
è0

	)

146 #ià(
defšed
 
_BSD_SOURCE
 || defšed 
_SVID_SOURCE
) \

147 && !
defšed
 
	g_DEFAULT_SOURCE


149 #undeà
_DEFAULT_SOURCE


150 
	#_DEFAULT_SOURCE
 1

	)

154 #ifdeà
_GNU_SOURCE


155 #undeà
_ISOC95_SOURCE


156 
	#_ISOC95_SOURCE
 1

	)

157 #undeà
_ISOC99_SOURCE


158 
	#_ISOC99_SOURCE
 1

	)

159 #undeà
_ISOC11_SOURCE


160 
	#_ISOC11_SOURCE
 1

	)

161 #undeà
_POSIX_SOURCE


162 
	#_POSIX_SOURCE
 1

	)

163 #undeà
_POSIX_C_SOURCE


164 
	#_POSIX_C_SOURCE
 200809L

	)

165 #undeà
_XOPEN_SOURCE


166 
	#_XOPEN_SOURCE
 700

	)

167 #undeà
_XOPEN_SOURCE_EXTENDED


168 
	#_XOPEN_SOURCE_EXTENDED
 1

	)

169 #undeà
_LARGEFILE64_SOURCE


170 
	#_LARGEFILE64_SOURCE
 1

	)

171 #undeà
_DEFAULT_SOURCE


172 
	#_DEFAULT_SOURCE
 1

	)

173 #undeà
_ATFILE_SOURCE


174 
	#_ATFILE_SOURCE
 1

	)

179 #ià(
defšed
 
_DEFAULT_SOURCE
 \

180 || (!
defšed
 
	g__STRICT_ANSI__
 \

181 && !
defšed
 
	g_ISOC99_SOURCE
 \

182 && !
defšed
 
	g_POSIX_SOURCE
 && !defšed 
	g_POSIX_C_SOURCE
 \

183 && !
defšed
 
	g_XOPEN_SOURCE
))

184 #undeà
_DEFAULT_SOURCE


185 
	#_DEFAULT_SOURCE
 1

	)

189 #ià(
defšed
 
_ISOC11_SOURCE
 \

190 || (
defšed
 
	g__STDC_VERSION__
 && __STDC_VERSION__ >= 201112L))

191 
	#__USE_ISOC11
 1

	)

195 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

196 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L))

197 
	#__USE_ISOC99
 1

	)

201 #ià(
defšed
 
_ISOC99_SOURCE
 || defšed 
_ISOC11_SOURCE
 \

202 || (
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199409L))

203 
	#__USE_ISOC95
 1

	)

210 #ià((
defšed
 
__ılu¥lus
 && __cplusplus >= 201103L) \

211 || 
defšed
 
__GXX_EXPERIMENTAL_CXX0X__
)

212 
	#__USE_ISOCXX11
 1

	)

218 #ifdeà
_DEFAULT_SOURCE


219 #ià!
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE


220 
	#__USE_POSIX_IMPLICITLY
 1

	)

222 #undeà
_POSIX_SOURCE


223 
	#_POSIX_SOURCE
 1

	)

224 #undeà
_POSIX_C_SOURCE


225 
	#_POSIX_C_SOURCE
 200809L

	)

227 #ià((!
defšed
 
__STRICT_ANSI__
 \

228 || (
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) >= 500)) \

229 && !
defšed
 
_POSIX_SOURCE
 && !defšed 
_POSIX_C_SOURCE
)

230 
	#_POSIX_SOURCE
 1

	)

231 #ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 500

232 
	#_POSIX_C_SOURCE
 2

	)

233 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 600

234 
	#_POSIX_C_SOURCE
 199506L

	)

235 #–ià
defšed
 
_XOPEN_SOURCE
 && (_XOPEN_SOURCE - 0) < 700

236 
	#_POSIX_C_SOURCE
 200112L

	)

238 
	#_POSIX_C_SOURCE
 200809L

	)

240 
	#__USE_POSIX_IMPLICITLY
 1

	)

243 #ià(
defšed
 
_POSIX_SOURCE
 \

244 || (
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >= 1) \

245 || 
defšed
 
_XOPEN_SOURCE
)

246 
	#__USE_POSIX
 1

	)

249 #ià
defšed
 
_POSIX_C_SOURCE
 && _POSIX_C_SOURCE >ğ2 || defšed 
_XOPEN_SOURCE


250 
	#__USE_POSIX2
 1

	)

253 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199309L

254 
	#__USE_POSIX199309
 1

	)

257 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 199506L

258 
	#__USE_POSIX199506
 1

	)

261 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200112L

262 
	#__USE_XOPEN2K
 1

	)

263 #undeà
__USE_ISOC95


264 
	#__USE_ISOC95
 1

	)

265 #undeà
__USE_ISOC99


266 
	#__USE_ISOC99
 1

	)

269 #ià
defšed
 
_POSIX_C_SOURCE
 && (_POSIX_C_SOURCE - 0) >= 200809L

270 
	#__USE_XOPEN2K8
 1

	)

271 #undeà
_ATFILE_SOURCE


272 
	#_ATFILE_SOURCE
 1

	)

275 #ifdef 
_XOPEN_SOURCE


276 
	#__USE_XOPEN
 1

	)

277 #ià(
_XOPEN_SOURCE
 - 0) >= 500

278 
	#__USE_XOPEN_EXTENDED
 1

	)

279 
	#__USE_UNIX98
 1

	)

280 #undeà
_LARGEFILE_SOURCE


281 
	#_LARGEFILE_SOURCE
 1

	)

282 #ià(
_XOPEN_SOURCE
 - 0) >= 600

283 #ià(
_XOPEN_SOURCE
 - 0) >= 700

284 
	#__USE_XOPEN2K8
 1

	)

285 
	#__USE_XOPEN2K8XSI
 1

	)

287 
	#__USE_XOPEN2K
 1

	)

288 
	#__USE_XOPEN2KXSI
 1

	)

289 #undeà
__USE_ISOC95


290 
	#__USE_ISOC95
 1

	)

291 #undeà
__USE_ISOC99


292 
	#__USE_ISOC99
 1

	)

295 #ifdeà
_XOPEN_SOURCE_EXTENDED


296 
	#__USE_XOPEN_EXTENDED
 1

	)

301 #ifdeà
_LARGEFILE_SOURCE


302 
	#__USE_LARGEFILE
 1

	)

305 #ifdeà
_LARGEFILE64_SOURCE


306 
	#__USE_LARGEFILE64
 1

	)

309 #ià
defšed
 
_FILE_OFFSET_BITS
 && _FILE_OFFSET_BITS == 64

310 
	#__USE_FILE_OFFSET64
 1

	)

313 #ià
defšed
 
_DEFAULT_SOURCE


314 
	#__USE_MISC
 1

	)

317 #ifdef 
_ATFILE_SOURCE


318 
	#__USE_ATFILE
 1

	)

321 #ifdef 
_GNU_SOURCE


322 
	#__USE_GNU
 1

	)

325 #ià
defšed
 
_REENTRANT
 || defšed 
_THREAD_SAFE


326 
	#__USE_REENTRANT
 1

	)

329 #ià
defšed
 
_FORTIFY_SOURCE
 && _FORTIFY_SOURCE > 0

330 #ià!
defšed
 
__OPTIMIZE__
 || __OPTIMIZE__ <= 0

331 #w¬nšg 
_FORTIFY_SOURCE
 
»quœes
 
compšg
 
w™h
 
İtimiz©iÚ
 (-
O
)

332 #–ià!
__GNUC_PREREQ
 (4, 1)

333 #w¬nšg 
_FORTIFY_SOURCE
 
»quœes
 
GCC
 4.1 
Ü
 
Ï‹r


334 #–ià
_FORTIFY_SOURCE
 > 1

335 
	#__USE_FORTIFY_LEVEL
 2

	)

337 
	#__USE_FORTIFY_LEVEL
 1

	)

340 #iâdeà
__USE_FORTIFY_LEVEL


341 
	#__USE_FORTIFY_LEVEL
 0

	)

346 
	~<¡dc-´edef.h
>

354 #undeà
__GNU_LIBRARY__


355 
	#__GNU_LIBRARY__
 6

	)

359 
	#__GLIBC__
 2

	)

360 
	#__GLIBC_MINOR__
 23

	)

362 
	#__GLIBC_PREREQ
(
maj
, 
mš
) \

363 ((
__GLIBC__
 << 16è+ 
__GLIBC_MINOR__
 >ğ((
maj
è<< 16è+ (
mš
))

	)

366 #iâdeà
__ASSEMBLER__


367 #iâdeà
_SYS_CDEFS_H


368 
	~<sys/cdefs.h
>

373 #ià
defšed
 
__USE_FILE_OFFSET64
 && !defšed 
__REDIRECT


374 
	#__USE_LARGEFILE
 1

	)

375 
	#__USE_LARGEFILE64
 1

	)

381 #ià
__GNUC_PREREQ
 (2, 7è&& 
defšed
 
__OPTIMIZE__
 \

382 && !
defšed
 
	g__OPTIMIZE_SIZE__
 && !defšed 
	g__NO_INLINE__
 \

383 && 
defšed
 
	g__ex‹º_šlše


384 
	#__USE_EXTERN_INLINES
 1

	)

392 
	~<gnu/¡ubs.h
>

	@/usr/include/linux/hdlc/ioctl.h

1 #iâdeà
__HDLC_IOCTL_H__


2 
	#__HDLC_IOCTL_H__


	)

5 
	#GENERIC_HDLC_VERSION
 4

	)

7 
	#CLOCK_DEFAULT
 0

	)

8 
	#CLOCK_EXT
 1

	)

9 
	#CLOCK_INT
 2

	)

10 
	#CLOCK_TXINT
 3

	)

11 
	#CLOCK_TXFROMRX
 4

	)

14 
	#ENCODING_DEFAULT
 0

	)

15 
	#ENCODING_NRZ
 1

	)

16 
	#ENCODING_NRZI
 2

	)

17 
	#ENCODING_FM_MARK
 3

	)

18 
	#ENCODING_FM_SPACE
 4

	)

19 
	#ENCODING_MANCHESTER
 5

	)

22 
	#PARITY_DEFAULT
 0

	)

23 
	#PARITY_NONE
 1

	)

24 
	#PARITY_CRC16_PR0
 2

	)

25 
	#PARITY_CRC16_PR1
 3

	)

26 
	#PARITY_CRC16_PR0_CCITT
 4

	)

27 
	#PARITY_CRC16_PR1_CCITT
 5

	)

28 
	#PARITY_CRC32_PR0_CCITT
 6

	)

29 
	#PARITY_CRC32_PR1_CCITT
 7

	)

31 
	#LMI_DEFAULT
 0

	)

32 
	#LMI_NONE
 1

	)

33 
	#LMI_ANSI
 2

	)

34 
	#LMI_CCITT
 3

	)

35 
	#LMI_CISCO
 4

	)

37 #iâdeà
__ASSEMBLY__


40 
	mşock_¿‹
;

41 
	mşock_ty³
;

42 
	mloİback
;

43 } 
	tsync_£rŸl_£‰šgs
;

46 
	mşock_¿‹
;

47 
	mşock_ty³
;

48 
	mloİback
;

49 
	m¦Ù_m­
;

50 } 
	t‹1_£‰šgs
;

53 
	m’codšg
;

54 
	m·r™y
;

55 } 
	t¿w_hdlc_´Ùo
;

58 
	mt391
;

59 
	mt392
;

60 
	mn391
;

61 
	mn392
;

62 
	mn393
;

63 
	mlmi
;

64 
	mdû
;

65 } 
	tä_´Ùo
;

68 
	mdlci
;

69 } 
	tä_´Ùo_pvc
;

72 
	mdlci
;

73 
	mma¡”
[
IFNAMSIZ
];

74 }
	tä_´Ùo_pvc_šfo
;

77 
	mš‹rv®
;

78 
	mtimeout
;

79 } 
	tcisco_´Ùo
;

	@/usr/include/linux/libc-compat.h

48 #iâdeà
_LIBC_COMPAT_H


49 
	#_LIBC_COMPAT_H


	)

52 #ià
defšed
(
__GLIBC__
)

55 #ià
defšed
(
_NET_IF_H
è&& defšed(
__USE_MISC
)

60 
	#__UAPI_DEF_IF_IFCONF
 0

	)

61 
	#__UAPI_DEF_IF_IFMAP
 0

	)

62 
	#__UAPI_DEF_IF_IFNAMSIZ
 0

	)

63 
	#__UAPI_DEF_IF_IFREQ
 0

	)

65 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 0

	)

67 #iâdeà
__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO


68 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

77 
	#__UAPI_DEF_IF_IFCONF
 1

	)

78 
	#__UAPI_DEF_IF_IFMAP
 1

	)

79 
	#__UAPI_DEF_IF_IFNAMSIZ
 1

	)

80 
	#__UAPI_DEF_IF_IFREQ
 1

	)

82 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 1

	)

84 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

89 #ià
defšed
(
_NETINET_IN_H
)

93 
	#__UAPI_DEF_IN_ADDR
 0

	)

94 
	#__UAPI_DEF_IN_IPPROTO
 0

	)

95 
	#__UAPI_DEF_IN_PKTINFO
 0

	)

96 
	#__UAPI_DEF_IP_MREQ
 0

	)

97 
	#__UAPI_DEF_SOCKADDR_IN
 0

	)

98 
	#__UAPI_DEF_IN_CLASS
 0

	)

100 
	#__UAPI_DEF_IN6_ADDR
 0

	)

105 #ià
defšed
(
__USE_MISC
è|| defšed (
__USE_GNU
)

106 
	#__UAPI_DEF_IN6_ADDR_ALT
 0

	)

108 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

110 
	#__UAPI_DEF_SOCKADDR_IN6
 0

	)

111 
	#__UAPI_DEF_IPV6_MREQ
 0

	)

112 
	#__UAPI_DEF_IPPROTO_V6
 0

	)

113 
	#__UAPI_DEF_IPV6_OPTIONS
 0

	)

114 
	#__UAPI_DEF_IN6_PKTINFO
 0

	)

115 
	#__UAPI_DEF_IP6_MTUINFO
 0

	)

122 
	#__UAPI_DEF_IN_ADDR
 1

	)

123 
	#__UAPI_DEF_IN_IPPROTO
 1

	)

124 
	#__UAPI_DEF_IN_PKTINFO
 1

	)

125 
	#__UAPI_DEF_IP_MREQ
 1

	)

126 
	#__UAPI_DEF_SOCKADDR_IN
 1

	)

127 
	#__UAPI_DEF_IN_CLASS
 1

	)

129 
	#__UAPI_DEF_IN6_ADDR
 1

	)

132 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

133 
	#__UAPI_DEF_SOCKADDR_IN6
 1

	)

134 
	#__UAPI_DEF_IPV6_MREQ
 1

	)

135 
	#__UAPI_DEF_IPPROTO_V6
 1

	)

136 
	#__UAPI_DEF_IPV6_OPTIONS
 1

	)

137 
	#__UAPI_DEF_IN6_PKTINFO
 1

	)

138 
	#__UAPI_DEF_IP6_MTUINFO
 1

	)

143 #ià
defšed
(
__NETIPX_IPX_H
)

145 
	#__UAPI_DEF_SOCKADDR_IPX
 0

	)

146 
	#__UAPI_DEF_IPX_ROUTE_DEFINITION
 0

	)

147 
	#__UAPI_DEF_IPX_INTERFACE_DEFINITION
 0

	)

148 
	#__UAPI_DEF_IPX_CONFIG_DATA
 0

	)

149 
	#__UAPI_DEF_IPX_ROUTE_DEF
 0

	)

153 
	#__UAPI_DEF_SOCKADDR_IPX
 1

	)

154 
	#__UAPI_DEF_IPX_ROUTE_DEFINITION
 1

	)

155 
	#__UAPI_DEF_IPX_INTERFACE_DEFINITION
 1

	)

156 
	#__UAPI_DEF_IPX_CONFIG_DATA
 1

	)

157 
	#__UAPI_DEF_IPX_ROUTE_DEF
 1

	)

162 #ià
defšed
(
_SYS_XATTR_H
)

163 
	#__UAPI_DEF_XATTR
 0

	)

165 
	#__UAPI_DEF_XATTR
 1

	)

174 
	#__UAPI_DEF_IF_IFCONF
 1

	)

175 
	#__UAPI_DEF_IF_IFMAP
 1

	)

176 
	#__UAPI_DEF_IF_IFNAMSIZ
 1

	)

177 
	#__UAPI_DEF_IF_IFREQ
 1

	)

179 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS
 1

	)

181 
	#__UAPI_DEF_IF_NET_DEVICE_FLAGS_LOWER_UP_DORMANT_ECHO
 1

	)

184 
	#__UAPI_DEF_IN_ADDR
 1

	)

185 
	#__UAPI_DEF_IN_IPPROTO
 1

	)

186 
	#__UAPI_DEF_IN_PKTINFO
 1

	)

187 
	#__UAPI_DEF_IP_MREQ
 1

	)

188 
	#__UAPI_DEF_SOCKADDR_IN
 1

	)

189 
	#__UAPI_DEF_IN_CLASS
 1

	)

192 
	#__UAPI_DEF_IN6_ADDR
 1

	)

193 
	#__UAPI_DEF_IN6_ADDR_ALT
 1

	)

194 
	#__UAPI_DEF_SOCKADDR_IN6
 1

	)

195 
	#__UAPI_DEF_IPV6_MREQ
 1

	)

196 
	#__UAPI_DEF_IPPROTO_V6
 1

	)

197 
	#__UAPI_DEF_IPV6_OPTIONS
 1

	)

198 
	#__UAPI_DEF_IN6_PKTINFO
 1

	)

199 
	#__UAPI_DEF_IP6_MTUINFO
 1

	)

202 
	#__UAPI_DEF_SOCKADDR_IPX
 1

	)

203 
	#__UAPI_DEF_IPX_ROUTE_DEFINITION
 1

	)

204 
	#__UAPI_DEF_IPX_INTERFACE_DEFINITION
 1

	)

205 
	#__UAPI_DEF_IPX_CONFIG_DATA
 1

	)

206 
	#__UAPI_DEF_IPX_ROUTE_DEF
 1

	)

209 
	#__UAPI_DEF_XATTR
 1

	)

	@/usr/include/linux/posix_types.h

1 #iâdeà
_LINUX_POSIX_TYPES_H


2 
	#_LINUX_POSIX_TYPES_H


	)

4 
	~<lšux/¡ddef.h
>

21 #undeà
__FD_SETSIZE


22 
	#__FD_SETSIZE
 1024

	)

25 
	mfds_b™s
[
__FD_SETSIZE
 / (8 * ())];

26 } 
	t__k”Ãl_fd_£t
;

29 (*
	t__k”Ãl_sighªdËr_t
)();

32 
	t__k”Ãl_key_t
;

33 
	t__k”Ãl_mqd_t
;

35 
	~<asm/posix_ty³s.h
>

	@/usr/include/asm-generic/fcntl.h

1 #iâdeà
_ASM_GENERIC_FCNTL_H


2 
	#_ASM_GENERIC_FCNTL_H


	)

4 
	~<lšux/ty³s.h
>

18 
	#O_ACCMODE
 00000003

	)

19 
	#O_RDONLY
 00000000

	)

20 
	#O_WRONLY
 00000001

	)

21 
	#O_RDWR
 00000002

	)

22 #iâdeà
O_CREAT


23 
	#O_CREAT
 00000100

	)

25 #iâdeà
O_EXCL


26 
	#O_EXCL
 00000200

	)

28 #iâdeà
O_NOCTTY


29 
	#O_NOCTTY
 00000400

	)

31 #iâdeà
O_TRUNC


32 
	#O_TRUNC
 00001000

	)

34 #iâdeà
O_APPEND


35 
	#O_APPEND
 00002000

	)

37 #iâdeà
O_NONBLOCK


38 
	#O_NONBLOCK
 00004000

	)

40 #iâdeà
O_DSYNC


41 
	#O_DSYNC
 00010000

	)

43 #iâdeà
FASYNC


44 
	#FASYNC
 00020000

	)

46 #iâdeà
O_DIRECT


47 
	#O_DIRECT
 00040000

	)

49 #iâdeà
O_LARGEFILE


50 
	#O_LARGEFILE
 00100000

	)

52 #iâdeà
O_DIRECTORY


53 
	#O_DIRECTORY
 00200000

	)

55 #iâdeà
O_NOFOLLOW


56 
	#O_NOFOLLOW
 00400000

	)

58 #iâdeà
O_NOATIME


59 
	#O_NOATIME
 01000000

	)

61 #iâdeà
O_CLOEXEC


62 
	#O_CLOEXEC
 02000000

	)

78 #iâdeà
O_SYNC


79 
	#__O_SYNC
 04000000

	)

80 
	#O_SYNC
 (
__O_SYNC
|
O_DSYNC
)

	)

83 #iâdeà
O_PATH


84 
	#O_PATH
 010000000

	)

87 #iâdeà
__O_TMPFILE


88 
	#__O_TMPFILE
 020000000

	)

92 
	#O_TMPFILE
 (
__O_TMPFILE
 | 
O_DIRECTORY
)

	)

93 
	#O_TMPFILE_MASK
 (
__O_TMPFILE
 | 
O_DIRECTORY
 | 
O_CREAT
)

	)

95 #iâdeà
O_NDELAY


96 
	#O_NDELAY
 
O_NONBLOCK


	)

99 
	#F_DUPFD
 0

	)

100 
	#F_GETFD
 1

	)

101 
	#F_SETFD
 2

	)

102 
	#F_GETFL
 3

	)

103 
	#F_SETFL
 4

	)

104 #iâdeà
F_GETLK


105 
	#F_GETLK
 5

	)

106 
	#F_SETLK
 6

	)

107 
	#F_SETLKW
 7

	)

109 #iâdeà
F_SETOWN


110 
	#F_SETOWN
 8

	)

111 
	#F_GETOWN
 9

	)

113 #iâdeà
F_SETSIG


114 
	#F_SETSIG
 10

	)

115 
	#F_GETSIG
 11

	)

118 #iâdeà
CONFIG_64BIT


119 #iâdeà
F_GETLK64


120 
	#F_GETLK64
 12

	)

121 
	#F_SETLK64
 13

	)

122 
	#F_SETLKW64
 14

	)

126 #iâdeà
F_SETOWN_EX


127 
	#F_SETOWN_EX
 15

	)

128 
	#F_GETOWN_EX
 16

	)

131 #iâdeà
F_GETOWNER_UIDS


132 
	#F_GETOWNER_UIDS
 17

	)

147 
	#F_OFD_GETLK
 36

	)

148 
	#F_OFD_SETLK
 37

	)

149 
	#F_OFD_SETLKW
 38

	)

151 
	#F_OWNER_TID
 0

	)

152 
	#F_OWNER_PID
 1

	)

153 
	#F_OWNER_PGRP
 2

	)

155 
	sf_owÃr_ex
 {

156 
	mty³
;

157 
__k”Ãl_pid_t
 
	mpid
;

161 
	#FD_CLOEXEC
 1

	)

164 #iâdeà
F_RDLCK


165 
	#F_RDLCK
 0

	)

166 
	#F_WRLCK
 1

	)

167 
	#F_UNLCK
 2

	)

171 #iâdeà
F_EXLCK


172 
	#F_EXLCK
 4

	)

173 
	#F_SHLCK
 8

	)

177 
	#LOCK_SH
 1

	)

178 
	#LOCK_EX
 2

	)

179 
	#LOCK_NB
 4

	)

181 
	#LOCK_UN
 8

	)

183 
	#LOCK_MAND
 32

	)

184 
	#LOCK_READ
 64

	)

185 
	#LOCK_WRITE
 128

	)

186 
	#LOCK_RW
 192

	)

188 
	#F_LINUX_SPECIFIC_BASE
 1024

	)

190 #iâdeà
HAVE_ARCH_STRUCT_FLOCK


191 #iâdeà
__ARCH_FLOCK_PAD


192 
	#__ARCH_FLOCK_PAD


	)

195 
	sæock
 {

196 
	ml_ty³
;

197 
	ml_wh’û
;

198 
__k”Ãl_off_t
 
	ml_¡¬t
;

199 
__k”Ãl_off_t
 
	ml_Ën
;

200 
__k”Ãl_pid_t
 
	ml_pid
;

201 
	m__ARCH_FLOCK_PAD


205 #iâdeà
HAVE_ARCH_STRUCT_FLOCK64


206 #iâdeà
__ARCH_FLOCK64_PAD


207 
	#__ARCH_FLOCK64_PAD


	)

210 
	sæock64
 {

211 
	ml_ty³
;

212 
	ml_wh’û
;

213 
__k”Ãl_loff_t
 
	ml_¡¬t
;

214 
__k”Ãl_loff_t
 
	ml_Ën
;

215 
__k”Ãl_pid_t
 
	ml_pid
;

216 
	m__ARCH_FLOCK64_PAD


	@/usr/include/asm-generic/ioctl.h

1 #iâdeà
_ASM_GENERIC_IOCTL_H


2 
	#_ASM_GENERIC_IOCTL_H


	)

22 
	#_IOC_NRBITS
 8

	)

23 
	#_IOC_TYPEBITS
 8

	)

30 #iâdeà
_IOC_SIZEBITS


31 
	#_IOC_SIZEBITS
 14

	)

34 #iâdeà
_IOC_DIRBITS


35 
	#_IOC_DIRBITS
 2

	)

38 
	#_IOC_NRMASK
 ((1 << 
_IOC_NRBITS
)-1)

	)

39 
	#_IOC_TYPEMASK
 ((1 << 
_IOC_TYPEBITS
)-1)

	)

40 
	#_IOC_SIZEMASK
 ((1 << 
_IOC_SIZEBITS
)-1)

	)

41 
	#_IOC_DIRMASK
 ((1 << 
_IOC_DIRBITS
)-1)

	)

43 
	#_IOC_NRSHIFT
 0

	)

44 
	#_IOC_TYPESHIFT
 (
_IOC_NRSHIFT
+
_IOC_NRBITS
)

	)

45 
	#_IOC_SIZESHIFT
 (
_IOC_TYPESHIFT
+
_IOC_TYPEBITS
)

	)

46 
	#_IOC_DIRSHIFT
 (
_IOC_SIZESHIFT
+
_IOC_SIZEBITS
)

	)

53 #iâdeà
_IOC_NONE


54 
	#_IOC_NONE
 0U

	)

57 #iâdeà
_IOC_WRITE


58 
	#_IOC_WRITE
 1U

	)

61 #iâdeà
_IOC_READ


62 
	#_IOC_READ
 2U

	)

65 
	#_IOC
(
dœ
,
ty³
,
Ä
,
size
) \

66 (((
dœ
è<< 
_IOC_DIRSHIFT
) | \

67 ((
ty³
è<< 
_IOC_TYPESHIFT
) | \

68 ((
Ä
è<< 
_IOC_NRSHIFT
) | \

69 ((
size
è<< 
_IOC_SIZESHIFT
))

	)

71 
	#_IOC_TYPECHECK
(
t
è(Ñ))

	)

74 
	#_IO
(
ty³
,
Ä
è
	`_IOC
(
_IOC_NONE
,Ñy³),Òr),0)

	)

75 
	#_IOR
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

76 
	#_IOW
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_WRITE
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

77 
	#_IOWR
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,Ñy³),Òr),(
	`_IOC_TYPECHECK
(size)))

	)

78 
	#_IOR_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
,Ñy³),Òr),(size))

	)

79 
	#_IOW_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_WRITE
,Ñy³),Òr),(size))

	)

80 
	#_IOWR_BAD
(
ty³
,
Ä
,
size
è
	`_IOC
(
_IOC_READ
|
_IOC_WRITE
,Ñy³),Òr),(size))

	)

83 
	#_IOC_DIR
(
Ä
è((Òrè>> 
_IOC_DIRSHIFT
è& 
_IOC_DIRMASK
)

	)

84 
	#_IOC_TYPE
(
Ä
è((Òrè>> 
_IOC_TYPESHIFT
è& 
_IOC_TYPEMASK
)

	)

85 
	#_IOC_NR
(
Ä
è((Òrè>> 
_IOC_NRSHIFT
è& 
_IOC_NRMASK
)

	)

86 
	#_IOC_SIZE
(
Ä
è((Òrè>> 
_IOC_SIZESHIFT
è& 
_IOC_SIZEMASK
)

	)

90 
	#IOC_IN
 (
_IOC_WRITE
 << 
_IOC_DIRSHIFT
)

	)

91 
	#IOC_OUT
 (
_IOC_READ
 << 
_IOC_DIRSHIFT
)

	)

92 
	#IOC_INOUT
 ((
_IOC_WRITE
|
_IOC_READ
è<< 
_IOC_DIRSHIFT
)

	)

93 
	#IOCSIZE_MASK
 (
_IOC_SIZEMASK
 << 
_IOC_SIZESHIFT
)

	)

94 
	#IOCSIZE_SHIFT
 (
_IOC_SIZESHIFT
)

	)

	@/usr/include/asm-generic/types.h

1 #iâdeà
_ASM_GENERIC_TYPES_H


2 
	#_ASM_GENERIC_TYPES_H


	)

6 
	~<asm-g’”ic/št-Î64.h
>

	@/usr/include/asm/posix_types.h

1 #ifdeà
__i386__


2 
	~<asm/posix_ty³s_32.h
>

3 #–ià
defšed
(
__ILP32__
)

4 
	~<asm/posix_ty³s_x32.h
>

6 
	~<asm/posix_ty³s_64.h
>

	@/usr/include/bits/local_lim.h

24 #iâdeà
NR_OPEN


25 
	#__undef_NR_OPEN


	)

27 #iâdeà
LINK_MAX


28 
	#__undef_LINK_MAX


	)

30 #iâdeà
OPEN_MAX


31 
	#__undef_OPEN_MAX


	)

33 #iâdeà
ARG_MAX


34 
	#__undef_ARG_MAX


	)

38 
	~<lšux/lim™s.h
>

41 #ifdeà
__undef_NR_OPEN


42 #undeà
NR_OPEN


43 #undeà
__undef_NR_OPEN


46 #ifdeà
__undef_LINK_MAX


47 #undeà
LINK_MAX


48 #undeà
__undef_LINK_MAX


51 #ifdeà
__undef_OPEN_MAX


52 #undeà
OPEN_MAX


53 #undeà
__undef_OPEN_MAX


56 #ifdeà
__undef_ARG_MAX


57 #undeà
ARG_MAX


58 #undeà
__undef_ARG_MAX


62 
	#_POSIX_THREAD_KEYS_MAX
 128

	)

64 
	#PTHREAD_KEYS_MAX
 1024

	)

67 
	#_POSIX_THREAD_DESTRUCTOR_ITERATIONS
 4

	)

69 
	#PTHREAD_DESTRUCTOR_ITERATIONS
 
_POSIX_THREAD_DESTRUCTOR_ITERATIONS


	)

72 
	#_POSIX_THREAD_THREADS_MAX
 64

	)

74 #undeà
PTHREAD_THREADS_MAX


78 
	#AIO_PRIO_DELTA_MAX
 20

	)

81 
	#PTHREAD_STACK_MIN
 16384

	)

84 
	#DELAYTIMER_MAX
 2147483647

	)

87 
	#TTY_NAME_MAX
 32

	)

90 
	#LOGIN_NAME_MAX
 256

	)

93 
	#HOST_NAME_MAX
 64

	)

96 
	#MQ_PRIO_MAX
 32768

	)

99 
	#SEM_VALUE_MAX
 (2147483647)

	)

	@/usr/include/bits/stdio_lim.h

18 #ià!
defšed
 
_STDIO_H
 && !defšed 
__Ãed_FOPEN_MAX
 && !defšed 
__Ãed_IOV_MAX


22 #ifdeà
_STDIO_H


23 
	#L_tm²am
 20

	)

24 
	#TMP_MAX
 238328

	)

25 
	#FILENAME_MAX
 4096

	)

27 #ifdeà
__USE_POSIX


28 
	#L_ù”mid
 9

	)

29 #ià!
defšed
 
__USE_XOPEN2K
 || defšed 
__USE_GNU


30 
	#L_cu£rid
 9

	)

35 #ià
defšed
 
__Ãed_FOPEN_MAX
 || defšed 
_STDIO_H


36 #undeà
FOPEN_MAX


37 
	#FOPEN_MAX
 16

	)

40 #ià
defšed
 
__Ãed_IOV_MAX
 && !defšed 
IOV_MAX


41 
	#IOV_MAX
 1024

	)

	@/usr/include/gnu/stubs.h

6 #ià!
defšed
 
__x86_64__


7 
	~<gnu/¡ubs-32.h
>

9 #ià
defšed
 
__x86_64__
 && defšed 
__LP64__


10 
	~<gnu/¡ubs-64.h
>

12 #ià
defšed
 
__x86_64__
 && defšed 
__ILP32__


13 
	~<gnu/¡ubs-x32.h
>

	@/usr/include/linux/byteorder/little_endian.h

1 #iâdeà
_LINUX_BYTEORDER_LITTLE_ENDIAN_H


2 
	#_LINUX_BYTEORDER_LITTLE_ENDIAN_H


	)

4 #iâdeà
__LITTLE_ENDIAN


5 
	#__LITTLE_ENDIAN
 1234

	)

7 #iâdeà
__LITTLE_ENDIAN_BITFIELD


8 
	#__LITTLE_ENDIAN_BITFIELD


	)

11 
	~<lšux/ty³s.h
>

12 
	~<lšux/swab.h
>

14 
	#__cÚ¡ªt_htÚl
(
x
è((
__be32
)
	`___cÚ¡ªt_swab32
((x)))

	)

15 
	#__cÚ¡ªt_Áohl
(
x
è
	`___cÚ¡ªt_swab32
((
__be32
)(x))

	)

16 
	#__cÚ¡ªt_htÚs
(
x
è((
__be16
)
	`___cÚ¡ªt_swab16
((x)))

	)

17 
	#__cÚ¡ªt_Áohs
(
x
è
	`___cÚ¡ªt_swab16
((
__be16
)(x))

	)

18 
	#__cÚ¡ªt_ıu_to_Ë64
(
x
è((
__Ë64
)(
__u64
)(x))

	)

19 
	#__cÚ¡ªt_Ë64_to_ıu
(
x
è((
__u64
)(
__Ë64
)(x))

	)

20 
	#__cÚ¡ªt_ıu_to_Ë32
(
x
è((
__Ë32
)(
__u32
)(x))

	)

21 
	#__cÚ¡ªt_Ë32_to_ıu
(
x
è((
__u32
)(
__Ë32
)(x))

	)

22 
	#__cÚ¡ªt_ıu_to_Ë16
(
x
è((
__Ë16
)(
__u16
)(x))

	)

23 
	#__cÚ¡ªt_Ë16_to_ıu
(
x
è((
__u16
)(
__Ë16
)(x))

	)

24 
	#__cÚ¡ªt_ıu_to_be64
(
x
è((
__be64
)
	`___cÚ¡ªt_swab64
((x)))

	)

25 
	#__cÚ¡ªt_be64_to_ıu
(
x
è
	`___cÚ¡ªt_swab64
((
__u64
)(
__be64
)(x))

	)

26 
	#__cÚ¡ªt_ıu_to_be32
(
x
è((
__be32
)
	`___cÚ¡ªt_swab32
((x)))

	)

27 
	#__cÚ¡ªt_be32_to_ıu
(
x
è
	`___cÚ¡ªt_swab32
((
__u32
)(
__be32
)(x))

	)

28 
	#__cÚ¡ªt_ıu_to_be16
(
x
è((
__be16
)
	`___cÚ¡ªt_swab16
((x)))

	)

29 
	#__cÚ¡ªt_be16_to_ıu
(
x
è
	`___cÚ¡ªt_swab16
((
__u16
)(
__be16
)(x))

	)

30 
	#__ıu_to_Ë64
(
x
è((
__Ë64
)(
__u64
)(x))

	)

31 
	#__Ë64_to_ıu
(
x
è((
__u64
)(
__Ë64
)(x))

	)

32 
	#__ıu_to_Ë32
(
x
è((
__Ë32
)(
__u32
)(x))

	)

33 
	#__Ë32_to_ıu
(
x
è((
__u32
)(
__Ë32
)(x))

	)

34 
	#__ıu_to_Ë16
(
x
è((
__Ë16
)(
__u16
)(x))

	)

35 
	#__Ë16_to_ıu
(
x
è((
__u16
)(
__Ë16
)(x))

	)

36 
	#__ıu_to_be64
(
x
è((
__be64
)
	`__swab64
((x)))

	)

37 
	#__be64_to_ıu
(
x
è
	`__swab64
((
__u64
)(
__be64
)(x))

	)

38 
	#__ıu_to_be32
(
x
è((
__be32
)
	`__swab32
((x)))

	)

39 
	#__be32_to_ıu
(
x
è
	`__swab32
((
__u32
)(
__be32
)(x))

	)

40 
	#__ıu_to_be16
(
x
è((
__be16
)
	`__swab16
((x)))

	)

41 
	#__be16_to_ıu
(
x
è
	`__swab16
((
__u16
)(
__be16
)(x))

	)

43 
__®ways_šlše
 
__Ë64
 
	$__ıu_to_Ë64p
(cÚ¡ 
__u64
 *
p
)

45  (
__Ë64
)*
p
;

46 
	}
}

47 
__®ways_šlše
 
__u64
 
	$__Ë64_to_ıup
(cÚ¡ 
__Ë64
 *
p
)

49  (
__u64
)*
p
;

50 
	}
}

51 
__®ways_šlše
 
__Ë32
 
	$__ıu_to_Ë32p
(cÚ¡ 
__u32
 *
p
)

53  (
__Ë32
)*
p
;

54 
	}
}

55 
__®ways_šlše
 
__u32
 
	$__Ë32_to_ıup
(cÚ¡ 
__Ë32
 *
p
)

57  (
__u32
)*
p
;

58 
	}
}

59 
__®ways_šlše
 
__Ë16
 
	$__ıu_to_Ë16p
(cÚ¡ 
__u16
 *
p
)

61  (
__Ë16
)*
p
;

62 
	}
}

63 
__®ways_šlše
 
__u16
 
	$__Ë16_to_ıup
(cÚ¡ 
__Ë16
 *
p
)

65  (
__u16
)*
p
;

66 
	}
}

67 
__®ways_šlše
 
__be64
 
	$__ıu_to_be64p
(cÚ¡ 
__u64
 *
p
)

69  (
__be64
)
	`__swab64p
(
p
);

70 
	}
}

71 
__®ways_šlše
 
__u64
 
	$__be64_to_ıup
(cÚ¡ 
__be64
 *
p
)

73  
	`__swab64p
((
__u64
 *)
p
);

74 
	}
}

75 
__®ways_šlše
 
__be32
 
	$__ıu_to_be32p
(cÚ¡ 
__u32
 *
p
)

77  (
__be32
)
	`__swab32p
(
p
);

78 
	}
}

79 
__®ways_šlše
 
__u32
 
	$__be32_to_ıup
(cÚ¡ 
__be32
 *
p
)

81  
	`__swab32p
((
__u32
 *)
p
);

82 
	}
}

83 
__®ways_šlše
 
__be16
 
	$__ıu_to_be16p
(cÚ¡ 
__u16
 *
p
)

85  (
__be16
)
	`__swab16p
(
p
);

86 
	}
}

87 
__®ways_šlše
 
__u16
 
	$__be16_to_ıup
(cÚ¡ 
__be16
 *
p
)

89  
	`__swab16p
((
__u16
 *)
p
);

90 
	}
}

91 
	#__ıu_to_Ë64s
(
x
èdØ{ ()(x); } 0)

	)

92 
	#__Ë64_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

93 
	#__ıu_to_Ë32s
(
x
èdØ{ ()(x); } 0)

	)

94 
	#__Ë32_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

95 
	#__ıu_to_Ë16s
(
x
èdØ{ ()(x); } 0)

	)

96 
	#__Ë16_to_ıus
(
x
èdØ{ ()(x); } 0)

	)

97 
	#__ıu_to_be64s
(
x
è
	`__swab64s
((x))

	)

98 
	#__be64_to_ıus
(
x
è
	`__swab64s
((x))

	)

99 
	#__ıu_to_be32s
(
x
è
	`__swab32s
((x))

	)

100 
	#__be32_to_ıus
(
x
è
	`__swab32s
((x))

	)

101 
	#__ıu_to_be16s
(
x
è
	`__swab16s
((x))

	)

102 
	#__be16_to_ıus
(
x
è
	`__swab16s
((x))

	)

	@/usr/include/linux/stddef.h

3 #iâdeà
__®ways_šlše


4 
	#__®ways_šlše
 
__šlše__


	)

	@/usr/include/stdc-predef.h

18 #iâdef 
_STDC_PREDEF_H


19 
	#_STDC_PREDEF_H
 1

	)

36 #ifdeà
__GCC_IEC_559


37 #ià
__GCC_IEC_559
 > 0

38 
	#__STDC_IEC_559__
 1

	)

41 
	#__STDC_IEC_559__
 1

	)

44 #ifdeà
__GCC_IEC_559_COMPLEX


45 #ià
__GCC_IEC_559_COMPLEX
 > 0

46 
	#__STDC_IEC_559_COMPLEX__
 1

	)

49 
	#__STDC_IEC_559_COMPLEX__
 1

	)

55 
	#__STDC_ISO_10646__
 201505L

	)

58 
	#__STDC_NO_THREADS__
 1

	)

	@/usr/include/sys/cdefs.h

18 #iâdef 
_SYS_CDEFS_H


19 
	#_SYS_CDEFS_H
 1

	)

22 #iâdeà
_FEATURES_H


23 
	~<ã©u»s.h
>

29 #ià
defšed
 
__GNUC__
 && !defšed 
__STDC__


34 #undeà
__P


35 #undeà
__PMT


37 #ifdeà
__GNUC__


41 #ià
__GNUC_PREREQ
 (4, 6è&& !
defšed
 
_LIBC


42 
	#__LEAF
 , 
__Ëaf__


	)

43 
	#__LEAF_ATTR
 
	`__©Œibu‹__
 ((
__Ëaf__
))

	)

45 
	#__LEAF


	)

46 
	#__LEAF_ATTR


	)

54 #ià!
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (3, 3)

55 
	#__THROW
 
	`__©Œibu‹__
 ((
__nÙhrow__
 
__LEAF
))

	)

56 
	#__THROWNL
 
	`__©Œibu‹__
 ((
__nÙhrow__
))

	)

57 
	#__NTH
(
fù
è
	`__©Œibu‹__
 ((
__nÙhrow__
 
__LEAF
)è
	)
fct

59 #ià
defšed
 
__ılu¥lus
 && 
__GNUC_PREREQ
 (2,8)

60 
	#__THROW
 
	`throw
 ()

	)

61 
	#__THROWNL
 
	`throw
 ()

	)

62 
	#__NTH
(
fù
è
__LEAF_ATTR
 fù 
	`throw
 ()

	)

64 
	#__THROW


	)

65 
	#__THROWNL


	)

66 
	#__NTH
(
fù
è
	)
fct

72 
	#__šlše


	)

74 
	#__THROW


	)

75 
	#__THROWNL


	)

76 
	#__NTH
(
fù
è
	)
fct

82 
	#__P
(
¬gs
è
	)
args

83 
	#__PMT
(
¬gs
è
	)
args

88 
	#__CONCAT
(
x
,
y
èx ## 
	)
y

89 
	#__STRING
(
x
è#x

	)

92 
	#__±r_t
 *

	)

93 
	#__lÚg_doubË_t
 

	)

97 #ifdef 
__ılu¥lus


98 
	#__BEGIN_DECLS
 "C" {

	)

99 
	#__END_DECLS
 }

	)

101 
	#__BEGIN_DECLS


	)

102 
	#__END_DECLS


	)

111 #ià
defšed
 
__ılu¥lus
 && defšed 
_GLIBCPP_USE_NAMESPACES


112 
	#__BEGIN_NAMESPACE_STD
 
Çme¥aû
 
¡d
 {

	)

113 
	#__END_NAMESPACE_STD
 }

	)

114 
	#__USING_NAMESPACE_STD
(
Çme
è
usšg
 
¡d
::Çme;

	)

115 
	#__BEGIN_NAMESPACE_C99
 
Çme¥aû
 
__c99
 {

	)

116 
	#__END_NAMESPACE_C99
 }

	)

117 
	#__USING_NAMESPACE_C99
(
Çme
è
usšg
 
__c99
::Çme;

	)

122 
	#__BEGIN_NAMESPACE_STD


	)

123 
	#__END_NAMESPACE_STD


	)

124 
	#__USING_NAMESPACE_STD
(
Çme
)

	)

125 
	#__BEGIN_NAMESPACE_C99


	)

126 
	#__END_NAMESPACE_C99


	)

127 
	#__USING_NAMESPACE_C99
(
Çme
)

	)

132 
	#__bos
(
±r
è
	`__butš_objeù_size
 (±r, 
__USE_FORTIFY_LEVEL
 > 1)

	)

133 
	#__bos0
(
±r
è
	`__butš_objeù_size
 (±r, 0)

	)

135 #ià
__GNUC_PREREQ
 (4,3)

136 
	#__w¬ndeş
(
Çme
, 
msg
) \

137 
	`Çme
 (è
	`__©Œibu‹__
((
	`__w¬nšg__
 (
msg
)))

	)

138 
	#__w¬Ç‰r
(
msg
è
	`__©Œibu‹__
((
	`__w¬nšg__
 (msg)))

	)

139 
	#__”rÜdeş
(
Çme
, 
msg
) \

140 
	`Çme
 (è
	`__©Œibu‹__
((
	`__”rÜ__
 (
msg
)))

	)

142 
	#__w¬ndeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

143 
	#__w¬Ç‰r
(
msg
)

	)

144 
	#__”rÜdeş
(
Çme
, 
msg
è
	`Çme
 ()

	)

148 #ià
__GNUC_PREREQ
 (2,97)

150 
	#__æex¬r
 []

	)

152 #ifdeà
__GNUC__


153 
	#__æex¬r
 [0]

	)

155 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

156 
	#__æex¬r
 []

	)

159 
	#__æex¬r
 [1]

	)

175 #ià
defšed
 
__GNUC__
 && __GNUC__ >= 2

177 
	#__REDIRECT
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

178 #ifdeà
__ılu¥lus


179 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

180 
Çme
 
´Ùo
 
__THROW
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

181 
	#__REDIRECT_NTHNL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

182 
Çme
 
´Ùo
 
__THROWNL
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs))

	)

184 
	#__REDIRECT_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
) \

185 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROW


	)

186 
	#__REDIRECT_NTHNL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

187 
Çme
 
´Ùo
 
	`__asm__
 (
	`__ASMNAME
 (#®Ÿs)è
__THROWNL


	)

189 
	#__ASMNAME
(
úame
è
	`__ASMNAME2
 (
__USER_LABEL_PREFIX__
, cÇme)

	)

190 
	#__ASMNAME2
(
´efix
, 
úame
è
	`__STRING
 (´efixè
	)
cname

203 #ià!
defšed
 
__GNUC__
 || __GNUC__ < 2

204 
	#__©Œibu‹__
(
xyz
è

	)

210 #ià
__GNUC_PREREQ
 (2,96)

211 
	#__©Œibu‹_m®loc__
 
	`__©Œibu‹__
 ((
__m®loc__
))

	)

213 
	#__©Œibu‹_m®loc__


	)

218 #ià
__GNUC_PREREQ
 (4, 3)

219 
	#__©Œibu‹_®loc_size__
(
·¿ms
) \

220 
	`__©Œibu‹__
 ((
__®loc_size__
 
·¿ms
))

	)

222 
	#__©Œibu‹_®loc_size__
(
·¿ms
è

	)

228 #ià
__GNUC_PREREQ
 (2,96)

229 
	#__©Œibu‹_pu»__
 
	`__©Œibu‹__
 ((
__pu»__
))

	)

231 
	#__©Œibu‹_pu»__


	)

235 #ià
__GNUC_PREREQ
 (2,5)

236 
	#__©Œibu‹_cÚ¡__
 
	`__©Œibu‹__
 ((
__cÚ¡__
))

	)

238 
	#__©Œibu‹_cÚ¡__


	)

244 #ià
__GNUC_PREREQ
 (3,1)

245 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__u£d__
))

	)

246 
	#__©Œibu‹_nošlše__
 
	`__©Œibu‹__
 ((
__nošlše__
))

	)

248 
	#__©Œibu‹_u£d__
 
	`__©Œibu‹__
 ((
__unu£d__
))

	)

249 
	#__©Œibu‹_nošlše__


	)

253 #ià
__GNUC_PREREQ
 (3,2)

254 
	#__©Œibu‹_d•»ÿ‹d__
 
	`__©Œibu‹__
 ((
__d•»ÿ‹d__
))

	)

256 
	#__©Œibu‹_d•»ÿ‹d__


	)

265 #ià
__GNUC_PREREQ
 (2,8)

266 
	#__©Œibu‹_fÜm©_¬g__
(
x
è
	`__©Œibu‹__
 ((
	`__fÜm©_¬g__
 (x)))

	)

268 
	#__©Œibu‹_fÜm©_¬g__
(
x
è

	)

275 #ià
__GNUC_PREREQ
 (2,97)

276 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
) \

277 
	`__©Œibu‹__
 ((
	`__fÜm©__
 (
__¡rfmÚ__
, 
a
, 
b
)))

	)

279 
	#__©Œibu‹_fÜm©_¡rfmÚ__
(
a
,
b
è

	)

284 #ià
__GNUC_PREREQ
 (3,3)

285 
	#__nÚnuÎ
(
·¿ms
è
	`__©Œibu‹__
 ((
__nÚnuÎ__
…¬ams))

	)

287 
	#__nÚnuÎ
(
·¿ms
)

	)

292 #ià
__GNUC_PREREQ
 (3,4)

293 
	#__©Œibu‹_w¬n_unu£d_»suÉ__
 \

294 
	`__©Œibu‹__
 ((
__w¬n_unu£d_»suÉ__
))

	)

295 #ià
__USE_FORTIFY_LEVEL
 > 0

296 
	#__wur
 
__©Œibu‹_w¬n_unu£d_»suÉ__


	)

299 
	#__©Œibu‹_w¬n_unu£d_»suÉ__


	)

301 #iâdeà
__wur


302 
	#__wur


	)

306 #ià
__GNUC_PREREQ
 (3,2)

307 
	#__®ways_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__®ways_šlše__
))

	)

309 
	#__®ways_šlše
 
__šlše


	)

314 #ià
__GNUC_PREREQ
 (4,3)

315 
	#__©Œibu‹_¬tificŸl__
 
	`__©Œibu‹__
 ((
__¬tificŸl__
))

	)

317 
	#__©Œibu‹_¬tificŸl__


	)

329 #ià(!
defšed
 
__ılu¥lus
 || 
__GNUC_PREREQ
 (4,3) \

330 || (
defšed
 
__şªg__
 && (defšed 
__GNUC_STDC_INLINE__
 \

331 || 
defšed
 
__GNUC_GNU_INLINE__
)))

332 #ià
defšed
 
__GNUC_STDC_INLINE__
 || defšed 
__ılu¥lus


333 
	#__ex‹º_šlše
 
__šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

334 
	#__ex‹º_®ways_šlše
 \

335 
__®ways_šlše
 
	`__©Œibu‹__
 ((
__gnu_šlše__
))

	)

337 
	#__ex‹º_šlše
 
__šlše


	)

338 
	#__ex‹º_®ways_šlše
 
__®ways_šlše


	)

342 #ifdeà
__ex‹º_®ways_šlše


343 
	#__fÜtify_funùiÚ
 
__ex‹º_®ways_šlše
 
__©Œibu‹_¬tificŸl__


	)

348 #ià
__GNUC_PREREQ
 (4,3)

349 
	#__va_¬g_·ck
(è
	`__butš_va_¬g_·ck
 ()

	)

350 
	#__va_¬g_·ck_Ën
(è
	`__butš_va_¬g_·ck_Ën
 ()

	)

357 #ià!
__GNUC_PREREQ
 (2,8)

358 
	#__ex‹nsiÚ__


	)

362 #ià!
__GNUC_PREREQ
 (2,92)

363 
	#__»¡riù


	)

369 #ià
__GNUC_PREREQ
 (3,1è&& !
defšed
 
__GNUG__


370 
	#__»¡riù_¬r
 
__»¡riù


	)

372 #ifdeà
__GNUC__


373 
	#__»¡riù_¬r


	)

375 #ià
defšed
 
__STDC_VERSION__
 && __STDC_VERSION__ >= 199901L

376 
	#__»¡riù_¬r
 
»¡riù


	)

379 
	#__»¡riù_¬r


	)

384 #ià
__GNUC__
 >= 3

385 
	#__glibc_uÆik–y
(
cÚd
è
	`__butš_ex³ù
 ((cÚd), 0)

	)

386 
	#__glibc_lik–y
(
cÚd
è
	`__butš_ex³ù
 ((cÚd), 1)

	)

388 
	#__glibc_uÆik–y
(
cÚd
è(cÚd)

	)

389 
	#__glibc_lik–y
(
cÚd
è(cÚd)

	)

392 #ià(!
defšed
 
_NÜ‘uº
 \

393 && (
defšed
 
__STDC_VERSION__
 ? __STDC_VERSION__ : 0) < 201112 \

394 && !
	$__GNUC_PREREQ
 (4,7))

395 #ià
	`__GNUC_PREREQ
 (2,8)

396 
	#_NÜ‘uº
 
	`__©Œibu‹__
 ((
__nÜ‘uº__
))

	)

398 
	#_NÜ‘uº


	)

402 #ià(!
defšed
 
_Stic_as£¹
 && !defšed 
__ılu¥lus
 \

403 && (
defšed
 
__STDC_VERSION__
 ? __STDC_VERSION__ : 0) < 201112 \

404 && (!
	`__GNUC_PREREQ
 (4, 6è|| 
defšed
 
__STRICT_ANSI__
))

405 
	#_Stic_as£¹
(
ex´
, 
dŸgno¡ic
) \

406 (*
	`__Stic_as£¹_funùiÚ
 ()) \

407 [!! (¡ruù { 
__”rÜ_if_Ãg©ive
: (
ex´
è? 2 : -1; })]

	)

410 
	~<b™s/wÜdsize.h
>

412 #ià
defšed
 
__LONG_DOUBLE_MATH_OPTIONAL
 && defšed 
__NO_LONG_DOUBLE_MATH


413 
	#__LDBL_COMPAT
 1

	)

414 #ifdeà
__REDIRECT


415 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

416 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
) \

417 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

418 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT_NTH
 (Çme,…rÙo,‡lŸs)

	)

419 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
) \

420 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##Çme)

	)

421 
	#__LDBL_REDIR1_DECL
(
Çme
, 
®Ÿs
) \

422 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 (#®Ÿs));

	)

423 
	#__LDBL_REDIR_DECL
(
Çme
) \

424 
	`__ty³of
 (
Çme
èÇm
	`__asm
 (
	`__ASMNAME
 ("__Ædbl_" #Çme));

	)

425 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

426 
	`__LDBL_REDIR1
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

427 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

428 
	`__LDBL_REDIR1_NTH
 (
Çme
, 
´Ùo
, 
__Ædbl_
##
®Ÿs
)

	)

431 #ià!
defšed
 
__LDBL_COMPAT
 || !defšed 
__REDIRECT


432 
	#__LDBL_REDIR1
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm
	)
proto

433 
	#__LDBL_REDIR
(
Çme
, 
´Ùo
èÇm
	)
proto

434 
	#__LDBL_REDIR1_NTH
(
Çme
, 
´Ùo
, 
®Ÿs
èÇm´ÙØ
__THROW


	)

435 
	#__LDBL_REDIR_NTH
(
Çme
, 
´Ùo
èÇm´ÙØ
__THROW


	)

436 
	#__LDBL_REDIR_DECL
(
Çme
)

	)

437 #ifdeà
__REDIRECT


438 
	#__REDIRECT_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
è
	`__REDIRECT
 (Çme,…rÙo,‡lŸs)

	)

439 
	#__REDIRECT_NTH_LDBL
(
Çme
, 
´Ùo
, 
®Ÿs
) \

440 
	`__REDIRECT_NTH
 (
Çme
, 
´Ùo
, 
®Ÿs
)

	)

	@/usr/include/asm-generic/int-ll64.h

8 #iâdeà
_ASM_GENERIC_INT_LL64_H


9 
	#_ASM_GENERIC_INT_LL64_H


	)

11 
	~<asm/b™¥”lÚg.h
>

13 #iâdeà
__ASSEMBLY__


19 
__sigÃd__
 
	t__s8
;

20 
	t__u8
;

22 
__sigÃd__
 
	t__s16
;

23 
	t__u16
;

25 
__sigÃd__
 
	t__s32
;

26 
	t__u32
;

28 #ifdeà
__GNUC__


29 
__ex‹nsiÚ__
 
__sigÃd__
 
	t__s64
;

30 
__ex‹nsiÚ__
 
	t__u64
;

32 
__sigÃd__
 
	t__s64
;

33 
	t__u64
;

	@/usr/include/asm/posix_types_32.h

1 #iâdeà
_ASM_X86_POSIX_TYPES_32_H


2 
	#_ASM_X86_POSIX_TYPES_32_H


	)

10 
	t__k”Ãl_mode_t
;

11 
	#__k”Ãl_mode_t
 
__k”Ãl_mode_t


	)

13 
	t__k”Ãl_c_pid_t
;

14 
	#__k”Ãl_c_pid_t
 
__k”Ãl_c_pid_t


	)

16 
	t__k”Ãl_uid_t
;

17 
	t__k”Ãl_gid_t
;

18 
	#__k”Ãl_uid_t
 
__k”Ãl_uid_t


	)

20 
	t__k”Ãl_Şd_dev_t
;

21 
	#__k”Ãl_Şd_dev_t
 
__k”Ãl_Şd_dev_t


	)

23 
	~<asm-g’”ic/posix_ty³s.h
>

	@/usr/include/asm/posix_types_64.h

1 #iâdeà
_ASM_X86_POSIX_TYPES_64_H


2 
	#_ASM_X86_POSIX_TYPES_64_H


	)

10 
	t__k”Ãl_Şd_uid_t
;

11 
	t__k”Ãl_Şd_gid_t
;

12 
	#__k”Ãl_Şd_uid_t
 
__k”Ãl_Şd_uid_t


	)

14 
	t__k”Ãl_Şd_dev_t
;

15 
	#__k”Ãl_Şd_dev_t
 
__k”Ãl_Şd_dev_t


	)

17 
	~<asm-g’”ic/posix_ty³s.h
>

	@/usr/include/asm/posix_types_x32.h

1 #iâdeà
_ASM_X86_POSIX_TYPES_X32_H


2 
	#_ASM_X86_POSIX_TYPES_X32_H


	)

13 
	t__k”Ãl_lÚg_t
;

14 
	t__k”Ãl_ulÚg_t
;

15 
	#__k”Ãl_lÚg_t
 
__k”Ãl_lÚg_t


	)

17 
	~<asm/posix_ty³s_64.h
>

	@/usr/include/gnu/stubs-32.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub_chæags


	)

11 
	#__¡ub_ç‰ach


	)

12 
	#__¡ub_fchæags


	)

13 
	#__¡ub_fd‘ach


	)

14 
	#__¡ub_g‰y


	)

15 
	#__¡ub_lchmod


	)

16 
	#__¡ub_»voke


	)

17 
	#__¡ub_£ogš


	)

18 
	#__¡ub_sig»tuº


	)

19 
	#__¡ub_s¡k


	)

20 
	#__¡ub_¡ty


	)

	@/usr/include/gnu/stubs-64.h

6 #ifdeà
_LIBC


7 #”rÜ 
AµliÿtiÚs
 
may
 
nÙ
 
defše
 
the
 
maüo
 
_LIBC


10 
	#__¡ub___com·t_bdæush


	)

11 
	#__¡ub_chæags


	)

12 
	#__¡ub_ç‰ach


	)

13 
	#__¡ub_fchæags


	)

14 
	#__¡ub_fd‘ach


	)

15 
	#__¡ub_g‘msg


	)

16 
	#__¡ub_g‰y


	)

17 
	#__¡ub_lchmod


	)

18 
	#__¡ub_putmsg


	)

19 
	#__¡ub_»voke


	)

20 
	#__¡ub_£ogš


	)

21 
	#__¡ub_sig»tuº


	)

22 
	#__¡ub_s¡k


	)

23 
	#__¡ub_¡ty


	)

	@/usr/include/linux/swab.h

1 #iâdeà
_LINUX_SWAB_H


2 
	#_LINUX_SWAB_H


	)

4 
	~<lšux/ty³s.h
>

6 
	~<asm/swab.h
>

12 
	#___cÚ¡ªt_swab16
(
x
è((
__u16
)( \

13 (((
__u16
)(
x
) & (__u16)0x00ffU) << 8) | \

14 (((
__u16
)(
x
è& (__u16)0xff00Uè>> 8)))

	)

16 
	#___cÚ¡ªt_swab32
(
x
è((
__u32
)( \

17 (((
__u32
)(
x
) & (__u32)0x000000ffUL) << 24) | \

18 (((
__u32
)(
x
) & (__u32)0x0000ff00UL) << 8) | \

19 (((
__u32
)(
x
) & (__u32)0x00ff0000UL) >> 8) | \

20 (((
__u32
)(
x
è& (__u32)0xff000000ULè>> 24)))

	)

22 
	#___cÚ¡ªt_swab64
(
x
è((
__u64
)( \

23 (((
__u64
)(
x
) & (__u64)0x00000000000000ffULL) << 56) | \

24 (((
__u64
)(
x
) & (__u64)0x000000000000ff00ULL) << 40) | \

25 (((
__u64
)(
x
) & (__u64)0x0000000000ff0000ULL) << 24) | \

26 (((
__u64
)(
x
) & (__u64)0x00000000ff000000ULL) << 8) | \

27 (((
__u64
)(
x
) & (__u64)0x000000ff00000000ULL) >> 8) | \

28 (((
__u64
)(
x
) & (__u64)0x0000ff0000000000ULL) >> 24) | \

29 (((
__u64
)(
x
) & (__u64)0x00ff000000000000ULL) >> 40) | \

30 (((
__u64
)(
x
è& (__u64)0xff00000000000000ULLè>> 56)))

	)

32 
	#___cÚ¡ªt_swahw32
(
x
è((
__u32
)( \

33 (((
__u32
)(
x
) & (__u32)0x0000ffffUL) << 16) | \

34 (((
__u32
)(
x
è& (__u32)0xffff0000ULè>> 16)))

	)

36 
	#___cÚ¡ªt_swahb32
(
x
è((
__u32
)( \

37 (((
__u32
)(
x
) & (__u32)0x00ff00ffUL) << 8) | \

38 (((
__u32
)(
x
è& (__u32)0xff00ff00ULè>> 8)))

	)

46 
__šlše__
 
__u16
 
	$__fswab16
(
__u16
 
v®
)

48 #ià
	`defšed
 (
__¬ch_swab16
)

49  
	`__¬ch_swab16
(
v®
);

51  
	`___cÚ¡ªt_swab16
(
v®
);

53 
	}
}

55 
__šlše__
 
__u32
 
	$__fswab32
(
__u32
 
v®
)

57 #ià
	`defšed
(
__¬ch_swab32
)

58  
	`__¬ch_swab32
(
v®
);

60  
	`___cÚ¡ªt_swab32
(
v®
);

62 
	}
}

64 
__šlše__
 
__u64
 
	$__fswab64
(
__u64
 
v®
)

66 #ià
	`defšed
 (
__¬ch_swab64
)

67  
	`__¬ch_swab64
(
v®
);

68 #–ià
	`defšed
(
__SWAB_64_THRU_32__
)

69 
__u32
 
h
 = 
v®
 >> 32;

70 
__u32
 
l
 = 
v®
 & ((1ULL << 32) - 1);

71  (((
__u64
)
	`__fswab32
(
l
)è<< 32è| ((__u64)(__fswab32(
h
)));

73  
	`___cÚ¡ªt_swab64
(
v®
);

75 
	}
}

77 
__šlše__
 
__u32
 
	$__fswahw32
(
__u32
 
v®
)

79 #ifdeà
__¬ch_swahw32


80  
	`__¬ch_swahw32
(
v®
);

82  
	`___cÚ¡ªt_swahw32
(
v®
);

84 
	}
}

86 
__šlše__
 
__u32
 
	$__fswahb32
(
__u32
 
v®
)

88 #ifdeà
__¬ch_swahb32


89  
	`__¬ch_swahb32
(
v®
);

91  
	`___cÚ¡ªt_swahb32
(
v®
);

93 
	}
}

99 #ifdeà
__HAVE_BUILTIN_BSWAP16__


100 
	#__swab16
(
x
è(
__u16
)
	`__butš_bsw­16
((__u16)(x))

	)

102 
	#__swab16
(
x
) \

103 (
	`__butš_cÚ¡ªt_p
((
__u16
)(
x
)) ? \

104 
	`___cÚ¡ªt_swab16
(
x
) : \

105 
	`__fswab16
(
x
))

	)

112 #ifdeà
__HAVE_BUILTIN_BSWAP32__


113 
	#__swab32
(
x
è(
__u32
)
	`__butš_bsw­32
((__u32)(x))

	)

115 
	#__swab32
(
x
) \

116 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

117 
	`___cÚ¡ªt_swab32
(
x
) : \

118 
	`__fswab32
(
x
))

	)

125 #ifdeà
__HAVE_BUILTIN_BSWAP64__


126 
	#__swab64
(
x
è(
__u64
)
	`__butš_bsw­64
((__u64)(x))

	)

128 
	#__swab64
(
x
) \

129 (
	`__butš_cÚ¡ªt_p
((
__u64
)(
x
)) ? \

130 
	`___cÚ¡ªt_swab64
(
x
) : \

131 
	`__fswab64
(
x
))

	)

140 
	#__swahw32
(
x
) \

141 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

142 
	`___cÚ¡ªt_swahw32
(
x
) : \

143 
	`__fswahw32
(
x
))

	)

151 
	#__swahb32
(
x
) \

152 (
	`__butš_cÚ¡ªt_p
((
__u32
)(
x
)) ? \

153 
	`___cÚ¡ªt_swahb32
(
x
) : \

154 
	`__fswahb32
(
x
))

	)

160 
__®ways_šlše
 
__u16
 
	$__swab16p
(cÚ¡ 
__u16
 *
p
)

162 #ifdeà
__¬ch_swab16p


163  
	`__¬ch_swab16p
(
p
);

165  
	`__swab16
(*
p
);

167 
	}
}

173 
__®ways_šlše
 
__u32
 
	$__swab32p
(cÚ¡ 
__u32
 *
p
)

175 #ifdeà
__¬ch_swab32p


176  
	`__¬ch_swab32p
(
p
);

178  
	`__swab32
(*
p
);

180 
	}
}

186 
__®ways_šlše
 
__u64
 
	$__swab64p
(cÚ¡ 
__u64
 *
p
)

188 #ifdeà
__¬ch_swab64p


189  
	`__¬ch_swab64p
(
p
);

191  
	`__swab64
(*
p
);

193 
	}
}

201 
__šlše__
 
__u32
 
	$__swahw32p
(cÚ¡ 
__u32
 *
p
)

203 #ifdeà
__¬ch_swahw32p


204  
	`__¬ch_swahw32p
(
p
);

206  
	`__swahw32
(*
p
);

208 
	}
}

216 
__šlše__
 
__u32
 
	$__swahb32p
(cÚ¡ 
__u32
 *
p
)

218 #ifdeà
__¬ch_swahb32p


219  
	`__¬ch_swahb32p
(
p
);

221  
	`__swahb32
(*
p
);

223 
	}
}

229 
__šlše__
 
	$__swab16s
(
__u16
 *
p
)

231 #ifdeà
__¬ch_swab16s


232 
	`__¬ch_swab16s
(
p
);

234 *
p
 = 
	`__swab16p
(p);

236 
	}
}

241 
__®ways_šlše
 
	$__swab32s
(
__u32
 *
p
)

243 #ifdeà
__¬ch_swab32s


244 
	`__¬ch_swab32s
(
p
);

246 *
p
 = 
	`__swab32p
(p);

248 
	}
}

254 
__®ways_šlše
 
	$__swab64s
(
__u64
 *
p
)

256 #ifdeà
__¬ch_swab64s


257 
	`__¬ch_swab64s
(
p
);

259 *
p
 = 
	`__swab64p
(p);

261 
	}
}

269 
__šlše__
 
	$__swahw32s
(
__u32
 *
p
)

271 #ifdeà
__¬ch_swahw32s


272 
	`__¬ch_swahw32s
(
p
);

274 *
p
 = 
	`__swahw32p
(p);

276 
	}
}

284 
__šlše__
 
	$__swahb32s
(
__u32
 *
p
)

286 #ifdeà
__¬ch_swahb32s


287 
	`__¬ch_swahb32s
(
p
);

289 *
p
 = 
	`__swahb32p
(p);

291 
	}
}

	@/usr/include/asm-generic/posix_types.h

1 #iâdeà
__ASM_GENERIC_POSIX_TYPES_H


2 
	#__ASM_GENERIC_POSIX_TYPES_H


	)

4 
	~<asm/b™¥”lÚg.h
>

13 #iâdeà
__k”Ãl_lÚg_t


14 
	t__k”Ãl_lÚg_t
;

15 
	t__k”Ãl_ulÚg_t
;

18 #iâdeà
__k”Ãl_šo_t


19 
__k”Ãl_ulÚg_t
 
	t__k”Ãl_šo_t
;

22 #iâdeà
__k”Ãl_mode_t


23 
	t__k”Ãl_mode_t
;

26 #iâdeà
__k”Ãl_pid_t


27 
	t__k”Ãl_pid_t
;

30 #iâdeà
__k”Ãl_c_pid_t


31 
	t__k”Ãl_c_pid_t
;

34 #iâdeà
__k”Ãl_uid_t


35 
	t__k”Ãl_uid_t
;

36 
	t__k”Ãl_gid_t
;

39 #iâdeà
__k”Ãl_su£cÚds_t


40 
__k”Ãl_lÚg_t
 
	t__k”Ãl_su£cÚds_t
;

43 #iâdeà
__k”Ãl_daddr_t


44 
	t__k”Ãl_daddr_t
;

47 #iâdeà
__k”Ãl_uid32_t


48 
	t__k”Ãl_uid32_t
;

49 
	t__k”Ãl_gid32_t
;

52 #iâdeà
__k”Ãl_Şd_uid_t


53 
__k”Ãl_uid_t
 
	t__k”Ãl_Şd_uid_t
;

54 
__k”Ãl_gid_t
 
	t__k”Ãl_Şd_gid_t
;

57 #iâdeà
__k”Ãl_Şd_dev_t


58 
	t__k”Ãl_Şd_dev_t
;

65 #iâdeà
__k”Ãl_size_t


66 #ià
__BITS_PER_LONG
 != 64

67 
	t__k”Ãl_size_t
;

68 
	t__k”Ãl_ssize_t
;

69 
	t__k”Ãl_±rdiff_t
;

71 
__k”Ãl_ulÚg_t
 
	t__k”Ãl_size_t
;

72 
__k”Ãl_lÚg_t
 
	t__k”Ãl_ssize_t
;

73 
__k”Ãl_lÚg_t
 
	t__k”Ãl_±rdiff_t
;

77 #iâdeà
__k”Ãl_fsid_t


79 
	mv®
[2];

80 } 
	t__k”Ãl_fsid_t
;

86 
__k”Ãl_lÚg_t
 
	t__k”Ãl_off_t
;

87 
	t__k”Ãl_loff_t
;

88 
__k”Ãl_lÚg_t
 
	t__k”Ãl_time_t
;

89 
__k”Ãl_lÚg_t
 
	t__k”Ãl_şock_t
;

90 
	t__k”Ãl_tim”_t
;

91 
	t__k”Ãl_şockid_t
;

92 * 
	t__k”Ãl_ÿddr_t
;

93 
	t__k”Ãl_uid16_t
;

94 
	t__k”Ãl_gid16_t
;

	@/usr/include/asm/bitsperlong.h

1 #iâdeà
__ASM_X86_BITSPERLONG_H


2 
	#__ASM_X86_BITSPERLONG_H


	)

4 #ià
defšed
(
__x86_64__
è&& !defšed(
__ILP32__
)

5 
	#__BITS_PER_LONG
 64

	)

7 
	#__BITS_PER_LONG
 32

	)

10 
	~<asm-g’”ic/b™¥”lÚg.h
>

	@/usr/include/asm/swab.h

1 #iâdeà
_ASM_X86_SWAB_H


2 
	#_ASM_X86_SWAB_H


	)

4 
	~<lšux/ty³s.h
>

7 
__šlše__
 
__u32
 
	$__¬ch_swab32
(
__u32
 
v®
)

9 
	`__asm__
("bsw­È%0" : "ô" (
v®
) : "0" (val));

10  
v®
;

11 
	}
}

12 
	#__¬ch_swab32
 
__¬ch_swab32


	)

14 
__šlše__
 
__u64
 
	$__¬ch_swab64
(
__u64
 
v®
)

16 #ifdeà
__i386__


19 
__u32
 
a
;

20 
__u32
 
b
;

21 } 
s
;

22 
__u64
 
u
;

23 } 
v
;

24 
v
.
u
 = 
v®
;

25 
	`__asm__
("bswapl %0 ; bswapl %1 ; xchgl %0,%1"

26 : "ô" (
v
.
s
.
a
), "ô" (v.s.
b
)

27 : "0" (
v
.
s
.
a
), "1" (v.s.
b
));

28  
v
.
u
;

30 
	`__asm__
("bsw­q %0" : "ô" (
v®
) : "0" (val));

31  
v®
;

33 
	}
}

34 
	#__¬ch_swab64
 
__¬ch_swab64


	)

	@/usr/include/asm-generic/bitsperlong.h

1 #iâdeà
__ASM_GENERIC_BITS_PER_LONG


2 
	#__ASM_GENERIC_BITS_PER_LONG


	)

11 #iâdeà
__BITS_PER_LONG


12 
	#__BITS_PER_LONG
 32

	)

	@
1
.
1
/usr/include
95
2475
bonding.c
compat.c
driver.c
driverlink_ip.c
epoll_device.c
iscsi_support.c
linux_cplane.c
linux_efabcfg.c
linux_sock_ops.c
linux_stats.c
linux_trampoline.c
mmap.c
onload_internal.h
onload_kernel_compat.h
onloadfs.c
ossock_calls.c
pinbuf.c
ppc64_linux_trampoline.c
ppc64_linux_trampoline_internal.c
ppc64_linux_trampoline_internal.h
shmbuf.c
sigaction_calls.c
tcp_sendpage.c
terminate.c
x86_linux_trampoline.c
../linux_resource/kernel_compat.h
/usr/include/asm/msr.h
/usr/include/asm/unistd.h
/usr/include/linux/eventpoll.h
/usr/include/linux/fs.h
/usr/include/linux/if_addr.h
/usr/include/linux/if_arp.h
/usr/include/linux/kernel.h
/usr/include/linux/netdevice.h
/usr/include/linux/netfilter.h
/usr/include/linux/netfilter_arp.h
/usr/include/linux/netfilter_ipv4.h
/usr/include/linux/netlink.h
/usr/include/linux/rtnetlink.h
/usr/include/linux/times.h
/usr/include/linux/unistd.h
/usr/include/linux/version.h
/usr/include/asm/unistd_32.h
/usr/include/asm/unistd_64.h
/usr/include/asm/unistd_x32.h
/usr/include/limits.h
/usr/include/linux/fcntl.h
/usr/include/linux/if.h
/usr/include/linux/if_ether.h
/usr/include/linux/if_link.h
/usr/include/linux/if_packet.h
/usr/include/linux/in.h
/usr/include/linux/in6.h
/usr/include/linux/ioctl.h
/usr/include/linux/limits.h
/usr/include/linux/neighbour.h
/usr/include/linux/sched.h
/usr/include/linux/socket.h
/usr/include/linux/sysctl.h
/usr/include/linux/sysinfo.h
/usr/include/linux/types.h
/usr/include/asm/byteorder.h
/usr/include/asm/fcntl.h
/usr/include/asm/ioctl.h
/usr/include/asm/types.h
/usr/include/bits/posix1_lim.h
/usr/include/bits/posix2_lim.h
/usr/include/bits/wordsize.h
/usr/include/bits/xopen_lim.h
/usr/include/features.h
/usr/include/linux/hdlc/ioctl.h
/usr/include/linux/libc-compat.h
/usr/include/linux/posix_types.h
/usr/include/asm-generic/fcntl.h
/usr/include/asm-generic/ioctl.h
/usr/include/asm-generic/types.h
/usr/include/asm/posix_types.h
/usr/include/bits/local_lim.h
/usr/include/bits/stdio_lim.h
/usr/include/gnu/stubs.h
/usr/include/linux/byteorder/little_endian.h
/usr/include/linux/stddef.h
/usr/include/stdc-predef.h
/usr/include/sys/cdefs.h
/usr/include/asm-generic/int-ll64.h
/usr/include/asm/posix_types_32.h
/usr/include/asm/posix_types_64.h
/usr/include/asm/posix_types_x32.h
/usr/include/gnu/stubs-32.h
/usr/include/gnu/stubs-64.h
/usr/include/linux/swab.h
/usr/include/asm-generic/posix_types.h
/usr/include/asm/bitsperlong.h
/usr/include/asm/swab.h
/usr/include/asm-generic/bitsperlong.h
